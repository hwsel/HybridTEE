cscope 15 $HOME/IntelSGX_Stable/linux-sgx-sgx_2.9/SampleCode/darknet_SGX               0000762754
	@App/App.cpp

1 
	~<¡dio.h
>

2 
	~<io¡»am
>

3 
	~<¡dlib.h
>

4 
	~"Enşave_u.h
"

5 
	~"sgx_u¹s.h
"

6 
	~"Aµ.h
"

7 
	~"d¬kÃt.h
"

8 
	~"uts.h
"

9 
	~"sock‘_­i.h
"

11 #iâdeà
TRUE


12 
	#TRUE
 1

	)

15 #iâdeà
FALSE


16 
	#FALSE
 0

	)

20 
sgx_’şave_id_t
 
	gglob®_eid
;

21 *
	gÃt_šput_back
;

22 *
	gÃt_d–_back
;

23 *
	gÃt_ouut_back
;

24 
ušt8_t
 *
	gÃt_g_bufãr
;

25 *
	gÃt_©‹¡©iÚ_bufãr
;

26 
ušt32_t
 
	g£ssiÚ_tok’
;

28 
	gglob®_¡¬t_šdex
;

31 
	$oÿÎ_´št
(cÚ¡ * 
¡r
, 
v®ue
) {

32 
	`´štf
("%s", 
¡r
);

33 
	`´štf
("%.2f", 
v®ue
);

34 
	}
}

37 
	$´št_”rÜ_mes§ge
(
sgx_¡©us_t
 
»t
) {

38 
	`´štf
("SGXƒ¼Ü code: %x\n", 
»t
);

39 
	}
}

44 
	$š™Ÿlize_’şave
()

46 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

50 
»t
 = 
	`sgx_ü—‹_’şave
(
ENCLAVE_FILENAME
, 
SGX_DEBUG_FLAG
, 
NULL
, NULL, &
glob®_eid
, NULL);

51 ià(
»t
 !ğ
SGX_SUCCESS
) {

52 
	`´št_”rÜ_mes§ge
(
»t
);

57 
	}
}

79 
	$´ediù_şassif›r
(*
d©acfg
, *
cfgfe
, *
weightfe
, *
f’ame
, *
g
, *
g_size
, 
tİ
, 
şock_t
 
time
)

81 
ÃtwÜk
 *
Ãt
 = 
	`lßd_ÃtwÜk
(
cfgfe
, 
weightfe
, 0);

82 
	`£t_b©ch_ÃtwÜk
(
Ãt
, 1);

84 
Ïy”
 
l
 = 
Ãt
->
Ïy”s
[
glob®_¡¬t_šdex
];

85 
Ïy”
 
l1
 = 
Ãt
->
Ïy”s
[Ãt->
n
 - 2];

86 
	`´štf
("\nTÙ® iÅuˆsizğ%d\n\n",
l
.
šputs
*l.
b©ch
*());

87 *
šput_v®ues
 = (*)
	`ÿÎoc
(1, 
l
.
šputs
*l.
b©ch
*());

88 
	`¤ªd
(2222222);

96 
i
 = 0;

123 
	`årštf
(
¡d”r
, "Lßdšg…¬tŸÈouut äom %s...", 
f’ame
);

124 
	`fæush
(
¡dout
);

125 
FILE
 *
å
 = 
	`fİ’
(
f’ame
, "rb");

126 if(
å
 =ğ
NULL
)

128 
	`fe_”rÜ
(
f’ame
);

131 
	`ä—d
(
šput_v®ues
, (), 
l
.
šputs
 *†.
b©ch
, 
å
);

133 
Ãt_g_bufãr
 = (
ušt8_t
 *)
	`ÿÎoc
(1,16);

134 
FILE
 *
å0
 = 
	`fİ’
(
g
, "rb");

135 if(
å0
 =ğ
NULL
)

137 
	`fe_”rÜ
(
g
);

139 
	`ä—d
(
Ãt_g_bufãr
, 1, 16, 
å0
);

151 
	`´štf
("\n Run forward…ropagation.....\n");

152 *
·¹Ÿl_»suÉs
 = 
	`ÃtwÜk_´ediù
(
Ãt
, 
šput_v®ues
);

167 
tÙ®_size
 = 
l1
.
ouuts
 *†1.
b©ch
;

168 
ouut_fe
[100];

169 
ouut_g
[80];

170 
	`´štf
("\nTÙ® sizsgx : %d\n", 
tÙ®_size
);

171 
	`¡rıy
(
ouut_fe
, "partial_outputs_sgx.data");

172 
	`årštf
(
¡d”r
, "Savšg…¬tŸÈouut tØ%s\n", 
ouut_fe
);

173 
	`¡rıy
(
ouut_g
, "tag_sgx.data");

174 
	`årštf
(
¡d”r
, "Savšg g’”©ed GCMagØ%s\n", 
ouut_g
);

175 
FILE
 *
å1
 = 
	`fİ’
(
ouut_fe
, "wb");

176 
FILE
 *
å1_1
 = 
	`fİ’
(
ouut_g
, "wb");

177 if(
å1
 =ğ
NULL
)

179 
	`fe_”rÜ
(
ouut_fe
);

181 if(
å1_1
 =ğ
NULL
)

183 
	`fe_”rÜ
(
ouut_g
);

186 
	`fwr™e
(
·¹Ÿl_»suÉs
, (), 
tÙ®_size
, 
å1
);

187 
	`fwr™e
(
Ãt_g_bufãr
, 1, 16, 
å1_1
);

189 
	`ä“
(
Ãt_ouut_back
);

190 
	`ä“
(
šput_v®ues
);

191 
	`ä“
(
Ãt_g_bufãr
);

205 
	`fşo£
(
å
);

206 
	`fşo£
(
å1
);

207 
	`fşo£
(
å0
);

208 
	`fşo£
(
å1_1
);

230 
¡©us
 = 0;

231 
¡©us
 = 
	`Sock‘_Cl›Á
(
ouut_fe
, 
ouut_g
);

232 if(
¡©us
 != 0)

234 
	`´štf
("\nUnableo send output file!!\n");

235 
	`ex™
(1);

238 
	`årštf
(
¡d”r
, "\nTÙ®ƒxecutiÚimSGX: %à£cÚds.\n", ()(
	`şock
()-
time
)/
CLOCKS_PER_SEC
);

240 ià(
f’ame
) ;

242 
	}
}

244 
	$run_şassif›r
(
¬gc
, **
¬gv
)

246 if(
¬gc
 < 4){

247 
	`årštf
(
¡d”r
, "u§ge: % % [Œaš/‹¡/v®id] [cfg] [weight (İtiÚ®)]\n", 
¬gv
[0],‡rgv[1]);

251 
¡©us
 = 0;

252 
tİ
 = 
	`fšd_št_¬g
(
¬gc
, 
¬gv
, (*)"-t", 0);

253 *
d©a
 = 
¬gv
[3];

254 *
cfg
 = 
¬gv
[4];

255 *
weights
 = (
¬gc
 > 5è? 
¬gv
[5] : 0;

256 *
f’ame
 = (
¬gc
 > 6è? 
¬gv
[6]: 0;

257 *
fesize
 = (
¬gc
 > 7è? 
¬gv
[7]: 0;

258 *
g
 = (
¬gc
 > 8è? 
¬gv
[8]: 0;

259 *
g_size
 = (
¬gc
 > 9è? 
¬gv
[9]: 0;

260 
şock_t
 
time
;

263 
glob®_¡¬t_šdex
 = 
	`fšd_št_¬g
(
¬gc
, 
¬gv
, (*)"-st", 1);

265 
¡©us
 = 
	`Sock‘_S”v”
(
f’ame
, 
fesize
, 
g
, 
g_size
, &
time
, 5000, 0);

266 if(
¡©us
 != 0)

268 
	`´štf
("\nUnableo„eceive file!!\n");

269 
	`ex™
(1);

289 if(0==
	`¡rcmp
(
¬gv
[2], (*)"predict")) {

291 
	`´ediù_şassif›r
(
d©a
, 
cfg
, 
weights
, 
f’ame
, 
g
, 
g_size
, 
tİ
, 
time
);

295 
	`´štf
("Incorrect‡rguments\n");

297 
	}
}

299 
	$»mÙe_©‹¡©iÚ
()

301 
»suÉ
 = 0;

302 
¡©us
 = 0;

303 
şock_t
 
time
 = 
	`şock
();

307 
	`´štf
("\nWait forƒncrypted UUID from SGX\n");

308 
¡©us
 = 
	`Sock‘_S”v”
((*)"d©a/d¬kÃt/£ssiÚ_tok’.d©a", (*)"d©a/d¬kÃt/tok’_size.txt", 
NULL
, NULL, &
time
, 8000, 1);

309 if(
¡©us
 != 0)

311 
	`´štf
("\nFile„eceiving failed...\n");

312 
	`ex™
(1);

314 
	`´štf
("Done....\n");

316 *
£ssiÚ_tok’_fe
 = (*)"data/darknet/session_token.data";

317 
	`årštf
(
¡d”r
, "Lßdšg sessiÚok’ from %s...", 
£ssiÚ_tok’_fe
);

318 
FILE
 *
å
 = 
	`fİ’
(
£ssiÚ_tok’_fe
, "rb");

319 if(
å
 =ğ
NULL
)

321 
	`fe_”rÜ
(
£ssiÚ_tok’_fe
);

324 
	`ä—d
(&
£ssiÚ_tok’
, (
ušt32_t
), 1, 
å
);

325 
	`fşo£
(
å
);

327 
Ãt_g_bufãr
 = (
ušt8_t
 *)
	`ÿÎoc
(1,16);

329 
Ãt_©‹¡©iÚ_bufãr
 = (*)
	`ÿÎoc
((), 46);

331 
	`´štf
("\nSessiÚok’ v®ue: %d",
£ssiÚ_tok’
);

333 
	`´štf
("\n Attesthe sessionoken with UUID\n");

334 
±r
;

335 
	`eÿÎ_©‹¡_£ssiÚ_tok’
(
glob®_eid
, &
±r
, 
£ssiÚ_tok’
, 
Ãt_©‹¡©iÚ_bufãr
, (è* 46, 
Ãt_g_bufãr
, 16);

337 if(
±r
 != 0)

340 
»suÉ
 = -1;

345 
ouut_tok’
[80];

346 
ouut_g
[80];

347 
	`¡rıy
(
ouut_tok’
, "uuid_token_sgx.data");

348 
	`årštf
(
¡d”r
, "Savšg uuidok’Ø%s\n", 
ouut_tok’
);

349 
	`¡rıy
(
ouut_g
, "tag_token_sgx.data");

350 
	`årštf
(
¡d”r
, "Savšg g’”©ed GCMagØ%s\n", 
ouut_g
);

351 
FILE
 *
å1
 = 
	`fİ’
(
ouut_tok’
, "wb");

352 
FILE
 *
å1_1
 = 
	`fİ’
(
ouut_g
, "wb");

353 if(
å1
 =ğ
NULL
)

355 
	`fe_”rÜ
(
ouut_tok’
);

357 if(
å1_1
 =ğ
NULL
)

359 
	`fe_”rÜ
(
ouut_g
);

362 
	`fwr™e
(
Ãt_©‹¡©iÚ_bufãr
, (), 46, 
å1
);

363 
	`fwr™e
(
Ãt_g_bufãr
, 1, 16, 
å1_1
);

365 
	`fşo£
(
å1
);

366 
	`fşo£
(
å1_1
);

368 
	`´štf
("\nSendheƒncryptedoken‡ndag backorustzone\n");

390 
¡©us
 = 
	`Sock‘_Cl›Á
(
ouut_tok’
, 
ouut_g
);

391 if(
¡©us
 != 0)

393 
	`´štf
("\nUnableo send output file!!\n");

394 
	`ex™
(1);

397 
	`årštf
(
¡d”r
, "\nA‰e¡©iÚ…roûs com¶‘ed iÀ%à£cÚds.\n", ()(
	`şock
()-
time
)/
CLOCKS_PER_SEC
);

399 
	`ä“
(
Ãt_g_bufãr
);

400 
	`ä“
(
Ãt_©‹¡©iÚ_bufãr
);

401  
»suÉ
;

402 
	}
}

405 
	$maš
(
¬gc
, **
¬gv
) {

406 
glob®_eid
 = 0;

407 ià(
	`š™Ÿlize_’şave
() < 0) {

408 
¡d
::
cout
 << "FaØš™Ÿliz’şave." << std::
’dl
;

411 
±r
;

413 
	`´štf
("\nRemote‡ttestation\n");

414 
»suÉ
 = 
	`»mÙe_©‹¡©iÚ
();

416 if(
»suÉ
 == 0)

418 
	`´štf
("Begin darknet\n");

419 
	`run_şassif›r
(
¬gc
, 
¬gv
);

423 
	`´štf
("\nRemote‡ttestation…rocess failed...\n");

427 
	`sgx_de¡roy_’şave
(
glob®_eid
);

429 
¡d
::
cout
 << "\nInfo: Sam¶eEnşavsucûssfuÎy„‘uºed." << std::
’dl
;

432 
	}
}

	@App/App.h

1 
	~<”r.h
>

2 
	~<¡dio.h
>

3 
	~<¡ršg.h
>

4 
	~<¡dšt.h
>

6 
	~"d¬kÃt.h
"

12 
sgx_’şave_id_t
 
glob®_eid
;

13 *
Ãt_šput_back
;

14 *
Ãt_d–_back
;

15 *
Ãt_ouut_back
;

16 
glob®_¡¬t_šdex
;

17 
ušt8_t
 *
Ãt_g_bufãr
;

19 
	#TOKEN_FILENAME
 "’şave.tok’"

	)

20 
	#ENCLAVE_FILENAME
 "’şave.sigÃd.so"

	)

22 
	#MAX_DATA_SIZE
 500

	)

23 
	#SGX_AESGCM_MAC_SIZE
 16

	)

24 
	#SGX_AESGCM_IV_SIZE
 12

	)

26 
	#DECRYPT_AND_VERIFY
 1

	)

28 
	#ENCRYPT_OUTPUT_DATA
 1

	)

	@App/Enclave_u.c

1 
	~"Enşave_u.h
"

2 
	~<”ºo.h
>

4 
	sms_eÿÎ_make_ÃtwÜk_t
 {

5 
	mms_»tv®
;

6 
	mms_n
;

7 
	mms_Ë¬nšg_¿‹
;

8 
	mms_mom’tum
;

9 
	mms_deÿy
;

10 
	mms_time_¡•s
;

11 
	mms_nÙruth
;

12 
	mms_b©ch
;

13 
	mms_subdivisiÚs
;

14 
	mms_¿ndom
;

15 
	mms_adam
;

16 
	mms_B1
;

17 
	mms_B2
;

18 
	mms_•s
;

19 
	mms_h
;

20 
	mms_w
;

21 
	mms_c
;

22 
	mms_šputs
;

23 
	mms_max_üİ
;

24 
	mms_mš_üİ
;

25 
	mms_max_¿tio
;

26 
	mms_mš_¿tio
;

27 
	mms_ûÁ”
;

28 
	mms_ş
;

29 
	mms_ªgË
;

30 
	mms_a¥eù
;

31 
	mms_§tu¿tiÚ
;

32 
	mms_exposu»
;

33 
	mms_hue
;

34 
	mms_buº_š
;

35 
	mms_pow”
;

36 
	mms_max_b©ches
;

37 
	mms_¡¬t_šdex
;

38 } 
	tms_eÿÎ_make_ÃtwÜk_t
;

40 
	sms_eÿÎ_make_cÚvŞutiÚ®_Ïy”_t
 {

41 
	mms_»tv®
;

42 
	mms_b©ch
;

43 
	mms_h
;

44 
	mms_w
;

45 
	mms_c
;

46 
	mms_n
;

47 
	mms_groups
;

48 
	mms_size
;

49 
	mms_¡ride
;

50 
	mms_·ddšg
;

51 * 
	mms_aùiv©iÚ_s
;

52 
	mms_aùi_Ëngth
;

53 
	mms_b©ch_nÜm®ize
;

54 
	mms_bš¬y
;

55 
	mms_xnÜ
;

56 
	mms_adam
;

57 
	mms_æ³d
;

58 
	mms_dÙ
;

59 } 
	tms_eÿÎ_make_cÚvŞutiÚ®_Ïy”_t
;

61 
	sms_eÿÎ_make_cÚÃùed_Ïy”_t
 {

62 
	mms_»tv®
;

63 
	mms_b©ch
;

64 
	mms_šputs
;

65 
	mms_ouuts
;

66 * 
	mms_aùiv©iÚ_s
;

67 
	mms_aùi_Ëngth
;

68 
	mms_b©ch_nÜm®ize
;

69 
	mms_adam
;

70 } 
	tms_eÿÎ_make_cÚÃùed_Ïy”_t
;

72 
	sms_eÿÎ_make_soámax_Ïy”_t
 {

73 
	mms_»tv®
;

74 
	mms_b©ch
;

75 
	mms_šputs
;

76 
	mms_groups
;

77 
	mms_‹m³¿tu»
;

78 
	mms_w
;

79 
	mms_h
;

80 
	mms_c
;

81 
	mms_¥©Ÿl
;

82 
	mms_nŞoss
;

83 } 
	tms_eÿÎ_make_soámax_Ïy”_t
;

85 
	sms_eÿÎ_make_co¡_Ïy”_t
 {

86 
	mms_»tv®
;

87 
	mms_b©ch
;

88 
	mms_šputs
;

89 * 
	mms_co¡_ty³
;

90 
	mms_co¡_size
;

91 
	mms_sÿË
;

92 
	mms_¿tio
;

93 
	mms_noobjeù_sÿË
;

94 
	mms_th»sh
;

95 } 
	tms_eÿÎ_make_co¡_Ïy”_t
;

97 
	sms_eÿÎ_make_maxpoŞ_Ïy”_t
 {

98 
	mms_»tv®
;

99 
	mms_b©ch
;

100 
	mms_h
;

101 
	mms_w
;

102 
	mms_c
;

103 
	mms_size
;

104 
	mms_¡ride
;

105 
	mms_·ddšg
;

106 } 
	tms_eÿÎ_make_maxpoŞ_Ïy”_t
;

108 
	sms_eÿÎ_make_drİout_Ïy”_t
 {

109 
	mms_»tv®
;

110 
	mms_b©ch
;

111 
	mms_šputs
;

112 
	mms_´obab™y
;

113 
	mms_w
;

114 
	mms_h
;

115 
	mms_c
;

116 * 
	mms_Ãt_´ev_ouut
;

117 
	mms_´ev_size
;

118 * 
	mms_Ãt_´ev_d–
;

119 
	mms_d–_size
;

120 } 
	tms_eÿÎ_make_drİout_Ïy”_t
;

122 
	sms_eÿÎ_make_avgpoŞ_Ïy”_t
 {

123 
	mms_»tv®
;

124 
	mms_b©ch
;

125 
	mms_w
;

126 
	mms_h
;

127 
	mms_c
;

128 } 
	tms_eÿÎ_make_avgpoŞ_Ïy”_t
;

130 
	sms_eÿÎ_®loÿ‹_wÜk¥aû_t
 {

131 
	mms_»tv®
;

132 
	mms_wÜk¥aû_size
;

133 } 
	tms_eÿÎ_®loÿ‹_wÜk¥aû_t
;

135 
	sms_eÿÎ_Œªsãr_weights_t
 {

136 
	mms_»tv®
;

137 * 
	mms_vec
;

138 
	mms_Ëngth
;

139 
	mms_Ïy”_i
;

140 
	mms_ty³
;

141 
	mms_add™iÚ®
;

142 } 
	tms_eÿÎ_Œªsãr_weights_t
;

144 
	sms_eÿÎ_Ãt_ouut_»tuº_t
 {

145 
	mms_»tv®
;

146 * 
	mms_Ãt_ouut
;

147 
	mms_Ëngth
;

148 
ušt8_t
* 
	mms_g_bufãr
;

149 
	mms_g_Ëngth
;

150 } 
	tms_eÿÎ_Ãt_ouut_»tuº_t
;

152 
	sms_eÿÎ_fÜw¬d_ÃtwÜk_t
 {

153 
	mms_»tv®
;

154 * 
	mms_Ãt_šput
;

155 
	mms_l_šputs
;

156 
ušt8_t
* 
	mms_g_bufãr
;

157 
	mms_l_g
;

158 
	mms_Ãt_Œaš
;

159 } 
	tms_eÿÎ_fÜw¬d_ÃtwÜk_t
;

161 
	sms_eÿÎ_©‹¡_£ssiÚ_tok’_t
 {

162 
	mms_»tv®
;

163 
	mms_£ssiÚ_tok’
;

164 * 
	mms_©‹¡©iÚ_bufãr
;

165 
	mms_©‹¡_size
;

166 
ušt8_t
* 
	mms_g_bufãr
;

167 
	mms_l_g
;

168 } 
	tms_eÿÎ_©‹¡_£ssiÚ_tok’_t
;

170 
	sms_eÿÎ_deüy±_t
 {

171 
	mms_»tv®
;

172 
ušt32_t
* 
	mms_’üy±_šput
;

173 
ušt32_t
 
	mms_šput_Ëngth
;

174 
ušt32_t
* 
	mms_¶aš‹xt_ouut
;

175 
ušt32_t
 
	mms_ouut_Ëngth
;

176 
ušt8_t
* 
	mms_key
;

177 
ušt32_t
 
	mms_key_size
;

178 } 
	tms_eÿÎ_deüy±_t
;

180 
	sms_eÿÎ_’üy±_t
 {

181 
	mms_»tv®
;

182 
ušt32_t
* 
	mms_¶aš‹xt_šput
;

183 
ušt32_t
 
	mms_šput_Ëngth
;

184 
ušt32_t
* 
	mms_’üy±ed_ouut
;

185 
ušt32_t
 
	mms_ouut_Ëngth
;

186 
ušt8_t
* 
	mms_key
;

187 
ušt32_t
 
	mms_key_size
;

188 } 
	tms_eÿÎ_’üy±_t
;

190 
	sms_oÿÎ_´št_t
 {

191 cÚ¡ * 
	mms_¡r
;

192 
	mms_v®ue
;

193 } 
	tms_oÿÎ_´št_t
;

195 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_oÿÎ_´št
(* 
pms
)

197 
ms_oÿÎ_´št_t
* 
ms
 = 
	`SGX_CAST
(ms_oÿÎ_´št_t*, 
pms
);

198 
	`oÿÎ_´št
(
ms
->
ms_¡r
, ms->
ms_v®ue
);

200  
SGX_SUCCESS
;

201 
	}
}

204 
size_t
 
	mÄ_oÿÎ
;

205 * 
	mbË
[1];

206 } 
	goÿÎ_bË_Enşave
 = {

209 (*)
Enşave_oÿÎ_´št
,

212 
sgx_¡©us_t
 
	$eÿÎ_make_ÃtwÜk
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
n
, 
Ë¬nšg_¿‹
, 
mom’tum
, 
deÿy
, 
time_¡•s
, 
nÙruth
, 
b©ch
, 
subdivisiÚs
, 
¿ndom
, 
adam
, 
B1
, 
B2
, 
•s
, 
h
, 
w
, 
c
, 
šputs
, 
max_üİ
, 
mš_üİ
, 
max_¿tio
, 
mš_¿tio
, 
ûÁ”
, 
ş
, 
ªgË
, 
a¥eù
, 
§tu¿tiÚ
, 
exposu»
, 
hue
, 
buº_š
, 
pow”
, 
max_b©ches
, 
¡¬t_šdex
)

214 
sgx_¡©us_t
 
¡©us
;

215 
ms_eÿÎ_make_ÃtwÜk_t
 
ms
;

216 
ms
.
ms_n
 = 
n
;

217 
ms
.
ms_Ë¬nšg_¿‹
 = 
Ë¬nšg_¿‹
;

218 
ms
.
ms_mom’tum
 = 
mom’tum
;

219 
ms
.
ms_deÿy
 = 
deÿy
;

220 
ms
.
ms_time_¡•s
 = 
time_¡•s
;

221 
ms
.
ms_nÙruth
 = 
nÙruth
;

222 
ms
.
ms_b©ch
 = 
b©ch
;

223 
ms
.
ms_subdivisiÚs
 = 
subdivisiÚs
;

224 
ms
.
ms_¿ndom
 = 
¿ndom
;

225 
ms
.
ms_adam
 = 
adam
;

226 
ms
.
ms_B1
 = 
B1
;

227 
ms
.
ms_B2
 = 
B2
;

228 
ms
.
ms_•s
 = 
•s
;

229 
ms
.
ms_h
 = 
h
;

230 
ms
.
ms_w
 = 
w
;

231 
ms
.
ms_c
 = 
c
;

232 
ms
.
ms_šputs
 = 
šputs
;

233 
ms
.
ms_max_üİ
 = 
max_üİ
;

234 
ms
.
ms_mš_üİ
 = 
mš_üİ
;

235 
ms
.
ms_max_¿tio
 = 
max_¿tio
;

236 
ms
.
ms_mš_¿tio
 = 
mš_¿tio
;

237 
ms
.
ms_ûÁ”
 = 
ûÁ”
;

238 
ms
.
ms_ş
 = 
ş
;

239 
ms
.
ms_ªgË
 = 
ªgË
;

240 
ms
.
ms_a¥eù
 = 
a¥eù
;

241 
ms
.
ms_§tu¿tiÚ
 = 
§tu¿tiÚ
;

242 
ms
.
ms_exposu»
 = 
exposu»
;

243 
ms
.
ms_hue
 = 
hue
;

244 
ms
.
ms_buº_š
 = 
buº_š
;

245 
ms
.
ms_pow”
 = 
pow”
;

246 
ms
.
ms_max_b©ches
 = 
max_b©ches
;

247 
ms
.
ms_¡¬t_šdex
 = 
¡¬t_šdex
;

248 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 0, &
oÿÎ_bË_Enşave
, &
ms
);

249 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

250  
¡©us
;

251 
	}
}

253 
sgx_¡©us_t
 
	$eÿÎ_make_cÚvŞutiÚ®_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
h
, 
w
, 
c
, 
n
, 
groups
, 
size
, 
¡ride
, 
·ddšg
, * 
aùiv©iÚ_s
, 
aùi_Ëngth
, 
b©ch_nÜm®ize
, 
bš¬y
, 
xnÜ
, 
adam
, 
æ³d
, 
dÙ
)

255 
sgx_¡©us_t
 
¡©us
;

256 
ms_eÿÎ_make_cÚvŞutiÚ®_Ïy”_t
 
ms
;

257 
ms
.
ms_b©ch
 = 
b©ch
;

258 
ms
.
ms_h
 = 
h
;

259 
ms
.
ms_w
 = 
w
;

260 
ms
.
ms_c
 = 
c
;

261 
ms
.
ms_n
 = 
n
;

262 
ms
.
ms_groups
 = 
groups
;

263 
ms
.
ms_size
 = 
size
;

264 
ms
.
ms_¡ride
 = 
¡ride
;

265 
ms
.
ms_·ddšg
 = 
·ddšg
;

266 
ms
.
ms_aùiv©iÚ_s
 = 
aùiv©iÚ_s
;

267 
ms
.
ms_aùi_Ëngth
 = 
aùi_Ëngth
;

268 
ms
.
ms_b©ch_nÜm®ize
 = 
b©ch_nÜm®ize
;

269 
ms
.
ms_bš¬y
 = 
bš¬y
;

270 
ms
.
ms_xnÜ
 = 
xnÜ
;

271 
ms
.
ms_adam
 = 
adam
;

272 
ms
.
ms_æ³d
 = 
æ³d
;

273 
ms
.
ms_dÙ
 = 
dÙ
;

274 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 1, &
oÿÎ_bË_Enşave
, &
ms
);

275 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

276  
¡©us
;

277 
	}
}

279 
sgx_¡©us_t
 
	$eÿÎ_make_cÚÃùed_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
šputs
, 
ouuts
, * 
aùiv©iÚ_s
, 
aùi_Ëngth
, 
b©ch_nÜm®ize
, 
adam
)

281 
sgx_¡©us_t
 
¡©us
;

282 
ms_eÿÎ_make_cÚÃùed_Ïy”_t
 
ms
;

283 
ms
.
ms_b©ch
 = 
b©ch
;

284 
ms
.
ms_šputs
 = 
šputs
;

285 
ms
.
ms_ouuts
 = 
ouuts
;

286 
ms
.
ms_aùiv©iÚ_s
 = 
aùiv©iÚ_s
;

287 
ms
.
ms_aùi_Ëngth
 = 
aùi_Ëngth
;

288 
ms
.
ms_b©ch_nÜm®ize
 = 
b©ch_nÜm®ize
;

289 
ms
.
ms_adam
 = 
adam
;

290 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 2, &
oÿÎ_bË_Enşave
, &
ms
);

291 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

292  
¡©us
;

293 
	}
}

295 
sgx_¡©us_t
 
	$eÿÎ_make_soámax_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
šputs
, 
groups
, 
‹m³¿tu»
, 
w
, 
h
, 
c
, 
¥©Ÿl
, 
nŞoss
)

297 
sgx_¡©us_t
 
¡©us
;

298 
ms_eÿÎ_make_soámax_Ïy”_t
 
ms
;

299 
ms
.
ms_b©ch
 = 
b©ch
;

300 
ms
.
ms_šputs
 = 
šputs
;

301 
ms
.
ms_groups
 = 
groups
;

302 
ms
.
ms_‹m³¿tu»
 = 
‹m³¿tu»
;

303 
ms
.
ms_w
 = 
w
;

304 
ms
.
ms_h
 = 
h
;

305 
ms
.
ms_c
 = 
c
;

306 
ms
.
ms_¥©Ÿl
 = 
¥©Ÿl
;

307 
ms
.
ms_nŞoss
 = 
nŞoss
;

308 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 3, &
oÿÎ_bË_Enşave
, &
ms
);

309 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

310  
¡©us
;

311 
	}
}

313 
sgx_¡©us_t
 
	$eÿÎ_make_co¡_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
šputs
, * 
co¡_ty³
, 
co¡_size
, 
sÿË
, 
¿tio
, 
noobjeù_sÿË
, 
th»sh
)

315 
sgx_¡©us_t
 
¡©us
;

316 
ms_eÿÎ_make_co¡_Ïy”_t
 
ms
;

317 
ms
.
ms_b©ch
 = 
b©ch
;

318 
ms
.
ms_šputs
 = 
šputs
;

319 
ms
.
ms_co¡_ty³
 = 
co¡_ty³
;

320 
ms
.
ms_co¡_size
 = 
co¡_size
;

321 
ms
.
ms_sÿË
 = 
sÿË
;

322 
ms
.
ms_¿tio
 = 
¿tio
;

323 
ms
.
ms_noobjeù_sÿË
 = 
noobjeù_sÿË
;

324 
ms
.
ms_th»sh
 = 
th»sh
;

325 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 4, &
oÿÎ_bË_Enşave
, &
ms
);

326 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

327  
¡©us
;

328 
	}
}

330 
sgx_¡©us_t
 
	$eÿÎ_make_maxpoŞ_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
h
, 
w
, 
c
, 
size
, 
¡ride
, 
·ddšg
)

332 
sgx_¡©us_t
 
¡©us
;

333 
ms_eÿÎ_make_maxpoŞ_Ïy”_t
 
ms
;

334 
ms
.
ms_b©ch
 = 
b©ch
;

335 
ms
.
ms_h
 = 
h
;

336 
ms
.
ms_w
 = 
w
;

337 
ms
.
ms_c
 = 
c
;

338 
ms
.
ms_size
 = 
size
;

339 
ms
.
ms_¡ride
 = 
¡ride
;

340 
ms
.
ms_·ddšg
 = 
·ddšg
;

341 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 5, &
oÿÎ_bË_Enşave
, &
ms
);

342 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

343  
¡©us
;

344 
	}
}

346 
sgx_¡©us_t
 
	$eÿÎ_make_drİout_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
šputs
, 
´obab™y
, 
w
, 
h
, 
c
, * 
Ãt_´ev_ouut
, 
´ev_size
, * 
Ãt_´ev_d–
, 
d–_size
)

348 
sgx_¡©us_t
 
¡©us
;

349 
ms_eÿÎ_make_drİout_Ïy”_t
 
ms
;

350 
ms
.
ms_b©ch
 = 
b©ch
;

351 
ms
.
ms_šputs
 = 
šputs
;

352 
ms
.
ms_´obab™y
 = 
´obab™y
;

353 
ms
.
ms_w
 = 
w
;

354 
ms
.
ms_h
 = 
h
;

355 
ms
.
ms_c
 = 
c
;

356 
ms
.
ms_Ãt_´ev_ouut
 = 
Ãt_´ev_ouut
;

357 
ms
.
ms_´ev_size
 = 
´ev_size
;

358 
ms
.
ms_Ãt_´ev_d–
 = 
Ãt_´ev_d–
;

359 
ms
.
ms_d–_size
 = 
d–_size
;

360 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 6, &
oÿÎ_bË_Enşave
, &
ms
);

361 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

362  
¡©us
;

363 
	}
}

365 
sgx_¡©us_t
 
	$eÿÎ_make_avgpoŞ_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
w
, 
h
, 
c
)

367 
sgx_¡©us_t
 
¡©us
;

368 
ms_eÿÎ_make_avgpoŞ_Ïy”_t
 
ms
;

369 
ms
.
ms_b©ch
 = 
b©ch
;

370 
ms
.
ms_w
 = 
w
;

371 
ms
.
ms_h
 = 
h
;

372 
ms
.
ms_c
 = 
c
;

373 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 7, &
oÿÎ_bË_Enşave
, &
ms
);

374 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

375  
¡©us
;

376 
	}
}

378 
sgx_¡©us_t
 
	$eÿÎ_®loÿ‹_wÜk¥aû
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
wÜk¥aû_size
)

380 
sgx_¡©us_t
 
¡©us
;

381 
ms_eÿÎ_®loÿ‹_wÜk¥aû_t
 
ms
;

382 
ms
.
ms_wÜk¥aû_size
 = 
wÜk¥aû_size
;

383 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 8, &
oÿÎ_bË_Enşave
, &
ms
);

384 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

385  
¡©us
;

386 
	}
}

388 
sgx_¡©us_t
 
	$eÿÎ_Œªsãr_weights
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, * 
vec
, 
Ëngth
, 
Ïy”_i
, 
ty³
, 
add™iÚ®
)

390 
sgx_¡©us_t
 
¡©us
;

391 
ms_eÿÎ_Œªsãr_weights_t
 
ms
;

392 
ms
.
ms_vec
 = 
vec
;

393 
ms
.
ms_Ëngth
 = 
Ëngth
;

394 
ms
.
ms_Ïy”_i
 = 
Ïy”_i
;

395 
ms
.
ms_ty³
 = 
ty³
;

396 
ms
.
ms_add™iÚ®
 = 
add™iÚ®
;

397 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 9, &
oÿÎ_bË_Enşave
, &
ms
);

398 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

399  
¡©us
;

400 
	}
}

402 
sgx_¡©us_t
 
	$eÿÎ_Ãt_ouut_»tuº
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, * 
Ãt_ouut
, 
Ëngth
, 
ušt8_t
* 
g_bufãr
, 
g_Ëngth
)

404 
sgx_¡©us_t
 
¡©us
;

405 
ms_eÿÎ_Ãt_ouut_»tuº_t
 
ms
;

406 
ms
.
ms_Ãt_ouut
 = 
Ãt_ouut
;

407 
ms
.
ms_Ëngth
 = 
Ëngth
;

408 
ms
.
ms_g_bufãr
 = 
g_bufãr
;

409 
ms
.
ms_g_Ëngth
 = 
g_Ëngth
;

410 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 10, &
oÿÎ_bË_Enşave
, &
ms
);

411 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

412  
¡©us
;

413 
	}
}

415 
sgx_¡©us_t
 
	$eÿÎ_fÜw¬d_ÃtwÜk
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, * 
Ãt_šput
, 
l_šputs
, 
ušt8_t
* 
g_bufãr
, 
l_g
, 
Ãt_Œaš
)

417 
sgx_¡©us_t
 
¡©us
;

418 
ms_eÿÎ_fÜw¬d_ÃtwÜk_t
 
ms
;

419 
ms
.
ms_Ãt_šput
 = 
Ãt_šput
;

420 
ms
.
ms_l_šputs
 = 
l_šputs
;

421 
ms
.
ms_g_bufãr
 = 
g_bufãr
;

422 
ms
.
ms_l_g
 = 
l_g
;

423 
ms
.
ms_Ãt_Œaš
 = 
Ãt_Œaš
;

424 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 11, &
oÿÎ_bË_Enşave
, &
ms
);

425 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

426  
¡©us
;

427 
	}
}

429 
sgx_¡©us_t
 
	$eÿÎ_©‹¡_£ssiÚ_tok’
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
£ssiÚ_tok’
, * 
©‹¡©iÚ_bufãr
, 
©‹¡_size
, 
ušt8_t
* 
g_bufãr
, 
l_g
)

431 
sgx_¡©us_t
 
¡©us
;

432 
ms_eÿÎ_©‹¡_£ssiÚ_tok’_t
 
ms
;

433 
ms
.
ms_£ssiÚ_tok’
 = 
£ssiÚ_tok’
;

434 
ms
.
ms_©‹¡©iÚ_bufãr
 = 
©‹¡©iÚ_bufãr
;

435 
ms
.
ms_©‹¡_size
 = 
©‹¡_size
;

436 
ms
.
ms_g_bufãr
 = 
g_bufãr
;

437 
ms
.
ms_l_g
 = 
l_g
;

438 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 12, &
oÿÎ_bË_Enşave
, &
ms
);

439 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

440  
¡©us
;

441 
	}
}

443 
sgx_¡©us_t
 
	$eÿÎ_deüy±
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
ušt32_t
* 
’üy±_šput
, ušt32_ˆ
šput_Ëngth
, ušt32_t* 
¶aš‹xt_ouut
, ušt32_ˆ
ouut_Ëngth
, 
ušt8_t
* 
key
, ušt32_ˆ
key_size
)

445 
sgx_¡©us_t
 
¡©us
;

446 
ms_eÿÎ_deüy±_t
 
ms
;

447 
ms
.
ms_’üy±_šput
 = 
’üy±_šput
;

448 
ms
.
ms_šput_Ëngth
 = 
šput_Ëngth
;

449 
ms
.
ms_¶aš‹xt_ouut
 = 
¶aš‹xt_ouut
;

450 
ms
.
ms_ouut_Ëngth
 = 
ouut_Ëngth
;

451 
ms
.
ms_key
 = 
key
;

452 
ms
.
ms_key_size
 = 
key_size
;

453 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 13, &
oÿÎ_bË_Enşave
, &
ms
);

454 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

455  
¡©us
;

456 
	}
}

458 
sgx_¡©us_t
 
	$eÿÎ_’üy±
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
ušt32_t
* 
¶aš‹xt_šput
, ušt32_ˆ
šput_Ëngth
, ušt32_t* 
’üy±ed_ouut
, ušt32_ˆ
ouut_Ëngth
, 
ušt8_t
* 
key
, ušt32_ˆ
key_size
)

460 
sgx_¡©us_t
 
¡©us
;

461 
ms_eÿÎ_’üy±_t
 
ms
;

462 
ms
.
ms_¶aš‹xt_šput
 = 
¶aš‹xt_šput
;

463 
ms
.
ms_šput_Ëngth
 = 
šput_Ëngth
;

464 
ms
.
ms_’üy±ed_ouut
 = 
’üy±ed_ouut
;

465 
ms
.
ms_ouut_Ëngth
 = 
ouut_Ëngth
;

466 
ms
.
ms_key
 = 
key
;

467 
ms
.
ms_key_size
 = 
key_size
;

468 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 14, &
oÿÎ_bË_Enşave
, &
ms
);

469 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

470  
¡©us
;

471 
	}
}

	@App/Enclave_u.h

1 #iâdeà
ENCLAVE_U_H__


2 
	#ENCLAVE_U_H__


	)

4 
	~<¡dšt.h
>

5 
	~<wch¬.h
>

6 
	~<¡ddef.h
>

7 
	~<¡ršg.h
>

8 
	~"sgx_edg”8r.h
"

11 
	~<¡dlib.h
>

13 
	#SGX_CAST
(
ty³
, 
™em
è(Ñy³)(™em))

	)

15 #ifdeà
__ılu¥lus


19 #iâdeà
OCALL_PRINT_DEFINED__


20 
	#OCALL_PRINT_DEFINED__


	)

21 
SGX_UBRIDGE
(
SGX_NOCONVENTION
, 
oÿÎ_´št
, (cÚ¡ * 
¡r
, 
v®ue
));

24 
sgx_¡©us_t
 
eÿÎ_make_ÃtwÜk
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
n
, 
Ë¬nšg_¿‹
, 
mom’tum
, 
deÿy
, 
time_¡•s
, 
nÙruth
, 
b©ch
, 
subdivisiÚs
, 
¿ndom
, 
adam
, 
B1
, 
B2
, 
•s
, 
h
, 
w
, 
c
, 
šputs
, 
max_üİ
, 
mš_üİ
, 
max_¿tio
, 
mš_¿tio
, 
ûÁ”
, 
ş
, 
ªgË
, 
a¥eù
, 
§tu¿tiÚ
, 
exposu»
, 
hue
, 
buº_š
, 
pow”
, 
max_b©ches
, 
¡¬t_šdex
);

25 
sgx_¡©us_t
 
eÿÎ_make_cÚvŞutiÚ®_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
h
, 
w
, 
c
, 
n
, 
groups
, 
size
, 
¡ride
, 
·ddšg
, * 
aùiv©iÚ_s
, 
aùi_Ëngth
, 
b©ch_nÜm®ize
, 
bš¬y
, 
xnÜ
, 
adam
, 
æ³d
, 
dÙ
);

26 
sgx_¡©us_t
 
eÿÎ_make_cÚÃùed_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
šputs
, 
ouuts
, * 
aùiv©iÚ_s
, 
aùi_Ëngth
, 
b©ch_nÜm®ize
, 
adam
);

27 
sgx_¡©us_t
 
eÿÎ_make_soámax_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
šputs
, 
groups
, 
‹m³¿tu»
, 
w
, 
h
, 
c
, 
¥©Ÿl
, 
nŞoss
);

28 
sgx_¡©us_t
 
eÿÎ_make_co¡_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
šputs
, * 
co¡_ty³
, 
co¡_size
, 
sÿË
, 
¿tio
, 
noobjeù_sÿË
, 
th»sh
);

29 
sgx_¡©us_t
 
eÿÎ_make_maxpoŞ_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
h
, 
w
, 
c
, 
size
, 
¡ride
, 
·ddšg
);

30 
sgx_¡©us_t
 
eÿÎ_make_drİout_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
šputs
, 
´obab™y
, 
w
, 
h
, 
c
, * 
Ãt_´ev_ouut
, 
´ev_size
, * 
Ãt_´ev_d–
, 
d–_size
);

31 
sgx_¡©us_t
 
eÿÎ_make_avgpoŞ_Ïy”
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
b©ch
, 
w
, 
h
, 
c
);

32 
sgx_¡©us_t
 
eÿÎ_®loÿ‹_wÜk¥aû
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
wÜk¥aû_size
);

33 
sgx_¡©us_t
 
eÿÎ_Œªsãr_weights
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, * 
vec
, 
Ëngth
, 
Ïy”_i
, 
ty³
, 
add™iÚ®
);

34 
sgx_¡©us_t
 
eÿÎ_Ãt_ouut_»tuº
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, * 
Ãt_ouut
, 
Ëngth
, 
ušt8_t
* 
g_bufãr
, 
g_Ëngth
);

35 
sgx_¡©us_t
 
eÿÎ_fÜw¬d_ÃtwÜk
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, * 
Ãt_šput
, 
l_šputs
, 
ušt8_t
* 
g_bufãr
, 
l_g
, 
Ãt_Œaš
);

36 
sgx_¡©us_t
 
eÿÎ_©‹¡_£ssiÚ_tok’
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
£ssiÚ_tok’
, * 
©‹¡©iÚ_bufãr
, 
©‹¡_size
, 
ušt8_t
* 
g_bufãr
, 
l_g
);

37 
sgx_¡©us_t
 
eÿÎ_deüy±
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
ušt32_t
* 
’üy±_šput
, ušt32_ˆ
šput_Ëngth
, ušt32_t* 
¶aš‹xt_ouut
, ušt32_ˆ
ouut_Ëngth
, 
ušt8_t
* 
key
, ušt32_ˆ
key_size
);

38 
sgx_¡©us_t
 
eÿÎ_’üy±
(
sgx_’şave_id_t
 
eid
, * 
»tv®
, 
ušt32_t
* 
¶aš‹xt_šput
, ušt32_ˆ
šput_Ëngth
, ušt32_t* 
’üy±ed_ouut
, ušt32_ˆ
ouut_Ëngth
, 
ušt8_t
* 
key
, ušt32_ˆ
key_size
);

40 #ifdeà
__ılu¥lus


	@App/activations.cpp

1 
	~"aùiv©iÚs.h
"

3 
	~<m©h.h
>

4 
	~<¡dio.h
>

5 
	~<¡dlib.h
>

6 
	~<¡ršg.h
>

8 *
	$g‘_aùiv©iÚ_¡ršg
(
ACTIVATION
 
a
)

10 
a
){

11 
LOGISTIC
:

13 
LOGGY
:

15 
RELU
:

17 
ELU
:

19 
SELU
:

21 
RELIE
:

23 
RAMP
:

25 
LINEAR
:

27 
TANH
:

29 
PLSE
:

31 
LEAKY
:

33 
STAIR
:

35 
HARDTAN
:

37 
LHTAN
:

43 
	}
}

45 
ACTIVATION
 
	$g‘_aùiv©iÚ
(*
s
)

47 ià(
	`¡rcmp
(
s
, (*)"logi¡ic")==0è 
LOGISTIC
;

48 ià(
	`¡rcmp
(
s
, (*)"loggy")==0è 
LOGGY
;

49 ià(
	`¡rcmp
(
s
, (*)"»lu")==0è 
RELU
;

50 ià(
	`¡rcmp
(
s
, (*)"–u")==0è 
ELU
;

51 ià(
	`¡rcmp
(
s
, (*)"£lu")==0è 
SELU
;

52 ià(
	`¡rcmp
(
s
, (*)"»l›")==0è 
RELIE
;

53 ià(
	`¡rcmp
(
s
, (*)"¶£")==0è 
PLSE
;

54 ià(
	`¡rcmp
(
s
, (*)"h¬dn")==0è 
HARDTAN
;

55 ià(
	`¡rcmp
(
s
, (*)"lhn")==0è 
LHTAN
;

56 ià(
	`¡rcmp
(
s
, (*)"lš—r")==0è 
LINEAR
;

57 ià(
	`¡rcmp
(
s
, (*)"¿mp")==0è 
RAMP
;

58 ià(
	`¡rcmp
(
s
, (*)"Ëaky")==0è 
LEAKY
;

59 ià(
	`¡rcmp
(
s
, (*)"nh")==0è 
TANH
;

60 ià(
	`¡rcmp
(
s
, (*)"¡aœ")==0è 
STAIR
;

61 
	`årštf
(
¡d”r
, "Couldn'ˆfšd‡ùiv©iÚ funùiÚ %s, gošg w™h ReLU\n", 
s
);

62  
RELU
;

63 
	}
}

65 
	$aùiv©e
(
x
, 
ACTIVATION
 
a
)

67 
a
){

68 
LINEAR
:

69  
	`lš—r_aùiv©e
(
x
);

70 
LOGISTIC
:

71  
	`logi¡ic_aùiv©e
(
x
);

72 
LOGGY
:

73  
	`loggy_aùiv©e
(
x
);

74 
RELU
:

75  
	`»lu_aùiv©e
(
x
);

76 
ELU
:

77  
	`–u_aùiv©e
(
x
);

78 
SELU
:

79  
	`£lu_aùiv©e
(
x
);

80 
RELIE
:

81  
	`»l›_aùiv©e
(
x
);

82 
RAMP
:

83  
	`¿mp_aùiv©e
(
x
);

84 
LEAKY
:

85  
	`Ëaky_aùiv©e
(
x
);

86 
TANH
:

87  
	`nh_aùiv©e
(
x
);

88 
PLSE
:

89  
	`¶£_aùiv©e
(
x
);

90 
STAIR
:

91  
	`¡aœ_aùiv©e
(
x
);

92 
HARDTAN
:

93  
	`h¬dn_aùiv©e
(
x
);

94 
LHTAN
:

95  
	`lhn_aùiv©e
(
x
);

98 
	}
}

100 
	$aùiv©e_¬¿y
(*
x
, cÚ¡ 
n
, cÚ¡ 
ACTIVATION
 
a
)

102 
i
;

103 
i
 = 0; i < 
n
; ++i){

104 
x
[
i
] = 
	`aùiv©e
(x[i], 
a
);

106 
	}
}

108 
	$g¿d›Á
(
x
, 
ACTIVATION
 
a
)

110 
a
){

111 
LINEAR
:

112  
	`lš—r_g¿d›Á
(
x
);

113 
LOGISTIC
:

114  
	`logi¡ic_g¿d›Á
(
x
);

115 
LOGGY
:

116  
	`loggy_g¿d›Á
(
x
);

117 
RELU
:

118  
	`»lu_g¿d›Á
(
x
);

119 
ELU
:

120  
	`–u_g¿d›Á
(
x
);

121 
SELU
:

122  
	`£lu_g¿d›Á
(
x
);

123 
RELIE
:

124  
	`»l›_g¿d›Á
(
x
);

125 
RAMP
:

126  
	`¿mp_g¿d›Á
(
x
);

127 
LEAKY
:

128  
	`Ëaky_g¿d›Á
(
x
);

129 
TANH
:

130  
	`nh_g¿d›Á
(
x
);

131 
PLSE
:

132  
	`¶£_g¿d›Á
(
x
);

133 
STAIR
:

134  
	`¡aœ_g¿d›Á
(
x
);

135 
HARDTAN
:

136  
	`h¬dn_g¿d›Á
(
x
);

137 
LHTAN
:

138  
	`lhn_g¿d›Á
(
x
);

141 
	}
}

143 
	$g¿d›Á_¬¿y
(cÚ¡ *
x
, cÚ¡ 
n
, cÚ¡ 
ACTIVATION
 
a
, *
d–
)

145 
i
;

146 
i
 = 0; i < 
n
; ++i){

147 
d–
[
i
] *ğ
	`g¿d›Á
(
x
[i], 
a
);

149 
	}
}

	@App/activations.h

1 #iâdeà
ACTIVATIONS_H


2 
	#ACTIVATIONS_H


	)

3 
	~"d¬kÃt.h
"

5 
	~"m©h.h
"

7 
ACTIVATION
 
g‘_aùiv©iÚ
(*
s
);

9 *
g‘_aùiv©iÚ_¡ršg
(
ACTIVATION
 
a
);

10 
aùiv©e
(
x
, 
ACTIVATION
 
a
);

11 
g¿d›Á
(
x
, 
ACTIVATION
 
a
);

12 
g¿d›Á_¬¿y
(cÚ¡ *
x
, cÚ¡ 
n
, cÚ¡ 
ACTIVATION
 
a
, *
d–
);

13 
aùiv©e_¬¿y
(*
x
, cÚ¡ 
n
, cÚ¡ 
ACTIVATION
 
a
);

15 
šlše
 
	$¡aœ_aùiv©e
(
x
)

17 
n
 = 
	`æoÜ
(
x
);

18 ià(
n
%2 =ğ0è 
	`æoÜ
(
x
/2.);

19  (
x
 - 
n
è+ 
	`æoÜ
(x/2.);

20 
	}
}

21 
šlše
 
	$h¬dn_aùiv©e
(
x
)

23 ià(
x
 < -1)  -1;

24 ià(
x
 > 1)  1;

25  
x
;

26 
	}
}

27 
šlše
 
	$lš—r_aùiv©e
(
x
){ x;
	}
}

28 
šlše
 
	$logi¡ic_aùiv©e
(
x
){ 1./(1. + 
	`exp
(-x));
	}
}

29 
šlše
 
	$loggy_aùiv©e
(
x
){ 2./(1. + 
	`exp
(-x)è- 1;
	}
}

30 
šlše
 
	$»lu_aùiv©e
(
x
){ x*(x>0);
	}
}

31 
šlše
 
	$–u_aùiv©e
(
x
){ (x >ğ0)*x + (x < 0)*(
	`exp
(x)-1);
	}
}

32 
šlše
 
	$£lu_aùiv©e
(
x
){ (x >ğ0)*1.0507*x + (x < 0)*1.0507*1.6732*(
	`exp
(x)-1);
	}
}

33 
šlše
 
	$»l›_aùiv©e
(
x
){ (x>0è? x : .01*x;
	}
}

34 
šlše
 
	$¿mp_aùiv©e
(
x
){ x*(x>0)+.1*x;
	}
}

35 
šlše
 
	$Ëaky_aùiv©e
(
x
){ (x>0è? x : .1*x;
	}
}

36 
šlše
 
	$nh_aùiv©e
(
x
){ (
	`exp
(2*x)-1)/Óxp(2*x)+1);
	}
}

37 
šlše
 
	$¶£_aùiv©e
(
x
)

39 if(
x
 < -4)  .01 * (x + 4);

40 if(
x
 > 4)  .01 * (x - 4) + 1;

41  .125*
x
 + .5;

42 
	}
}

44 
šlše
 
	$lhn_aùiv©e
(
x
)

46 if(
x
 < 0)  .001*x;

47 if(
x
 > 1)  .001*(x-1) + 1;

48  
x
;

49 
	}
}

50 
šlše
 
	$lhn_g¿d›Á
(
x
)

52 if(
x
 > 0 && x < 1)  1;

54 
	}
}

56 
šlše
 
	$h¬dn_g¿d›Á
(
x
)

58 ià(
x
 > -1 && x < 1)  1;

60 
	}
}

61 
šlše
 
	$lš—r_g¿d›Á
(
x
){ 1;
	}
}

62 
šlše
 
	$logi¡ic_g¿d›Á
(
x
){ (1-x)*x;
	}
}

63 
šlše
 
	$loggy_g¿d›Á
(
x
)

65 
y
 = (
x
+1.)/2.;

66  2*(1-
y
)*y;

67 
	}
}

68 
šlše
 
	$¡aœ_g¿d›Á
(
x
)

70 ià(
	`æoÜ
(
x
) == x)  0;

72 
	}
}

73 
šlše
 
	$»lu_g¿d›Á
(
x
){ (x>0);
	}
}

74 
šlše
 
	$–u_g¿d›Á
(
x
){ (x >ğ0è+ (x < 0)*(x + 1);
	}
}

75 
šlše
 
	$£lu_g¿d›Á
(
x
){ (x >ğ0)*1.0507 + (x < 0)*(x + 1.0507*1.6732);
	}
}

76 
šlše
 
	$»l›_g¿d›Á
(
x
){ (x>0è? 1 : .01;
	}
}

77 
šlše
 
	$¿mp_g¿d›Á
(
x
){ (x>0)+.1;
	}
}

78 
šlše
 
	$Ëaky_g¿d›Á
(
x
){ (x>0è? 1 : .1;
	}
}

79 
šlše
 
	$nh_g¿d›Á
(
x
){ 1-x*x;
	}
}

80 
šlše
 
	$¶£_g¿d›Á
(
x
){ (x < 0 || x > 1è? .01 : .125;
	}
}

	@App/avgpool_layer.h

1 #iâdeà
AVGPOOL_LAYER_H


2 
	#AVGPOOL_LAYER_H


	)

4 
	~"image.h
"

6 
	~"Ïy”.h
"

9 
Ïy”
 
	tavgpoŞ_Ïy”
;

12 
avgpoŞ_Ïy”
 
make_avgpoŞ_Ïy”
(
b©ch
, 
w
, 
h
, 
c
);

	@App/blas.cpp

1 
	~"bÏs.h
"

3 
	~<m©h.h
>

4 
	~<as£¹.h
>

5 
	~<æßt.h
>

6 
	~<¡dio.h
>

7 
	~<¡dlib.h
>

8 
	~<¡ršg.h
>

9 
	$»Üg_ıu
(*
x
, 
w
, 
h
, 
c
, 
b©ch
, 
¡ride
, 
fÜw¬d
, *
out
)

11 
b
,
i
,
j
,
k
;

12 
out_c
 = 
c
/(
¡ride
*stride);

14 
b
 = 0; b < 
b©ch
; ++b){

15 
k
 = 0; k < 
c
; ++k){

16 
j
 = 0; j < 
h
; ++j){

17 
i
 = 0; i < 
w
; ++i){

18 
š_šdex
 = 
i
 + 
w
*(
j
 + 
h
*(
k
 + 
c
*
b
));

19 
c2
 = 
k
 % 
out_c
;

20 
off£t
 = 
k
 / 
out_c
;

21 
w2
 = 
i
*
¡ride
 + 
off£t
 % stride;

22 
h2
 = 
j
*
¡ride
 + 
off£t
 / stride;

23 
out_šdex
 = 
w2
 + 
w
*
¡ride
*(
h2
 + 
h
*¡ride*(
c2
 + 
out_c
*
b
));

24 if(
fÜw¬d
è
out
[
out_šdex
] = 
x
[
š_šdex
];

25 
out
[
š_šdex
] = 
x
[
out_šdex
];

30 
	}
}

32 
	$æ©‹n
(*
x
, 
size
, 
Ïy”s
, 
b©ch
, 
fÜw¬d
)

34 *
sw­
 = (*)
	`ÿÎoc
(
size
*
Ïy”s
*
b©ch
, ());

35 
i
,
c
,
b
;

36 
b
 = 0; b < 
b©ch
; ++b){

37 
c
 = 0; c < 
Ïy”s
; ++c){

38 
i
 = 0; i < 
size
; ++i){

39 
i1
 = 
b
*
Ïy”s
*
size
 + 
c
*siz+ 
i
;

40 
i2
 = 
b
*
Ïy”s
*
size
 + 
i
*Ïy” + 
c
;

41 ià(
fÜw¬d
è
sw­
[
i2
] = 
x
[
i1
];

42 
sw­
[
i1
] = 
x
[
i2
];

46 
	`memıy
(
x
, 
sw­
, 
size
*
Ïy”s
*
b©ch
*());

47 
	`ä“
(
sw­
);

48 
	}
}

50 
	$weigh‹d_sum_ıu
(*
a
, *
b
, *
s
, 
n
, *
c
)

52 
i
;

53 
i
 = 0; i < 
n
; ++i){

54 
c
[
i
] = 
s
[i]*
a
[i] + (1-s[i])*(
b
 ? b[i] : 0);

56 
	}
}

58 
	$weigh‹d_d–_ıu
(*
a
, *
b
, *
s
, *
da
, *
db
, *
ds
, 
n
, *
dc
)

60 
i
;

61 
i
 = 0; i < 
n
; ++i){

62 if(
da
èda[
i
] +ğ
dc
[i] * 
s
[i];

63 if(
db
èdb[
i
] +ğ
dc
[i] * (1-
s
[i]);

64 
ds
[
i
] +ğ
dc
[i] * (
a
[i] - 
b
[i]);

66 
	}
}

68 
	$shÜtcut_ıu
(
b©ch
, 
w1
, 
h1
, 
c1
, *
add
, 
w2
, 
h2
, 
c2
, 
s1
, 
s2
, *
out
)

70 
¡ride
 = 
w1
/
w2
;

71 
§m¶e
 = 
w2
/
w1
;

72 
	`as£¹
(
¡ride
 =ğ
h1
/
h2
);

73 
	`as£¹
(
§m¶e
 =ğ
h2
/
h1
);

74 if(
¡ride
 < 1) stride = 1;

75 if(
§m¶e
 < 1) sample = 1;

76 
mšw
 = (
w1
 < 
w2
) ? w1 : w2;

77 
mšh
 = (
h1
 < 
h2
) ? h1 : h2;

78 
mšc
 = (
c1
 < 
c2
) ? c1 : c2;

80 
i
,
j
,
k
,
b
;

81 
b
 = 0; b < 
b©ch
; ++b){

82 
k
 = 0; k < 
mšc
; ++k){

83 
j
 = 0; j < 
mšh
; ++j){

84 
i
 = 0; i < 
mšw
; ++i){

85 
out_šdex
 = 
i
*
§m¶e
 + 
w2
*(
j
*§m¶+ 
h2
*(
k
 + 
c2
*
b
));

86 
add_šdex
 = 
i
*
¡ride
 + 
w1
*(
j
*¡rid+ 
h1
*(
k
 + 
c1
*
b
));

87 
out
[
out_šdex
] = 
s1
*out[out_šdex] + 
s2
*
add
[
add_šdex
];

92 
	}
}

94 
	$m—n_ıu
(*
x
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
, *
m—n
)

96 
sÿË
 = 1./(
b©ch
 * 
¥©Ÿl
);

97 
i
,
j
,
k
;

98 
i
 = 0; i < 
f‹rs
; ++i){

99 
m—n
[
i
] = 0;

100 
j
 = 0; j < 
b©ch
; ++j){

101 
k
 = 0; k < 
¥©Ÿl
; ++k){

102 
šdex
 = 
j
*
f‹rs
*
¥©Ÿl
 + 
i
*¥©ŸÈ+ 
k
;

103 
m—n
[
i
] +ğ
x
[
šdex
];

106 
m—n
[
i
] *ğ
sÿË
;

108 
	}
}

110 
	$v¬Ÿnû_ıu
(*
x
, *
m—n
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
, *
v¬Ÿnû
)

112 
sÿË
 = 1./(
b©ch
 * 
¥©Ÿl
 - 1);

113 
i
,
j
,
k
;

114 
i
 = 0; i < 
f‹rs
; ++i){

115 
v¬Ÿnû
[
i
] = 0;

116 
j
 = 0; j < 
b©ch
; ++j){

117 
k
 = 0; k < 
¥©Ÿl
; ++k){

118 
šdex
 = 
j
*
f‹rs
*
¥©Ÿl
 + 
i
*¥©ŸÈ+ 
k
;

119 
v¬Ÿnû
[
i
] +ğ
	`pow
((
x
[
šdex
] - 
m—n
[i]), 2);

122 
v¬Ÿnû
[
i
] *ğ
sÿË
;

124 
	}
}

126 
	$l2nÜm®ize_ıu
(*
x
, *
dx
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
)

128 
b
,
f
,
i
;

129 
b
 = 0; b < 
b©ch
; ++b){

130 
i
 = 0; i < 
¥©Ÿl
; ++i){

131 
sum
 = 0;

132 
f
 = 0; f < 
f‹rs
; ++f){

133 
šdex
 = 
b
*
f‹rs
*
¥©Ÿl
 + 
f
*¥©ŸÈ+ 
i
;

134 
sum
 +ğ
	`powf
(
x
[
šdex
], 2);

136 
sum
 = 
	`sq¹f
(sum);

137 
f
 = 0; f < 
f‹rs
; ++f){

138 
šdex
 = 
b
*
f‹rs
*
¥©Ÿl
 + 
f
*¥©ŸÈ+ 
i
;

139 
x
[
šdex
] /ğ
sum
;

140 
dx
[
šdex
] = (1 - 
x
[šdex]è/ 
sum
;

144 
	}
}

147 
	$nÜm®ize_ıu
(*
x
, *
m—n
, *
v¬Ÿnû
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
)

149 
b
, 
f
, 
i
;

150 
b
 = 0; b < 
b©ch
; ++b){

151 
f
 = 0; f < 
f‹rs
; ++f){

152 
i
 = 0; i < 
¥©Ÿl
; ++i){

153 
šdex
 = 
b
*
f‹rs
*
¥©Ÿl
 + 
f
*¥©ŸÈ+ 
i
;

154 
x
[
šdex
] = (x[šdex] - 
m—n
[
f
])/(
	`sq¹
(
v¬Ÿnû
[f]) + .000001f);

158 
	}
}

160 
	$cÚ¡_ıu
(
N
, 
ALPHA
, *
X
, 
INCX
)

162 
i
;

163 
i
 = 0; i < 
N
; ++iè
X
[i*
INCX
] = 
ALPHA
;

164 
	}
}

166 
	$mul_ıu
(
N
, *
X
, 
INCX
, *
Y
, 
INCY
)

168 
i
;

169 
i
 = 0; i < 
N
; ++iè
Y
[i*
INCY
] *ğ
X
[i*
INCX
];

170 
	}
}

172 
	$pow_ıu
(
N
, 
ALPHA
, *
X
, 
INCX
, *
Y
, 
INCY
)

174 
i
;

175 
i
 = 0; i < 
N
; ++iè
Y
[i*
INCY
] = 
	`pow
(
X
[i*
INCX
], 
ALPHA
);

176 
	}
}

178 
	$axpy_ıu
(
N
, 
ALPHA
, *
X
, 
INCX
, *
Y
, 
INCY
)

180 
i
;

181 
i
 = 0; i < 
N
; ++iè
Y
[i*
INCY
] +ğ
ALPHA
*
X
[i*
INCX
];

182 
	}
}

184 
	$sÿl_ıu
(
N
, 
ALPHA
, *
X
, 
INCX
)

186 
i
;

187 
i
 = 0; i < 
N
; ++iè
X
[i*
INCX
] *ğ
ALPHA
;

188 
	}
}

190 
	$fl_ıu
(
N
, 
ALPHA
, *
X
, 
INCX
)

192 
i
;

193 
i
 = 0; i < 
N
; ++iè
X
[i*
INCX
] = 
ALPHA
;

194 
	}
}

196 
	$deš‹r_ıu
(
NX
, *
X
, 
NY
, *
Y
, 
B
, *
OUT
)

198 
i
, 
j
;

199 
šdex
 = 0;

200 
j
 = 0; j < 
B
; ++j) {

201 
i
 = 0; i < 
NX
; ++i){

202 if(
X
èX[
j
*
NX
 + 
i
] +ğ
OUT
[
šdex
];

203 ++
šdex
;

205 
i
 = 0; i < 
NY
; ++i){

206 if(
Y
èY[
j
*
NY
 + 
i
] +ğ
OUT
[
šdex
];

207 ++
šdex
;

210 
	}
}

212 
	$š‹r_ıu
(
NX
, *
X
, 
NY
, *
Y
, 
B
, *
OUT
)

214 
i
, 
j
;

215 
šdex
 = 0;

216 
j
 = 0; j < 
B
; ++j) {

217 
i
 = 0; i < 
NX
; ++i){

218 
OUT
[
šdex
++] = 
X
[
j
*
NX
 + 
i
];

220 
i
 = 0; i < 
NY
; ++i){

221 
OUT
[
šdex
++] = 
Y
[
j
*
NY
 + 
i
];

224 
	}
}

226 
	$cİy_ıu
(
N
, *
X
, 
INCX
, *
Y
, 
INCY
)

228 
i
;

229 
i
 = 0; i < 
N
; ++iè
Y
[i*
INCY
] = 
X
[i*
INCX
];

230 
	}
}

232 
	$muÉ_add_što_ıu
(
N
, *
X
, *
Y
, *
Z
)

234 
i
;

235 
i
 = 0; i < 
N
; ++iè
Z
[i] +ğ
X
[i]*
Y
[i];

236 
	}
}

238 
	$smoÙh_l1_ıu
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
)

240 
i
;

241 
i
 = 0; i < 
n
; ++i){

242 
diff
 = 
Œuth
[
i
] - 
´ed
[i];

243 
abs_v®
 = 
	`çbs
(
diff
);

244 if(
abs_v®
 < 1) {

245 
”rÜ
[
i
] = 
diff
 * diff;

246 
d–
[
i
] = 
diff
;

249 
”rÜ
[
i
] = 2*
abs_v®
 - 1;

250 
d–
[
i
] = (
diff
 < 0) ? 1 : -1;

253 
	}
}

255 
	$l1_ıu
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
)

257 
i
;

258 
i
 = 0; i < 
n
; ++i){

259 
diff
 = 
Œuth
[
i
] - 
´ed
[i];

260 
”rÜ
[
i
] = 
	`çbs
(
diff
);

261 
d–
[
i
] = 
diff
 > 0 ? 1 : -1;

263 
	}
}

265 
	$soámax_x_’t_ıu
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
)

267 
i
;

268 
i
 = 0; i < 
n
; ++i){

269 
t
 = 
Œuth
[
i
];

270 
p
 = 
´ed
[
i
];

271 
”rÜ
[
i
] = (
t
è? -
	`log
(
p
) : 0;

272 
d–
[
i
] = 
t
-
p
;

274 
	}
}

276 
	$logi¡ic_x_’t_ıu
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
)

278 
i
;

279 
i
 = 0; i < 
n
; ++i){

280 
t
 = 
Œuth
[
i
];

281 
p
 = 
´ed
[
i
];

282 
”rÜ
[
i
] = -
t
*
	`log
(
p
) - (1-t)*log(1-p);

283 
d–
[
i
] = 
t
-
p
;

285 
	}
}

287 
	$l2_ıu
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
)

289 
i
;

290 
i
 = 0; i < 
n
; ++i){

291 
diff
 = 
Œuth
[
i
] - 
´ed
[i];

292 
”rÜ
[
i
] = 
diff
 * diff;

293 
d–
[
i
] = 
diff
;

295 
	}
}

297 
	$dÙ_ıu
(
N
, *
X
, 
INCX
, *
Y
, 
INCY
)

299 
i
;

300 
dÙ
 = 0;

301 
i
 = 0; i < 
N
; ++iè
dÙ
 +ğ
X
[i*
INCX
] * 
Y
[i*
INCY
];

302  
dÙ
;

303 
	}
}

305 
	$soámax
(*
šput
, 
n
, 
‹mp
, 
¡ride
, *
ouut
)

307 
i
;

308 
sum
 = 0;

309 
Ïrge¡
 = -
FLT_MAX
;

310 
i
 = 0; i < 
n
; ++i){

311 if(
šput
[
i
*
¡ride
] > 
Ïrge¡
)†argest = input[i*stride];

313 
i
 = 0; i < 
n
; ++i){

314 
e
 = 
	`exp
(
šput
[
i
*
¡ride
]/
‹mp
 - 
Ïrge¡
/temp);

315 
sum
 +ğ
e
;

316 
ouut
[
i
*
¡ride
] = 
e
;

318 
i
 = 0; i < 
n
; ++i){

319 
ouut
[
i
*
¡ride
] /ğ
sum
;

321 
	}
}

324 
	$soámax_ıu
(*
šput
, 
n
, 
b©ch
, 
b©ch_off£t
, 
groups
, 
group_off£t
, 
¡ride
, 
‹mp
, *
ouut
)

326 
g
, 
b
;

327 
b
 = 0; b < 
b©ch
; ++b){

328 
g
 = 0; g < 
groups
; ++g){

329 
	`soámax
(
šput
 + 
b
*
b©ch_off£t
 + 
g
*
group_off£t
, 
n
, 
‹mp
, 
¡ride
, 
ouut
 + b*batch_offset + g*group_offset);

332 
	}
}

334 
	$up§m¶e_ıu
(*
š
, 
w
, 
h
, 
c
, 
b©ch
, 
¡ride
, 
fÜw¬d
, 
sÿË
, *
out
)

336 
i
, 
j
, 
k
, 
b
;

337 
b
 = 0; b < 
b©ch
; ++b){

338 
k
 = 0; k < 
c
; ++k){

339 
j
 = 0; j < 
h
*
¡ride
; ++j){

340 
i
 = 0; i < 
w
*
¡ride
; ++i){

341 
š_šdex
 = 
b
*
w
*
h
*
c
 + 
k
*w*h + (
j
/
¡ride
)*w + 
i
/stride;

342 
out_šdex
 = 
b
*
w
*
h
*
c
*
¡ride
*¡rid+ 
k
*w*h*¡ride*¡rid+ 
j
*w*¡rid+ 
i
;

343 if(
fÜw¬d
è
out
[
out_šdex
] = 
sÿË
*
š
[
š_šdex
];

344 
š
[
š_šdex
] +ğ
sÿË
*
out
[
out_šdex
];

349 
	}
}

	@App/blas.h

1 #iâdeà
BLAS_H


2 
	#BLAS_H


	)

3 
	~"d¬kÃt.h
"

5 
æ©‹n
(*
x
, 
size
, 
Ïy”s
, 
b©ch
, 
fÜw¬d
);

6 
pm
(
M
, 
N
, *
A
);

7 *
¿ndom_m©rix
(
rows
, 
cŞs
);

8 
time_¿ndom_m©rix
(
TA
, 
TB
, 
m
, 
k
, 
n
);

9 
»Üg_ıu
(*
x
, 
w
, 
h
, 
c
, 
b©ch
, 
¡ride
, 
fÜw¬d
, *
out
);

11 
‹¡_bÏs
();

13 
š‹r_ıu
(
NX
, *
X
, 
NY
, *
Y
, 
B
, *
OUT
);

14 
deš‹r_ıu
(
NX
, *
X
, 
NY
, *
Y
, 
B
, *
OUT
);

15 
muÉ_add_što_ıu
(
N
, *
X
, *
Y
, *
Z
);

17 
cÚ¡_ıu
(
N
, 
ALPHA
, *
X
, 
INCX
);

18 
cÚ¡¿š_gpu
(
N
, 
ALPHA
, * 
X
, 
INCX
);

19 
pow_ıu
(
N
, 
ALPHA
, *
X
, 
INCX
, *
Y
, 
INCY
);

20 
mul_ıu
(
N
, *
X
, 
INCX
, *
Y
, 
INCY
);

22 
‹¡_gpu_bÏs
();

23 
shÜtcut_ıu
(
b©ch
, 
w1
, 
h1
, 
c1
, *
add
, 
w2
, 
h2
, 
c2
, 
s1
, 
s2
, *
out
);

25 
m—n_ıu
(*
x
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
, *
m—n
);

26 
v¬Ÿnû_ıu
(*
x
, *
m—n
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
, *
v¬Ÿnû
);

28 
sÿË_bŸs
(*
ouut
, *
sÿËs
, 
b©ch
, 
n
, 
size
);

29 
backw¬d_sÿË_ıu
(*
x_nÜm
, *
d–
, 
b©ch
, 
n
, 
size
, *
sÿË_upd©es
);

30 
m—n_d–_ıu
(*
d–
, *
v¬Ÿnû
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
, *
m—n_d–
);

31 
v¬Ÿnû_d–_ıu
(*
x
, *
d–
, *
m—n
, *
v¬Ÿnû
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
, *
v¬Ÿnû_d–
);

32 
nÜm®ize_d–_ıu
(*
x
, *
m—n
, *
v¬Ÿnû
, *
m—n_d–
, *
v¬Ÿnû_d–
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
, *
d–
);

33 
l2nÜm®ize_ıu
(*
x
, *
dx
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
);

35 
smoÙh_l1_ıu
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
);

36 
l2_ıu
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
);

37 
l1_ıu
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
);

38 
logi¡ic_x_’t_ıu
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
);

39 
soámax_x_’t_ıu
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
);

40 
weigh‹d_sum_ıu
(*
a
, *
b
, *
s
, 
num
, *
c
);

41 
weigh‹d_d–_ıu
(*
a
, *
b
, *
s
, *
da
, *
db
, *
ds
, 
n
, *
dc
);

43 
soámax
(*
šput
, 
n
, 
‹mp
, 
¡ride
, *
ouut
);

44 
soámax_ıu
(*
šput
, 
n
, 
b©ch
, 
b©ch_off£t
, 
groups
, 
group_off£t
, 
¡ride
, 
‹mp
, *
ouut
);

45 
up§m¶e_ıu
(*
š
, 
w
, 
h
, 
c
, 
b©ch
, 
¡ride
, 
fÜw¬d
, 
sÿË
, *
out
);

	@App/connected_layer.h

1 #iâdeà
CONNECTED_LAYER_H


2 
	#CONNECTED_LAYER_H


	)

4 
	~"aùiv©iÚs.h
"

5 
	~"Ïy”.h
"

6 
	~"ÃtwÜk.h
"

8 
Ïy”
 
make_cÚÃùed_Ïy”
(
b©ch
, 
šputs
, 
ouuts
, 
ACTIVATION
 
aùiv©iÚ
, 
b©ch_nÜm®ize
, 
adam
);

	@App/convolutional_layer.h

1 #iâdeà
CONVOLUTIONAL_LAYER_H


2 
	#CONVOLUTIONAL_LAYER_H


	)

5 
	~"image.h
"

6 
	~"aùiv©iÚs.h
"

7 
	~"Ïy”.h
"

8 
	~"ÃtwÜk.h
"

10 
Ïy”
 
	tcÚvŞutiÚ®_Ïy”
;

12 
cÚvŞutiÚ®_Ïy”
 
make_cÚvŞutiÚ®_Ïy”
(
b©ch
, 
h
, 
w
, 
c
, 
n
, 
groups
, 
size
, 
¡ride
, 
·ddšg
, 
ACTIVATION
 
aùiv©iÚ
, 
b©ch_nÜm®ize
, 
bš¬y
, 
xnÜ
, 
adam
);

23 
add_bŸs
(*
ouut
, *
bŸ£s
, 
b©ch
, 
n
, 
size
);

30 
cÚvŞutiÚ®_out_height
(
cÚvŞutiÚ®_Ïy”
 
Ïy”
);

31 
cÚvŞutiÚ®_out_width
(
cÚvŞutiÚ®_Ïy”
 
Ïy”
);

	@App/cost_layer.h

1 #iâdeà
COST_LAYER_H


2 
	#COST_LAYER_H


	)

3 
	~"Ïy”.h
"

4 
	~"ÃtwÜk.h
"

6 
Ïy”
 
	tco¡_Ïy”
;

8 
COST_TYPE
 
g‘_co¡_ty³
(*
s
);

9 *
g‘_co¡_¡ršg
(
COST_TYPE
 
a
);

10 
co¡_Ïy”
 
make_co¡_Ïy”
(
b©ch
, 
šputs
, 
COST_TYPE
 
ty³
, 
sÿË
);

	@App/darknet.h

1 #iâdeà
DARKNET_API


2 
	#DARKNET_API


	)

3 
	~<¡dlib.h
>

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

6 
	~<±h»ad.h
>

9 #ifdeà
__ılu¥lus


13 
	#SECRET_NUM
 -1234

	)

14 
gpu_šdex
;

17 *
	gËaf
;

18 
	gn
;

19 *
	g·»Á
;

20 *
	gchd
;

21 *
	ggroup
;

22 **
	gÇme
;

24 
	ggroups
;

25 *
	ggroup_size
;

26 *
	ggroup_off£t
;

27 } 
	tŒ“
;

28 
Œ“
 *
»ad_Œ“
(*
f’ame
);

31 
	gLOGISTIC
, 
	gRELU
, 
	gRELIE
, 
	gLINEAR
, 
	gRAMP
, 
	gTANH
, 
	gPLSE
, 
	gLEAKY
, 
	gELU
, 
	gLOGGY
, 
	gSTAIR
, 
	gHARDTAN
, 
	gLHTAN
, 
	gSELU


32 } 
	tACTIVATION
;

35 
	gPNG
, 
	gBMP
, 
	gTGA
, 
	gJPG


36 } 
	tIMTYPE
;

39 
	gMULT
, 
	gADD
, 
	gSUB
, 
	gDIV


40 } 
	tBINARY_ACTIVATION
;

43 
	gCONVOLUTIONAL
,

44 
	gDECONVOLUTIONAL
,

45 
	gCONNECTED
,

46 
	gMAXPOOL
,

47 
	gSOFTMAX
,

48 
	gDETECTION
,

49 
	gDROPOUT
,

50 
	gCROP
,

51 
	gROUTE
,

52 
	gCOST
,

53 
	gNORMALIZATION
,

54 
	gAVGPOOL
,

55 
	gLOCAL
,

56 
	gSHORTCUT
,

57 
	gACTIVE
,

58 
	gRNN
,

59 
	gGRU
,

60 
	gLSTM
,

61 
	gCRNN
,

62 
	gBATCHNORM
,

63 
	gNETWORK
,

64 
	gXNOR
,

65 
	gREGION
,

66 
	gYOLO
,

67 
	gISEG
,

68 
	gREORG
,

69 
	gUPSAMPLE
,

70 
	gLOGXENT
,

71 
	gL2NORM
,

72 
	gBLANK


73 } 
	tLAYER_TYPE
;

76 
	gSSE
, 
	gMASKED
, 
	gL1
, 
	gSEG
, 
	gSMOOTH
,
	gWGAN


77 } 
	tCOST_TYPE
;

80 
	gb©ch
;

81 
	gË¬nšg_¿‹
;

82 
	gmom’tum
;

83 
	gdeÿy
;

84 
	gadam
;

85 
	gB1
;

86 
	gB2
;

87 
	g•s
;

88 
	gt
;

89 } 
	tupd©e_¬gs
;

91 
	gÃtwÜk
;

92 
ÃtwÜk
 
	tÃtwÜk
;

94 
	gÏy”
;

95 
Ïy”
 
	tÏy”
;

96 
	sÏy”
{

97 
LAYER_TYPE
 
	gty³
;

98 
ACTIVATION
 
	gaùiv©iÚ
;

99 
COST_TYPE
 
	gco¡_ty³
;

101 (*
	gfÜw¬d
è(
	gÏy”
, 
	gÃtwÜk
);

102 (*
	gbackw¬d
è(
	gÏy”
, 
	gÃtwÜk
);

103 (*
	gupd©e
è(
	gÏy”
, 
	gupd©e_¬gs
);

104 (*
	gfÜw¬d_gpu
è(
	gÏy”
, 
	gÃtwÜk
);

105 (*
	gbackw¬d_gpu
è(
	gÏy”
, 
	gÃtwÜk
);

106 (*
	gupd©e_gpu
è(
	gÏy”
, 
	gupd©e_¬gs
);

108 (*
	gfÜw¬d_TA
è(
	gÏy”
, * 
	gÃt_šput
, 
	gÃt_Œaš
);

109 (*
	gbackw¬d_TA
è(
	gÏy”
, 
	gÃtwÜk
);

110 (*
	gupd©e_TA
è(
	gÏy”
, 
	gupd©e_¬gs
);

112 
	gb©ch_nÜm®ize
;

113 
	gshÜtcut
;

114 
	gb©ch
;

115 
	gfÜûd
;

116 
	gæ³d
;

117 
	gšputs
;

118 
	gouuts
;

119 
	gnweights
;

120 
	gnbŸ£s
;

121 
	gexŒa
;

122 
	gŒuths
;

123 
	gh
,
	gw
,
	gc
;

124 
	gout_h
, 
	gout_w
, 
	gout_c
;

125 
	gn
;

126 
	gmax_boxes
;

127 
	ggroups
;

128 
	gsize
;

129 
	gside
;

130 
	g¡ride
;

131 
	g»v”£
;

132 
	gæ©‹n
;

133 
	g¥©Ÿl
;

134 
	g·d
;

135 
	gsq¹
;

136 
	gæ
;

137 
	gšdex
;

138 
	gbš¬y
;

139 
	gxnÜ
;

140 
	g¡•s
;

141 
	ghidd’
;

142 
	gŒuth
;

143 
	gsmoÙh
;

144 
	gdÙ
;

145 
	gªgË
;

146 
	gj™‹r
;

147 
	g§tu¿tiÚ
;

148 
	gexposu»
;

149 
	gshiá
;

150 
	g¿tio
;

151 
	gË¬nšg_¿‹_sÿË
;

152 
	gş
;

153 
	gnŞoss
;

154 
	gsoámax
;

155 
	gşas£s
;

156 
	gcoÜds
;

157 
	gbackground
;

158 
	g»scÜe
;

159 
	gobjeùÃss
;

160 
	gjošt
;

161 
	gnßdju¡
;

162 
	g»Üg
;

163 
	glog
;

164 
	gnh
;

165 *
	gmask
;

166 
	gtÙ®
;

168 
	g®pha
;

169 
	gb‘a
;

170 
	gk­·
;

172 
	gcoÜd_sÿË
;

173 
	gobjeù_sÿË
;

174 
	gnoobjeù_sÿË
;

175 
	gmask_sÿË
;

176 
	gşass_sÿË
;

177 
	gbŸs_m©ch
;

178 
	g¿ndom
;

179 
	gignÜe_th»sh
;

180 
	gŒuth_th»sh
;

181 
	gth»sh
;

182 
	gfocus
;

183 
	gşassfix
;

184 
	gabsŞu‹
;

186 
	gÚlyfÜw¬d
;

187 
	g¡İbackw¬d
;

188 
	gdÚßd
;

189 
	gdÚt§ve
;

190 
	gdÚßdsÿËs
;

191 
	gnumlßd
;

193 
	g‹m³¿tu»
;

194 
	g´obab™y
;

195 
	gsÿË
;

197 * 
	gcweights
;

198 * 
	gšdexes
;

199 * 
	gšput_Ïy”s
;

200 * 
	gšput_sizes
;

201 * 
	gm­
;

202 * 
	gcouÁs
;

203 ** 
	gsums
;

204 * 
	g¿nd
;

205 * 
	gco¡
;

206 * 
	g¡©e
;

207 * 
	g´ev_¡©e
;

208 * 
	gfÜgÙ_¡©e
;

209 * 
	gfÜgÙ_d–
;

210 * 
	g¡©e_d–
;

211 * 
	gcombše_ıu
;

212 * 
	gcombše_d–_ıu
;

214 * 
	gcÚÿt
;

215 * 
	gcÚÿt_d–
;

217 * 
	gbš¬y_weights
;

219 * 
	gbŸ£s
;

220 * 
	gbŸs_upd©es
;

222 * 
	gsÿËs
;

223 * 
	gsÿË_upd©es
;

225 * 
	gweights
;

226 * 
	gweight_upd©es
;

228 * 
	gd–
;

229 * 
	gouut
;

230 * 
	gloss
;

231 * 
	gsqu¬ed
;

232 * 
	gnÜms
;

234 * 
	g¥©Ÿl_m—n
;

235 * 
	gm—n
;

236 * 
	gv¬Ÿnû
;

238 * 
	gm—n_d–
;

239 * 
	gv¬Ÿnû_d–
;

241 * 
	grŞlšg_m—n
;

242 * 
	grŞlšg_v¬Ÿnû
;

244 * 
	gx
;

245 * 
	gx_nÜm
;

247 * 
	gm
;

248 * 
	gv
;

250 * 
	gbŸs_m
;

251 * 
	gbŸs_v
;

252 * 
	gsÿË_m
;

253 * 
	gsÿË_v
;

256 *
	gz_ıu
;

257 *
	gr_ıu
;

258 *
	gh_ıu
;

259 * 
	g´ev_¡©e_ıu
;

261 *
	g‹mp_ıu
;

262 *
	g‹mp2_ıu
;

263 *
	g‹mp3_ıu
;

265 *
	gdh_ıu
;

266 *
	ghh_ıu
;

267 *
	g´ev_ûÎ_ıu
;

268 *
	gûÎ_ıu
;

269 *
	gf_ıu
;

270 *
	gi_ıu
;

271 *
	gg_ıu
;

272 *
	go_ıu
;

273 *
	gc_ıu
;

274 *
	gdc_ıu
;

276 * 
	gbš¬y_šput
;

278 
Ïy”
 *
	gšput_Ïy”
;

279 
Ïy”
 *
	g£lf_Ïy”
;

280 
Ïy”
 *
	gouut_Ïy”
;

282 
Ïy”
 *
	g»£t_Ïy”
;

283 
Ïy”
 *
	gupd©e_Ïy”
;

284 
Ïy”
 *
	g¡©e_Ïy”
;

286 
Ïy”
 *
	gšput_g©e_Ïy”
;

287 
Ïy”
 *
	g¡©e_g©e_Ïy”
;

288 
Ïy”
 *
	gšput_§ve_Ïy”
;

289 
Ïy”
 *
	g¡©e_§ve_Ïy”
;

290 
Ïy”
 *
	gšput_¡©e_Ïy”
;

291 
Ïy”
 *
	g¡©e_¡©e_Ïy”
;

293 
Ïy”
 *
	gšput_z_Ïy”
;

294 
Ïy”
 *
	g¡©e_z_Ïy”
;

296 
Ïy”
 *
	gšput_r_Ïy”
;

297 
Ïy”
 *
	g¡©e_r_Ïy”
;

299 
Ïy”
 *
	gšput_h_Ïy”
;

300 
Ïy”
 *
	g¡©e_h_Ïy”
;

302 
Ïy”
 *
	gwz
;

303 
Ïy”
 *
	guz
;

304 
Ïy”
 *
	gwr
;

305 
Ïy”
 *
	gur
;

306 
Ïy”
 *
	gwh
;

307 
Ïy”
 *
	guh
;

308 
Ïy”
 *
	guo
;

309 
Ïy”
 *
	gwo
;

310 
Ïy”
 *
	guf
;

311 
Ïy”
 *
	gwf
;

312 
Ïy”
 *
	gui
;

313 
Ïy”
 *
	gwi
;

314 
Ïy”
 *
	gug
;

315 
Ïy”
 *
	gwg
;

317 
Œ“
 *
	gsoámax_Œ“
;

319 
size_t
 
	gwÜk¥aû_size
;

324 
ä“_Ïy”
(
Ïy”
);

327 
	gCONSTANT
, 
	gSTEP
, 
	gEXP
, 
	gPOLY
, 
	gSTEPS
, 
	gSIG
, 
	gRANDOM


328 } 
	tË¬nšg_¿‹_pŞicy
;

330 
	sÃtwÜk
{

331 
	gn
;

332 
	gb©ch
;

333 
size_t
 *
	g£’
;

334 *
	gt
;

335 
	g•och
;

336 
	gsubdivisiÚs
;

337 
Ïy”
 *
	gÏy”s
;

338 *
	gouut
;

339 
Ë¬nšg_¿‹_pŞicy
 
	gpŞicy
;

341 
	gË¬nšg_¿‹
;

342 
	gmom’tum
;

343 
	gdeÿy
;

344 
	ggamma
;

345 
	gsÿË
;

346 
	gpow”
;

347 
	gtime_¡•s
;

348 
	g¡•
;

349 
	gmax_b©ches
;

350 *
	gsÿËs
;

351 *
	g¡•s
;

352 
	gnum_¡•s
;

353 
	gbuº_š
;

355 
	gadam
;

356 
	gB1
;

357 
	gB2
;

358 
	g•s
;

360 
	gšputs
;

361 
	gouuts
;

362 
	gŒuths
;

363 
	gnÙruth
;

364 
	gh
, 
	gw
, 
	gc
;

365 
	gmax_üİ
;

366 
	gmš_üİ
;

367 
	gmax_¿tio
;

368 
	gmš_¿tio
;

369 
	gûÁ”
;

370 
	gªgË
;

371 
	ga¥eù
;

372 
	gexposu»
;

373 
	g§tu¿tiÚ
;

374 
	ghue
;

375 
	g¿ndom
;

377 
	ggpu_šdex
;

378 
Œ“
 *
	gh›¿rchy
;

380 *
	gšput
;

381 *
	gŒuth
;

382 *
	gd–
;

383 *
	gwÜk¥aû
;

384 
	gŒaš
;

385 
	gšdex
;

386 *
	gco¡
;

387 
	gş
;

390 } 
	tÃtwÜk
;

393 
	gw
;

394 
	gh
;

395 
	gsÿË
;

396 
	g¿d
;

397 
	gdx
;

398 
	gdy
;

399 
	ga¥eù
;

400 } 
	taugm’t_¬gs
;

403 
	gw
;

404 
	gh
;

405 
	gc
;

406 *
	gd©a
;

407 } 
	timage
;

410 
	gx
, 
	gy
, 
	gw
, 
	gh
;

411 } 
	tbox
;

413 
	sd‘eùiÚ
{

414 
box
 
	gbbox
;

415 
	gşas£s
;

416 *
	g´ob
;

417 *
	gmask
;

418 
	gobjeùÃss
;

419 
	gsÜt_şass
;

420 } 
	td‘eùiÚ
;

422 
	sm©rix
{

423 
	grows
, 
	gcŞs
;

424 **
	gv®s
;

425 } 
	tm©rix
;

429 
	gw
, 
	gh
;

430 
m©rix
 
	gX
;

431 
m©rix
 
	gy
;

432 
	gsh®low
;

433 *
	gnum_boxes
;

434 
box
 **
	gboxes
;

435 } 
	td©a
;

438 
	gCLASSIFICATION_DATA
, 
	gDETECTION_DATA
, 
	gCAPTCHA_DATA
, 
	gREGION_DATA
, 
	gIMAGE_DATA
, 
	gCOMPARE_DATA
, 
	gWRITING_DATA
, 
	gSWAG_DATA
, 
	gTAG_DATA
, 
	gOLD_CLASSIFICATION_DATA
, 
	gSTUDY_DATA
, 
	gDET_DATA
, 
	gSUPER_DATA
, 
	gLETTERBOX_DATA
, 
	gREGRESSION_DATA
, 
	gSEGMENTATION_DATA
, 
	gINSTANCE_DATA
, 
	gISEG_DATA


439 } 
	td©a_ty³
;

441 
	slßd_¬gs
{

442 
	gth»ads
;

443 **
	g·ths
;

444 *
	g·th
;

445 
	gn
;

446 
	gm
;

447 **
	gÏb–s
;

448 
	gh
;

449 
	gw
;

450 
	gout_w
;

451 
	gout_h
;

452 
	gnh
;

453 
	gnw
;

454 
	gnum_boxes
;

455 
	gmš
, 
	gmax
, 
	gsize
;

456 
	gşas£s
;

457 
	gbackground
;

458 
	gsÿË
;

459 
	gûÁ”
;

460 
	gcoÜds
;

461 
	gj™‹r
;

462 
	gªgË
;

463 
	ga¥eù
;

464 
	g§tu¿tiÚ
;

465 
	gexposu»
;

466 
	ghue
;

467 
d©a
 *
	gd
;

468 
image
 *
	gim
;

469 
image
 *
	g»sized
;

470 
d©a_ty³
 
	gty³
;

471 
Œ“
 *
	gh›¿rchy
;

472 } 
	tlßd_¬gs
;

475 
	gid
;

476 
	gx
,
	gy
,
	gw
,
	gh
;

477 
	gËá
, 
	gright
, 
	gtİ
, 
	gbÙtom
;

478 } 
	tbox_Ïb–
;

481 
ÃtwÜk
 *
lßd_ÃtwÜk
(*
cfg
, *
weights
, 
ş—r
);

482 
lßd_¬gs
 
g‘_ba£_¬gs
(
ÃtwÜk
 *
Ãt
);

484 
ä“_d©a
(
d©a
 
d
);

486 
	snode
{

487 *
	gv®
;

488 
node
 *
	gÃxt
;

489 
node
 *
	g´ev
;

490 } 
	tnode
;

492 
	sli¡
{

493 
	gsize
;

494 
node
 *
	gäÚt
;

495 
node
 *
	gback
;

496 } 
	tli¡
;

498 
±h»ad_t
 
lßd_d©a
(
lßd_¬gs
 
¬gs
);

499 
li¡
 *
»ad_d©a_cfg
(*
f’ame
);

500 
li¡
 *
»ad_cfg
(*
f’ame
);

501 *
»ad_fe
(*
f’ame
);

502 
d©a
 
»size_d©a
(d©¨
Üig
, 
w
, 
h
);

503 
d©a
 *
te_d©a
(d©¨
Üig
, 
divs
, 
size
);

504 
d©a
 
£Ëù_d©a
(d©¨*
Üig
, *
šds
);

506 
fÜw¬d_ÃtwÜk
(
ÃtwÜk
 *
Ãt
, *
šputs
);

507 
backw¬d_ÃtwÜk
(
ÃtwÜk
 *
Ãt
);

508 
upd©e_ÃtwÜk
(
ÃtwÜk
 *
Ãt
);

511 
dÙ_ıu
(
N
, *
X
, 
INCX
, *
Y
, 
INCY
);

512 
axpy_ıu
(
N
, 
ALPHA
, *
X
, 
INCX
, *
Y
, 
INCY
);

513 
cİy_ıu
(
N
, *
X
, 
INCX
, *
Y
, 
INCY
);

514 
sÿl_ıu
(
N
, 
ALPHA
, *
X
, 
INCX
);

515 
fl_ıu
(
N
, 
ALPHA
, * 
X
, 
INCX
);

516 
nÜm®ize_ıu
(*
x
, *
m—n
, *
v¬Ÿnû
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
);

517 
soámax
(*
šput
, 
n
, 
‹mp
, 
¡ride
, *
ouut
);

519 
be¡_3d_shiá_r
(
image
 
a
, imag
b
, 
mš
, 
max
);

520 
image
 
g‘_Ïb–
(imag**
ch¬aù”s
, *
¡ršg
, 
size
);

521 
d¿w_Ïb–
(
image
 
a
, 
r
, 
c
, imag
Ïb–
, cÚ¡ *
rgb
);

522 
§ve_image
(
image
 
im
, cÚ¡ *
Çme
);

523 
§ve_image_İtiÚs
(
image
 
im
, cÚ¡ *
Çme
, 
IMTYPE
 
f
, 
qu®™y
);

524 
g‘_Ãxt_b©ch
(
d©a
 
d
, 
n
, 
off£t
, *
X
, *
y
);

525 
g¿ysÿË_image_3c
(
image
 
im
);

526 
nÜm®ize_image
(
image
 
p
);

527 
m©rix_to_csv
(
m©rix
 
m
);

528 
Œaš_ÃtwÜk_sgd
(
ÃtwÜk
 *
Ãt
, 
d©a
 
d
, 
n
);

529 
rgbgr_image
(
image
 
im
);

530 
d©a
 
cİy_d©a
(d©¨
d
);

531 
d©a
 
cÚÿt_d©a
(d©¨
d1
, d©¨
d2
);

532 
d©a
 
lßd_ciçr10_d©a
(*
f’ame
);

533 
m©rix_tİk_accu¿cy
(
m©rix
 
Œuth
, m©rix 
guess
, 
k
);

534 
m©rix_add_m©rix
(
m©rix
 
äom
, m©rix 
to
);

535 
sÿË_m©rix
(
m©rix
 
m
, 
sÿË
);

536 
m©rix
 
csv_to_m©rix
(*
f’ame
);

537 *
ÃtwÜk_accu¿c›s
(
ÃtwÜk
 *
Ãt
, 
d©a
 
d
, 
n
);

538 
Œaš_ÃtwÜk_d©um
(
ÃtwÜk
 *
Ãt
);

539 
image
 
make_¿ndom_image
(
w
, 
h
, 
c
);

541 
d’Üm®ize_cÚÃùed_Ïy”
(
Ïy”
 
l
);

542 
d’Üm®ize_cÚvŞutiÚ®_Ïy”
(
Ïy”
 
l
);

543 
¡©i¡ics_cÚÃùed_Ïy”
(
Ïy”
 
l
);

544 
»sÿË_weights
(
Ïy”
 
l
, 
sÿË
, 
Œªs
);

545 
rgbgr_weights
(
Ïy”
 
l
);

546 
image
 *
g‘_weights
(
Ïy”
 
l
);

548 
demo
(*
cfgfe
, *
weightfe
, 
th»sh
, 
ÿm_šdex
, cÚ¡ *
f’ame
, **
Çmes
, 
şas£s
, 
äame_sk
, *
´efix
, 
avg
, 
h›r_th»sh
, 
w
, 
h
, 
ås
, 
fuÎsü“n
);

549 
g‘_d‘eùiÚ_d‘eùiÚs
(
Ïy”
 
l
, 
w
, 
h
, 
th»sh
, 
d‘eùiÚ
 *
d‘s
);

551 *
İtiÚ_fšd_¡r
(
li¡
 *
l
, *
key
, *
def
);

552 
İtiÚ_fšd_št
(
li¡
 *
l
, *
key
, 
def
);

553 
İtiÚ_fšd_št_qu›t
(
li¡
 *
l
, *
key
, 
def
);

555 
ÃtwÜk
 *
·r£_ÃtwÜk_cfg
(*
f’ame
);

556 
§ve_weights
(
ÃtwÜk
 *
Ãt
, *
f’ame
);

557 
lßd_weights
(
ÃtwÜk
 *
Ãt
, *
f’ame
);

558 
§ve_weights_u±o
(
ÃtwÜk
 *
Ãt
, *
f’ame
, 
cutoff
);

559 
lßd_weights_u±o
(
ÃtwÜk
 *
Ãt
, *
f’ame
, 
¡¬t
, 
cutoff
);

561 
z”o_objeùÃss
(
Ïy”
 
l
);

562 
g‘_»giÚ_d‘eùiÚs
(
Ïy”
 
l
, 
w
, 
h
, 
Ãtw
, 
Ãth
, 
th»sh
, *
m­
, 
Œ“_th»sh
, 
»Ïtive
, 
d‘eùiÚ
 *
d‘s
);

563 
g‘_yŞo_d‘eùiÚs
(
Ïy”
 
l
, 
w
, 
h
, 
Ãtw
, 
Ãth
, 
th»sh
, *
m­
, 
»Ïtive
, 
d‘eùiÚ
 *
d‘s
);

564 
ä“_ÃtwÜk
(
ÃtwÜk
 *
Ãt
);

565 
£t_b©ch_ÃtwÜk
(
ÃtwÜk
 *
Ãt
, 
b
);

566 
image
 
lßd_image
(*
f’ame
, 
w
, 
h
, 
c
);

567 
image
 
lßd_image_cŞÜ
(*
f’ame
, 
w
, 
h
);

568 
image
 
make_image
(
w
, 
h
, 
c
);

569 
image
 
»size_image
(imag
im
, 
w
, 
h
);

570 
ûnsÜ_image
(
image
 
im
, 
dx
, 
dy
, 
w
, 
h
);

571 
image
 
Ë‰”box_image
(imag
im
, 
w
, 
h
);

572 
image
 
üİ_image
(imag
im
, 
dx
, 
dy
, 
w
, 
h
);

573 
image
 
ûÁ”_üİ_image
(imag
im
, 
w
, 
h
);

574 
image
 
»size_mš
(imag
im
, 
mš
);

575 
image
 
»size_max
(imag
im
, 
max
);

576 
image
 
th»shŞd_image
(imag
im
, 
th»sh
);

577 
image
 
mask_to_rgb
(imag
mask
);

578 
ä“_m©rix
(
m©rix
 
m
);

579 
‹¡_»size
(*
f’ame
);

580 
show_image
(
image
 
p
, cÚ¡ *
Çme
, 
ms
);

581 
image
 
cİy_image
(imag
p
);

582 
d¿w_box_width
(
image
 
a
, 
x1
, 
y1
, 
x2
, 
y2
, 
w
, 
r
, 
g
, 
b
);

583 
g‘_cu¼’t_¿‹
(
ÃtwÜk
 *
Ãt
);

584 
compos™e_3d
(*
f1
, *
f2
, *
out
, 
d–
);

585 
d©a
 
lßd_d©a_Şd
(**
·ths
, 
n
, 
m
, **
Ïb–s
, 
k
, 
w
, 
h
);

586 
size_t
 
g‘_cu¼’t_b©ch
(
ÃtwÜk
 *
Ãt
);

587 
cÚ¡¿š_image
(
image
 
im
);

588 
Ïy”
 
g‘_ÃtwÜk_ouut_Ïy”
(
ÃtwÜk
 *
Ãt
);

589 
tİ_´ediùiÚs
(
ÃtwÜk
 *
Ãt
, 
n
, *
šdex
);

590 
æ_image
(
image
 
a
);

591 
image
 
æßt_to_image
(
w
, 
h
, 
c
, *
d©a
);

592 
gho¡_image
(
image
 
sourû
, imag
de¡
, 
dx
, 
dy
);

593 
ÃtwÜk_accu¿cy
(
ÃtwÜk
 *
Ãt
, 
d©a
 
d
);

594 
¿ndom_di¡Üt_image
(
image
 
im
, 
hue
, 
§tu¿tiÚ
, 
exposu»
);

595 
fl_image
(
image
 
m
, 
s
);

596 
image
 
g¿ysÿË_image
(imag
im
);

597 
rÙ©e_image_cw
(
image
 
im
, 
times
);

598 
wh©_time_is_™_now
();

599 
image
 
rÙ©e_image
(imag
m
, 
¿d
);

600 
visu®ize_ÃtwÜk
(
ÃtwÜk
 *
Ãt
);

601 
box_iou
(
box
 
a
, box 
b
);

602 
d©a
 
lßd_®l_ciçr10
();

603 
box_Ïb–
 *
»ad_boxes
(*
f’ame
, *
n
);

604 
box
 
æßt_to_box
(*
f
, 
¡ride
);

605 
d¿w_d‘eùiÚs
(
image
 
im
, 
d‘eùiÚ
 *
d‘s
, 
num
, 
th»sh
, **
Çmes
, imag**
®phab‘
, 
şas£s
);

607 
m©rix
 
ÃtwÜk_´ediù_d©a
(
ÃtwÜk
 *
Ãt
, 
d©a
 
‹¡
);

608 
image
 **
lßd_®phab‘
();

609 
image
 
g‘_ÃtwÜk_image
(
ÃtwÜk
 *
Ãt
);

610 *
ÃtwÜk_´ediù
(
ÃtwÜk
 *
Ãt
, *
šput
);

612 
ÃtwÜk_width
(
ÃtwÜk
 *
Ãt
);

613 
ÃtwÜk_height
(
ÃtwÜk
 *
Ãt
);

614 *
ÃtwÜk_´ediù_image
(
ÃtwÜk
 *
Ãt
, 
image
 
im
);

615 
ÃtwÜk_d‘eù
(
ÃtwÜk
 *
Ãt
, 
image
 
im
, 
th»sh
, 
h›r_th»sh
, 
nms
, 
d‘eùiÚ
 *
d‘s
);

616 
d‘eùiÚ
 *
g‘_ÃtwÜk_boxes
(
ÃtwÜk
 *
Ãt
, 
w
, 
h
, 
th»sh
, 
h›r
, *
m­
, 
»Ïtive
, *
num
);

617 
ä“_d‘eùiÚs
(
d‘eùiÚ
 *
d‘s
, 
n
);

619 
»£t_ÃtwÜk_¡©e
(
ÃtwÜk
 *
Ãt
, 
b
);

621 **
g‘_Ïb–s
(*
f’ame
);

622 
do_nms_obj
(
d‘eùiÚ
 *
d‘s
, 
tÙ®
, 
şas£s
, 
th»sh
);

623 
do_nms_sÜt
(
d‘eùiÚ
 *
d‘s
, 
tÙ®
, 
şas£s
, 
th»sh
);

625 
m©rix
 
make_m©rix
(
rows
, 
cŞs
);

627 
ä“_image
(
image
 
m
);

628 
Œaš_ÃtwÜk
(
ÃtwÜk
 *
Ãt
, 
d©a
 
d
);

629 
±h»ad_t
 
lßd_d©a_š_th»ad
(
lßd_¬gs
 
¬gs
);

630 
lßd_d©a_blockšg
(
lßd_¬gs
 
¬gs
);

631 
li¡
 *
g‘_·ths
(*
f’ame
);

632 
h›¿rchy_´ediùiÚs
(*
´ediùiÚs
, 
n
, 
Œ“
 *
h›r
, 
Úly_Ëaves
, 
¡ride
);

633 
chªge_Ëaves
(
Œ“
 *
t
, *
Ëaf_li¡
);

635 
fšd_št_¬g
(
¬gc
, **
¬gv
, *
¬g
, 
def
);

636 
fšd_æßt_¬g
(
¬gc
, **
¬gv
, *
¬g
, 
def
);

637 
fšd_¬g
(
¬gc
, * 
¬gv
[], *
¬g
);

638 *
fšd_ch¬_¬g
(
¬gc
, **
¬gv
, *
¬g
, *
def
);

639 *
ba£cfg
(*
cfgfe
);

640 
fšd_»¶aû
(*
¡r
, *
Üig
, *
»p
, *
ouut
);

641 
ä“_±rs
(**
±rs
, 
n
);

642 *
fg‘l
(
FILE
 *
å
);

643 
¡r
(*
s
);

644 
£c
(
şock_t
 
şocks
);

645 **
li¡_to_¬¿y
(
li¡
 *
l
);

646 
tİ_k
(*
a
, 
n
, 
k
, *
šdex
);

647 *
»ad_m­
(*
f’ame
);

648 
”rÜ
(cÚ¡ *
s
);

649 
max_šdex
(*
a
, 
n
);

650 
max_št_šdex
(*
a
, 
n
);

651 
§m¶e_¬¿y
(*
a
, 
n
);

652 *
¿ndom_šdex_Üd”
(
mš
, 
max
);

653 
ä“_li¡
(
li¡
 *
l
);

654 
m£_¬¿y
(*
a
, 
n
);

655 
v¬Ÿnû_¬¿y
(*
a
, 
n
);

656 
mag_¬¿y
(*
a
, 
n
);

657 
sÿË_¬¿y
(*
a
, 
n
, 
s
);

658 
m—n_¬¿y
(*
a
, 
n
);

659 
sum_¬¿y
(*
a
, 
n
);

660 
nÜm®ize_¬¿y
(*
a
, 
n
);

661 *
»ad_ši¡
(*
s
, *
n
, 
d
);

662 
size_t
 
¿nd_size_t
();

663 
¿nd_nÜm®
();

664 
¿nd_unifÜm
(
mš
, 
max
);

666 #ifdeà
__ılu¥lus


	@App/data.cpp

1 
	~"d©a.h
"

2 
	~"uts.h
"

3 
	~"image.h
"

6 
	~<¡dio.h
>

7 
	~<¡dlib.h
>

8 
	~<¡ršg.h
>

10 
±h»ad_mu‹x_t
 
	gmu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

12 
li¡
 *
	$g‘_·ths
(*
f’ame
)

14 *
·th
;

15 
FILE
 *
fe
 = 
	`fİ’
(
f’ame
, "r");

16 if(!
fe
è
	`fe_”rÜ
(
f’ame
);

17 
li¡
 *
lšes
 = 
	`make_li¡
();

18 (
·th
=
	`fg‘l
(
fe
))){

19 
	`li¡_š£¹
(
lšes
, 
·th
);

21 
	`fşo£
(
fe
);

22  
lšes
;

23 
	}
}

26 **
	$g‘_¿ndom_·ths_šdexes
(**
·ths
, 
n
, 
m
, *
šdexes
)

28 **
¿ndom_·ths
 = (**)
	`ÿÎoc
(
n
, (*));

29 
i
;

30 
	`±h»ad_mu‹x_lock
(&
mu‹x
);

31 
i
 = 0; i < 
n
; ++i){

32 
šdex
 = 
	`¿nd
()%
m
;

33 
šdexes
[
i
] = 
šdex
;

34 
¿ndom_·ths
[
i
] = 
·ths
[
šdex
];

35 if(
i
 =ğ0è
	`´štf
("%s\n", 
·ths
[
šdex
]);

37 
	`±h»ad_mu‹x_uÆock
(&
mu‹x
);

38  
¿ndom_·ths
;

39 
	}
}

41 **
	$g‘_¿ndom_·ths
(**
·ths
, 
n
, 
m
)

43 **
¿ndom_·ths
 = (**)
	`ÿÎoc
(
n
, (*));

44 
i
;

45 
	`±h»ad_mu‹x_lock
(&
mu‹x
);

46 
i
 = 0; i < 
n
; ++i){

47 
šdex
 = 
	`¿nd
()%
m
;

48 
¿ndom_·ths
[
i
] = 
·ths
[
šdex
];

51 
	`±h»ad_mu‹x_uÆock
(&
mu‹x
);

52  
¿ndom_·ths
;

53 
	}
}

56 **
	$fšd_»¶aû_·ths
(**
·ths
, 
n
, *
fšd
, *
»¶aû
)

58 **
»¶aû_·ths
 = (**)
	`ÿÎoc
(
n
, (*));

59 
i
;

60 
i
 = 0; i < 
n
; ++i){

61 
»¶aûd
[4096];

62 
	`fšd_»¶aû
(
·ths
[
i
], 
fšd
, 
»¶aû
, 
»¶aûd
);

63 
»¶aû_·ths
[
i
] = 
	`cİy_¡ršg
(
»¶aûd
);

65  
»¶aû_·ths
;

66 
	}
}

68 
m©rix
 
	$lßd_image_·ths_g¿y
(**
·ths
, 
n
, 
w
, 
h
)

70 
i
;

71 
m©rix
 
X
;

72 
X
.
rows
 = 
n
;

73 
X
.
v®s
 = (**)
	`ÿÎoc
(X.
rows
, (*));

74 
X
.
cŞs
 = 0;

76 
i
 = 0; i < 
n
; ++i){

77 
image
 
im
 = 
	`lßd_image
(
·ths
[
i
], 
w
, 
h
, 3);

79 
image
 
g¿y
 = 
	`g¿ysÿË_image
(
im
);

80 
	`ä“_image
(
im
);

81 
im
 = 
g¿y
;

83 
X
.
v®s
[
i
] = 
im
.
d©a
;

84 
X
.
cŞs
 = 
im
.
h
*im.
w
*im.
c
;

86  
X
;

87 
	}
}

89 
m©rix
 
	$lßd_image_·ths
(**
·ths
, 
n
, 
w
, 
h
)

91 
i
;

92 
m©rix
 
X
;

93 
X
.
rows
 = 
n
;

94 
X
.
v®s
 = (**)
	`ÿÎoc
(X.
rows
, (*));

95 
X
.
cŞs
 = 0;

97 
i
 = 0; i < 
n
; ++i){

98 
image
 
im
 = 
	`lßd_image_cŞÜ
(
·ths
[
i
], 
w
, 
h
);

99 
X
.
v®s
[
i
] = 
im
.
d©a
;

100 
X
.
cŞs
 = 
im
.
h
*im.
w
*im.
c
;

102  
X
;

103 
	}
}

105 
m©rix
 
	$lßd_image_augm’t_·ths
(**
·ths
, 
n
, 
mš
, 
max
, 
size
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
, 
ûÁ”
)

107 
i
;

108 
m©rix
 
X
;

109 
X
.
rows
 = 
n
;

110 
X
.
v®s
 = (**)
	`ÿÎoc
(X.
rows
, (*));

111 
X
.
cŞs
 = 0;

113 
i
 = 0; i < 
n
; ++i){

114 
image
 
im
 = 
	`lßd_image_cŞÜ
(
·ths
[
i
], 0, 0);

115 
image
 
üİ
;

116 if(
ûÁ”
){

117 
üİ
 = 
	`ûÁ”_üİ_image
(
im
, 
size
, size);

119 
üİ
 = 
	`¿ndom_augm’t_image
(
im
, 
ªgË
, 
a¥eù
, 
mš
, 
max
, 
size
, size);

121 
æ
 = 
	`¿nd
()%2;

122 ià(
æ
è
	`æ_image
(
üİ
);

123 
	`¿ndom_di¡Üt_image
(
üİ
, 
hue
, 
§tu¿tiÚ
, 
exposu»
);

131 
	`ä“_image
(
im
);

132 
X
.
v®s
[
i
] = 
üİ
.
d©a
;

133 
X
.
cŞs
 = 
üİ
.
h
*üİ.
w
*üİ.
c
;

135  
X
;

136 
	}
}

139 
box_Ïb–
 *
	$»ad_boxes
(*
f’ame
, *
n
)

141 
FILE
 *
fe
 = 
	`fİ’
(
f’ame
, "r");

142 if(!
fe
è
	`fe_”rÜ
(
f’ame
);

143 
x
, 
y
, 
h
, 
w
;

144 
id
;

145 
couÁ
 = 0;

146 
size
 = 64;

147 
box_Ïb–
 *
boxes
 = (box_Ïb– *)
	`ÿÎoc
(
size
, (box_label));

148 
	`fsÿnf
(
fe
, "%d %à%à%à%f", &
id
, &
x
, &
y
, &
w
, &
h
) == 5){

149 if(
couÁ
 =ğ
size
) {

150 
size
 = size * 2;

151 
boxes
 = (
box_Ïb–
 *)
	`»®loc
(boxes, 
size
*(box_label));

153 
boxes
[
couÁ
].
id
 = id;

154 
boxes
[
couÁ
].
x
 = x;

155 
boxes
[
couÁ
].
y
 = y;

156 
boxes
[
couÁ
].
h
 = h;

157 
boxes
[
couÁ
].
w
 = w;

158 
boxes
[
couÁ
].
Ëá
 = 
x
 - 
w
/2;

159 
boxes
[
couÁ
].
right
 = 
x
 + 
w
/2;

160 
boxes
[
couÁ
].
tİ
 = 
y
 - 
h
/2;

161 
boxes
[
couÁ
].
bÙtom
 = 
y
 + 
h
/2;

162 ++
couÁ
;

164 
	`fşo£
(
fe
);

165 *
n
 = 
couÁ
;

166  
boxes
;

167 
	}
}

169 
	$¿ndomize_boxes
(
box_Ïb–
 *
b
, 
n
)

171 
i
;

172 
i
 = 0; i < 
n
; ++i){

173 
box_Ïb–
 
sw­
 = 
b
[
i
];

174 
šdex
 = 
	`¿nd
()%
n
;

175 
b
[
i
] = b[
šdex
];

176 
b
[
šdex
] = 
sw­
;

178 
	}
}

180 
	$cÜ»ù_boxes
(
box_Ïb–
 *
boxes
, 
n
, 
dx
, 
dy
, 
sx
, 
sy
, 
æ
)

182 
i
;

183 
i
 = 0; i < 
n
; ++i){

184 if(
boxes
[
i
].
x
 =ğ0 && boxes[i].
y
 == 0) {

185 
boxes
[
i
].
x
 = 999999;

186 
boxes
[
i
].
y
 = 999999;

187 
boxes
[
i
].
w
 = 999999;

188 
boxes
[
i
].
h
 = 999999;

191 
boxes
[
i
].
Ëá
 = boxes[i].Ëá * 
sx
 - 
dx
;

192 
boxes
[
i
].
right
 = boxes[i].righˆ* 
sx
 - 
dx
;

193 
boxes
[
i
].
tİ
 = boxes[i].tİ * 
sy
 - 
dy
;

194 
boxes
[
i
].
bÙtom
 = boxes[i].bÙtom* 
sy
 - 
dy
;

196 if(
æ
){

197 
sw­
 = 
boxes
[
i
].
Ëá
;

198 
boxes
[
i
].
Ëá
 = 1. - boxes[i].
right
;

199 
boxes
[
i
].
right
 = 1. - 
sw­
;

202 
boxes
[
i
].
Ëá
 = 
	`cÚ¡¿š
(0, 1, boxes[i].left);

203 
boxes
[
i
].
right
 = 
	`cÚ¡¿š
(0, 1, boxes[i].right);

204 
boxes
[
i
].
tİ
 = 
	`cÚ¡¿š
(0, 1, boxes[i].top);

205 
boxes
[
i
].
bÙtom
 = 
	`cÚ¡¿š
(0, 1, boxes[i].bottom);

207 
boxes
[
i
].
x
 = (boxes[i].
Ëá
+boxes[i].
right
)/2;

208 
boxes
[
i
].
y
 = (boxes[i].
tİ
+boxes[i].
bÙtom
)/2;

209 
boxes
[
i
].
w
 = (boxes[i].
right
 - boxes[i].
Ëá
);

210 
boxes
[
i
].
h
 = (boxes[i].
bÙtom
 - boxes[i].
tİ
);

212 
boxes
[
i
].
w
 = 
	`cÚ¡¿š
(0, 1, boxes[i].w);

213 
boxes
[
i
].
h
 = 
	`cÚ¡¿š
(0, 1, boxes[i].h);

215 
	}
}

217 
	$fl_Œuth_swag
(*
·th
, *
Œuth
, 
şas£s
, 
æ
, 
dx
, 
dy
, 
sx
, 
sy
)

219 
Ïb–·th
[4096];

220 
	`fšd_»¶aû
(
·th
, (*)"images", (*)"Ïb–s", 
Ïb–·th
);

221 
	`fšd_»¶aû
(
Ïb–·th
, (*)"JPEGImages", (*)"labels",†abelpath);

222 
	`fšd_»¶aû
(
Ïb–·th
, (*)".jpg", (*)".txt",†abelpath);

223 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPG", (*)".txt",†abelpath);

224 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPEG", (*)".txt",†abelpath);

226 
couÁ
 = 0;

227 
box_Ïb–
 *
boxes
 = 
	`»ad_boxes
(
Ïb–·th
, &
couÁ
);

228 
	`¿ndomize_boxes
(
boxes
, 
couÁ
);

229 
	`cÜ»ù_boxes
(
boxes
, 
couÁ
, 
dx
, 
dy
, 
sx
, 
sy
, 
æ
);

230 
x
,
y
,
w
,
h
;

231 
id
;

232 
i
;

234 
i
 = 0; i < 
couÁ
 && i < 90; ++i) {

235 
x
 = 
boxes
[
i
].x;

236 
y
 = 
boxes
[
i
].y;

237 
w
 = 
boxes
[
i
].w;

238 
h
 = 
boxes
[
i
].h;

239 
id
 = 
boxes
[
i
].id;

241 ià(
w
 < .0 || 
h
 < .0) ;

243 
šdex
 = (4+
şas£s
è* 
i
;

245 
Œuth
[
šdex
++] = 
x
;

246 
Œuth
[
šdex
++] = 
y
;

247 
Œuth
[
šdex
++] = 
w
;

248 
Œuth
[
šdex
++] = 
h
;

250 ià(
id
 < 
şas£s
è
Œuth
[
šdex
+id] = 1;

252 
	`ä“
(
boxes
);

253 
	}
}

255 
	$fl_Œuth_»giÚ
(*
·th
, *
Œuth
, 
şas£s
, 
num_boxes
, 
æ
, 
dx
, 
dy
, 
sx
, 
sy
)

257 
Ïb–·th
[4096];

258 
	`fšd_»¶aû
(
·th
, (*)"images", (*)"Ïb–s", 
Ïb–·th
);

259 
	`fšd_»¶aû
(
Ïb–·th
, (*)"JPEGImages", (*)"labels",†abelpath);

261 
	`fšd_»¶aû
(
Ïb–·th
, (*)".jpg", (*)".txt",†abelpath);

262 
	`fšd_»¶aû
(
Ïb–·th
, (*)".png", (*)".txt",†abelpath);

263 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPG", (*)".txt",†abelpath);

264 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPEG", (*)".txt",†abelpath);

265 
couÁ
 = 0;

266 
box_Ïb–
 *
boxes
 = 
	`»ad_boxes
(
Ïb–·th
, &
couÁ
);

267 
	`¿ndomize_boxes
(
boxes
, 
couÁ
);

268 
	`cÜ»ù_boxes
(
boxes
, 
couÁ
, 
dx
, 
dy
, 
sx
, 
sy
, 
æ
);

269 
x
,
y
,
w
,
h
;

270 
id
;

271 
i
;

273 
i
 = 0; i < 
couÁ
; ++i) {

274 
x
 = 
boxes
[
i
].x;

275 
y
 = 
boxes
[
i
].y;

276 
w
 = 
boxes
[
i
].w;

277 
h
 = 
boxes
[
i
].h;

278 
id
 = 
boxes
[
i
].id;

280 ià(
w
 < .005 || 
h
 < .005) ;

282 
cŞ
 = ()(
x
*
num_boxes
);

283 
row
 = ()(
y
*
num_boxes
);

285 
x
 = x*
num_boxes
 - 
cŞ
;

286 
y
 = y*
num_boxes
 - 
row
;

288 
šdex
 = (
cŞ
+
row
*
num_boxes
)*(5+
şas£s
);

289 ià(
Œuth
[
šdex
]) ;

290 
Œuth
[
šdex
++] = 1;

292 ià(
id
 < 
şas£s
è
Œuth
[
šdex
+id] = 1;

293 
šdex
 +ğ
şas£s
;

295 
Œuth
[
šdex
++] = 
x
;

296 
Œuth
[
šdex
++] = 
y
;

297 
Œuth
[
šdex
++] = 
w
;

298 
Œuth
[
šdex
++] = 
h
;

300 
	`ä“
(
boxes
);

301 
	}
}

303 
	$lßd_¾e
(
image
 
im
, *
¾e
, 
n
)

305 
couÁ
 = 0;

306 
cu¼
 = 0;

307 
i
,
j
;

308 
i
 = 0; i < 
n
; ++i){

309 
j
 = 0; j < 
¾e
[
i
]; ++j){

310 
im
.
d©a
[
couÁ
++] = 
cu¼
;

312 
cu¼
 = 1 - curr;

314 ; 
couÁ
 < 
im
.
h
*im.
w
*im.
c
; ++count){

315 
im
.
d©a
[
couÁ
] = 
cu¼
;

317 
	}
}

319 
	$Ü_image
(
image
 
¤c
, imag
de¡
, 
c
)

321 
i
;

322 
i
 = 0; i < 
¤c
.
w
*¤c.
h
; ++i){

323 if(
¤c
.
d©a
[
i
]è
de¡
.d©a[de¡.
w
*de¡.
h
*
c
 + i] = 1;

325 
	}
}

327 
	$exşusive_image
(
image
 
¤c
)

329 
k
, 
j
, 
i
;

330 
s
 = 
¤c
.
w
*¤c.
h
;

331 
k
 = 0; k < 
¤c
.
c
-1; ++k){

332 
i
 = 0; i < 
s
; ++i){

333 ià(
¤c
.
d©a
[
k
*
s
 + 
i
]){

334 
j
 = 
k
+1; j < 
¤c
.
c
; ++j){

335 
¤c
.
d©a
[
j
*
s
 + 
i
] = 0;

340 
	}
}

342 
box
 
	$bound_image
(
image
 
im
)

344 
x
,
y
;

345 
mšx
 = 
im
.
w
;

346 
mšy
 = 
im
.
h
;

347 
maxx
 = 0;

348 
maxy
 = 0;

349 
y
 = 0; y < 
im
.
h
; ++y){

350 
x
 = 0; x < 
im
.
w
; ++x){

351 if(
im
.
d©a
[
y
*im.
w
 + 
x
]){

352 
mšx
 = (
x
 < minx) ? x : minx;

353 
mšy
 = (
y
 < miny) ? y : miny;

354 
maxx
 = (
x
 > maxx) ? x : maxx;

355 
maxy
 = (
y
 > maxy) ? y : maxy;

359 
box
 
b
 = {
mšx
, 
mšy
, 
maxx
-mšx + 1, 
maxy
-miny + 1};

361  
b
;

362 
	}
}

364 
	$fl_Œuth_i£g
(*
·th
, 
num_boxes
, *
Œuth
, 
şas£s
, 
w
, 
h
, 
augm’t_¬gs
 
aug
, 
æ
, 
mw
, 
mh
)

366 
Ïb–·th
[4096];

367 
	`fšd_»¶aû
(
·th
, (*)"images", (*)"mask", 
Ïb–·th
);

368 
	`fšd_»¶aû
(
Ïb–·th
, (*)"JPEGImages", (*)"mask",†abelpath);

369 
	`fšd_»¶aû
(
Ïb–·th
, (*)".jpg", (*)".txt",†abelpath);

370 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPG", (*)".txt",†abelpath);

371 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPEG", (*)".txt",†abelpath);

372 
FILE
 *
fe
 = 
	`fİ’
(
Ïb–·th
, "r");

373 if(!
fe
è
	`fe_”rÜ
(
Ïb–·th
);

374 
buff
[32788];

375 
id
;

376 
i
 = 0;

377 
j
;

378 
image
 
·¹
 = 
	`make_image
(
w
, 
h
, 1);

379 (
	`fsÿnf
(
fe
, "%d %s", &
id
, 
buff
è=ğ2è&& 
i
 < 
num_boxes
){

380 
n
 = 0;

381 *
¾e
 = 
	`»ad_ši¡
(
buff
, &
n
, 0);

382 
	`lßd_¾e
(
·¹
, 
¾e
, 
n
);

383 
image
 
sized
 = 
	`rÙ©e_üİ_image
(
·¹
, 
aug
.
¿d
,‡ug.
sÿË
,‡ug.
w
,‡ug.
h
,‡ug.
dx
,‡ug.
dy
,‡ug.
a¥eù
);

384 if(
æ
è
	`æ_image
(
sized
);

386 
image
 
mask
 = 
	`»size_image
(
sized
, 
mw
, 
mh
);

387 
Œuth
[
i
*(
mw
*
mh
+1)] = 
id
;

388 
j
 = 0; j < 
mw
*
mh
; ++j){

389 
Œuth
[
i
*(
mw
*
mh
 + 1è+ 1 + 
j
] = 
mask
.
d©a
[j];

391 ++
i
;

393 
	`ä“_image
(
mask
);

394 
	`ä“_image
(
sized
);

395 
	`ä“
(
¾e
);

397 if(
i
 < 
num_boxes
è
Œuth
[i*(
mw
*
mh
+1)] = -1;

398 
	`fşo£
(
fe
);

399 
	`ä“_image
(
·¹
);

400 
	}
}

402 
	$fl_Œuth_mask
(*
·th
, 
num_boxes
, *
Œuth
, 
şas£s
, 
w
, 
h
, 
augm’t_¬gs
 
aug
, 
æ
, 
mw
, 
mh
)

404 
Ïb–·th
[4096];

405 
	`fšd_»¶aû
(
·th
, (*)"images", (*)"mask", 
Ïb–·th
);

406 
	`fšd_»¶aû
(
Ïb–·th
, (*)"JPEGImages", (*)"mask",†abelpath);

407 
	`fšd_»¶aû
(
Ïb–·th
, (*)".jpg", (*)".txt",†abelpath);

408 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPG", (*)".txt",†abelpath);

409 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPEG", (*)".txt",†abelpath);

410 
FILE
 *
fe
 = 
	`fİ’
(
Ïb–·th
, "r");

411 if(!
fe
è
	`fe_”rÜ
(
Ïb–·th
);

412 
buff
[32788];

413 
id
;

414 
i
 = 0;

415 
image
 
·¹
 = 
	`make_image
(
w
, 
h
, 1);

416 (
	`fsÿnf
(
fe
, "%d %s", &
id
, 
buff
è=ğ2è&& 
i
 < 
num_boxes
){

417 
n
 = 0;

418 *
¾e
 = 
	`»ad_ši¡
(
buff
, &
n
, 0);

419 
	`lßd_¾e
(
·¹
, 
¾e
, 
n
);

420 
image
 
sized
 = 
	`rÙ©e_üİ_image
(
·¹
, 
aug
.
¿d
,‡ug.
sÿË
,‡ug.
w
,‡ug.
h
,‡ug.
dx
,‡ug.
dy
,‡ug.
a¥eù
);

421 if(
æ
è
	`æ_image
(
sized
);

422 
box
 
b
 = 
	`bound_image
(
sized
);

423 if(
b
.
w
 > 0){

424 
image
 
üİ
 = 
	`üİ_image
(
sized
, 
b
.
x
, b.
y
, b.
w
, b.
h
);

425 
image
 
mask
 = 
	`»size_image
(
üİ
, 
mw
, 
mh
);

426 
Œuth
[
i
*(4 + 
mw
*
mh
 + 1è+ 0] = (
b
.
x
 + b.
w
/2.)/
sized
.w;

427 
Œuth
[
i
*(4 + 
mw
*
mh
 + 1è+ 1] = (
b
.
y
 + b.
h
/2.)/
sized
.h;

428 
Œuth
[
i
*(4 + 
mw
*
mh
 + 1è+ 2] = 
b
.
w
/
sized
.w;

429 
Œuth
[
i
*(4 + 
mw
*
mh
 + 1è+ 3] = 
b
.
h
/
sized
.h;

430 
j
;

431 
j
 = 0; j < 
mw
*
mh
; ++j){

432 
Œuth
[
i
*(4 + 
mw
*
mh
 + 1è+ 4 + 
j
] = 
mask
.
d©a
[j];

434 
Œuth
[
i
*(4 + 
mw
*
mh
 + 1è+ 4 + mw*mh] = 
id
;

435 
	`ä“_image
(
üİ
);

436 
	`ä“_image
(
mask
);

437 ++
i
;

439 
	`ä“_image
(
sized
);

440 
	`ä“
(
¾e
);

442 
	`fşo£
(
fe
);

443 
	`ä“_image
(
·¹
);

444 
	}
}

447 
	$fl_Œuth_d‘eùiÚ
(*
·th
, 
num_boxes
, *
Œuth
, 
şas£s
, 
æ
, 
dx
, 
dy
, 
sx
, 
sy
)

449 
Ïb–·th
[4096];

450 
	`fšd_»¶aû
(
·th
, (*)"images", (*)"Ïb–s", 
Ïb–·th
);

451 
	`fšd_»¶aû
(
Ïb–·th
, (*)"JPEGImages", (*)"labels",†abelpath);

453 
	`fšd_»¶aû
(
Ïb–·th
, (*)"raw", (*)"labels",†abelpath);

454 
	`fšd_»¶aû
(
Ïb–·th
, (*)".jpg", (*)".txt",†abelpath);

455 
	`fšd_»¶aû
(
Ïb–·th
, (*)".png", (*)".txt",†abelpath);

456 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPG", (*)".txt",†abelpath);

457 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPEG", (*)".txt",†abelpath);

458 
couÁ
 = 0;

459 
box_Ïb–
 *
boxes
 = 
	`»ad_boxes
(
Ïb–·th
, &
couÁ
);

460 
	`¿ndomize_boxes
(
boxes
, 
couÁ
);

461 
	`cÜ»ù_boxes
(
boxes
, 
couÁ
, 
dx
, 
dy
, 
sx
, 
sy
, 
æ
);

462 if(
couÁ
 > 
num_boxes
) count =‚um_boxes;

463 
x
,
y
,
w
,
h
;

464 
id
;

465 
i
;

466 
sub
 = 0;

468 
i
 = 0; i < 
couÁ
; ++i) {

469 
x
 = 
boxes
[
i
].x;

470 
y
 = 
boxes
[
i
].y;

471 
w
 = 
boxes
[
i
].w;

472 
h
 = 
boxes
[
i
].h;

473 
id
 = 
boxes
[
i
].id;

475 ià((
w
 < .001 || 
h
 < .001)) {

476 ++
sub
;

480 
Œuth
[(
i
-
sub
)*5+0] = 
x
;

481 
Œuth
[(
i
-
sub
)*5+1] = 
y
;

482 
Œuth
[(
i
-
sub
)*5+2] = 
w
;

483 
Œuth
[(
i
-
sub
)*5+3] = 
h
;

484 
Œuth
[(
i
-
sub
)*5+4] = 
id
;

486 
	`ä“
(
boxes
);

487 
	}
}

489 
	#NUMCHARS
 37

	)

491 
	$´št_Ë‰”s
(*
´ed
, 
n
)

493 
i
;

494 
i
 = 0; i < 
n
; ++i){

495 
šdex
 = 
	`max_šdex
(
´ed
+
i
*
NUMCHARS
, NUMCHARS);

496 
	`´štf
("%c", 
	`št_to_®phªum
(
šdex
));

498 
	`´štf
("\n");

499 
	}
}

501 
	$fl_Œuth_ÿ±cha
(*
·th
, 
n
, *
Œuth
)

503 *
begš
 = 
	`¡¼chr
(
·th
, '/');

504 ++
begš
;

505 
i
;

506 
i
 = 0; i < 
	`¡¾’
(
begš
è&& i < 
n
 && begin[i] != '.'; ++i){

507 
šdex
 = 
	`®phªum_to_št
(
begš
[
i
]);

508 if(
šdex
 > 35è
	`´štf
("Bad %c\n", 
begš
[
i
]);

509 
Œuth
[
i
*
NUMCHARS
+
šdex
] = 1;

511 ;
i
 < 
n
; ++i){

512 
Œuth
[
i
*
NUMCHARS
 + NUMCHARS-1] = 1;

514 
	}
}

516 
d©a
 
	$lßd_d©a_ÿ±cha
(**
·ths
, 
n
, 
m
, 
k
, 
w
, 
h
)

518 if(
m
è
·ths
 = 
	`g‘_¿ndom_·ths
Õ©hs, 
n
, m);

519 
d©a
 
d
 = {0};

520 
d
.
sh®low
 = 0;

521 
d
.
X
 = 
	`lßd_image_·ths
(
·ths
, 
n
, 
w
, 
h
);

522 
d
.
y
 = 
	`make_m©rix
(
n
, 
k
*
NUMCHARS
);

523 
i
;

524 
i
 = 0; i < 
n
; ++i){

525 
	`fl_Œuth_ÿ±cha
(
·ths
[
i
], 
k
, 
d
.
y
.
v®s
[i]);

527 if(
m
è
	`ä“
(
·ths
);

528  
d
;

529 
	}
}

531 
d©a
 
	$lßd_d©a_ÿ±cha_’code
(**
·ths
, 
n
, 
m
, 
w
, 
h
)

533 if(
m
è
·ths
 = 
	`g‘_¿ndom_·ths
Õ©hs, 
n
, m);

534 
d©a
 
d
 = {0};

535 
d
.
sh®low
 = 0;

536 
d
.
X
 = 
	`lßd_image_·ths
(
·ths
, 
n
, 
w
, 
h
);

537 
d
.
X
.
cŞs
 = 17100;

538 
d
.
y
 = d.
X
;

539 if(
m
è
	`ä“
(
·ths
);

540  
d
;

541 
	}
}

543 
	$fl_Œuth
(*
·th
, **
Ïb–s
, 
k
, *
Œuth
)

545 
i
;

546 
	`mem£t
(
Œuth
, 0, 
k
*());

547 
couÁ
 = 0;

548 
i
 = 0; i < 
k
; ++i){

549 if(
	`¡r¡r
(
·th
, 
Ïb–s
[
i
])){

550 
Œuth
[
i
] = 1;

551 ++
couÁ
;

555 if(
couÁ
 !ğ1 && (
k
 !ğ1 || couÁ !ğ0)è
	`´štf
("ToØmªy o¸toØãw†ab–s: %d, %s\n", couÁ, 
·th
);

556 
	}
}

558 
	$fl_h›¿rchy
(*
Œuth
, 
k
, 
Œ“
 *
h›¿rchy
)

560 
j
;

561 
j
 = 0; j < 
k
; ++j){

562 if(
Œuth
[
j
]){

563 
·»Á
 = 
h›¿rchy
->·»Á[
j
];

564 
·»Á
 >= 0){

565 
Œuth
[
·»Á
] = 1;

566 
·»Á
 = 
h›¿rchy
->parent[parent];

570 
i
;

571 
couÁ
 = 0;

572 
j
 = 0; j < 
h›¿rchy
->
groups
; ++j){

574 
mask
 = 1;

575 
i
 = 0; i < 
h›¿rchy
->
group_size
[
j
]; ++i){

576 if(
Œuth
[
couÁ
 + 
i
]){

577 
mask
 = 0;

581 ià(
mask
) {

582 
i
 = 0; i < 
h›¿rchy
->
group_size
[
j
]; ++i){

583 
Œuth
[
couÁ
 + 
i
] = 
SECRET_NUM
;

586 
couÁ
 +ğ
h›¿rchy
->
group_size
[
j
];

588 
	}
}

590 
m©rix
 
	$lßd_»g»ssiÚ_Ïb–s_·ths
(**
·ths
, 
n
, 
k
)

592 
m©rix
 
y
 = 
	`make_m©rix
(
n
, 
k
);

593 
i
,
j
;

594 
i
 = 0; i < 
n
; ++i){

595 
Ïb–·th
[4096];

596 
	`fšd_»¶aû
(
·ths
[
i
], (*)"images", (*)"Ïb–s", 
Ïb–·th
);

597 
	`fšd_»¶aû
(
Ïb–·th
, (*)"JPEGImages", (*)"labels",†abelpath);

598 
	`fšd_»¶aû
(
Ïb–·th
, (*)".BMP", (*)".txt",†abelpath);

599 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPEG", (*)".txt",†abelpath);

600 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPG", (*)".txt",†abelpath);

601 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPeG", (*)".txt",†abelpath);

602 
	`fšd_»¶aû
(
Ïb–·th
, (*)".Jpeg", (*)".txt",†abelpath);

603 
	`fšd_»¶aû
(
Ïb–·th
, (*)".PNG", (*)".txt",†abelpath);

604 
	`fšd_»¶aû
(
Ïb–·th
, (*)".TIF", (*)".txt",†abelpath);

605 
	`fšd_»¶aû
(
Ïb–·th
, (*)".bmp", (*)".txt",†abelpath);

606 
	`fšd_»¶aû
(
Ïb–·th
, (*)".jpeg", (*)".txt",†abelpath);

607 
	`fšd_»¶aû
(
Ïb–·th
, (*)".jpg", (*)".txt",†abelpath);

608 
	`fšd_»¶aû
(
Ïb–·th
, (*)".png", (*)".txt",†abelpath);

609 
	`fšd_»¶aû
(
Ïb–·th
, (*)".tif", (*)".txt",†abelpath);

611 
FILE
 *
fe
 = 
	`fİ’
(
Ïb–·th
, "r");

612 
j
 = 0; j < 
k
; ++j){

613 
	`fsÿnf
(
fe
, "%f", &(
y
.
v®s
[
i
][
j
]));

615 
	`fşo£
(
fe
);

617  
y
;

618 
	}
}

620 
m©rix
 
	$lßd_Ïb–s_·ths
(**
·ths
, 
n
, **
Ïb–s
, 
k
, 
Œ“
 *
h›¿rchy
)

622 
m©rix
 
y
 = 
	`make_m©rix
(
n
, 
k
);

623 
i
;

624 
i
 = 0; i < 
n
 && 
Ïb–s
; ++i){

625 
	`fl_Œuth
(
·ths
[
i
], 
Ïb–s
, 
k
, 
y
.
v®s
[i]);

626 if(
h›¿rchy
){

627 
	`fl_h›¿rchy
(
y
.
v®s
[
i
], 
k
, 
h›¿rchy
);

630  
y
;

631 
	}
}

633 
m©rix
 
	$lßd_gs_·ths
(**
·ths
, 
n
, 
k
)

635 
m©rix
 
y
 = 
	`make_m©rix
(
n
, 
k
);

636 
i
;

638 
i
 = 0; i < 
n
; ++i){

639 
Ïb–
[4096];

640 
	`fšd_»¶aû
(
·ths
[
i
], (*)"images", (*)"Ïb–s", 
Ïb–
);

641 
	`fšd_»¶aû
(
Ïb–
, (*)".jpg", (*)".txt",†abel);

642 
FILE
 *
fe
 = 
	`fİ’
(
Ïb–
, "r");

643 ià(!
fe
) ;

645 
g
;

646 
	`fsÿnf
(
fe
, "%d", &
g
) == 1){

647 if(
g
 < 
k
){

648 
y
.
v®s
[
i
][
g
] = 1;

651 
	`fşo£
(
fe
);

654  
y
;

655 
	}
}

657 **
	$g‘_Ïb–s
(*
f’ame
)

659 
li¡
 *
¶i¡
 = 
	`g‘_·ths
(
f’ame
);

660 **
Ïb–s
 = (**)
	`li¡_to_¬¿y
(
¶i¡
);

661 
	`ä“_li¡
(
¶i¡
);

662  
Ïb–s
;

663 
	}
}

665 
	$ä“_d©a
(
d©a
 
d
)

667 if(!
d
.
sh®low
){

668 
	`ä“_m©rix
(
d
.
X
);

669 
	`ä“_m©rix
(
d
.
y
);

671 
	`ä“
(
d
.
X
.
v®s
);

672 
	`ä“
(
d
.
y
.
v®s
);

674 
	}
}

676 
image
 
	$g‘_£gm’tiÚ_image
(*
·th
, 
w
, 
h
, 
şas£s
)

678 
Ïb–·th
[4096];

679 
	`fšd_»¶aû
(
·th
, (*)"images", (*)"mask", 
Ïb–·th
);

680 
	`fšd_»¶aû
(
Ïb–·th
, (*)"JPEGImages", (*)"mask",†abelpath);

681 
	`fšd_»¶aû
(
Ïb–·th
, (*)".jpg", (*)".txt",†abelpath);

682 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPG", (*)".txt",†abelpath);

683 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPEG", (*)".txt",†abelpath);

684 
image
 
mask
 = 
	`make_image
(
w
, 
h
, 
şas£s
);

685 
FILE
 *
fe
 = 
	`fİ’
(
Ïb–·th
, "r");

686 if(!
fe
è
	`fe_”rÜ
(
Ïb–·th
);

687 
buff
[32788];

688 
id
;

689 
image
 
·¹
 = 
	`make_image
(
w
, 
h
, 1);

690 
	`fsÿnf
(
fe
, "%d %s", &
id
, 
buff
) == 2){

691 
n
 = 0;

692 *
¾e
 = 
	`»ad_ši¡
(
buff
, &
n
, 0);

693 
	`lßd_¾e
(
·¹
, 
¾e
, 
n
);

694 
	`Ü_image
(
·¹
, 
mask
, 
id
);

695 
	`ä“
(
¾e
);

698 
	`fşo£
(
fe
);

699 
	`ä“_image
(
·¹
);

700  
mask
;

701 
	}
}

703 
image
 
	$g‘_£gm’tiÚ_image2
(*
·th
, 
w
, 
h
, 
şas£s
)

705 
Ïb–·th
[4096];

706 
	`fšd_»¶aû
(
·th
, (*)"images", (*)"mask", 
Ïb–·th
);

707 
	`fšd_»¶aû
(
Ïb–·th
, (*)"JPEGImages", (*)"mask",†abelpath);

708 
	`fšd_»¶aû
(
Ïb–·th
, (*)".jpg", (*)".txt",†abelpath);

709 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPG", (*)".txt",†abelpath);

710 
	`fšd_»¶aû
(
Ïb–·th
, (*)".JPEG", (*)".txt",†abelpath);

711 
image
 
mask
 = 
	`make_image
(
w
, 
h
, 
şas£s
+1);

712 
i
;

713 
i
 = 0; i < 
w
*
h
; ++i){

714 
mask
.
d©a
[
w
*
h
*
şas£s
 + 
i
] = 1;

716 
FILE
 *
fe
 = 
	`fİ’
(
Ïb–·th
, "r");

717 if(!
fe
è
	`fe_”rÜ
(
Ïb–·th
);

718 
buff
[32788];

719 
id
;

720 
image
 
·¹
 = 
	`make_image
(
w
, 
h
, 1);

721 
	`fsÿnf
(
fe
, "%d %s", &
id
, 
buff
) == 2){

722 
n
 = 0;

723 *
¾e
 = 
	`»ad_ši¡
(
buff
, &
n
, 0);

724 
	`lßd_¾e
(
·¹
, 
¾e
, 
n
);

725 
	`Ü_image
(
·¹
, 
mask
, 
id
);

726 
i
 = 0; i < 
w
*
h
; ++i){

727 if(
·¹
.
d©a
[
i
]è
mask
.d©a[
w
*
h
*
şas£s
 + i] = 0;

729 
	`ä“
(
¾e
);

732 
	`fşo£
(
fe
);

733 
	`ä“_image
(
·¹
);

734  
mask
;

735 
	}
}

737 
d©a
 
	$lßd_d©a_£g
(
n
, **
·ths
, 
m
, 
w
, 
h
, 
şas£s
, 
mš
, 
max
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
, 
div
)

739 **
¿ndom_·ths
 = 
	`g‘_¿ndom_·ths
(
·ths
, 
n
, 
m
);

740 
i
;

741 
d©a
 
d
 = {0};

742 
d
.
sh®low
 = 0;

744 
d
.
X
.
rows
 = 
n
;

745 
d
.
X
.
v®s
 = (**)
	`ÿÎoc
(d.X.
rows
, (*));

746 
d
.
X
.
cŞs
 = 
h
*
w
*3;

749 
d
.
y
.
rows
 = 
n
;

750 
d
.
y
.
cŞs
 = 
h
*
w
*
şas£s
/
div
/div;

751 
d
.
y
.
v®s
 = (**)
	`ÿÎoc
(d.
X
.
rows
, (*));

753 
i
 = 0; i < 
n
; ++i){

754 
image
 
Üig
 = 
	`lßd_image_cŞÜ
(
¿ndom_·ths
[
i
], 0, 0);

755 
augm’t_¬gs
 
a
 = 
	`¿ndom_augm’t_¬gs
(
Üig
, 
ªgË
, 
a¥eù
, 
mš
, 
max
, 
w
, 
h
);

756 
image
 
sized
 = 
	`rÙ©e_üİ_image
(
Üig
, 
a
.
¿d
,‡.
sÿË
,‡.
w
,‡.
h
,‡.
dx
,‡.
dy
,‡.
a¥eù
);

758 
æ
 = 
	`¿nd
()%2;

759 if(
æ
è
	`æ_image
(
sized
);

760 
	`¿ndom_di¡Üt_image
(
sized
, 
hue
, 
§tu¿tiÚ
, 
exposu»
);

761 
d
.
X
.
v®s
[
i
] = 
sized
.
d©a
;

763 
image
 
mask
 = 
	`g‘_£gm’tiÚ_image
(
¿ndom_·ths
[
i
], 
Üig
.
w
, orig.
h
, 
şas£s
);

765 
image
 
sized_m
 = 
	`rÙ©e_üİ_image
(
mask
, 
a
.
¿d
,‡.
sÿË
/
div
,‡.
w
/div,‡.
h
/div,‡.
dx
/div,‡.
dy
/div,‡.
a¥eù
);

767 if(
æ
è
	`æ_image
(
sized_m
);

768 
d
.
y
.
v®s
[
i
] = 
sized_m
.
d©a
;

770 
	`ä“_image
(
Üig
);

771 
	`ä“_image
(
mask
);

781 
	`ä“
(
¿ndom_·ths
);

782  
d
;

783 
	}
}

785 
d©a
 
	$lßd_d©a_i£g
(
n
, **
·ths
, 
m
, 
w
, 
h
, 
şas£s
, 
boxes
, 
div
, 
mš
, 
max
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
)

787 **
¿ndom_·ths
 = 
	`g‘_¿ndom_·ths
(
·ths
, 
n
, 
m
);

788 
i
;

789 
d©a
 
d
 = {0};

790 
d
.
sh®low
 = 0;

792 
d
.
X
.
rows
 = 
n
;

793 
d
.
X
.
v®s
 = (**)
	`ÿÎoc
(d.X.
rows
, (*));

794 
d
.
X
.
cŞs
 = 
h
*
w
*3;

796 
d
.
y
 = 
	`make_m©rix
(
n
, (((
w
/
div
)*(
h
/div))+1)*
boxes
);

798 
i
 = 0; i < 
n
; ++i){

799 
image
 
Üig
 = 
	`lßd_image_cŞÜ
(
¿ndom_·ths
[
i
], 0, 0);

800 
augm’t_¬gs
 
a
 = 
	`¿ndom_augm’t_¬gs
(
Üig
, 
ªgË
, 
a¥eù
, 
mš
, 
max
, 
w
, 
h
);

801 
image
 
sized
 = 
	`rÙ©e_üİ_image
(
Üig
, 
a
.
¿d
,‡.
sÿË
,‡.
w
,‡.
h
,‡.
dx
,‡.
dy
,‡.
a¥eù
);

803 
æ
 = 
	`¿nd
()%2;

804 if(
æ
è
	`æ_image
(
sized
);

805 
	`¿ndom_di¡Üt_image
(
sized
, 
hue
, 
§tu¿tiÚ
, 
exposu»
);

806 
d
.
X
.
v®s
[
i
] = 
sized
.
d©a
;

809 
	`fl_Œuth_i£g
(
¿ndom_·ths
[
i
], 
boxes
, 
d
.
y
.
v®s
[i], 
şas£s
, 
Üig
.
w
, orig.
h
, 
a
, 
æ
, w/
div
, h/div);

811 
	`ä“_image
(
Üig
);

821 
	`ä“
(
¿ndom_·ths
);

822  
d
;

823 
	}
}

825 
d©a
 
	$lßd_d©a_mask
(
n
, **
·ths
, 
m
, 
w
, 
h
, 
şas£s
, 
boxes
, 
coÜds
, 
mš
, 
max
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
)

827 **
¿ndom_·ths
 = 
	`g‘_¿ndom_·ths
(
·ths
, 
n
, 
m
);

828 
i
;

829 
d©a
 
d
 = {0};

830 
d
.
sh®low
 = 0;

832 
d
.
X
.
rows
 = 
n
;

833 
d
.
X
.
v®s
 = (**)
	`ÿÎoc
(d.X.
rows
, (*));

834 
d
.
X
.
cŞs
 = 
h
*
w
*3;

836 
d
.
y
 = 
	`make_m©rix
(
n
, (
coÜds
+1)*
boxes
);

838 
i
 = 0; i < 
n
; ++i){

839 
image
 
Üig
 = 
	`lßd_image_cŞÜ
(
¿ndom_·ths
[
i
], 0, 0);

840 
augm’t_¬gs
 
a
 = 
	`¿ndom_augm’t_¬gs
(
Üig
, 
ªgË
, 
a¥eù
, 
mš
, 
max
, 
w
, 
h
);

841 
image
 
sized
 = 
	`rÙ©e_üİ_image
(
Üig
, 
a
.
¿d
,‡.
sÿË
,‡.
w
,‡.
h
,‡.
dx
,‡.
dy
,‡.
a¥eù
);

843 
æ
 = 
	`¿nd
()%2;

844 if(
æ
è
	`æ_image
(
sized
);

845 
	`¿ndom_di¡Üt_image
(
sized
, 
hue
, 
§tu¿tiÚ
, 
exposu»
);

846 
d
.
X
.
v®s
[
i
] = 
sized
.
d©a
;

849 
	`fl_Œuth_mask
(
¿ndom_·ths
[
i
], 
boxes
, 
d
.
y
.
v®s
[i], 
şas£s
, 
Üig
.
w
, orig.
h
, 
a
, 
æ
, 14, 14);

851 
	`ä“_image
(
Üig
);

861 
	`ä“
(
¿ndom_·ths
);

862  
d
;

863 
	}
}

865 
d©a
 
	$lßd_d©a_»giÚ
(
n
, **
·ths
, 
m
, 
w
, 
h
, 
size
, 
şas£s
, 
j™‹r
, 
hue
, 
§tu¿tiÚ
, 
exposu»
)

867 **
¿ndom_·ths
 = 
	`g‘_¿ndom_·ths
(
·ths
, 
n
, 
m
);

868 
i
;

869 
d©a
 
d
 = {0};

870 
d
.
sh®low
 = 0;

872 
d
.
X
.
rows
 = 
n
;

873 
d
.
X
.
v®s
 = (**)
	`ÿÎoc
(d.X.
rows
, (*));

874 
d
.
X
.
cŞs
 = 
h
*
w
*3;

877 
k
 = 
size
*size*(5+
şas£s
);

878 
d
.
y
 = 
	`make_m©rix
(
n
, 
k
);

879 
i
 = 0; i < 
n
; ++i){

880 
image
 
Üig
 = 
	`lßd_image_cŞÜ
(
¿ndom_·ths
[
i
], 0, 0);

882 
oh
 = 
Üig
.
h
;

883 
ow
 = 
Üig
.
w
;

885 
dw
 = (
ow
*
j™‹r
);

886 
dh
 = (
oh
*
j™‹r
);

888 
¶eá
 = 
	`¿nd_unifÜm
(-
dw
, dw);

889 
´ight
 = 
	`¿nd_unifÜm
(-
dw
, dw);

890 
±İ
 = 
	`¿nd_unifÜm
(-
dh
, dh);

891 
pbÙ
 = 
	`¿nd_unifÜm
(-
dh
, dh);

893 
swidth
 = 
ow
 - 
¶eá
 - 
´ight
;

894 
sheight
 = 
oh
 - 
±İ
 - 
pbÙ
;

896 
sx
 = ()
swidth
 / 
ow
;

897 
sy
 = ()
sheight
 / 
oh
;

899 
æ
 = 
	`¿nd
()%2;

900 
image
 
üİ³d
 = 
	`üİ_image
(
Üig
, 
¶eá
, 
±İ
, 
swidth
, 
sheight
);

902 
dx
 = (()
¶eá
/
ow
)/
sx
;

903 
dy
 = (()
±İ
 /
oh
)/
sy
;

905 
image
 
sized
 = 
	`»size_image
(
üİ³d
, 
w
, 
h
);

906 if(
æ
è
	`æ_image
(
sized
);

907 
	`¿ndom_di¡Üt_image
(
sized
, 
hue
, 
§tu¿tiÚ
, 
exposu»
);

908 
d
.
X
.
v®s
[
i
] = 
sized
.
d©a
;

910 
	`fl_Œuth_»giÚ
(
¿ndom_·ths
[
i
], 
d
.
y
.
v®s
[i], 
şas£s
, 
size
, 
æ
, 
dx
, 
dy
, 1./
sx
, 1./
sy
);

912 
	`ä“_image
(
Üig
);

913 
	`ä“_image
(
üİ³d
);

915 
	`ä“
(
¿ndom_·ths
);

916  
d
;

917 
	}
}

919 
d©a
 
	$lßd_d©a_com·»
(
n
, **
·ths
, 
m
, 
şas£s
, 
w
, 
h
)

921 if(
m
è
·ths
 = 
	`g‘_¿ndom_·ths
Õ©hs, 2*
n
, m);

922 
i
,
j
;

923 
d©a
 
d
 = {0};

924 
d
.
sh®low
 = 0;

926 
d
.
X
.
rows
 = 
n
;

927 
d
.
X
.
v®s
 = (**)
	`ÿÎoc
(d.X.
rows
, (*));

928 
d
.
X
.
cŞs
 = 
h
*
w
*6;

930 
k
 = 2*(
şas£s
);

931 
d
.
y
 = 
	`make_m©rix
(
n
, 
k
);

932 
i
 = 0; i < 
n
; ++i){

933 
image
 
im1
 = 
	`lßd_image_cŞÜ
(
·ths
[
i
*2], 
w
, 
h
);

934 
image
 
im2
 = 
	`lßd_image_cŞÜ
(
·ths
[
i
*2+1], 
w
, 
h
);

936 
d
.
X
.
v®s
[
i
] = (*)
	`ÿÎoc
(d.X.
cŞs
, ());

937 
	`memıy
(
d
.
X
.
v®s
[
i
], 
im1
.
d©a
, 
h
*
w
*3*());

938 
	`memıy
(
d
.
X
.
v®s
[
i
] + 
h
*
w
*3, 
im2
.
d©a
, h*w*3*());

940 
id
;

941 
iou
;

943 
imÏb–1
[4096];

944 
imÏb–2
[4096];

945 
	`fšd_»¶aû
(
·ths
[
i
*2], (*)"imgs", (*)"Ïb–s", 
imÏb–1
);

946 
	`fšd_»¶aû
(
imÏb–1
, (*)"jpg", (*)"txt", imlabel1);

947 
FILE
 *
å1
 = 
	`fİ’
(
imÏb–1
, "r");

949 
	`fsÿnf
(
å1
, "%d %f", &
id
, &
iou
) == 2){

950 ià(
d
.
y
.
v®s
[
i
][2*
id
] < 
iou
) d.y.vals[i][2*id] = iou;

953 
	`fšd_»¶aû
(
·ths
[
i
*2+1], (*)"imgs", (*)"Ïb–s", 
imÏb–2
);

954 
	`fšd_»¶aû
(
imÏb–2
, (*)"jpg", (*)"txt", imlabel2);

955 
FILE
 *
å2
 = 
	`fİ’
(
imÏb–2
, "r");

957 
	`fsÿnf
(
å2
, "%d %f", &
id
, &
iou
) == 2){

958 ià(
d
.
y
.
v®s
[
i
][2*
id
 + 1] < 
iou
) d.y.vals[i][2*id + 1] = iou;

961 
j
 = 0; j < 
şas£s
; ++j){

962 ià(
d
.
y
.
v®s
[
i
][2*
j
] > .5 && d.y.vals[i][2*j+1] < .5){

963 
d
.
y
.
v®s
[
i
][2*
j
] = 1;

964 
d
.
y
.
v®s
[
i
][2*
j
+1] = 0;

965 } ià(
d
.
y
.
v®s
[
i
][2*
j
] < .5 && d.y.vals[i][2*j+1] > .5){

966 
d
.
y
.
v®s
[
i
][2*
j
] = 0;

967 
d
.
y
.
v®s
[
i
][2*
j
+1] = 1;

969 
d
.
y
.
v®s
[
i
][2*
j
] = 
SECRET_NUM
;

970 
d
.
y
.
v®s
[
i
][2*
j
+1] = 
SECRET_NUM
;

973 
	`fşo£
(
å1
);

974 
	`fşo£
(
å2
);

976 
	`ä“_image
(
im1
);

977 
	`ä“_image
(
im2
);

979 if(
m
è
	`ä“
(
·ths
);

980  
d
;

981 
	}
}

983 
d©a
 
	$lßd_d©a_swag
(**
·ths
, 
n
, 
şas£s
, 
j™‹r
)

985 
šdex
 = 
	`¿nd
()%
n
;

986 *
¿ndom_·th
 = 
·ths
[
šdex
];

988 
image
 
Üig
 = 
	`lßd_image_cŞÜ
(
¿ndom_·th
, 0, 0);

989 
h
 = 
Üig
.h;

990 
w
 = 
Üig
.w;

992 
d©a
 
d
 = {0};

993 
d
.
sh®low
 = 0;

994 
d
.
w
 = w;

995 
d
.
h
 = h;

997 
d
.
X
.
rows
 = 1;

998 
d
.
X
.
v®s
 = (**)
	`ÿÎoc
(d.X.
rows
, (*));

999 
d
.
X
.
cŞs
 = 
h
*
w
*3;

1001 
k
 = (4+
şas£s
)*90;

1002 
d
.
y
 = 
	`make_m©rix
(1, 
k
);

1004 
dw
 = 
w
*
j™‹r
;

1005 
dh
 = 
h
*
j™‹r
;

1007 
¶eá
 = 
	`¿nd_unifÜm
(-
dw
, dw);

1008 
´ight
 = 
	`¿nd_unifÜm
(-
dw
, dw);

1009 
±İ
 = 
	`¿nd_unifÜm
(-
dh
, dh);

1010 
pbÙ
 = 
	`¿nd_unifÜm
(-
dh
, dh);

1012 
swidth
 = 
w
 - 
¶eá
 - 
´ight
;

1013 
sheight
 = 
h
 - 
±İ
 - 
pbÙ
;

1015 
sx
 = ()
swidth
 / 
w
;

1016 
sy
 = ()
sheight
 / 
h
;

1018 
æ
 = 
	`¿nd
()%2;

1019 
image
 
üİ³d
 = 
	`üİ_image
(
Üig
, 
¶eá
, 
±İ
, 
swidth
, 
sheight
);

1021 
dx
 = (()
¶eá
/
w
)/
sx
;

1022 
dy
 = (()
±İ
 /
h
)/
sy
;

1024 
image
 
sized
 = 
	`»size_image
(
üİ³d
, 
w
, 
h
);

1025 if(
æ
è
	`æ_image
(
sized
);

1026 
d
.
X
.
v®s
[0] = 
sized
.
d©a
;

1028 
	`fl_Œuth_swag
(
¿ndom_·th
, 
d
.
y
.
v®s
[0], 
şas£s
, 
æ
, 
dx
, 
dy
, 1./
sx
, 1./
sy
);

1030 
	`ä“_image
(
Üig
);

1031 
	`ä“_image
(
üİ³d
);

1033  
d
;

1034 
	}
}

1036 
d©a
 
	$lßd_d©a_d‘eùiÚ
(
n
, **
·ths
, 
m
, 
w
, 
h
, 
boxes
, 
şas£s
, 
j™‹r
, 
hue
, 
§tu¿tiÚ
, 
exposu»
)

1038 **
¿ndom_·ths
 = 
	`g‘_¿ndom_·ths
(
·ths
, 
n
, 
m
);

1039 
i
;

1040 
d©a
 
d
 = {0};

1041 
d
.
sh®low
 = 0;

1043 
d
.
X
.
rows
 = 
n
;

1044 
d
.
X
.
v®s
 = (**)
	`ÿÎoc
(d.X.
rows
, (*));

1045 
d
.
X
.
cŞs
 = 
h
*
w
*3;

1047 
d
.
y
 = 
	`make_m©rix
(
n
, 5*
boxes
);

1048 
i
 = 0; i < 
n
; ++i){

1049 
image
 
Üig
 = 
	`lßd_image_cŞÜ
(
¿ndom_·ths
[
i
], 0, 0);

1050 
image
 
sized
 = 
	`make_image
(
w
, 
h
, 
Üig
.
c
);

1051 
	`fl_image
(
sized
, .5);

1053 
dw
 = 
j™‹r
 * 
Üig
.
w
;

1054 
dh
 = 
j™‹r
 * 
Üig
.
h
;

1056 
Ãw_¬
 = (
Üig
.
w
 + 
	`¿nd_unifÜm
(-
dw
, dw)è/ (Üig.
h
 +„ªd_unifÜm(-
dh
, dh));

1058 
sÿË
 = 1;

1060 
nw
, 
nh
;

1062 if(
Ãw_¬
 < 1){

1063 
nh
 = 
sÿË
 * 
h
;

1064 
nw
 = 
nh
 * 
Ãw_¬
;

1066 
nw
 = 
sÿË
 * 
w
;

1067 
nh
 = 
nw
 / 
Ãw_¬
;

1070 
dx
 = 
	`¿nd_unifÜm
(0, 
w
 - 
nw
);

1071 
dy
 = 
	`¿nd_unifÜm
(0, 
h
 - 
nh
);

1073 
	`¶aû_image
(
Üig
, 
nw
, 
nh
, 
dx
, 
dy
, 
sized
);

1075 
	`¿ndom_di¡Üt_image
(
sized
, 
hue
, 
§tu¿tiÚ
, 
exposu»
);

1077 
æ
 = 
	`¿nd
()%2;

1078 if(
æ
è
	`æ_image
(
sized
);

1079 
d
.
X
.
v®s
[
i
] = 
sized
.
d©a
;

1082 
	`fl_Œuth_d‘eùiÚ
(
¿ndom_·ths
[
i
], 
boxes
, 
d
.
y
.
v®s
[i], 
şas£s
, 
æ
, -
dx
/
w
, -
dy
/
h
, 
nw
/w, 
nh
/h);

1084 
	`ä“_image
(
Üig
);

1086 
	`ä“
(
¿ndom_·ths
);

1087  
d
;

1088 
	}
}

1090 *
	$lßd_th»ad
(*
±r
)

1093 
lßd_¬gs
 
a
 = *(lßd_¬gs*)
±r
;

1094 if(
a
.
exposu»
 == 0)‡.exposure = 1;

1095 if(
a
.
§tu¿tiÚ
 == 0)‡.saturation = 1;

1096 if(
a
.
a¥eù
 == 0)‡.aspect = 1;

1098 ià(
a
.
ty³
 =ğ
OLD_CLASSIFICATION_DATA
){

1099 *
a
.
d
 = 
	`lßd_d©a_Şd
×.
·ths
,‡.
n
,‡.
m
,‡.
Ïb–s
,‡.
şas£s
,‡.
w
,‡.
h
);

1100 } ià(
a
.
ty³
 =ğ
REGRESSION_DATA
){

1101 *
a
.
d
 = 
	`lßd_d©a_»g»ssiÚ
×.
·ths
,‡.
n
,‡.
m
,‡.
şas£s
,‡.
mš
,‡.
max
,‡.
size
,‡.
ªgË
,‡.
a¥eù
,‡.
hue
,‡.
§tu¿tiÚ
,‡.
exposu»
);

1102 } ià(
a
.
ty³
 =ğ
CLASSIFICATION_DATA
){

1103 *
a
.
d
 = 
	`lßd_d©a_augm’t
×.
·ths
,‡.
n
,‡.
m
,‡.
Ïb–s
,‡.
şas£s
,‡.
h›¿rchy
,‡.
mš
,‡.
max
,‡.
size
,‡.
ªgË
,‡.
a¥eù
,‡.
hue
,‡.
§tu¿tiÚ
,‡.
exposu»
,‡.
ûÁ”
);

1104 } ià(
a
.
ty³
 =ğ
SUPER_DATA
){

1105 *
a
.
d
 = 
	`lßd_d©a_su³r
×.
·ths
,‡.
n
,‡.
m
,‡.
w
,‡.
h
,‡.
sÿË
);

1106 } ià(
a
.
ty³
 =ğ
WRITING_DATA
){

1107 *
a
.
d
 = 
	`lßd_d©a_wr™šg
×.
·ths
,‡.
n
,‡.
m
,‡.
w
,‡.
h
,‡.
out_w
,‡.
out_h
);

1108 } ià(
a
.
ty³
 =ğ
ISEG_DATA
){

1109 *
a
.
d
 = 
	`lßd_d©a_i£g
×.
n
,‡.
·ths
,‡.
m
,‡.
w
,‡.
h
,‡.
şas£s
,‡.
num_boxes
,‡.
sÿË
,‡.
mš
,‡.
max
,‡.
ªgË
,‡.
a¥eù
,‡.
hue
,‡.
§tu¿tiÚ
,‡.
exposu»
);

1110 } ià(
a
.
ty³
 =ğ
INSTANCE_DATA
){

1111 *
a
.
d
 = 
	`lßd_d©a_mask
×.
n
,‡.
·ths
,‡.
m
,‡.
w
,‡.
h
,‡.
şas£s
,‡.
num_boxes
,‡.
coÜds
,‡.
mš
,‡.
max
,‡.
ªgË
,‡.
a¥eù
,‡.
hue
,‡.
§tu¿tiÚ
,‡.
exposu»
);

1112 } ià(
a
.
ty³
 =ğ
SEGMENTATION_DATA
){

1113 *
a
.
d
 = 
	`lßd_d©a_£g
×.
n
,‡.
·ths
,‡.
m
,‡.
w
,‡.
h
,‡.
şas£s
,‡.
mš
,‡.
max
,‡.
ªgË
,‡.
a¥eù
,‡.
hue
,‡.
§tu¿tiÚ
,‡.
exposu»
,‡.
sÿË
);

1114 } ià(
a
.
ty³
 =ğ
REGION_DATA
){

1115 *
a
.
d
 = 
	`lßd_d©a_»giÚ
×.
n
,‡.
·ths
,‡.
m
,‡.
w
,‡.
h
,‡.
num_boxes
,‡.
şas£s
,‡.
j™‹r
,‡.
hue
,‡.
§tu¿tiÚ
,‡.
exposu»
);

1116 } ià(
a
.
ty³
 =ğ
DETECTION_DATA
){

1117 *
a
.
d
 = 
	`lßd_d©a_d‘eùiÚ
×.
n
,‡.
·ths
,‡.
m
,‡.
w
,‡.
h
,‡.
num_boxes
,‡.
şas£s
,‡.
j™‹r
,‡.
hue
,‡.
§tu¿tiÚ
,‡.
exposu»
);

1118 } ià(
a
.
ty³
 =ğ
SWAG_DATA
){

1119 *
a
.
d
 = 
	`lßd_d©a_swag
×.
·ths
,‡.
n
,‡.
şas£s
,‡.
j™‹r
);

1120 } ià(
a
.
ty³
 =ğ
COMPARE_DATA
){

1121 *
a
.
d
 = 
	`lßd_d©a_com·»
×.
n
,‡.
·ths
,‡.
m
,‡.
şas£s
,‡.
w
,‡.
h
);

1122 } ià(
a
.
ty³
 =ğ
IMAGE_DATA
){

1123 *(
a
.
im
èğ
	`lßd_image_cŞÜ
×.
·th
, 0, 0);

1124 *(
a
.
»sized
èğ
	`»size_image
(*×.
im
),‡.
w
,‡.
h
);

1125 } ià(
a
.
ty³
 =ğ
LETTERBOX_DATA
){

1126 *(
a
.
im
èğ
	`lßd_image_cŞÜ
×.
·th
, 0, 0);

1127 *(
a
.
»sized
èğ
	`Ë‰”box_image
(*×.
im
),‡.
w
,‡.
h
);

1128 } ià(
a
.
ty³
 =ğ
TAG_DATA
){

1129 *
a
.
d
 = 
	`lßd_d©a_g
×.
·ths
,‡.
n
,‡.
m
,‡.
şas£s
,‡.
mš
,‡.
max
,‡.
size
,‡.
ªgË
,‡.
a¥eù
,‡.
hue
,‡.
§tu¿tiÚ
,‡.
exposu»
);

1131 
	`ä“
(
±r
);

1133 
	}
}

1135 
±h»ad_t
 
	$lßd_d©a_š_th»ad
(
lßd_¬gs
 
¬gs
)

1137 
±h»ad_t
 
th»ad
;

1138 
lßd_¬gs
 *
±r
 = (lßd_¬g *)
	`ÿÎoc
(1, (load_args));

1139 *
±r
 = 
¬gs
;

1140 if(
	`±h»ad_ü—‹
(&
th»ad
, 0, 
lßd_th»ad
, 
±r
)è
	`”rÜ
("Thread creation failed");

1141  
th»ad
;

1142 
	}
}

1144 *
	$lßd_th»ads
(*
±r
)

1146 
i
;

1147 
lßd_¬gs
 
¬gs
 = *Ößd_¬g *)
±r
;

1148 ià(
¬gs
.
th»ads
 == 0)‡rgs.threads = 1;

1149 
d©a
 *
out
 = 
¬gs
.
d
;

1150 
tÙ®
 = 
¬gs
.
n
;

1151 
	`ä“
(
±r
);

1152 
d©a
 *
bufãrs
 = (d©¨*)
	`ÿÎoc
(
¬gs
.
th»ads
, (data));

1153 
±h»ad_t
 *
th»ads
 = (±h»ad_ˆ*)
	`ÿÎoc
(
¬gs
.threads, (pthread_t));

1154 
i
 = 0; i < 
¬gs
.
th»ads
; ++i){

1155 
¬gs
.
d
 = 
bufãrs
 + 
i
;

1156 
¬gs
.
n
 = (
i
+1è* 
tÙ®
/¬gs.
th»ads
 - i *otal/args.threads;

1157 
th»ads
[
i
] = 
	`lßd_d©a_š_th»ad
(
¬gs
);

1159 
i
 = 0; i < 
¬gs
.
th»ads
; ++i){

1160 
	`±h»ad_još
(
th»ads
[
i
], 0);

1162 *
out
 = 
	`cÚÿt_d©as
(
bufãrs
, 
¬gs
.
th»ads
);

1163 
out
->
sh®low
 = 0;

1164 
i
 = 0; i < 
¬gs
.
th»ads
; ++i){

1165 
bufãrs
[
i
].
sh®low
 = 1;

1166 
	`ä“_d©a
(
bufãrs
[
i
]);

1168 
	`ä“
(
bufãrs
);

1169 
	`ä“
(
th»ads
);

1171 
	}
}

1173 
	$lßd_d©a_blockšg
(
lßd_¬gs
 
¬gs
)

1175 
lßd_¬gs
 *
±r
 = (lßd_¬g *)
	`ÿÎoc
(1, (load_args));

1176 *
±r
 = 
¬gs
;

1177 
	`lßd_th»ad
(
±r
);

1178 
	}
}

1180 
±h»ad_t
 
	$lßd_d©a
(
lßd_¬gs
 
¬gs
)

1182 
±h»ad_t
 
th»ad
;

1183 
lßd_¬gs
 *
±r
 = (lßd_¬g *)
	`ÿÎoc
(1, (load_args));

1184 *
±r
 = 
¬gs
;

1185 if(
	`±h»ad_ü—‹
(&
th»ad
, 0, 
lßd_th»ads
, 
±r
)è
	`”rÜ
("Thread creation failed");

1186  
th»ad
;

1187 
	}
}

1189 
d©a
 
	$lßd_d©a_wr™šg
(**
·ths
, 
n
, 
m
, 
w
, 
h
, 
out_w
, 
out_h
)

1191 if(
m
è
·ths
 = 
	`g‘_¿ndom_·ths
Õ©hs, 
n
, m);

1192 **
»¶aû_·ths
 = 
	`fšd_»¶aû_·ths
(
·ths
, 
n
, (*)".png", (*)"-label.png");

1193 
d©a
 
d
 = {0};

1194 
d
.
sh®low
 = 0;

1195 
d
.
X
 = 
	`lßd_image_·ths
(
·ths
, 
n
, 
w
, 
h
);

1196 
d
.
y
 = 
	`lßd_image_·ths_g¿y
(
»¶aû_·ths
, 
n
, 
out_w
, 
out_h
);

1197 if(
m
è
	`ä“
(
·ths
);

1198 
i
;

1199 
i
 = 0; i < 
n
; ++iè
	`ä“
(
»¶aû_·ths
[i]);

1200 
	`ä“
(
»¶aû_·ths
);

1201  
d
;

1202 
	}
}

1204 
d©a
 
	$lßd_d©a_Şd
(**
·ths
, 
n
, 
m
, **
Ïb–s
, 
k
, 
w
, 
h
)

1206 if(
m
è
·ths
 = 
	`g‘_¿ndom_·ths
Õ©hs, 
n
, m);

1207 
d©a
 
d
 = {0};

1208 
d
.
sh®low
 = 0;

1209 
d
.
X
 = 
	`lßd_image_·ths
(
·ths
, 
n
, 
w
, 
h
);

1210 
d
.
y
 = 
	`lßd_Ïb–s_·ths
(
·ths
, 
n
, 
Ïb–s
, 
k
, 0);

1211 if(
m
è
	`ä“
(
·ths
);

1212  
d
;

1213 
	}
}

1229 
d©a
 
	$lßd_d©a_su³r
(**
·ths
, 
n
, 
m
, 
w
, 
h
, 
sÿË
)

1231 if(
m
è
·ths
 = 
	`g‘_¿ndom_·ths
Õ©hs, 
n
, m);

1232 
d©a
 
d
 = {0};

1233 
d
.
sh®low
 = 0;

1235 
i
;

1236 
d
.
X
.
rows
 = 
n
;

1237 
d
.
X
.
v®s
 = (**)
	`ÿÎoc
(
n
, (*));

1238 
d
.
X
.
cŞs
 = 
w
*
h
*3;

1240 
d
.
y
.
rows
 = 
n
;

1241 
d
.
y
.
v®s
 = (**)
	`ÿÎoc
(
n
, (*));

1242 
d
.
y
.
cŞs
 = 
w
*
sÿË
 * 
h
*scale * 3;

1244 
i
 = 0; i < 
n
; ++i){

1245 
image
 
im
 = 
	`lßd_image_cŞÜ
(
·ths
[
i
], 0, 0);

1246 
image
 
üİ
 = 
	`¿ndom_üİ_image
(
im
, 
w
*
sÿË
, 
h
*scale);

1247 
æ
 = 
	`¿nd
()%2;

1248 ià(
æ
è
	`æ_image
(
üİ
);

1249 
image
 
»size
 = 
	`»size_image
(
üİ
, 
w
, 
h
);

1250 
d
.
X
.
v®s
[
i
] = 
»size
.
d©a
;

1251 
d
.
y
.
v®s
[
i
] = 
üİ
.
d©a
;

1252 
	`ä“_image
(
im
);

1255 if(
m
è
	`ä“
(
·ths
);

1256  
d
;

1257 
	}
}

1259 
d©a
 
	$lßd_d©a_»g»ssiÚ
(**
·ths
, 
n
, 
m
, 
k
, 
mš
, 
max
, 
size
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
)

1261 if(
m
è
·ths
 = 
	`g‘_¿ndom_·ths
Õ©hs, 
n
, m);

1262 
d©a
 
d
 = {0};

1263 
d
.
sh®low
 = 0;

1264 
d
.
X
 = 
	`lßd_image_augm’t_·ths
(
·ths
, 
n
, 
mš
, 
max
, 
size
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
, 0);

1265 
d
.
y
 = 
	`lßd_»g»ssiÚ_Ïb–s_·ths
(
·ths
, 
n
, 
k
);

1266 if(
m
è
	`ä“
(
·ths
);

1267  
d
;

1268 
	}
}

1270 
d©a
 
	$£Ëù_d©a
(
d©a
 *
Üig
, *
šds
)

1272 
d©a
 
d
 = {0};

1273 
d
.
sh®low
 = 1;

1274 
d
.
w
 = 
Üig
[0].w;

1275 
d
.
h
 = 
Üig
[0].h;

1277 
d
.
X
.
rows
 = 
Üig
[0].X.rows;

1278 
d
.
y
.
rows
 = 
Üig
[0].
X
.rows;

1280 
d
.
X
.
cŞs
 = 
Üig
[0].X.cols;

1281 
d
.
y
.
cŞs
 = 
Üig
[0].y.cols;

1283 
d
.
X
.
v®s
 = (**)
	`ÿÎoc
(
Üig
[0].X.
rows
, (*));

1284 
d
.
y
.
v®s
 = (**)
	`ÿÎoc
(
Üig
[0].y.
rows
, (*));

1285 
i
;

1286 
i
 = 0; i < 
d
.
X
.
rows
; ++i){

1287 
d
.
X
.
v®s
[
i
] = 
Üig
[
šds
[i]].X.vals[i];

1288 
d
.
y
.
v®s
[
i
] = 
Üig
[
šds
[i]].y.vals[i];

1290  
d
;

1291 
	}
}

1293 
d©a
 *
	$te_d©a
(
d©a
 
Üig
, 
divs
, 
size
)

1295 
d©a
 *
ds
 = (d©¨*)
	`ÿÎoc
(
divs
*divs, (data));

1296 
i
, 
j
;

1297 #´agm¨
omp
 
·¿Î–
 

1298 
i
 = 0; i < 
divs
*divs; ++i){

1299 
d©a
 
d
;

1300 
d
.
sh®low
 = 0;

1301 
d
.
w
 = 
Üig
.w/
divs
 * 
size
;

1302 
d
.
h
 = 
Üig
.h/
divs
 * 
size
;

1303 
d
.
X
.
rows
 = 
Üig
.X.rows;

1304 
d
.
X
.
cŞs
 = d.
w
*d.
h
*3;

1305 
d
.
X
.
v®s
 = (**)
	`ÿÎoc
(d.X.
rows
, (*));

1307 
d
.
y
 = 
	`cİy_m©rix
(
Üig
.y);

1308 #´agm¨
omp
 
·¿Î–
 

1309 
j
 = 0; j < 
Üig
.
X
.
rows
; ++j){

1310 
x
 = (
i
%
divs
è* 
Üig
.
w
 / div - (
d
.w - orig.w/divs)/2;

1311 
y
 = (
i
/
divs
è* 
Üig
.
h
 / div - (
d
.h - orig.h/divs)/2;

1312 
image
 
im
 = 
	`æßt_to_image
(
Üig
.
w
, orig.
h
, 3, orig.
X
.
v®s
[
j
]);

1313 
d
.
X
.
v®s
[
j
] = 
	`üİ_image
(
im
, 
x
, 
y
, d.
w
, d.
h
).
d©a
;

1315 
ds
[
i
] = 
d
;

1317  
ds
;

1318 
	}
}

1320 
d©a
 
	$»size_d©a
(
d©a
 
Üig
, 
w
, 
h
)

1322 
d©a
 
d
 = {0};

1323 
d
.
sh®low
 = 0;

1324 
d
.
w
 = w;

1325 
d
.
h
 = h;

1326 
i
;

1327 
d
.
X
.
rows
 = 
Üig
.X.rows;

1328 
d
.
X
.
cŞs
 = 
w
*
h
*3;

1329 
d
.
X
.
v®s
 = (**)
	`ÿÎoc
(d.X.
rows
, (*));

1331 
d
.
y
 = 
	`cİy_m©rix
(
Üig
.y);

1332 #´agm¨
omp
 
·¿Î–
 

1333 
i
 = 0; i < 
Üig
.
X
.
rows
; ++i){

1334 
image
 
im
 = 
	`æßt_to_image
(
Üig
.
w
, orig.
h
, 3, orig.
X
.
v®s
[
i
]);

1335 
d
.
X
.
v®s
[
i
] = 
	`»size_image
(
im
, 
w
, 
h
).
d©a
;

1337  
d
;

1338 
	}
}

1340 
d©a
 
	$lßd_d©a_augm’t
(**
·ths
, 
n
, 
m
, **
Ïb–s
, 
k
, 
Œ“
 *
h›¿rchy
, 
mš
, 
max
, 
size
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
, 
ûÁ”
)

1342 if(
m
è
·ths
 = 
	`g‘_¿ndom_·ths
Õ©hs, 
n
, m);

1343 
d©a
 
d
 = {0};

1344 
d
.
sh®low
 = 0;

1345 
d
.
w
=
size
;

1346 
d
.
h
=
size
;

1347 
d
.
X
 = 
	`lßd_image_augm’t_·ths
(
·ths
, 
n
, 
mš
, 
max
, 
size
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
, 
ûÁ”
);

1348 
d
.
y
 = 
	`lßd_Ïb–s_·ths
(
·ths
, 
n
, 
Ïb–s
, 
k
, 
h›¿rchy
);

1349 if(
m
è
	`ä“
(
·ths
);

1350  
d
;

1351 
	}
}

1353 
d©a
 
	$lßd_d©a_g
(**
·ths
, 
n
, 
m
, 
k
, 
mš
, 
max
, 
size
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
)

1355 if(
m
è
·ths
 = 
	`g‘_¿ndom_·ths
Õ©hs, 
n
, m);

1356 
d©a
 
d
 = {0};

1357 
d
.
w
 = 
size
;

1358 
d
.
h
 = 
size
;

1359 
d
.
sh®low
 = 0;

1360 
d
.
X
 = 
	`lßd_image_augm’t_·ths
(
·ths
, 
n
, 
mš
, 
max
, 
size
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
, 0);

1361 
d
.
y
 = 
	`lßd_gs_·ths
(
·ths
, 
n
, 
k
);

1362 if(
m
è
	`ä“
(
·ths
);

1363  
d
;

1364 
	}
}

1366 
m©rix
 
	$cÚÿt_m©rix
(
m©rix
 
m1
, m©rix 
m2
)

1368 
i
, 
couÁ
 = 0;

1369 
m©rix
 
m
;

1370 
m
.
cŞs
 = 
m1
.cols;

1371 
m
.
rows
 = 
m1
.rows+
m2
.rows;

1372 
m
.
v®s
 = (**)
	`ÿÎoc
(
m1
.
rows
 + 
m2
.rows, (*));

1373 
i
 = 0; i < 
m1
.
rows
; ++i){

1374 
m
.
v®s
[
couÁ
++] = 
m1
.v®s[
i
];

1376 
i
 = 0; i < 
m2
.
rows
; ++i){

1377 
m
.
v®s
[
couÁ
++] = 
m2
.v®s[
i
];

1379  
m
;

1380 
	}
}

1382 
d©a
 
	$cÚÿt_d©a
(
d©a
 
d1
, d©¨
d2
)

1384 
d©a
 
d
 = {0};

1385 
d
.
sh®low
 = 1;

1386 
d
.
X
 = 
	`cÚÿt_m©rix
(
d1
.X, 
d2
.X);

1387 
d
.
y
 = 
	`cÚÿt_m©rix
(
d1
.y, 
d2
.y);

1388 
d
.
w
 = 
d1
.w;

1389 
d
.
h
 = 
d1
.h;

1390  
d
;

1391 
	}
}

1393 
d©a
 
	$cÚÿt_d©as
(
d©a
 *
d
, 
n
)

1395 
i
;

1396 
d©a
 
out
 = {0};

1397 
i
 = 0; i < 
n
; ++i){

1398 
d©a
 
Ãw_r
 = 
	`cÚÿt_d©a
(
d
[
i
], 
out
);

1399 
	`ä“_d©a
(
out
);

1400 
out
 = 
Ãw_r
;

1402  
out
;

1403 
	}
}

1405 
d©a
 
	$lßd_ÿ‹gÜiÿl_d©a_csv
(*
f’ame
, 
rg‘
, 
k
)

1407 
d©a
 
d
 = {0};

1408 
d
.
sh®low
 = 0;

1409 
m©rix
 
X
 = 
	`csv_to_m©rix
(
f’ame
);

1410 *
Œuth_1d
 = 
	`pİ_cŞumn
(&
X
, 
rg‘
);

1411 **
Œuth
 = 
	`Úe_hÙ_’code
(
Œuth_1d
, 
X
.
rows
, 
k
);

1412 
m©rix
 
y
;

1413 
y
.
rows
 = 
X
.rows;

1414 
y
.
cŞs
 = 
k
;

1415 
y
.
v®s
 = 
Œuth
;

1416 
d
.
X
 = X;

1417 
d
.
y
 = y;

1418 
	`ä“
(
Œuth_1d
);

1419  
d
;

1420 
	}
}

1422 
d©a
 
	$lßd_ciçr10_d©a
(*
f’ame
)

1424 
d©a
 
d
 = {0};

1425 
d
.
sh®low
 = 0;

1426 
i
,
j
;

1427 
m©rix
 
X
 = 
	`make_m©rix
(10000, 3072);

1428 
m©rix
 
y
 = 
	`make_m©rix
(10000, 10);

1429 
d
.
X
 = X;

1430 
d
.
y
 = y;

1432 
FILE
 *
å
 = 
	`fİ’
(
f’ame
, "rb");

1433 if(!
å
è
	`fe_”rÜ
(
f’ame
);

1434 
i
 = 0; i < 10000; ++i){

1435 
by‹s
[3073];

1436 
	`ä—d
(
by‹s
, 1, 3073, 
å
);

1437 
şass_r
 = 
by‹s
[0];

1438 
y
.
v®s
[
i
][
şass_r
] = 1;

1439 
j
 = 0; j < 
X
.
cŞs
; ++j){

1440 
X
.
v®s
[
i
][
j
] = ()
by‹s
[j+1];

1443 
	`sÿË_d©a_rows
(
d
, 1./255);

1445 
	`fşo£
(
å
);

1446  
d
;

1447 
	}
}

1449 
	$g‘_¿ndom_b©ch
(
d©a
 
d
, 
n
, *
X
, *
y
)

1451 
j
;

1452 
j
 = 0; j < 
n
; ++j){

1453 
šdex
 = 
	`¿nd
()%
d
.
X
.
rows
;

1454 
	`memıy
(
X
+
j
*
d
.X.
cŞs
, d.X.
v®s
[
šdex
], d.X.cols*());

1455 
	`memıy
(
y
+
j
*
d
.y.
cŞs
, d.y.
v®s
[
šdex
], d.y.cols*());

1457 
	}
}

1459 
	$g‘_Ãxt_b©ch
(
d©a
 
d
, 
n
, 
off£t
, *
X
, *
y
)

1461 
j
;

1462 
j
 = 0; j < 
n
; ++j){

1463 
šdex
 = 
off£t
 + 
j
;

1464 
	`memıy
(
X
+
j
*
d
.X.
cŞs
, d.X.
v®s
[
šdex
], d.X.cols*());

1465 if(
y
è
	`memıy
(y+
j
*
d
.y.
cŞs
, d.y.
v®s
[
šdex
], d.y.cols*());

1467 
	}
}

1469 
	$smoÙh_d©a
(
d©a
 
d
)

1471 
i
, 
j
;

1472 
sÿË
 = 1. / 
d
.
y
.
cŞs
;

1473 
•s
 = .1;

1474 
i
 = 0; i < 
d
.
y
.
rows
; ++i){

1475 
j
 = 0; j < 
d
.
y
.
cŞs
; ++j){

1476 
d
.
y
.
v®s
[
i
][
j
] = 
•s
 * 
sÿË
 + (1-eps) * d.y.vals[i][j];

1479 
	}
}

1481 
d©a
 
	$lßd_®l_ciçr10
()

1483 
d©a
 
d
 = {0};

1484 
d
.
sh®low
 = 0;

1485 
i
,
j
,
b
;

1486 
m©rix
 
X
 = 
	`make_m©rix
(50000, 3072);

1487 
m©rix
 
y
 = 
	`make_m©rix
(50000, 10);

1488 
d
.
X
 = X;

1489 
d
.
y
 = y;

1492 
b
 = 0; b < 5; ++b){

1493 
buff
[256];

1494 
	`¥rštf
(
buff
, "d©a/ciçr/ciçr-10-b©ches-bš/d©a_b©ch_%d.bš", 
b
+1);

1495 
FILE
 *
å
 = 
	`fİ’
(
buff
, "rb");

1496 if(!
å
è
	`fe_”rÜ
(
buff
);

1497 
i
 = 0; i < 10000; ++i){

1498 
by‹s
[3073];

1499 
	`ä—d
(
by‹s
, 1, 3073, 
å
);

1500 
şass_r
 = 
by‹s
[0];

1501 
y
.
v®s
[
i
+
b
*10000][
şass_r
] = 1;

1502 
j
 = 0; j < 
X
.
cŞs
; ++j){

1503 
X
.
v®s
[
i
+
b
*10000][
j
] = ()
by‹s
[j+1];

1506 
	`fşo£
(
å
);

1509 
	`sÿË_d©a_rows
(
d
, 1./255);

1510 
	`smoÙh_d©a
(
d
);

1511  
d
;

1512 
	}
}

1514 
d©a
 
	$lßd_go
(*
f’ame
)

1516 
FILE
 *
å
 = 
	`fİ’
(
f’ame
, "rb");

1517 
m©rix
 
X
 = 
	`make_m©rix
(3363059, 361);

1518 
m©rix
 
y
 = 
	`make_m©rix
(3363059, 361);

1519 
row
, 
cŞ
;

1521 if(!
å
è
	`fe_”rÜ
(
f’ame
);

1522 *
Ïb–
;

1523 
couÁ
 = 0;

1524 (
Ïb–
 = 
	`fg‘l
(
å
))){

1525 
i
;

1526 if(
couÁ
 =ğ
X
.
rows
){

1527 
X
 = 
	`»size_m©rix
(X, 
couÁ
*2);

1528 
y
 = 
	`»size_m©rix
(y, 
couÁ
*2);

1530 
	`ssÿnf
(
Ïb–
, "%d %d", &
row
, &
cŞ
);

1531 *
bßrd
 = 
	`fg‘l
(
å
);

1533 
šdex
 = 
row
*19 + 
cŞ
;

1534 
y
.
v®s
[
couÁ
][
šdex
] = 1;

1536 
i
 = 0; i < 19*19; ++i){

1537 
v®
 = 0;

1538 if(
bßrd
[
i
] =ğ'1'è
v®
 = 1;

1539 if(
bßrd
[
i
] =ğ'2'è
v®
 = -1;

1540 
X
.
v®s
[
couÁ
][
i
] = 
v®
;

1542 ++
couÁ
;

1543 
	`ä“
(
Ïb–
);

1544 
	`ä“
(
bßrd
);

1546 
X
 = 
	`»size_m©rix
(X, 
couÁ
);

1547 
y
 = 
	`»size_m©rix
(y, 
couÁ
);

1549 
d©a
 
d
 = {0};

1550 
d
.
sh®low
 = 0;

1551 
d
.
X
 = X;

1552 
d
.
y
 = y;

1555 
	`fşo£
(
å
);

1557  
d
;

1558 
	}
}

1561 
	$¿ndomize_d©a
(
d©a
 
d
)

1563 
i
;

1564 
i
 = 
d
.
X
.
rows
-1; i > 0; --i){

1565 
šdex
 = 
	`¿nd
()%
i
;

1566 *
sw­
 = 
d
.
X
.
v®s
[
šdex
];

1567 
d
.
X
.
v®s
[
šdex
] = d.X.v®s[
i
];

1568 
d
.
X
.
v®s
[
i
] = 
sw­
;

1570 
sw­
 = 
d
.
y
.
v®s
[
šdex
];

1571 
d
.
y
.
v®s
[
šdex
] = d.y.v®s[
i
];

1572 
d
.
y
.
v®s
[
i
] = 
sw­
;

1574 
	}
}

1576 
	$sÿË_d©a_rows
(
d©a
 
d
, 
s
)

1578 
i
;

1579 
i
 = 0; i < 
d
.
X
.
rows
; ++i){

1580 
	`sÿË_¬¿y
(
d
.
X
.
v®s
[
i
], d.X.
cŞs
, 
s
);

1582 
	}
}

1584 
	$Œª¦©e_d©a_rows
(
d©a
 
d
, 
s
)

1586 
i
;

1587 
i
 = 0; i < 
d
.
X
.
rows
; ++i){

1588 
	`Œª¦©e_¬¿y
(
d
.
X
.
v®s
[
i
], d.X.
cŞs
, 
s
);

1590 
	}
}

1592 
d©a
 
	$cİy_d©a
(
d©a
 
d
)

1594 
d©a
 
c
 = {0};

1595 
c
.
w
 = 
d
.w;

1596 
c
.
h
 = 
d
.h;

1597 
c
.
sh®low
 = 0;

1598 
c
.
num_boxes
 = 
d
.num_boxes;

1599 
c
.
boxes
 = 
d
.boxes;

1600 
c
.
X
 = 
	`cİy_m©rix
(
d
.X);

1601 
c
.
y
 = 
	`cİy_m©rix
(
d
.y);

1602  
c
;

1603 
	}
}

1605 
	$nÜm®ize_d©a_rows
(
d©a
 
d
)

1607 
i
;

1608 
i
 = 0; i < 
d
.
X
.
rows
; ++i){

1609 
	`nÜm®ize_¬¿y
(
d
.
X
.
v®s
[
i
], d.X.
cŞs
);

1611 
	}
}

1613 
d©a
 
	$g‘_d©a_·¹
(
d©a
 
d
, 
·¹
, 
tÙ®
)

1615 
d©a
 
p
 = {0};

1616 
p
.
sh®low
 = 1;

1617 
p
.
X
.
rows
 = 
d
.X.row * (
·¹
 + 1è/ 
tÙ®
 - d.X.rows *…art /otal;

1618 
p
.
y
.
rows
 = 
d
.y.row * (
·¹
 + 1è/ 
tÙ®
 - d.y.rows *…art /otal;

1619 
p
.
X
.
cŞs
 = 
d
.X.cols;

1620 
p
.
y
.
cŞs
 = 
d
.y.cols;

1621 
p
.
X
.
v®s
 = 
d
.X.v® + d.X.
rows
 * 
·¹
 / 
tÙ®
;

1622 
p
.
y
.
v®s
 = 
d
.y.v® + d.y.
rows
 * 
·¹
 / 
tÙ®
;

1623  
p
;

1624 
	}
}

1626 
d©a
 
	$g‘_¿ndom_d©a
(
d©a
 
d
, 
num
)

1628 
d©a
 
r
 = {0};

1629 
r
.
sh®low
 = 1;

1631 
r
.
X
.
rows
 = 
num
;

1632 
r
.
y
.
rows
 = 
num
;

1634 
r
.
X
.
cŞs
 = 
d
.X.cols;

1635 
r
.
y
.
cŞs
 = 
d
.y.cols;

1637 
r
.
X
.
v®s
 = (**)
	`ÿÎoc
(
num
, (*));

1638 
r
.
y
.
v®s
 = (**)
	`ÿÎoc
(
num
, (*));

1640 
i
;

1641 
i
 = 0; i < 
num
; ++i){

1642 
šdex
 = 
	`¿nd
()%
d
.
X
.
rows
;

1643 
r
.
X
.
v®s
[
i
] = 
d
.X.v®s[
šdex
];

1644 
r
.
y
.
v®s
[
i
] = 
d
.y.v®s[
šdex
];

1646  
r
;

1647 
	}
}

1649 
d©a
 *
	$¥l™_d©a
(
d©a
 
d
, 
·¹
, 
tÙ®
)

1651 
d©a
 *
¥l™
 = (d©¨*)
	`ÿÎoc
(2, (data));

1652 
i
;

1653 
¡¬t
 = 
·¹
*
d
.
X
.
rows
/
tÙ®
;

1654 
’d
 = (
·¹
+1)*
d
.
X
.
rows
/
tÙ®
;

1655 
d©a
 
Œaš
;

1656 
d©a
 
‹¡
;

1657 
Œaš
.
sh®low
 = 
‹¡
.shallow = 1;

1659 
‹¡
.
X
.
rows
 =e¡.
y
.row ğ
’d
-
¡¬t
;

1660 
Œaš
.
X
.
rows
 =¿š.
y
.row ğ
d
.X.row - (
’d
-
¡¬t
);

1661 
Œaš
.
X
.
cŞs
 = 
‹¡
.X.cŞ ğ
d
.X.cols;

1662 
Œaš
.
y
.
cŞs
 = 
‹¡
.y.cŞ ğ
d
.y.cols;

1664 
Œaš
.
X
.
v®s
 = (**)
	`ÿÎoc
Ñ¿š.X.
rows
, (*));

1665 
‹¡
.
X
.
v®s
 = (**)
	`ÿÎoc
Ñe¡.X.
rows
, (*));

1666 
Œaš
.
y
.
v®s
 = (**)
	`ÿÎoc
Ñ¿š.y.
rows
, (*));

1667 
‹¡
.
y
.
v®s
 = (**)
	`ÿÎoc
Ñe¡.y.
rows
, (*));

1669 
i
 = 0; i < 
¡¬t
; ++i){

1670 
Œaš
.
X
.
v®s
[
i
] = 
d
.X.vals[i];

1671 
Œaš
.
y
.
v®s
[
i
] = 
d
.y.vals[i];

1673 
i
 = 
¡¬t
; i < 
’d
; ++i){

1674 
‹¡
.
X
.
v®s
[
i
-
¡¬t
] = 
d
.X.vals[i];

1675 
‹¡
.
y
.
v®s
[
i
-
¡¬t
] = 
d
.y.vals[i];

1677 
i
 = 
’d
; i < 
d
.
X
.
rows
; ++i){

1678 
Œaš
.
X
.
v®s
[
i
-(
’d
-
¡¬t
)] = 
d
.X.vals[i];

1679 
Œaš
.
y
.
v®s
[
i
-(
’d
-
¡¬t
)] = 
d
.y.vals[i];

1681 
¥l™
[0] = 
Œaš
;

1682 
¥l™
[1] = 
‹¡
;

1683  
¥l™
;

1684 
	}
}

	@App/data.h

1 #iâdeà
DATA_H


2 
	#DATA_H


	)

3 
	~<±h»ad.h
>

5 
	~"d¬kÃt.h
"

6 
	~"m©rix.h
"

7 
	~"li¡.h
"

8 
	~"image.h
"

9 
	~"Œ“.h
"

11 
šlše
 
	$di¡ªû_äom_edge
(
x
, 
max
)

13 
dx
 = (
max
/2è- 
x
;

14 ià(
dx
 < 0) dx = -dx;

15 
dx
 = (
max
/2) + 1 - dx;

16 
dx
 *= 2;

17 
di¡
 = ()
dx
/
max
;

18 ià(
di¡
 > 1) dist = 1;

19  
di¡
;

20 
	}
}

21 
lßd_d©a_blockšg
(
lßd_¬gs
 
¬gs
);

24 
´št_Ë‰”s
(*
´ed
, 
n
);

25 
d©a
 
lßd_d©a_ÿ±cha
(**
·ths
, 
n
, 
m
, 
k
, 
w
, 
h
);

26 
d©a
 
lßd_d©a_ÿ±cha_’code
(**
·ths
, 
n
, 
m
, 
w
, 
h
);

27 
d©a
 
lßd_d©a_d‘eùiÚ
(
n
, **
·ths
, 
m
, 
w
, 
h
, 
boxes
, 
şas£s
, 
j™‹r
, 
hue
, 
§tu¿tiÚ
, 
exposu»
);

28 
d©a
 
lßd_d©a_g
(**
·ths
, 
n
, 
m
, 
k
, 
mš
, 
max
, 
size
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
);

29 
m©rix
 
lßd_image_augm’t_·ths
(**
·ths
, 
n
, 
mš
, 
max
, 
size
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
, 
ûÁ”
);

30 
d©a
 
lßd_d©a_su³r
(**
·ths
, 
n
, 
m
, 
w
, 
h
, 
sÿË
);

31 
d©a
 
lßd_d©a_augm’t
(**
·ths
, 
n
, 
m
, **
Ïb–s
, 
k
, 
Œ“
 *
h›¿rchy
, 
mš
, 
max
, 
size
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
, 
ûÁ”
);

32 
d©a
 
lßd_d©a_»g»ssiÚ
(**
·ths
, 
n
, 
m
, 
şas£s
, 
mš
, 
max
, 
size
, 
ªgË
, 
a¥eù
, 
hue
, 
§tu¿tiÚ
, 
exposu»
);

33 
d©a
 
lßd_go
(*
f’ame
);

36 
d©a
 
lßd_d©a_wr™šg
(**
·ths
, 
n
, 
m
, 
w
, 
h
, 
out_w
, 
out_h
);

38 
g‘_¿ndom_b©ch
(
d©a
 
d
, 
n
, *
X
, *
y
);

39 
d©a
 
g‘_d©a_·¹
(d©¨
d
, 
·¹
, 
tÙ®
);

40 
d©a
 
g‘_¿ndom_d©a
(d©¨
d
, 
num
);

41 
d©a
 
lßd_ÿ‹gÜiÿl_d©a_csv
(*
f’ame
, 
rg‘
, 
k
);

42 
nÜm®ize_d©a_rows
(
d©a
 
d
);

43 
sÿË_d©a_rows
(
d©a
 
d
, 
s
);

44 
Œª¦©e_d©a_rows
(
d©a
 
d
, 
s
);

45 
¿ndomize_d©a
(
d©a
 
d
);

46 
d©a
 *
¥l™_d©a
(d©¨
d
, 
·¹
, 
tÙ®
);

47 
d©a
 
cÚÿt_d©as
(d©¨*
d
, 
n
);

48 
fl_Œuth
(*
·th
, **
Ïb–s
, 
k
, *
Œuth
);

	@App/dropout_layer.h

1 #iâdeà
DROPOUT_LAYER_H


2 
	#DROPOUT_LAYER_H


	)

4 
	~"Ïy”.h
"

5 
	~"ÃtwÜk.h
"

7 
Ïy”
 
	tdrİout_Ïy”
;

9 
drİout_Ïy”
 
make_drİout_Ïy”
(
b©ch
, 
šputs
, 
´obab™y
);

	@App/image.cpp

1 
	~"image.h
"

2 
	~"uts.h
"

3 
	~"bÏs.h
"

5 
	~<¡dio.h
>

6 
	~<m©h.h
>

8 
	#STB_IMAGE_IMPLEMENTATION


	)

9 
	~"¡b_image.h
"

10 
	#STB_IMAGE_WRITE_IMPLEMENTATION


	)

11 
	~"¡b_image_wr™e.h
"

13 
	gwšdows
 = 0;

15 
	gcŞÜs
[6][3] = { {1,0,1}, {0,0,1},{0,1,1},{0,1,0},{1,1,0},{1,0,0} };

17 
	$g‘_cŞÜ
(
c
, 
x
, 
max
)

19 
¿tio
 = (()
x
/
max
)*5;

20 
i
 = 
	`æoÜ
(
¿tio
);

21 
j
 = 
	`û
(
¿tio
);

22 
¿tio
 -ğ
i
;

23 
r
 = (1-
¿tio
è* 
cŞÜs
[
i
][
c
] +„©io*cŞÜs[
j
][c];

25  
r
;

26 
	}
}

28 
image
 
	$mask_to_rgb
(
image
 
mask
)

30 
n
 = 
mask
.
c
;

31 
image
 
im
 = 
	`make_image
(
mask
.
w
, mask.
h
, 3);

32 
i
, 
j
;

33 
j
 = 0; j < 
n
; ++j){

34 
off£t
 = 
j
*123457 % 
n
;

35 
»d
 = 
	`g‘_cŞÜ
(2,
off£t
,
n
);

36 
g»’
 = 
	`g‘_cŞÜ
(1,
off£t
,
n
);

37 
blue
 = 
	`g‘_cŞÜ
(0,
off£t
,
n
);

38 
i
 = 0; i < 
im
.
w
*im.
h
; ++i){

39 
im
.
d©a
[
i
 + 0*im.
w
*im.
h
] +ğ
mask
.d©a[
j
*im.h*im.w + i]*
»d
;

40 
im
.
d©a
[
i
 + 1*im.
w
*im.
h
] +ğ
mask
.d©a[
j
*im.h*im.w + i]*
g»’
;

41 
im
.
d©a
[
i
 + 2*im.
w
*im.
h
] +ğ
mask
.d©a[
j
*im.h*im.w + i]*
blue
;

44  
im
;

45 
	}
}

47 
	$g‘_pix–
(
image
 
m
, 
x
, 
y
, 
c
)

49 
	`as£¹
(
x
 < 
m
.
w
 && 
y
 < m.
h
 && 
c
 < m.c);

50  
m
.
d©a
[
c
*m.
h
*m.
w
 + 
y
*m.w + 
x
];

51 
	}
}

52 
	$g‘_pix–_ex‹nd
(
image
 
m
, 
x
, 
y
, 
c
)

54 if(
x
 < 0 || x >ğ
m
.
w
 || 
y
 < 0 || y >ğm.
h
)  0;

61 if(
c
 < 0 || c >ğ
m
.c)  0;

62  
	`g‘_pix–
(
m
, 
x
, 
y
, 
c
);

63 
	}
}

64 
	$£t_pix–
(
image
 
m
, 
x
, 
y
, 
c
, 
v®
)

66 ià(
x
 < 0 || 
y
 < 0 || 
c
 < 0 || x >ğ
m
.
w
 || y >ğm.
h
 || c >= m.c) ;

67 
	`as£¹
(
x
 < 
m
.
w
 && 
y
 < m.
h
 && 
c
 < m.c);

68 
m
.
d©a
[
c
*m.
h
*m.
w
 + 
y
*m.w + 
x
] = 
v®
;

69 
	}
}

70 
	$add_pix–
(
image
 
m
, 
x
, 
y
, 
c
, 
v®
)

72 
	`as£¹
(
x
 < 
m
.
w
 && 
y
 < m.
h
 && 
c
 < m.c);

73 
m
.
d©a
[
c
*m.
h
*m.
w
 + 
y
*m.w + 
x
] +ğ
v®
;

74 
	}
}

76 
	$bš—r_š‹½Ş©e
(
image
 
im
, 
x
, 
y
, 
c
)

78 
ix
 = (è
	`æoÜf
(
x
);

79 
iy
 = (è
	`æoÜf
(
y
);

81 
dx
 = 
x
 - 
ix
;

82 
dy
 = 
y
 - 
iy
;

84 
v®
 = (1-
dy
è* (1-
dx
è* 
	`g‘_pix–_ex‹nd
(
im
, 
ix
, 
iy
, 
c
) +

85 
dy
 * (1-
dx
è* 
	`g‘_pix–_ex‹nd
(
im
, 
ix
, 
iy
+1, 
c
) +

86 (1-
dy
è* 
dx
 * 
	`g‘_pix–_ex‹nd
(
im
, 
ix
+1, 
iy
, 
c
) +

87 
dy
 * 
dx
 * 
	`g‘_pix–_ex‹nd
(
im
, 
ix
+1, 
iy
+1, 
c
);

88  
v®
;

89 
	}
}

92 
	$compos™e_image
(
image
 
sourû
, imag
de¡
, 
dx
, 
dy
)

94 
x
,
y
,
k
;

95 
k
 = 0; k < 
sourû
.
c
; ++k){

96 
y
 = 0; y < 
sourû
.
h
; ++y){

97 
x
 = 0; x < 
sourû
.
w
; ++x){

98 
v®
 = 
	`g‘_pix–
(
sourû
, 
x
, 
y
, 
k
);

99 
v®2
 = 
	`g‘_pix–_ex‹nd
(
de¡
, 
dx
+
x
, 
dy
+
y
, 
k
);

100 
	`£t_pix–
(
de¡
, 
dx
+
x
, 
dy
+
y
, 
k
, 
v®
 * 
v®2
);

104 
	}
}

106 
image
 
	$bÜd”_image
(
image
 
a
, 
bÜd”
)

108 
image
 
b
 = 
	`make_image
(
a
.
w
 + 2*
bÜd”
,‡.
h
 + 2*bÜd”,‡.
c
);

109 
x
,
y
,
k
;

110 
k
 = 0; k < 
b
.
c
; ++k){

111 
y
 = 0; y < 
b
.
h
; ++y){

112 
x
 = 0; x < 
b
.
w
; ++x){

113 
v®
 = 
	`g‘_pix–_ex‹nd
(
a
, 
x
 - 
bÜd”
, 
y
 - bÜd”, 
k
);

114 if(
x
 - 
bÜd”
 < 0 || x - bÜd” >ğ
a
.
w
 || 
y
 - bÜd” < 0 || y - bÜd” >ğa.
h
è
v®
 = 1;

115 
	`£t_pix–
(
b
, 
x
, 
y
, 
k
, 
v®
);

119  
b
;

120 
	}
}

122 
image
 
	$te_images
(
image
 
a
, imag
b
, 
dx
)

124 if(
a
.
w
 =ğ0è 
	`cİy_image
(
b
);

125 
image
 
c
 = 
	`make_image
(
a
.
w
 + 
b
.w + 
dx
, (a.
h
 > b.h) ?‡.h : b.h, (a.c > b.c) ?‡.c : b.c);

126 
	`fl_ıu
(
c
.
w
*c.
h
*c.c, 1, c.
d©a
, 1);

127 
	`embed_image
(
a
, 
c
, 0, 0);

128 
	`compos™e_image
(
b
, 
c
, 
a
.
w
 + 
dx
, 0);

129  
c
;

130 
	}
}

132 
image
 
	$g‘_Ïb–
(
image
 **
ch¬aù”s
, *
¡ršg
, 
size
)

134 
size
 = size/10;

135 if(
size
 > 7) size = 7;

136 
image
 
Ïb–
 = 
	`make_em±y_image
(0,0,0);

137 *
¡ršg
){

138 
image
 
l
 = 
ch¬aù”s
[
size
][()*
¡ršg
];

139 
image
 
n
 = 
	`te_images
(
Ïb–
, 
l
, -
size
 - 1 + (size+1)/2);

140 
	`ä“_image
(
Ïb–
);

141 
Ïb–
 = 
n
;

142 ++
¡ršg
;

144 
image
 
b
 = 
	`bÜd”_image
(
Ïb–
,†ab–.
h
*.25);

145 
	`ä“_image
(
Ïb–
);

146  
b
;

147 
	}
}

149 
	$d¿w_Ïb–
(
image
 
a
, 
r
, 
c
, imag
Ïb–
, cÚ¡ *
rgb
)

151 
w
 = 
Ïb–
.w;

152 
h
 = 
Ïb–
.h;

153 ià(
r
 - 
h
 >= 0)„ =„ - h;

155 
i
, 
j
, 
k
;

156 
j
 = 0; j < 
h
 && j + 
r
 < 
a
.h; ++j){

157 
i
 = 0; i < 
w
 && i + 
c
 < 
a
.w; ++i){

158 
k
 = 0; k < 
Ïb–
.
c
; ++k){

159 
v®
 = 
	`g‘_pix–
(
Ïb–
, 
i
, 
j
, 
k
);

160 
	`£t_pix–
(
a
, 
i
+
c
, 
j
+
r
, 
k
, 
rgb
[k] * 
v®
);

164 
	}
}

166 
	$d¿w_box
(
image
 
a
, 
x1
, 
y1
, 
x2
, 
y2
, 
r
, 
g
, 
b
)

169 
i
;

170 if(
x1
 < 0) x1 = 0;

171 if(
x1
 >ğ
a
.
w
) x1 =‡.w-1;

172 if(
x2
 < 0) x2 = 0;

173 if(
x2
 >ğ
a
.
w
) x2 =‡.w-1;

175 if(
y1
 < 0) y1 = 0;

176 if(
y1
 >ğ
a
.
h
) y1 =‡.h-1;

177 if(
y2
 < 0) y2 = 0;

178 if(
y2
 >ğ
a
.
h
) y2 =‡.h-1;

180 
i
 = 
x1
; i <ğ
x2
; ++i){

181 
a
.
d©a
[
i
 + 
y1
*a.
w
 + 0*a.w*a.
h
] = 
r
;

182 
a
.
d©a
[
i
 + 
y2
*a.
w
 + 0*a.w*a.
h
] = 
r
;

184 
a
.
d©a
[
i
 + 
y1
*a.
w
 + 1*a.w*a.
h
] = 
g
;

185 
a
.
d©a
[
i
 + 
y2
*a.
w
 + 1*a.w*a.
h
] = 
g
;

187 
a
.
d©a
[
i
 + 
y1
*a.
w
 + 2*a.w*a.
h
] = 
b
;

188 
a
.
d©a
[
i
 + 
y2
*a.
w
 + 2*a.w*a.
h
] = 
b
;

190 
i
 = 
y1
; i <ğ
y2
; ++i){

191 
a
.
d©a
[
x1
 + 
i
*a.
w
 + 0*a.w*a.
h
] = 
r
;

192 
a
.
d©a
[
x2
 + 
i
*a.
w
 + 0*a.w*a.
h
] = 
r
;

194 
a
.
d©a
[
x1
 + 
i
*a.
w
 + 1*a.w*a.
h
] = 
g
;

195 
a
.
d©a
[
x2
 + 
i
*a.
w
 + 1*a.w*a.
h
] = 
g
;

197 
a
.
d©a
[
x1
 + 
i
*a.
w
 + 2*a.w*a.
h
] = 
b
;

198 
a
.
d©a
[
x2
 + 
i
*a.
w
 + 2*a.w*a.
h
] = 
b
;

200 
	}
}

202 
	$d¿w_box_width
(
image
 
a
, 
x1
, 
y1
, 
x2
, 
y2
, 
w
, 
r
, 
g
, 
b
)

204 
i
;

205 
i
 = 0; i < 
w
; ++i){

206 
	`d¿w_box
(
a
, 
x1
+
i
, 
y1
+i, 
x2
-i, 
y2
-i, 
r
, 
g
, 
b
);

208 
	}
}

210 
	$d¿w_bbox
(
image
 
a
, 
box
 
bbox
, 
w
, 
r
, 
g
, 
b
)

212 
Ëá
 = (
bbox
.
x
-bbox.
w
/2)*
a
.w;

213 
right
 = (
bbox
.
x
+bbox.
w
/2)*
a
.w;

214 
tİ
 = (
bbox
.
y
-bbox.
h
/2)*
a
.h;

215 
bÙ
 = (
bbox
.
y
+bbox.
h
/2)*
a
.h;

217 
i
;

218 
i
 = 0; i < 
w
; ++i){

219 
	`d¿w_box
(
a
, 
Ëá
+
i
, 
tİ
+i, 
right
-i, 
bÙ
-i, 
r
, 
g
, 
b
);

221 
	}
}

223 
image
 **
	$lßd_®phab‘
()

225 
i
, 
j
;

226 cÚ¡ 
nsize
 = 8;

227 
image
 **
®phab‘s
 = (imag**)
	`ÿÎoc
(
nsize
, (image));

228 
j
 = 0; j < 
nsize
; ++j){

229 
®phab‘s
[
j
] = (
image
 *)
	`ÿÎoc
(128, (image));

230 
i
 = 32; i < 127; ++i){

231 
buff
[256];

232 
	`¥rštf
(
buff
, "d©a/Ïb–s/%d_%d.²g", 
i
, 
j
);

233 
®phab‘s
[
j
][
i
] = 
	`lßd_image_cŞÜ
(
buff
, 0, 0);

236  
®phab‘s
;

237 
	}
}

239 
	$d¿w_d‘eùiÚs
(
image
 
im
, 
d‘eùiÚ
 *
d‘s
, 
num
, 
th»sh
, **
Çmes
, imag**
®phab‘
, 
şas£s
)

241 
i
,
j
;

243 
i
 = 0; i < 
num
; ++i){

244 
Ïb–¡r
[4096] = {0};

245 
şass_r
 = -1;

246 
j
 = 0; j < 
şas£s
; ++j){

247 ià(
d‘s
[
i
].
´ob
[
j
] > 
th»sh
){

248 ià(
şass_r
 < 0) {

249 
	`¡rÿt
(
Ïb–¡r
, 
Çmes
[
j
]);

250 
şass_r
 = 
j
;

252 
	`¡rÿt
(
Ïb–¡r
, ", ");

253 
	`¡rÿt
(
Ïb–¡r
, 
Çmes
[
j
]);

255 
	`´štf
("%s: %.0f%%\n", 
Çmes
[
j
], 
d‘s
[
i
].
´ob
[j]*100);

258 if(
şass_r
 >= 0){

259 
width
 = 
im
.
h
 * .006;

269 
off£t
 = 
şass_r
*123457 % 
şas£s
;

270 
»d
 = 
	`g‘_cŞÜ
(2,
off£t
,
şas£s
);

271 
g»’
 = 
	`g‘_cŞÜ
(1,
off£t
,
şas£s
);

272 
blue
 = 
	`g‘_cŞÜ
(0,
off£t
,
şas£s
);

273 
rgb
[3];

277 
rgb
[0] = 
»d
;

278 
rgb
[1] = 
g»’
;

279 
rgb
[2] = 
blue
;

280 
box
 
b
 = 
d‘s
[
i
].
bbox
;

283 
Ëá
 = (
b
.
x
-b.
w
/2.)*
im
.w;

284 
right
 = (
b
.
x
+b.
w
/2.)*
im
.w;

285 
tİ
 = (
b
.
y
-b.
h
/2.)*
im
.h;

286 
bÙ
 = (
b
.
y
+b.
h
/2.)*
im
.h;

288 if(
Ëá
 < 0)†eft = 0;

289 if(
right
 > 
im
.
w
-1)„ight = im.w-1;

290 if(
tİ
 < 0)op = 0;

291 if(
bÙ
 > 
im
.
h
-1) bot = im.h-1;

293 
	`d¿w_box_width
(
im
, 
Ëá
, 
tİ
, 
right
, 
bÙ
, 
width
, 
»d
, 
g»’
, 
blue
);

294 ià(
®phab‘
) {

295 
image
 
Ïb–
 = 
	`g‘_Ïb–
(
®phab‘
, 
Ïb–¡r
, (
im
.
h
*.03));

296 
	`d¿w_Ïb–
(
im
, 
tİ
 + 
width
, 
Ëá
, 
Ïb–
, 
rgb
);

297 
	`ä“_image
(
Ïb–
);

299 ià(
d‘s
[
i
].
mask
){

300 
image
 
mask
 = 
	`æßt_to_image
(14, 14, 1, 
d‘s
[
i
].mask);

301 
image
 
»sized_mask
 = 
	`»size_image
(
mask
, 
b
.
w
*
im
.w, b.
h
*im.h);

302 
image
 
tmask
 = 
	`th»shŞd_image
(
»sized_mask
, .5);

303 
	`embed_image
(
tmask
, 
im
, 
Ëá
, 
tİ
);

304 
	`ä“_image
(
mask
);

305 
	`ä“_image
(
»sized_mask
);

306 
	`ä“_image
(
tmask
);

310 
	}
}

312 
	$Œª¥o£_image
(
image
 
im
)

314 
	`as£¹
(
im
.
w
 =ğim.
h
);

315 
n
, 
m
;

316 
c
;

317 
c
 = 0; c < 
im
.c; ++c){

318 
n
 = 0;‚ < 
im
.
w
-1; ++n){

319 
m
 = 
n
 + 1; m < 
im
.
w
; ++m){

320 
sw­
 = 
im
.
d©a
[
m
 + im.
w
*(
n
 + im.
h
*
c
)];

321 
im
.
d©a
[
m
 + im.
w
*(
n
 + im.
h
*
c
)] = im.data[n + im.w*(m + im.h*c)];

322 
im
.
d©a
[
n
 + im.
w
*(
m
 + im.
h
*
c
)] = 
sw­
;

326 
	}
}

328 
	$rÙ©e_image_cw
(
image
 
im
, 
times
)

330 
	`as£¹
(
im
.
w
 =ğim.
h
);

331 
times
 = (times + 400) % 4;

332 
i
, 
x
, 
y
, 
c
;

333 
n
 = 
im
.
w
;

334 
i
 = 0; i < 
times
; ++i){

335 
c
 = 0; c < 
im
.c; ++c){

336 
x
 = 0; x < 
n
/2; ++x){

337 
y
 = 0; y < (
n
-1)/2 + 1; ++y){

338 
‹mp
 = 
im
.
d©a
[
y
 + im.
w
*(
x
 + im.
h
*
c
)];

339 
im
.
d©a
[
y
 + im.
w
*(
x
 + im.
h
*
c
)] = im.d©a[
n
-1-x + im.w*(y + im.h*c)];

340 
im
.
d©a
[
n
-1-
x
 + im.
w
*(
y
 + im.
h
*
c
)] = im.data[n-1-y + im.w*(n-1-x + im.h*c)];

341 
im
.
d©a
[
n
-1-
y
 + im.
w
*Ò-1-
x
 + im.
h
*
c
)] = im.data[x + im.w*(n-1-y + im.h*c)];

342 
im
.
d©a
[
x
 + im.
w
*(
n
-1-
y
 + im.
h
*
c
)] = 
‹mp
;

347 
	}
}

349 
	$æ_image
(
image
 
a
)

351 
i
,
j
,
k
;

352 
k
 = 0; k < 
a
.
c
; ++k){

353 
i
 = 0; i < 
a
.
h
; ++i){

354 
j
 = 0; j < 
a
.
w
/2; ++j){

355 
šdex
 = 
j
 + 
a
.
w
*(
i
 +‡.
h
*(
k
));

356 
æ
 = (
a
.
w
 - 
j
 - 1è+‡.w*(
i
 +‡.
h
*(
k
));

357 
sw­
 = 
a
.
d©a
[
æ
];

358 
a
.
d©a
[
æ
] =‡.d©a[
šdex
];

359 
a
.
d©a
[
šdex
] = 
sw­
;

363 
	}
}

365 
image
 
	$image_di¡ªû
(
image
 
a
, imag
b
)

367 
i
,
j
;

368 
image
 
di¡
 = 
	`make_image
(
a
.
w
,‡.
h
, 1);

369 
i
 = 0; i < 
a
.
c
; ++i){

370 
j
 = 0; j < 
a
.
h
*a.
w
; ++j){

371 
di¡
.
d©a
[
j
] +ğ
	`pow
(
a
.d©a[
i
*a.
h
*a.
w
+j]-
b
.data[i*a.h*a.w+j],2);

374 
j
 = 0; j < 
a
.
h
*a.
w
; ++j){

375 
di¡
.
d©a
[
j
] = 
	`sq¹
(dist.data[j]);

377  
di¡
;

378 
	}
}

380 
	$gho¡_image
(
image
 
sourû
, imag
de¡
, 
dx
, 
dy
)

382 
x
,
y
,
k
;

383 
max_di¡
 = 
	`sq¹
((-
sourû
.
w
/2. + .5)*(-source.w/2. + .5));

384 
k
 = 0; k < 
sourû
.
c
; ++k){

385 
y
 = 0; y < 
sourû
.
h
; ++y){

386 
x
 = 0; x < 
sourû
.
w
; ++x){

387 
di¡
 = 
	`sq¹
((
x
 - 
sourû
.
w
/2. + .5)*(x - sourû.w/2. + .5è+ (
y
 - sourû.
h
/2. + .5)*(y - source.h/2. + .5));

388 
®pha
 = (1 - 
di¡
/
max_di¡
);

389 if(
®pha
 < 0)‡lpha = 0;

390 
v1
 = 
	`g‘_pix–
(
sourû
, 
x
,
y
,
k
);

391 
v2
 = 
	`g‘_pix–
(
de¡
, 
dx
+
x
,
dy
+
y
,
k
);

392 
v®
 = 
®pha
*
v1
 + (1-®pha)*
v2
;

393 
	`£t_pix–
(
de¡
, 
dx
+
x
, 
dy
+
y
, 
k
, 
v®
);

397 
	}
}

399 
	$blocky_image
(
image
 
im
, 
s
)

401 
i
,
j
,
k
;

402 
k
 = 0; k < 
im
.
c
; ++k){

403 
j
 = 0; j < 
im
.
h
; ++j){

404 
i
 = 0; i < 
im
.
w
; ++i){

405 
im
.
d©a
[
i
 + im.
w
*(
j
 + im.
h
*
k
)] = im.d©a[i/
s
*s + im.w*(j/s*s + im.h*k)];

409 
	}
}

411 
	$ûnsÜ_image
(
image
 
im
, 
dx
, 
dy
, 
w
, 
h
)

413 
i
,
j
,
k
;

414 
s
 = 32;

415 if(
dx
 < 0) dx = 0;

416 if(
dy
 < 0) dy = 0;

418 
k
 = 0; k < 
im
.
c
; ++k){

419 
j
 = 
dy
; j < dy + 
h
 && j < 
im
.h; ++j){

420 
i
 = 
dx
; i < dx + 
w
 && i < 
im
.w; ++i){

421 
im
.
d©a
[
i
 + im.
w
*(
j
 + im.
h
*
k
)] = im.d©a[i/
s
*s + im.w*(j/s*s + im.h*k)];

426 
	}
}

428 
	$embed_image
(
image
 
sourû
, imag
de¡
, 
dx
, 
dy
)

430 
x
,
y
,
k
;

431 
k
 = 0; k < 
sourû
.
c
; ++k){

432 
y
 = 0; y < 
sourû
.
h
; ++y){

433 
x
 = 0; x < 
sourû
.
w
; ++x){

434 
v®
 = 
	`g‘_pix–
(
sourû
, 
x
,
y
,
k
);

435 
	`£t_pix–
(
de¡
, 
dx
+
x
, 
dy
+
y
, 
k
, 
v®
);

439 
	}
}

441 
image
 
	$cŞÏp£_image_Ïy”s
(
image
 
sourû
, 
bÜd”
)

443 
h
 = 
sourû
.h;

444 
h
 = (h+
bÜd”
)*
sourû
.
c
 - border;

445 
image
 
de¡
 = 
	`make_image
(
sourû
.
w
, 
h
, 1);

446 
i
;

447 
i
 = 0; i < 
sourû
.
c
; ++i){

448 
image
 
Ïy”
 = 
	`g‘_image_Ïy”
(
sourû
, 
i
);

449 
h_off£t
 = 
i
*(
sourû
.
h
+
bÜd”
);

450 
	`embed_image
(
Ïy”
, 
de¡
, 0, 
h_off£t
);

451 
	`ä“_image
(
Ïy”
);

453  
de¡
;

454 
	}
}

456 
	$cÚ¡¿š_image
(
image
 
im
)

458 
i
;

459 
i
 = 0; i < 
im
.
w
*im.
h
*im.
c
; ++i){

460 if(
im
.
d©a
[
i
] < 0) im.data[i] = 0;

461 if(
im
.
d©a
[
i
] > 1) im.data[i] = 1;

463 
	}
}

465 
	$nÜm®ize_image
(
image
 
p
)

467 
i
;

468 
mš
 = 9999999;

469 
max
 = -999999;

471 
i
 = 0; i < 
p
.
h
*p.
w
*p.
c
; ++i){

472 
v
 = 
p
.
d©a
[
i
];

473 if(
v
 < 
mš
) min = v;

474 if(
v
 > 
max
) max = v;

476 if(
max
 - 
mš
 < .000000001){

477 
mš
 = 0;

478 
max
 = 1;

480 
i
 = 0; i < 
p
.
c
*p.
w
*p.
h
; ++i){

481 
p
.
d©a
[
i
] = (p.d©a[i] - 
mš
)/(
max
-min);

483 
	}
}

485 
	$nÜm®ize_image2
(
image
 
p
)

487 *
mš
 = (*)
	`ÿÎoc
(
p
.
c
, ());

488 *
max
 = (*)
	`ÿÎoc
(
p
.
c
, ());

489 
i
,
j
;

490 
i
 = 0; i < 
p
.
c
; ++iè
mš
[i] = 
max
[i] =….
d©a
[i*p.
h
*p.
w
];

492 
j
 = 0; j < 
p
.
c
; ++j){

493 
i
 = 0; i < 
p
.
h
*p.
w
; ++i){

494 
v
 = 
p
.
d©a
[
i
+
j
*p.
h
*p.
w
];

495 if(
v
 < 
mš
[
j
]) min[j] = v;

496 if(
v
 > 
max
[
j
]) max[j] = v;

499 
i
 = 0; i < 
p
.
c
; ++i){

500 if(
max
[
i
] - 
mš
[i] < .000000001){

501 
mš
[
i
] = 0;

502 
max
[
i
] = 1;

505 
j
 = 0; j < 
p
.
c
; ++j){

506 
i
 = 0; i < 
p
.
w
*p.
h
; ++i){

507 
p
.
d©a
[
i
+
j
*p.
h
*p.
w
] = (p.d©a[i+j*p.h*p.w] - 
mš
[j])/(
max
[j]-min[j]);

510 
	`ä“
(
mš
);

511 
	`ä“
(
max
);

512 
	}
}

514 
	$cİy_image_što
(
image
 
¤c
, imag
de¡
)

516 
	`memıy
(
de¡
.
d©a
, 
¤c
.d©a, src.
h
*¤c.
w
*¤c.
c
*());

517 
	}
}

519 
image
 
	$cİy_image
(
image
 
p
)

521 
image
 
cİy
 = 
p
;

522 
cİy
.
d©a
 = (*)
	`ÿÎoc
(
p
.
h
*p.
w
*p.
c
, ());

523 
	`memıy
(
cİy
.
d©a
, 
p
.d©a,….
h
*p.
w
*p.
c
*());

524  
cİy
;

525 
	}
}

527 
	$rgbgr_image
(
image
 
im
)

529 
i
;

530 
i
 = 0; i < 
im
.
w
*im.
h
; ++i){

531 
sw­
 = 
im
.
d©a
[
i
];

532 
im
.
d©a
[
i
] = im.d©a[i+im.
w
*im.
h
*2];

533 
im
.
d©a
[
i
+im.
w
*im.
h
*2] = 
sw­
;

535 
	}
}

537 
	$show_image
(
image
 
p
, cÚ¡ *
Çme
, 
ms
)

539 #ifdeà
OPENCV


540 
c
 = 
	`show_image_cv
(
p
, 
Çme
, 
ms
);

541  
c
;

543 
	`årštf
(
¡d”r
, "NÙ comped w™h O³nCV, savšgØ%s.²g in¡—d\n", 
Çme
);

544 
	`§ve_image
(
p
, 
Çme
);

547 
	}
}

549 
	$§ve_image_İtiÚs
(
image
 
im
, cÚ¡ *
Çme
, 
IMTYPE
 
f
, 
qu®™y
)

551 
buff
[256];

553 if(
f
 =ğ
PNG
è
	`¥rštf
(
buff
, "%s.²g", 
Çme
);

554 ià(
f
 =ğ
BMP
è
	`¥rštf
(
buff
, "%s.bmp", 
Çme
);

555 ià(
f
 =ğ
TGA
è
	`¥rštf
(
buff
, "%s.tga", 
Çme
);

556 ià(
f
 =ğ
JPG
è
	`¥rštf
(
buff
, "%s.jpg", 
Çme
);

557 
	`¥rštf
(
buff
, "%s.²g", 
Çme
);

558 *
d©a
 = (*)
	`ÿÎoc
(
im
.
w
*im.
h
*im.
c
, ());

559 
i
,
k
;

560 
k
 = 0; k < 
im
.
c
; ++k){

561 
i
 = 0; i < 
im
.
w
*im.
h
; ++i){

562 
d©a
[
i
*
im
.
c
+
k
] = (è(255*im.d©a[˜+ k*im.
w
*im.
h
]);

565 
sucûss
 = 0;

566 if(
f
 =ğ
PNG
è
sucûss
 = 
	`¡bi_wr™e_²g
(
buff
, 
im
.
w
, im.
h
, im.
c
, 
d©a
, im.w*im.c);

567 ià(
f
 =ğ
BMP
è
sucûss
 = 
	`¡bi_wr™e_bmp
(
buff
, 
im
.
w
, im.
h
, im.
c
, 
d©a
);

568 ià(
f
 =ğ
TGA
è
sucûss
 = 
	`¡bi_wr™e_tga
(
buff
, 
im
.
w
, im.
h
, im.
c
, 
d©a
);

569 ià(
f
 =ğ
JPG
è
sucûss
 = 
	`¡bi_wr™e_jpg
(
buff
, 
im
.
w
, im.
h
, im.
c
, 
d©a
, 
qu®™y
);

570 
	`ä“
(
d©a
);

571 if(!
sucûss
è
	`årštf
(
¡d”r
, "FaedØwr™imag%s\n", 
buff
);

572 
	}
}

574 
	$§ve_image
(
image
 
im
, cÚ¡ *
Çme
)

576 
	`§ve_image_İtiÚs
(
im
, 
Çme
, 
JPG
, 80);

577 
	}
}

579 
	$show_image_Ïy”s
(
image
 
p
, *
Çme
)

581 
i
;

582 
buff
[256];

583 
i
 = 0; i < 
p
.
c
; ++i){

584 
	`¥rštf
(
buff
, "% - Lay” %d", 
Çme
, 
i
);

585 
image
 
Ïy”
 = 
	`g‘_image_Ïy”
(
p
, 
i
);

586 
	`show_image
(
Ïy”
, 
buff
, 1);

587 
	`ä“_image
(
Ïy”
);

589 
	}
}

591 
	$show_image_cŞÏp£d
(
image
 
p
, *
Çme
)

593 
image
 
c
 = 
	`cŞÏp£_image_Ïy”s
(
p
, 1);

594 
	`show_image
(
c
, 
Çme
, 1);

595 
	`ä“_image
(
c
);

596 
	}
}

598 
image
 
	$make_em±y_image
(
w
, 
h
, 
c
)

600 
image
 
out
;

601 
out
.
d©a
 = 0;

602 
out
.
h
 = h;

603 
out
.
w
 = w;

604 
out
.
c
 = c;

605  
out
;

606 
	}
}

608 
image
 
	$make_image
(
w
, 
h
, 
c
)

610 
image
 
out
 = 
	`make_em±y_image
(
w
,
h
,
c
);

611 
out
.
d©a
 = (*)
	`ÿÎoc
(
h
*
w
*
c
, ());

612  
out
;

613 
	}
}

615 
image
 
	$make_¿ndom_image
(
w
, 
h
, 
c
)

617 
image
 
out
 = 
	`make_em±y_image
(
w
,
h
,
c
);

618 
out
.
d©a
 = (*)
	`ÿÎoc
(
h
*
w
*
c
, ());

619 
i
;

620 
i
 = 0; i < 
w
*
h
*
c
; ++i){

621 
out
.
d©a
[
i
] = (
	`¿nd_nÜm®
() * .25) + .5;

623  
out
;

624 
	}
}

626 
image
 
	$æßt_to_image
(
w
, 
h
, 
c
, *
d©a
)

628 
image
 
out
 = 
	`make_em±y_image
(
w
,
h
,
c
);

629 
out
.
d©a
 = data;

630  
out
;

631 
	}
}

633 
	$¶aû_image
(
image
 
im
, 
w
, 
h
, 
dx
, 
dy
, imag
ÿnvas
)

635 
x
, 
y
, 
c
;

636 
c
 = 0; c < 
im
.c; ++c){

637 
y
 = 0; y < 
h
; ++y){

638 
x
 = 0; x < 
w
; ++x){

639 
rx
 = (()
x
 / 
w
è* 
im
.w;

640 
ry
 = (()
y
 / 
h
è* 
im
.h;

641 
v®
 = 
	`bš—r_š‹½Ş©e
(
im
, 
rx
, 
ry
, 
c
);

642 
	`£t_pix–
(
ÿnvas
, 
x
 + 
dx
, 
y
 + 
dy
, 
c
, 
v®
);

646 
	}
}

648 
image
 
	$ûÁ”_üİ_image
(
image
 
im
, 
w
, 
h
)

650 
m
 = (
im
.
w
 < im.
h
) ? im.w : im.h;

651 
image
 
c
 = 
	`üİ_image
(
im
, (im.
w
 - 
m
è/ 2, (im.
h
 - m)/2, m, m);

652 
image
 
r
 = 
	`»size_image
(
c
, 
w
, 
h
);

653 
	`ä“_image
(
c
);

654  
r
;

655 
	}
}

657 
image
 
	$rÙ©e_üİ_image
(
image
 
im
, 
¿d
, 
s
, 
w
, 
h
, 
dx
, 
dy
, 
a¥eù
)

659 
x
, 
y
, 
c
;

660 
cx
 = 
im
.
w
/2.;

661 
cy
 = 
im
.
h
/2.;

662 
image
 
rÙ
 = 
	`make_image
(
w
, 
h
, 
im
.
c
);

663 
c
 = 0; c < 
im
.c; ++c){

664 
y
 = 0; y < 
h
; ++y){

665 
x
 = 0; x < 
w
; ++x){

666 
rx
 = 
	`cos
(
¿d
)*((
x
 - 
w
/2.)/
s
*
a¥eù
 + 
dx
/s*a¥eùè- 
	`sš
Ôad)*((
y
 - 
h
/2.)/ + 
dy
/sè+ 
cx
;

667 
ry
 = 
	`sš
(
¿d
)*((
x
 - 
w
/2.)/
s
*
a¥eù
 + 
dx
/s*a¥eùè+ 
	`cos
Ôad)*((
y
 - 
h
/2.)/ + 
dy
/sè+ 
cy
;

668 
v®
 = 
	`bš—r_š‹½Ş©e
(
im
, 
rx
, 
ry
, 
c
);

669 
	`£t_pix–
(
rÙ
, 
x
, 
y
, 
c
, 
v®
);

673  
rÙ
;

674 
	}
}

676 
image
 
	$rÙ©e_image
(
image
 
im
, 
¿d
)

678 
x
, 
y
, 
c
;

679 
cx
 = 
im
.
w
/2.;

680 
cy
 = 
im
.
h
/2.;

681 
image
 
rÙ
 = 
	`make_image
(
im
.
w
, im.
h
, im.
c
);

682 
c
 = 0; c < 
im
.c; ++c){

683 
y
 = 0; y < 
im
.
h
; ++y){

684 
x
 = 0; x < 
im
.
w
; ++x){

685 
rx
 = 
	`cos
(
¿d
)*(
x
-
cx
è- 
	`sš
Ôad)*(
y
-
cy
) + cx;

686 
ry
 = 
	`sš
(
¿d
)*(
x
-
cx
è+ 
	`cos
Ôad)*(
y
-
cy
) + cy;

687 
v®
 = 
	`bš—r_š‹½Ş©e
(
im
, 
rx
, 
ry
, 
c
);

688 
	`£t_pix–
(
rÙ
, 
x
, 
y
, 
c
, 
v®
);

692  
rÙ
;

693 
	}
}

695 
	$fl_image
(
image
 
m
, 
s
)

697 
i
;

698 
i
 = 0; i < 
m
.
h
*m.
w
*m.
c
; ++ièm.
d©a
[i] = 
s
;

699 
	}
}

701 
	$Œª¦©e_image
(
image
 
m
, 
s
)

703 
i
;

704 
i
 = 0; i < 
m
.
h
*m.
w
*m.
c
; ++ièm.
d©a
[i] +ğ
s
;

705 
	}
}

707 
	$sÿË_image
(
image
 
m
, 
s
)

709 
i
;

710 
i
 = 0; i < 
m
.
h
*m.
w
*m.
c
; ++ièm.
d©a
[i] *ğ
s
;

711 
	}
}

713 
image
 
	$üİ_image
(
image
 
im
, 
dx
, 
dy
, 
w
, 
h
)

715 
image
 
üİ³d
 = 
	`make_image
(
w
, 
h
, 
im
.
c
);

716 
i
, 
j
, 
k
;

717 
k
 = 0; k < 
im
.
c
; ++k){

718 
j
 = 0; j < 
h
; ++j){

719 
i
 = 0; i < 
w
; ++i){

720 
r
 = 
j
 + 
dy
;

721 
c
 = 
i
 + 
dx
;

722 
v®
 = 0;

723 
r
 = 
	`cÚ¡¿š_št
Ô, 0, 
im
.
h
-1);

724 
c
 = 
	`cÚ¡¿š_št
(c, 0, 
im
.
w
-1);

725 
v®
 = 
	`g‘_pix–
(
im
, 
c
, 
r
, 
k
);

726 
	`£t_pix–
(
üİ³d
, 
i
, 
j
, 
k
, 
v®
);

730  
üİ³d
;

731 
	}
}

733 
	$be¡_3d_shiá_r
(
image
 
a
, imag
b
, 
mš
, 
max
)

735 if(
mš
 =ğ
max
)  min;

736 
mid
 = 
	`æoÜ
((
mš
 + 
max
) / 2.);

737 
image
 
c1
 = 
	`üİ_image
(
b
, 0, 
mid
, b.
w
, b.
h
);

738 
image
 
c2
 = 
	`üİ_image
(
b
, 0, 
mid
+1, b.
w
, b.
h
);

739 
d1
 = 
	`di¡_¬¿y
(
c1
.
d©a
, 
a
.d©a,‡.
w
*a.
h
*a.
c
, 10);

740 
d2
 = 
	`di¡_¬¿y
(
c2
.
d©a
, 
a
.d©a,‡.
w
*a.
h
*a.
c
, 10);

741 
	`ä“_image
(
c1
);

742 
	`ä“_image
(
c2
);

743 if(
d1
 < 
d2
è 
	`be¡_3d_shiá_r
(
a
, 
b
, 
mš
, 
mid
);

744  
	`be¡_3d_shiá_r
(
a
, 
b
, 
mid
+1, 
max
);

745 
	}
}

747 
	$be¡_3d_shiá
(
image
 
a
, imag
b
, 
mš
, 
max
)

749 
i
;

750 
be¡
 = 0;

751 
be¡_di¡ªû
 = 
FLT_MAX
;

752 
i
 = 
mš
; i <ğ
max
; i += 2){

753 
image
 
c
 = 
	`üİ_image
(
b
, 0, 
i
, b.
w
, b.
h
);

754 
d
 = 
	`di¡_¬¿y
(
c
.
d©a
, 
a
.d©a,‡.
w
*a.
h
*a.c, 100);

755 if(
d
 < 
be¡_di¡ªû
){

756 
be¡_di¡ªû
 = 
d
;

757 
be¡
 = 
i
;

759 
	`´štf
("%d %f\n", 
i
, 
d
);

760 
	`ä“_image
(
c
);

762  
be¡
;

763 
	}
}

765 
	$compos™e_3d
(*
f1
, *
f2
, *
out
, 
d–
)

767 if(!
out
) out = (*)"out";

768 
image
 
a
 = 
	`lßd_image
(
f1
, 0,0,0);

769 
image
 
b
 = 
	`lßd_image
(
f2
, 0,0,0);

770 
shiá
 = 
	`be¡_3d_shiá_r
(
a
, 
b
, -a.
h
/100,‡.h/100);

772 
image
 
c1
 = 
	`üİ_image
(
b
, 10, 
shiá
, b.
w
, b.
h
);

773 
d1
 = 
	`di¡_¬¿y
(
c1
.
d©a
, 
a
.d©a,‡.
w
*a.
h
*a.
c
, 100);

774 
image
 
c2
 = 
	`üİ_image
(
b
, -10, 
shiá
, b.
w
, b.
h
);

775 
d2
 = 
	`di¡_¬¿y
(
c2
.
d©a
, 
a
.d©a,‡.
w
*a.
h
*a.
c
, 100);

777 if(
d2
 < 
d1
 && 0){

778 
image
 
sw­
 = 
a
;

779 
a
 = 
b
;

780 
b
 = 
sw­
;

781 
shiá
 = -shift;

782 
	`´štf
("sw­³d, %d\n", 
shiá
);

785 
	`´štf
("%d\n", 
shiá
);

788 
image
 
c
 = 
	`üİ_image
(
b
, 
d–
, 
shiá
, 
a
.
w
,‡.
h
);

789 
i
;

790 
i
 = 0; i < 
c
.
w
*c.
h
; ++i){

791 
c
.
d©a
[
i
] = 
a
.data[i];

793 
	`§ve_image
(
c
, 
out
);

794 
	}
}

796 
	$Ë‰”box_image_što
(
image
 
im
, 
w
, 
h
, imag
boxed
)

798 
Ãw_w
 = 
im
.
w
;

799 
Ãw_h
 = 
im
.
h
;

800 ià((()
w
/
im
.wè< (()
h
/im.h)) {

801 
Ãw_w
 = 
w
;

802 
Ãw_h
 = (
im
.
h
 * 
w
)/im.w;

804 
Ãw_h
 = 
h
;

805 
Ãw_w
 = (
im
.
w
 * 
h
)/im.h;

807 
image
 
»sized
 = 
	`»size_image
(
im
, 
Ãw_w
, 
Ãw_h
);

808 
	`embed_image
(
»sized
, 
boxed
, (
w
-
Ãw_w
)/2, (
h
-
Ãw_h
)/2);

809 
	`ä“_image
(
»sized
);

810 
	}
}

812 
image
 
	$Ë‰”box_image
(
image
 
im
, 
w
, 
h
)

814 
Ãw_w
 = 
im
.
w
;

815 
Ãw_h
 = 
im
.
h
;

816 ià((()
w
/
im
.wè< (()
h
/im.h)) {

817 
Ãw_w
 = 
w
;

818 
Ãw_h
 = (
im
.
h
 * 
w
)/im.w;

820 
Ãw_h
 = 
h
;

821 
Ãw_w
 = (
im
.
w
 * 
h
)/im.h;

823 
image
 
»sized
 = 
	`»size_image
(
im
, 
Ãw_w
, 
Ãw_h
);

824 
image
 
boxed
 = 
	`make_image
(
w
, 
h
, 
im
.
c
);

825 
	`fl_image
(
boxed
, .5);

828 
	`embed_image
(
»sized
, 
boxed
, (
w
-
Ãw_w
)/2, (
h
-
Ãw_h
)/2);

829 
	`ä“_image
(
»sized
);

830  
boxed
;

831 
	}
}

833 
image
 
	$»size_max
(
image
 
im
, 
max
)

835 
w
 = 
im
.w;

836 
h
 = 
im
.h;

837 if(
w
 > 
h
){

838 
h
 = (h * 
max
è/ 
w
;

839 
w
 = 
max
;

841 
w
 = (w * 
max
è/ 
h
;

842 
h
 = 
max
;

844 if(
w
 =ğ
im
.w && 
h
 == im.h)  im;

845 
image
 
»sized
 = 
	`»size_image
(
im
, 
w
, 
h
);

846  
»sized
;

847 
	}
}

849 
image
 
	$»size_mš
(
image
 
im
, 
mš
)

851 
w
 = 
im
.w;

852 
h
 = 
im
.h;

853 if(
w
 < 
h
){

854 
h
 = (h * 
mš
è/ 
w
;

855 
w
 = 
mš
;

857 
w
 = (w * 
mš
è/ 
h
;

858 
h
 = 
mš
;

860 if(
w
 =ğ
im
.w && 
h
 == im.h)  im;

861 
image
 
»sized
 = 
	`»size_image
(
im
, 
w
, 
h
);

862  
»sized
;

863 
	}
}

865 
image
 
	$¿ndom_üİ_image
(
image
 
im
, 
w
, 
h
)

867 
dx
 = 
	`¿nd_št
(0, 
im
.
w
 - w);

868 
dy
 = 
	`¿nd_št
(0, 
im
.
h
 - h);

869 
image
 
üİ
 = 
	`üİ_image
(
im
, 
dx
, 
dy
, 
w
, 
h
);

870  
üİ
;

871 
	}
}

873 
augm’t_¬gs
 
	$¿ndom_augm’t_¬gs
(
image
 
im
, 
ªgË
, 
a¥eù
, 
low
, 
high
, 
w
, 
h
)

875 
augm’t_¬gs
 
a
 = {0};

876 
a¥eù
 = 
	`¿nd_sÿË
(aspect);

877 
r
 = 
	`¿nd_št
(
low
, 
high
);

878 
mš
 = (
im
.
h
 < im.
w
*
a¥eù
) ? im.h : im.w*aspect;

879 
sÿË
 = ()
r
 / 
mš
;

881 
¿d
 = 
	`¿nd_unifÜm
(-
ªgË
,‡ngËè* 
TWO_PI
 / 360.;

883 
dx
 = (
im
.
w
*
sÿË
/
a¥eù
 - w) / 2.;

884 
dy
 = (
im
.
h
*
sÿË
 - 
w
) / 2.;

887 
dx
 = 
	`¿nd_unifÜm
(-dx, dx);

888 
dy
 = 
	`¿nd_unifÜm
(-dy, dy);

890 
a
.
¿d
 =„ad;

891 
a
.
sÿË
 = scale;

892 
a
.
w
 = w;

893 
a
.
h
 = h;

894 
a
.
dx
 = dx;

895 
a
.
dy
 = dy;

896 
a
.
a¥eù
 =‡spect;

897  
a
;

898 
	}
}

900 
image
 
	$¿ndom_augm’t_image
(
image
 
im
, 
ªgË
, 
a¥eù
, 
low
, 
high
, 
w
, 
h
)

902 
augm’t_¬gs
 
a
 = 
	`¿ndom_augm’t_¬gs
(
im
, 
ªgË
, 
a¥eù
, 
low
, 
high
, 
w
, 
h
);

903 
image
 
üİ
 = 
	`rÙ©e_üİ_image
(
im
, 
a
.
¿d
,‡.
sÿË
,‡.
w
,‡.
h
,‡.
dx
,‡.
dy
,‡.
a¥eù
);

904  
üİ
;

905 
	}
}

907 
	$th»e_way_max
(
a
, 
b
, 
c
)

909  (
a
 > 
b
è? ( (¨> 
c
) ?‡ : c) : ( (b > c) ? b : c) ;

910 
	}
}

912 
	$th»e_way_mš
(
a
, 
b
, 
c
)

914  (
a
 < 
b
è? ( (¨< 
c
) ?‡ : c) : ( (b < c) ? b : c) ;

915 
	}
}

917 
	$yuv_to_rgb
(
image
 
im
)

919 
	`as£¹
(
im
.
c
 == 3);

920 
i
, 
j
;

921 
r
, 
g
, 
b
;

922 
y
, 
u
, 
v
;

923 
j
 = 0; j < 
im
.
h
; ++j){

924 
i
 = 0; i < 
im
.
w
; ++i){

925 
y
 = 
	`g‘_pix–
(
im
, 
i
 , 
j
, 0);

926 
u
 = 
	`g‘_pix–
(
im
, 
i
 , 
j
, 1);

927 
v
 = 
	`g‘_pix–
(
im
, 
i
 , 
j
, 2);

929 
r
 = 
y
 + 1.13983*
v
;

930 
g
 = 
y
 + -.39465*
u
 + -.58060*
v
;

931 
b
 = 
y
 + 2.03211*
u
;

933 
	`£t_pix–
(
im
, 
i
, 
j
, 0, 
r
);

934 
	`£t_pix–
(
im
, 
i
, 
j
, 1, 
g
);

935 
	`£t_pix–
(
im
, 
i
, 
j
, 2, 
b
);

938 
	}
}

940 
	$rgb_to_yuv
(
image
 
im
)

942 
	`as£¹
(
im
.
c
 == 3);

943 
i
, 
j
;

944 
r
, 
g
, 
b
;

945 
y
, 
u
, 
v
;

946 
j
 = 0; j < 
im
.
h
; ++j){

947 
i
 = 0; i < 
im
.
w
; ++i){

948 
r
 = 
	`g‘_pix–
(
im
, 
i
 , 
j
, 0);

949 
g
 = 
	`g‘_pix–
(
im
, 
i
 , 
j
, 1);

950 
b
 = 
	`g‘_pix–
(
im
, 
i
 , 
j
, 2);

952 
y
 = .299*
r
 + .587*
g
 + .114*
b
;

953 
u
 = -.14713*
r
 + -.28886*
g
 + .436*
b
;

954 
v
 = .615*
r
 + -.51499*
g
 + -.10001*
b
;

956 
	`£t_pix–
(
im
, 
i
, 
j
, 0, 
y
);

957 
	`£t_pix–
(
im
, 
i
, 
j
, 1, 
u
);

958 
	`£t_pix–
(
im
, 
i
, 
j
, 2, 
v
);

961 
	}
}

964 
	$rgb_to_hsv
(
image
 
im
)

966 
	`as£¹
(
im
.
c
 == 3);

967 
i
, 
j
;

968 
r
, 
g
, 
b
;

969 
h
, 
s
, 
v
;

970 
j
 = 0; j < 
im
.
h
; ++j){

971 
i
 = 0; i < 
im
.
w
; ++i){

972 
r
 = 
	`g‘_pix–
(
im
, 
i
 , 
j
, 0);

973 
g
 = 
	`g‘_pix–
(
im
, 
i
 , 
j
, 1);

974 
b
 = 
	`g‘_pix–
(
im
, 
i
 , 
j
, 2);

975 
max
 = 
	`th»e_way_max
(
r
,
g
,
b
);

976 
mš
 = 
	`th»e_way_mš
(
r
,
g
,
b
);

977 
d–
 = 
max
 - 
mš
;

978 
v
 = 
max
;

979 if(
max
 == 0){

980 
s
 = 0;

981 
h
 = 0;

983 
s
 = 
d–
/
max
;

984 if(
r
 =ğ
max
){

985 
h
 = (
g
 - 
b
è/ 
d–
;

986 } ià(
g
 =ğ
max
) {

987 
h
 = 2 + (
b
 - 
r
è/ 
d–
;

989 
h
 = 4 + (
r
 - 
g
è/ 
d–
;

991 ià(
h
 < 0) h += 6;

992 
h
 = h/6.;

994 
	`£t_pix–
(
im
, 
i
, 
j
, 0, 
h
);

995 
	`£t_pix–
(
im
, 
i
, 
j
, 1, 
s
);

996 
	`£t_pix–
(
im
, 
i
, 
j
, 2, 
v
);

999 
	}
}

1001 
	$hsv_to_rgb
(
image
 
im
)

1003 
	`as£¹
(
im
.
c
 == 3);

1004 
i
, 
j
;

1005 
r
, 
g
, 
b
;

1006 
h
, 
s
, 
v
;

1007 
f
, 
p
, 
q
, 
t
;

1008 
j
 = 0; j < 
im
.
h
; ++j){

1009 
i
 = 0; i < 
im
.
w
; ++i){

1010 
h
 = 6 * 
	`g‘_pix–
(
im
, 
i
 , 
j
, 0);

1011 
s
 = 
	`g‘_pix–
(
im
, 
i
 , 
j
, 1);

1012 
v
 = 
	`g‘_pix–
(
im
, 
i
 , 
j
, 2);

1013 ià(
s
 == 0) {

1014 
r
 = 
g
 = 
b
 = 
v
;

1016 
šdex
 = 
	`æoÜ
(
h
);

1017 
f
 = 
h
 - 
šdex
;

1018 
p
 = 
v
*(1-
s
);

1019 
q
 = 
v
*(1-
s
*
f
);

1020 
t
 = 
v
*(1-
s
*(1-
f
));

1021 if(
šdex
 == 0){

1022 
r
 = 
v
; 
g
 = 
t
; 
b
 = 
p
;

1023 } if(
šdex
 == 1){

1024 
r
 = 
q
; 
g
 = 
v
; 
b
 = 
p
;

1025 } if(
šdex
 == 2){

1026 
r
 = 
p
; 
g
 = 
v
; 
b
 = 
t
;

1027 } if(
šdex
 == 3){

1028 
r
 = 
p
; 
g
 = 
q
; 
b
 = 
v
;

1029 } if(
šdex
 == 4){

1030 
r
 = 
t
; 
g
 = 
p
; 
b
 = 
v
;

1032 
r
 = 
v
; 
g
 = 
p
; 
b
 = 
q
;

1035 
	`£t_pix–
(
im
, 
i
, 
j
, 0, 
r
);

1036 
	`£t_pix–
(
im
, 
i
, 
j
, 1, 
g
);

1037 
	`£t_pix–
(
im
, 
i
, 
j
, 2, 
b
);

1040 
	}
}

1042 
	$g¿ysÿË_image_3c
(
image
 
im
)

1044 
	`as£¹
(
im
.
c
 == 3);

1045 
i
, 
j
, 
k
;

1046 
sÿË
[] = {0.299, 0.587, 0.114};

1047 
j
 = 0; j < 
im
.
h
; ++j){

1048 
i
 = 0; i < 
im
.
w
; ++i){

1049 
v®
 = 0;

1050 
k
 = 0; k < 3; ++k){

1051 
v®
 +ğ
sÿË
[
k
]*
	`g‘_pix–
(
im
, 
i
, 
j
, k);

1053 
im
.
d©a
[0*im.
h
*im.
w
 + im.w*
j
 + 
i
] = 
v®
;

1054 
im
.
d©a
[1*im.
h
*im.
w
 + im.w*
j
 + 
i
] = 
v®
;

1055 
im
.
d©a
[2*im.
h
*im.
w
 + im.w*
j
 + 
i
] = 
v®
;

1058 
	}
}

1060 
image
 
	$g¿ysÿË_image
(
image
 
im
)

1062 
	`as£¹
(
im
.
c
 == 3);

1063 
i
, 
j
, 
k
;

1064 
image
 
g¿y
 = 
	`make_image
(
im
.
w
, im.
h
, 1);

1065 
sÿË
[] = {0.299, 0.587, 0.114};

1066 
k
 = 0; k < 
im
.
c
; ++k){

1067 
j
 = 0; j < 
im
.
h
; ++j){

1068 
i
 = 0; i < 
im
.
w
; ++i){

1069 
g¿y
.
d©a
[
i
+
im
.
w
*
j
] +ğ
sÿË
[
k
]*
	`g‘_pix–
(im, i, j, k);

1073  
g¿y
;

1074 
	}
}

1076 
image
 
	$th»shŞd_image
(
image
 
im
, 
th»sh
)

1078 
i
;

1079 
image
 
t
 = 
	`make_image
(
im
.
w
, im.
h
, im.
c
);

1080 
i
 = 0; i < 
im
.
w
*im.
h
*im.
c
; ++i){

1081 
t
.
d©a
[
i
] = 
im
.d©a[i]>
th»sh
 ? 1 : 0;

1083  
t
;

1084 
	}
}

1086 
image
 
	$bËnd_image
(
image
 
fÜe
, imag
back
, 
®pha
)

1088 
	`as£¹
(
fÜe
.
w
 =ğ
back
.w && fÜe.
h
 =ğback.h && fÜe.
c
 == back.c);

1089 
image
 
bËnd
 = 
	`make_image
(
fÜe
.
w
, fÜe.
h
, fÜe.
c
);

1090 
i
, 
j
, 
k
;

1091 
k
 = 0; k < 
fÜe
.
c
; ++k){

1092 
j
 = 0; j < 
fÜe
.
h
; ++j){

1093 
i
 = 0; i < 
fÜe
.
w
; ++i){

1094 
v®
 = 
®pha
 * 
	`g‘_pix–
(
fÜe
, 
i
, 
j
, 
k
) +

1095 (1 - 
®pha
)* 
	`g‘_pix–
(
back
, 
i
, 
j
, 
k
);

1096 
	`£t_pix–
(
bËnd
, 
i
, 
j
, 
k
, 
v®
);

1100  
bËnd
;

1101 
	}
}

1103 
	$sÿË_image_chªÃl
(
image
 
im
, 
c
, 
v
)

1105 
i
, 
j
;

1106 
j
 = 0; j < 
im
.
h
; ++j){

1107 
i
 = 0; i < 
im
.
w
; ++i){

1108 
pix
 = 
	`g‘_pix–
(
im
, 
i
, 
j
, 
c
);

1109 
pix
 =…ix*
v
;

1110 
	`£t_pix–
(
im
, 
i
, 
j
, 
c
, 
pix
);

1113 
	}
}

1115 
	$Œª¦©e_image_chªÃl
(
image
 
im
, 
c
, 
v
)

1117 
i
, 
j
;

1118 
j
 = 0; j < 
im
.
h
; ++j){

1119 
i
 = 0; i < 
im
.
w
; ++i){

1120 
pix
 = 
	`g‘_pix–
(
im
, 
i
, 
j
, 
c
);

1121 
pix
 =…ix+
v
;

1122 
	`£t_pix–
(
im
, 
i
, 
j
, 
c
, 
pix
);

1125 
	}
}

1127 
image
 
	$bš¬ize_image
(
image
 
im
)

1129 
image
 
c
 = 
	`cİy_image
(
im
);

1130 
i
;

1131 
i
 = 0; i < 
im
.
w
 * im.
h
 * im.
c
; ++i){

1132 if(
c
.
d©a
[
i
] > .5) c.data[i] = 1;

1133 
c
.
d©a
[
i
] = 0;

1135  
c
;

1136 
	}
}

1138 
	$§tu¿‹_image
(
image
 
im
, 
§t
)

1140 
	`rgb_to_hsv
(
im
);

1141 
	`sÿË_image_chªÃl
(
im
, 1, 
§t
);

1142 
	`hsv_to_rgb
(
im
);

1143 
	`cÚ¡¿š_image
(
im
);

1144 
	}
}

1146 
	$hue_image
(
image
 
im
, 
hue
)

1148 
	`rgb_to_hsv
(
im
);

1149 
i
;

1150 
i
 = 0; i < 
im
.
w
*im.
h
; ++i){

1151 
im
.
d©a
[
i
] = im.d©a[i] + 
hue
;

1152 ià(
im
.
d©a
[
i
] > 1) im.data[i] -= 1;

1153 ià(
im
.
d©a
[
i
] < 0) im.data[i] += 1;

1155 
	`hsv_to_rgb
(
im
);

1156 
	`cÚ¡¿š_image
(
im
);

1157 
	}
}

1159 
	$exposu»_image
(
image
 
im
, 
§t
)

1161 
	`rgb_to_hsv
(
im
);

1162 
	`sÿË_image_chªÃl
(
im
, 2, 
§t
);

1163 
	`hsv_to_rgb
(
im
);

1164 
	`cÚ¡¿š_image
(
im
);

1165 
	}
}

1167 
	$di¡Üt_image
(
image
 
im
, 
hue
, 
§t
, 
v®
)

1169 
	`rgb_to_hsv
(
im
);

1170 
	`sÿË_image_chªÃl
(
im
, 1, 
§t
);

1171 
	`sÿË_image_chªÃl
(
im
, 2, 
v®
);

1172 
i
;

1173 
i
 = 0; i < 
im
.
w
*im.
h
; ++i){

1174 
im
.
d©a
[
i
] = im.d©a[i] + 
hue
;

1175 ià(
im
.
d©a
[
i
] > 1) im.data[i] -= 1;

1176 ià(
im
.
d©a
[
i
] < 0) im.data[i] += 1;

1178 
	`hsv_to_rgb
(
im
);

1179 
	`cÚ¡¿š_image
(
im
);

1180 
	}
}

1182 
	$¿ndom_di¡Üt_image
(
image
 
im
, 
hue
, 
§tu¿tiÚ
, 
exposu»
)

1184 
dhue
 = 
	`¿nd_unifÜm
(-
hue
, hue);

1185 
d§t
 = 
	`¿nd_sÿË
(
§tu¿tiÚ
);

1186 
dexp
 = 
	`¿nd_sÿË
(
exposu»
);

1187 
	`di¡Üt_image
(
im
, 
dhue
, 
d§t
, 
dexp
);

1188 
	}
}

1190 
	$§tu¿‹_exposu»_image
(
image
 
im
, 
§t
, 
exposu»
)

1192 
	`rgb_to_hsv
(
im
);

1193 
	`sÿË_image_chªÃl
(
im
, 1, 
§t
);

1194 
	`sÿË_image_chªÃl
(
im
, 2, 
exposu»
);

1195 
	`hsv_to_rgb
(
im
);

1196 
	`cÚ¡¿š_image
(
im
);

1197 
	}
}

1199 
image
 
	$»size_image
(
image
 
im
, 
w
, 
h
)

1201 
image
 
»sized
 = 
	`make_image
(
w
, 
h
, 
im
.
c
);

1202 
image
 
·¹
 = 
	`make_image
(
w
, 
im
.
h
, im.
c
);

1203 
r
, 
c
, 
k
;

1204 
w_sÿË
 = ()(
im
.
w
 - 1) / (w - 1);

1205 
h_sÿË
 = ()(
im
.
h
 - 1) / (h - 1);

1206 
k
 = 0; k < 
im
.
c
; ++k){

1207 
r
 = 0;„ < 
im
.
h
; ++r){

1208 
c
 = 0; c < 
w
; ++c){

1209 
v®
 = 0;

1210 if(
c
 =ğ
w
-1 || 
im
.w == 1){

1211 
v®
 = 
	`g‘_pix–
(
im
, im.
w
-1, 
r
, 
k
);

1213 
sx
 = 
c
*
w_sÿË
;

1214 
ix
 = (è
sx
;

1215 
dx
 = 
sx
 - 
ix
;

1216 
v®
 = (1 - 
dx
è* 
	`g‘_pix–
(
im
, 
ix
, 
r
, 
k
) + dx * get_pixel(im, ix+1,„, k);

1218 
	`£t_pix–
(
·¹
, 
c
, 
r
, 
k
, 
v®
);

1222 
k
 = 0; k < 
im
.
c
; ++k){

1223 
r
 = 0;„ < 
h
; ++r){

1224 
sy
 = 
r
*
h_sÿË
;

1225 
iy
 = (è
sy
;

1226 
dy
 = 
sy
 - 
iy
;

1227 
c
 = 0; c < 
w
; ++c){

1228 
v®
 = (1-
dy
è* 
	`g‘_pix–
(
·¹
, 
c
, 
iy
, 
k
);

1229 
	`£t_pix–
(
»sized
, 
c
, 
r
, 
k
, 
v®
);

1231 if(
r
 =ğ
h
-1 || 
im
.h == 1) ;

1232 
c
 = 0; c < 
w
; ++c){

1233 
v®
 = 
dy
 * 
	`g‘_pix–
(
·¹
, 
c
, 
iy
+1, 
k
);

1234 
	`add_pix–
(
»sized
, 
c
, 
r
, 
k
, 
v®
);

1239 
	`ä“_image
(
·¹
);

1240  
»sized
;

1241 
	}
}

1244 
	$‹¡_»size
(*
f’ame
)

1246 
image
 
im
 = 
	`lßd_image
(
f’ame
, 0,0, 3);

1247 
mag
 = 
	`mag_¬¿y
(
im
.
d©a
, im.
w
*im.
h
*im.
c
);

1248 
	`´štf
("L2 NÜm: %f\n", 
mag
);

1249 
image
 
g¿y
 = 
	`g¿ysÿË_image
(
im
);

1251 
image
 
c1
 = 
	`cİy_image
(
im
);

1252 
image
 
c2
 = 
	`cİy_image
(
im
);

1253 
image
 
c3
 = 
	`cİy_image
(
im
);

1254 
image
 
c4
 = 
	`cİy_image
(
im
);

1255 
	`di¡Üt_image
(
c1
, .1, 1.5, 1.5);

1256 
	`di¡Üt_image
(
c2
, -.1, .66666, .66666);

1257 
	`di¡Üt_image
(
c3
, .1, 1.5, .66666);

1258 
	`di¡Üt_image
(
c4
, .1, .66666, 1.5);

1261 
	`show_image
(
im
, "Original", 1);

1262 
	`show_image
(
g¿y
, "Gray", 1);

1263 
	`show_image
(
c1
, "C1", 1);

1264 
	`show_image
(
c2
, "C2", 1);

1265 
	`show_image
(
c3
, "C3", 1);

1266 
	`show_image
(
c4
, "C4", 1);

1267 #ifdeà
OPENCV


1269 
image
 
aug
 = 
	`¿ndom_augm’t_image
(
im
, 0, .75, 320, 448, 320, 320);

1270 
	`show_image
(
aug
, "aug", 1);

1271 
	`ä“_image
(
aug
);

1274 
exposu»
 = 1.15;

1275 
§tu¿tiÚ
 = 1.15;

1276 
hue
 = .05;

1278 
image
 
c
 = 
	`cİy_image
(
im
);

1280 
dexp
 = 
	`¿nd_sÿË
(
exposu»
);

1281 
d§t
 = 
	`¿nd_sÿË
(
§tu¿tiÚ
);

1282 
dhue
 = 
	`¿nd_unifÜm
(-
hue
, hue);

1284 
	`di¡Üt_image
(
c
, 
dhue
, 
d§t
, 
dexp
);

1285 
	`show_image
(
c
, "rand", 1);

1286 
	`´štf
("%à%à%f\n", 
dhue
, 
d§t
, 
dexp
);

1287 
	`ä“_image
(
c
);

1290 
	}
}

1293 
image
 
	$lßd_image_¡b
(*
f’ame
, 
chªÃls
)

1295 
w
, 
h
, 
c
;

1296 *
d©a
 = 
	`¡bi_lßd
(
f’ame
, &
w
, &
h
, &
c
, 
chªÃls
);

1297 ià(!
d©a
) {

1298 
	`årštf
(
¡d”r
, "CªnÙ†ßd imag\"%s\"\nSTB R—sÚ: %s\n", 
f’ame
, 
	`¡bi_çu»_»asÚ
());

1299 
	`ex™
(0);

1301 if(
chªÃls
è
c
 = channels;

1302 
i
,
j
,
k
;

1303 
image
 
im
 = 
	`make_image
(
w
, 
h
, 
c
);

1304 
k
 = 0; k < 
c
; ++k){

1305 
j
 = 0; j < 
h
; ++j){

1306 
i
 = 0; i < 
w
; ++i){

1307 
d¡_šdex
 = 
i
 + 
w
*
j
 + w*
h
*
k
;

1308 
¤c_šdex
 = 
k
 + 
c
*
i
 + c*
w
*
j
;

1309 
im
.
d©a
[
d¡_šdex
] = ()d©a[
¤c_šdex
]/255.;

1314 
	`ä“
(
d©a
);

1315  
im
;

1316 
	}
}

1318 
image
 
	$lßd_image
(*
f’ame
, 
w
, 
h
, 
c
)

1320 #ifdeà
OPENCV


1321 
image
 
out
 = 
	`lßd_image_cv
(
f’ame
, 
c
);

1323 
image
 
out
 = 
	`lßd_image_¡b
(
f’ame
, 
c
);

1326 if((
h
 && 
w
è&& (h !ğ
out
.h || w != out.w)){

1327 
image
 
»sized
 = 
	`»size_image
(
out
, 
w
, 
h
);

1328 
	`ä“_image
(
out
);

1329 
out
 = 
»sized
;

1331  
out
;

1332 
	}
}

1334 
image
 
	$lßd_image_cŞÜ
(*
f’ame
, 
w
, 
h
)

1336  
	`lßd_image
(
f’ame
, 
w
, 
h
, 3);

1337 
	}
}

1339 
image
 
	$g‘_image_Ïy”
(
image
 
m
, 
l
)

1341 
image
 
out
 = 
	`make_image
(
m
.
w
, m.
h
, 1);

1342 
i
;

1343 
i
 = 0; i < 
m
.
h
*m.
w
; ++i){

1344 
out
.
d©a
[
i
] = 
m
.d©a[i+
l
*m.
h
*m.
w
];

1346  
out
;

1347 
	}
}

1348 
	$´št_image
(
image
 
m
)

1350 
i
, 
j
, 
k
;

1351 
i
 =0 ; i < 
m
.
c
; ++i){

1352 
j
 =0 ; j < 
m
.
h
; ++j){

1353 
k
 = 0; k < 
m
.
w
; ++k){

1354 
	`´štf
("%.2lf, ", 
m
.
d©a
[
i
*m.
h
*m.
w
 + 
j
*m.w + 
k
]);

1355 if(
k
 > 30) ;

1357 
	`´štf
("\n");

1358 if(
j
 > 30) ;

1360 
	`´štf
("\n");

1362 
	`´štf
("\n");

1363 
	}
}

1365 
image
 
	$cŞÏp£_images_v”t
(
image
 *
ims
, 
n
)

1367 
cŞÜ
 = 1;

1368 
bÜd”
 = 1;

1369 
h
,
w
,
c
;

1370 
w
 = 
ims
[0].w;

1371 
h
 = (
ims
[0].h + 
bÜd”
è* 
n
 - border;

1372 
c
 = 
ims
[0].c;

1373 if(
c
 !ğ3 || !
cŞÜ
){

1374 
w
 = (w+
bÜd”
)*
c
 - border;

1375 
c
 = 1;

1378 
image
 
f‹rs
 = 
	`make_image
(
w
, 
h
, 
c
);

1379 
i
,
j
;

1380 
i
 = 0; i < 
n
; ++i){

1381 
h_off£t
 = 
i
*(
ims
[0].
h
+
bÜd”
);

1382 
image
 
cİy
 = 
	`cİy_image
(
ims
[
i
]);

1384 if(
c
 =ğ3 && 
cŞÜ
){

1385 
	`embed_image
(
cİy
, 
f‹rs
, 0, 
h_off£t
);

1388 
j
 = 0; j < 
cİy
.
c
; ++j){

1389 
w_off£t
 = 
j
*(
ims
[0].
w
+
bÜd”
);

1390 
image
 
Ïy”
 = 
	`g‘_image_Ïy”
(
cİy
, 
j
);

1391 
	`embed_image
(
Ïy”
, 
f‹rs
, 
w_off£t
, 
h_off£t
);

1392 
	`ä“_image
(
Ïy”
);

1395 
	`ä“_image
(
cİy
);

1397  
f‹rs
;

1398 
	}
}

1400 
image
 
	$cŞÏp£_images_hÜz
(
image
 *
ims
, 
n
)

1402 
cŞÜ
 = 1;

1403 
bÜd”
 = 1;

1404 
h
,
w
,
c
;

1405 
size
 = 
ims
[0].
h
;

1406 
h
 = 
size
;

1407 
w
 = (
ims
[0].w + 
bÜd”
è* 
n
 - border;

1408 
c
 = 
ims
[0].c;

1409 if(
c
 !ğ3 || !
cŞÜ
){

1410 
h
 = (h+
bÜd”
)*
c
 - border;

1411 
c
 = 1;

1414 
image
 
f‹rs
 = 
	`make_image
(
w
, 
h
, 
c
);

1415 
i
,
j
;

1416 
i
 = 0; i < 
n
; ++i){

1417 
w_off£t
 = 
i
*(
size
+
bÜd”
);

1418 
image
 
cİy
 = 
	`cİy_image
(
ims
[
i
]);

1420 if(
c
 =ğ3 && 
cŞÜ
){

1421 
	`embed_image
(
cİy
, 
f‹rs
, 
w_off£t
, 0);

1424 
j
 = 0; j < 
cİy
.
c
; ++j){

1425 
h_off£t
 = 
j
*(
size
+
bÜd”
);

1426 
image
 
Ïy”
 = 
	`g‘_image_Ïy”
(
cİy
, 
j
);

1427 
	`embed_image
(
Ïy”
, 
f‹rs
, 
w_off£t
, 
h_off£t
);

1428 
	`ä“_image
(
Ïy”
);

1431 
	`ä“_image
(
cİy
);

1433  
f‹rs
;

1434 
	}
}

1436 
	$show_image_nÜm®ized
(
image
 
im
, cÚ¡ *
Çme
)

1438 
image
 
c
 = 
	`cİy_image
(
im
);

1439 
	`nÜm®ize_image
(
c
);

1440 
	`show_image
(
c
, 
Çme
, 1);

1441 
	`ä“_image
(
c
);

1442 
	}
}

1444 
	$show_images
(
image
 *
ims
, 
n
, *
wšdow
)

1446 
image
 
m
 = 
	`cŞÏp£_images_v”t
(
ims
, 
n
);

1456 
	`nÜm®ize_image
(
m
);

1457 
	`§ve_image
(
m
, 
wšdow
);

1458 
	`show_image
(
m
, 
wšdow
, 1);

1459 
	`ä“_image
(
m
);

1460 
	}
}

1462 
	$ä“_image
(
image
 
m
)

1464 if(
m
.
d©a
){

1465 
	`ä“
(
m
.
d©a
);

1467 
	}
}

	@App/image.h

1 #iâdeà
IMAGE_H


2 
	#IMAGE_H


	)

4 
	~<¡dlib.h
>

5 
	~<¡dio.h
>

6 
	~<æßt.h
>

7 
	~<¡ršg.h
>

8 
	~<m©h.h
>

10 
	~"d¬kÃt.h
"

12 #ifdeà
__ılu¥lus


16 #ifdeà
OPENCV


17 *
İ’_video_¡»am
(cÚ¡ *
f
, 
c
, 
w
, 
h
, 
ås
);

18 
image
 
g‘_image_äom_¡»am
(*
p
);

19 
image
 
lßd_image_cv
(*
f’ame
, 
chªÃls
);

20 
show_image_cv
(
image
 
im
, cÚ¡ * 
Çme
, 
ms
);

23 
g‘_cŞÜ
(
c
, 
x
, 
max
);

24 
d¿w_box
(
image
 
a
, 
x1
, 
y1
, 
x2
, 
y2
, 
r
, 
g
, 
b
);

25 
d¿w_bbox
(
image
 
a
, 
box
 
bbox
, 
w
, 
r
, 
g
, 
b
);

26 
wr™e_Ïb–
(
image
 
a
, 
r
, 
c
, imag*
ch¬aù”s
, *
¡ršg
, *
rgb
);

27 
image
 
image_di¡ªû
(imag
a
, imag
b
);

28 
sÿË_image
(
image
 
m
, 
s
);

29 
image
 
rÙ©e_üİ_image
(imag
im
, 
¿d
, 
s
, 
w
, 
h
, 
dx
, 
dy
, 
a¥eù
);

30 
image
 
¿ndom_üİ_image
(imag
im
, 
w
, 
h
);

31 
image
 
¿ndom_augm’t_image
(imag
im
, 
ªgË
, 
a¥eù
, 
low
, 
high
, 
w
, 
h
);

32 
augm’t_¬gs
 
¿ndom_augm’t_¬gs
(
image
 
im
, 
ªgË
, 
a¥eù
, 
low
, 
high
, 
w
, 
h
);

33 
Ë‰”box_image_što
(
image
 
im
, 
w
, 
h
, imag
boxed
);

34 
image
 
»size_max
(imag
im
, 
max
);

35 
Œª¦©e_image
(
image
 
m
, 
s
);

36 
embed_image
(
image
 
sourû
, imag
de¡
, 
dx
, 
dy
);

37 
¶aû_image
(
image
 
im
, 
w
, 
h
, 
dx
, 
dy
, imag
ÿnvas
);

38 
§tu¿‹_image
(
image
 
im
, 
§t
);

39 
exposu»_image
(
image
 
im
, 
§t
);

40 
di¡Üt_image
(
image
 
im
, 
hue
, 
§t
, 
v®
);

41 
§tu¿‹_exposu»_image
(
image
 
im
, 
§t
, 
exposu»
);

42 
rgb_to_hsv
(
image
 
im
);

43 
hsv_to_rgb
(
image
 
im
);

44 
yuv_to_rgb
(
image
 
im
);

45 
rgb_to_yuv
(
image
 
im
);

48 
image
 
cŞÏp£_image_Ïy”s
(imag
sourû
, 
bÜd”
);

49 
image
 
cŞÏp£_images_hÜz
(imag*
ims
, 
n
);

50 
image
 
cŞÏp£_images_v”t
(imag*
ims
, 
n
);

52 
show_image_nÜm®ized
(
image
 
im
, cÚ¡ *
Çme
);

53 
show_images
(
image
 *
ims
, 
n
, *
wšdow
);

54 
show_image_Ïy”s
(
image
 
p
, *
Çme
);

55 
show_image_cŞÏp£d
(
image
 
p
, *
Çme
);

57 
´št_image
(
image
 
m
);

59 
image
 
make_em±y_image
(
w
, 
h
, 
c
);

60 
cİy_image_što
(
image
 
¤c
, imag
de¡
);

62 
image
 
g‘_image_Ïy”
(imag
m
, 
l
);

64 #ifdeà
__ılu¥lus


	@App/layer.h

1 
	~"d¬kÃt.h
"

	@App/list.cpp

1 
	~<¡dlib.h
>

2 
	~<¡ršg.h
>

3 
	~"li¡.h
"

5 
li¡
 *
	$make_li¡
()

7 
li¡
 *
l
 = (li¡ *)
	`m®loc
((list));

8 
l
->
size
 = 0;

9 
l
->
äÚt
 = 0;

10 
l
->
back
 = 0;

11  
l
;

12 
	}
}

28 *
	$li¡_pİ
(
li¡
 *
l
){

29 if(!
l
->
back
)  0;

30 
node
 *
b
 = 
l
->
back
;

31 *
v®
 = 
b
->val;

32 
l
->
back
 = 
b
->
´ev
;

33 if(
l
->
back
èl->back->
Ãxt
 = 0;

34 
	`ä“
(
b
);

35 --
l
->
size
;

37  
v®
;

38 
	}
}

40 
	$li¡_š£¹
(
li¡
 *
l
, *
v®
)

42 
node
 *
Ãw_r
 = (nod*)
	`m®loc
((node));

43 
Ãw_r
->
v®
 = val;

44 
Ãw_r
->
Ãxt
 = 0;

46 if(!
l
->
back
){

47 
l
->
äÚt
 = 
Ãw_r
;

48 
Ãw_r
->
´ev
 = 0;

50 
l
->
back
->
Ãxt
 = 
Ãw_r
;

51 
Ãw_r
->
´ev
 = 
l
->
back
;

53 
l
->
back
 = 
Ãw_r
;

54 ++
l
->
size
;

55 
	}
}

57 
	$ä“_node
(
node
 *
n
)

59 
node
 *
Ãxt
;

60 
n
) {

61 
Ãxt
 = 
n
->next;

62 
	`ä“
(
n
);

63 
n
 = 
Ãxt
;

65 
	}
}

67 
	$ä“_li¡
(
li¡
 *
l
)

69 
	`ä“_node
(
l
->
äÚt
);

70 
	`ä“
(
l
);

71 
	}
}

73 
	$ä“_li¡_cÚ‹Ás
(
li¡
 *
l
)

75 
node
 *
n
 = 
l
->
äÚt
;

76 
n
){

77 
	`ä“
(
n
->
v®
);

78 
n
 =‚->
Ãxt
;

80 
	}
}

82 **
	$li¡_to_¬¿y
(
li¡
 *
l
)

84 **
a
 = (**)
	`ÿÎoc
(
l
->
size
, (*));

85 
couÁ
 = 0;

86 
node
 *
n
 = 
l
->
äÚt
;

87 
n
){

88 
a
[
couÁ
++] = 
n
->
v®
;

89 
n
 =‚->
Ãxt
;

91  
a
;

92 
	}
}

	@App/list.h

1 #iâdeà
LIST_H


2 
	#LIST_H


	)

3 
	~"d¬kÃt.h
"

5 
li¡
 *
make_li¡
();

6 
li¡_fšd
(
li¡
 *
l
, *
v®
);

8 
li¡_š£¹
(
li¡
 *, *);

11 
ä“_li¡_cÚ‹Ás
(
li¡
 *
l
);

	@App/matrix.cpp

1 
	~"m©rix.h
"

2 
	~"uts.h
"

3 
	~"bÏs.h
"

4 
	~<¡dio.h
>

5 
	~<¡dlib.h
>

6 
	~<¡ršg.h
>

7 
	~<as£¹.h
>

8 
	~<m©h.h
>

10 
	$ä“_m©rix
(
m©rix
 
m
)

12 
i
;

13 
i
 = 0; i < 
m
.
rows
; ++iè
	`ä“
(m.
v®s
[i]);

14 
	`ä“
(
m
.
v®s
);

15 
	}
}

17 
	$m©rix_tİk_accu¿cy
(
m©rix
 
Œuth
, m©rix 
guess
, 
k
)

19 *
šdexes
 = (*)
	`ÿÎoc
(
k
, ());

20 
n
 = 
Œuth
.
cŞs
;

21 
i
,
j
;

22 
cÜ»ù
 = 0;

23 
i
 = 0; i < 
Œuth
.
rows
; ++i){

24 
	`tİ_k
(
guess
.
v®s
[
i
], 
n
, 
k
, 
šdexes
);

25 
j
 = 0; j < 
k
; ++j){

26 
şass_r
 = 
šdexes
[
j
];

27 if(
Œuth
.
v®s
[
i
][
şass_r
]){

28 ++
cÜ»ù
;

33 
	`ä“
(
šdexes
);

34  ()
cÜ»ù
/
Œuth
.
rows
;

35 
	}
}

37 
	$sÿË_m©rix
(
m©rix
 
m
, 
sÿË
)

39 
i
,
j
;

40 
i
 = 0; i < 
m
.
rows
; ++i){

41 
j
 = 0; j < 
m
.
cŞs
; ++j){

42 
m
.
v®s
[
i
][
j
] *ğ
sÿË
;

45 
	}
}

47 
m©rix
 
	$»size_m©rix
(
m©rix
 
m
, 
size
)

49 
i
;

50 ià(
m
.
rows
 =ğ
size
)  m;

51 ià(
m
.
rows
 < 
size
) {

52 
m
.
v®s
 = (**)
	`»®loc
(m.v®s, 
size
*(*));

53 
i
 = 
m
.
rows
; i < 
size
; ++i) {

54 
m
.
v®s
[
i
] = (*)
	`ÿÎoc
(m.
cŞs
, ());

56 } ià(
m
.
rows
 > 
size
) {

57 
i
 = 
size
; i < 
m
.
rows
; ++i) {

58 
	`ä“
(
m
.
v®s
[
i
]);

60 
m
.
v®s
 = (**)
	`»®loc
(m.v®s, 
size
*(*));

62 
m
.
rows
 = 
size
;

63  
m
;

64 
	}
}

66 
	$m©rix_add_m©rix
(
m©rix
 
äom
, m©rix 
to
)

68 
	`as£¹
(
äom
.
rows
 =ğ
to
.row && from.
cŞs
 ==o.cols);

69 
i
,
j
;

70 
i
 = 0; i < 
äom
.
rows
; ++i){

71 
j
 = 0; j < 
äom
.
cŞs
; ++j){

72 
to
.
v®s
[
i
][
j
] +ğ
äom
.vals[i][j];

75 
	}
}

77 
m©rix
 
	$cİy_m©rix
(
m©rix
 
m
)

79 
m©rix
 
c
 = {0};

80 
c
.
rows
 = 
m
.rows;

81 
c
.
cŞs
 = 
m
.cols;

82 
c
.
v®s
 = (**)
	`ÿÎoc
(c.
rows
, (*));

83 
i
;

84 
i
 = 0; i < 
c
.
rows
; ++i){

85 
c
.
v®s
[
i
] = (*)
	`ÿÎoc
(c.
cŞs
, ());

86 
	`cİy_ıu
(
c
.
cŞs
, 
m
.
v®s
[
i
], 1, c.vals[i], 1);

88  
c
;

89 
	}
}

91 
m©rix
 
	$make_m©rix
(
rows
, 
cŞs
)

93 
i
;

94 
m©rix
 
m
;

95 
m
.
rows
 =„ows;

96 
m
.
cŞs
 = cols;

97 
m
.
v®s
 = (**)
	`ÿÎoc
(m.
rows
, (*));

98 
i
 = 0; i < 
m
.
rows
; ++i){

99 
m
.
v®s
[
i
] = (*)
	`ÿÎoc
(m.
cŞs
, ());

101  
m
;

102 
	}
}

104 
m©rix
 
	$hŞd_out_m©rix
(
m©rix
 *
m
, 
n
)

106 
i
;

107 
m©rix
 
h
;

108 
h
.
rows
 = 
n
;

109 
h
.
cŞs
 = 
m
->cols;

110 
h
.
v®s
 = (**)
	`ÿÎoc
(h.
rows
, (*));

111 
i
 = 0; i < 
n
; ++i){

112 
šdex
 = 
	`¿nd
()%
m
->
rows
;

113 
h
.
v®s
[
i
] = 
m
->v®s[
šdex
];

114 
m
->
v®s
[
šdex
] = m->v®s[--(m->
rows
)];

116  
h
;

117 
	}
}

119 *
	$pİ_cŞumn
(
m©rix
 *
m
, 
c
)

121 *
cŞ
 = (*)
	`ÿÎoc
(
m
->
rows
, ());

122 
i
, 
j
;

123 
i
 = 0; i < 
m
->
rows
; ++i){

124 
cŞ
[
i
] = 
m
->
v®s
[i][
c
];

125 
j
 = 
c
; j < 
m
->
cŞs
-1; ++j){

126 
m
->
v®s
[
i
][
j
] = m->vals[i][j+1];

129 --
m
->
cŞs
;

130  
cŞ
;

131 
	}
}

133 
m©rix
 
	$csv_to_m©rix
(*
f’ame
)

135 
FILE
 *
å
 = 
	`fİ’
(
f’ame
, "r");

136 if(!
å
è
	`fe_”rÜ
(
f’ame
);

138 
m©rix
 
m
;

139 
m
.
cŞs
 = -1;

141 *
lše
;

143 
n
 = 0;

144 
size
 = 1024;

145 
m
.
v®s
 = (**)
	`ÿÎoc
(
size
, (*));

146 (
lše
 = 
	`fg‘l
(
å
))){

147 if(
m
.
cŞs
 =ğ-1èm.cŞ ğ
	`couÁ_f›lds
(
lše
);

148 if(
n
 =ğ
size
){

149 
size
 *= 2;

150 
m
.
v®s
 = (**)
	`»®loc
(m.v®s, 
size
*(*));

152 
m
.
v®s
[
n
] = 
	`·r£_f›lds
(
lše
, m.
cŞs
);

153 
	`ä“
(
lše
);

154 ++
n
;

156 
m
.
v®s
 = (**)
	`»®loc
(m.v®s, 
n
*(*));

157 
m
.
rows
 = 
n
;

158  
m
;

159 
	}
}

161 
	$m©rix_to_csv
(
m©rix
 
m
)

163 
i
, 
j
;

165 
i
 = 0; i < 
m
.
rows
; ++i){

166 
j
 = 0; j < 
m
.
cŞs
; ++j){

167 if(
j
 > 0è
	`´štf
(",");

168 
	`´štf
("%.17g", 
m
.
v®s
[
i
][
j
]);

170 
	`´štf
("\n");

172 
	}
}

174 
	$´št_m©rix
(
m©rix
 
m
)

176 
i
, 
j
;

177 
	`´štf
("%d X %d M©rix:\n",
m
.
rows
, m.
cŞs
);

178 
	`´štf
(" __");

179 
j
 = 0; j < 16*
m
.
cŞs
-1; ++jè
	`´štf
(" ");

180 
	`´štf
("__ \n");

182 
	`´štf
("| ");

183 
j
 = 0; j < 16*
m
.
cŞs
-1; ++jè
	`´štf
(" ");

184 
	`´štf
(" |\n");

186 
i
 = 0; i < 
m
.
rows
; ++i){

187 
	`´štf
("| ");

188 
j
 = 0; j < 
m
.
cŞs
; ++j){

189 
	`´štf
("%15.7à", 
m
.
v®s
[
i
][
j
]);

191 
	`´štf
(" |\n");

193 
	`´štf
("|__");

194 
j
 = 0; j < 16*
m
.
cŞs
-1; ++jè
	`´štf
(" ");

195 
	`´štf
("__|\n");

196 
	}
}

	@App/matrix.h

1 #iâdeà
MATRIX_H


2 
	#MATRIX_H


	)

3 
	~"d¬kÃt.h
"

5 
m©rix
 
cİy_m©rix
(m©rix 
m
);

6 
´št_m©rix
(
m©rix
 
m
);

8 
m©rix
 
hŞd_out_m©rix
(m©rix *
m
, 
n
);

9 
m©rix
 
»size_m©rix
(m©rix 
m
, 
size
);

11 *
pİ_cŞumn
(
m©rix
 *
m
, 
c
);

	@App/maxpool_layer.h

1 #iâdeà
MAXPOOL_LAYER_H


2 
	#MAXPOOL_LAYER_H


	)

6 
	~"Ïy”.h
"

7 
	~"ÃtwÜk.h
"

9 
Ïy”
 
	tmaxpoŞ_Ïy”
;

12 
maxpoŞ_Ïy”
 
make_maxpoŞ_Ïy”
(
b©ch
, 
h
, 
w
, 
c
, 
size
, 
¡ride
, 
·ddšg
);

	@App/network.cpp

2 
	~<¡dio.h
>

3 
	~<time.h
>

4 
	~<as£¹.h
>

5 
	~"ÃtwÜk.h
"

6 
	~"image.h
"

7 
	~"uts.h
"

8 
	~"Enşave_u.h
"

9 
	~"Aµ.h
"

12 
	~"cÚÃùed_Ïy”.h
"

13 
	~"cÚvŞutiÚ®_Ïy”.h
"

15 
	~"maxpoŞ_Ïy”.h
"

16 
	~"co¡_Ïy”.h
"

17 
	~"soámax_Ïy”.h
"

18 
	~"drİout_Ïy”.h
"

19 
	~"·r£r.h
"

20 
	~"sock‘_­i.h
"

27 
lßd_¬gs
 
	$g‘_ba£_¬gs
(
ÃtwÜk
 *
Ãt
)

29 
lßd_¬gs
 
¬gs
 = {0};

30 
¬gs
.
w
 = 
Ãt
->w;

31 
¬gs
.
h
 = 
Ãt
->h;

32 
¬gs
.
size
 = 
Ãt
->
w
;

34 
¬gs
.
mš
 = 
Ãt
->
mš_üİ
;

35 
¬gs
.
max
 = 
Ãt
->
max_üİ
;

36 
¬gs
.
ªgË
 = 
Ãt
->angle;

37 
¬gs
.
a¥eù
 = 
Ãt
->aspect;

38 
¬gs
.
exposu»
 = 
Ãt
->exposure;

39 
¬gs
.
ûÁ”
 = 
Ãt
->center;

40 
¬gs
.
§tu¿tiÚ
 = 
Ãt
->saturation;

41 
¬gs
.
hue
 = 
Ãt
->hue;

42  
¬gs
;

43 
	}
}

45 
ÃtwÜk
 *
	$lßd_ÃtwÜk
(*
cfg
, *
weights
, 
ş—r
)

47 
ÃtwÜk
 *
Ãt
 = 
	`·r£_ÃtwÜk_cfg
(
cfg
);

48 if(
weights
 && weights[0] != 0){

49 
	`lßd_weights
(
Ãt
, 
weights
);

51 if(
ş—r
è(*
Ãt
->
£’
) = 0;

52  
Ãt
;

53 
	}
}

55 *
	$g‘_Ïy”_¡ršg
(
LAYER_TYPE
 
a
)

57 
a
){

58 
CONVOLUTIONAL
:

60 
ACTIVE
:

62 
DECONVOLUTIONAL
:

64 
CONNECTED
:

66 
MAXPOOL
:

68 
SOFTMAX
:

70 
DROPOUT
:

72 
COST
:

74 
BATCHNORM
:

80 
	}
}

82 
ÃtwÜk
 *
	$make_ÃtwÜk
(
n
)

84 
ÃtwÜk
 *
Ãt
 = (ÃtwÜk *)
	`ÿÎoc
(1, (network));

85 
Ãt
->
n
 =‚;

86 
Ãt
->
Ïy”s
 = (
Ïy”
 *)
	`ÿÎoc
Ò‘->
n
, (layer));

87 
Ãt
->
£’
 = (
size_t
 *)
	`ÿÎoc
(1, (size_t));

88 
Ãt
->
t
 = (*)
	`ÿÎoc
(1, ());

89 
Ãt
->
co¡
 = (*)
	`ÿÎoc
(1, ());

90  
Ãt
;

91 
	}
}

93 
	$wÜk¥aûBOO
(
ÃtwÜk
 
Ãt
)

95 
wÜk¥aû_size
 = 0;

96 
i
 = 0; i < 
Ãt
.
n
; ++i)

98 if(
CONVOLUTIONAL
 =ğ
Ãt
.
Ïy”s
[
i
].
ty³
)

100 
Ïy”
 
l
 = 
Ãt
.
Ïy”s
[
i
];

101 if(
l
.
wÜk¥aû_size
 > workspace_size){

102 
wÜk¥aû_size
 = 
l
.workspace_size;

108  
wÜk¥aû_size
;

109 
	}
}

111 
	gwssize
 = -1;

113 
	$fÜw¬d_ÃtwÜk
(
ÃtwÜk
 *
Ã
, *
šputs
)

115 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

116 
±r
;

117 
ÃtwÜk
 
Ãt
 = *
Ã
;

118 
Ïy”
 
l
 = 
Ãt
.
Ïy”s
[
glob®_¡¬t_šdex
];

120 
»t
 = 
	`eÿÎ_fÜw¬d_ÃtwÜk
(
glob®_eid
, &
±r
, 
šputs
, 
l
.šputs*l.
b©ch
*(), 
Ãt_g_bufãr
, 16, 
Ãt
.
Œaš
);

121 if(
±r
 != 0)

123 
	`´štf
("\n\ÀE¼Ü occu¼ed iÀfÜw¬d‚‘wÜk : %d\n", 
±r
);

124 
	`ex™
(1);

127 
	}
}

129 
	$ÿlc_ÃtwÜk_co¡
(
ÃtwÜk
 *
Ã
)

131 
ÃtwÜk
 
Ãt
 = *
Ã
;

132 
i
;

133 
sum
 = 0;

134 
couÁ
 = 0;

135 
i
 = 0; i < 
Ãt
.
n
; ++i){

136 if(
Ãt
.
Ïy”s
[
i
].
co¡
){

137 
sum
 +ğ
Ãt
.
Ïy”s
[
i
].
co¡
[0];

139 ++
couÁ
;

142 *
Ãt
.
co¡
 = 
sum
/
couÁ
;

143 
	}
}

146 
	$£t_b©ch_ÃtwÜk
(
ÃtwÜk
 *
Ãt
, 
b
)

148 
Ãt
->
b©ch
 = 
b
;

149 
i
;

150 
i
 = 0; i < 
Ãt
->
n
; ++i){

151 
Ãt
->
Ïy”s
[
i
].
b©ch
 = 
b
;

153 
	}
}

171 
	$tİ_´ediùiÚs
(
ÃtwÜk
 *
Ãt
, 
k
, *
šdex
)

173 
	`tİ_k
(
Ãt
->
ouut
,‚‘->
ouuts
, 
k
, 
šdex
);

174 
	}
}

177 *
	$ÃtwÜk_´ediù
(
ÃtwÜk
 *
Ãt
, *
šput
)

179 
ÃtwÜk
 
Üig
 = *
Ãt
;

180 
Ãt
->
šput
 = input;

181 
Ãt
->
Œuth
 = 0;

182 
Ãt
->
Œaš
 = 0;

183 
Ãt
->
d–
 = 0;

184 
şock_t
 
time
 = 
	`şock
();

185 
	`fÜw¬d_ÃtwÜk
(
Ãt
, 
šput
);

186 
	`årštf
(
¡d”r
, "\nFÜw¬d…rİag©iÚ com¶‘ed iÀ%à£cÚds.\n", ()(
	`şock
()-
time
)/
CLOCKS_PER_SEC
);

188 *
out
;

189 
Ïy”
 
l
 = 
Ãt
->
Ïy”s
[Ãt->
n
 - 2];

191 
Ãt_ouut_back
 = (*)
	`m®loc
((è* 
l
.
ouuts
 *†.
b©ch
);

192 
	`mem£t
(
Ãt_g_bufãr
, 0, 16);

195 
±r
;

196 
	`eÿÎ_Ãt_ouut_»tuº
(
glob®_eid
, &
±r
, 
Ãt_ouut_back
, 
l
.
ouuts
 * (è*†.
b©ch
, 
Ãt_g_bufãr
, 16);

197 
out
 = 
Ãt_ouut_back
;

198 *
Ãt
 = 
Üig
;

199  
out
;

200 
	}
}

203 
	$ÃtwÜk_width
(
ÃtwÜk
 *
Ãt
){‚‘->
w
;
	}
}

204 
	$ÃtwÜk_height
(
ÃtwÜk
 *
Ãt
){‚‘->
h
;
	}
}

206 
m©rix
 
	$ÃtwÜk_´ediù_d©a
(
ÃtwÜk
 *
Ãt
, 
d©a
 
‹¡
)

208 
i
,
j
,
b
;

209 
k
 = 
Ãt
->
ouuts
;

210 
m©rix
 
´ed
 = 
	`make_m©rix
(
‹¡
.
X
.
rows
, 
k
);

211 *
X
 = (*)
	`ÿÎoc
(
Ãt
->
b©ch
*
‹¡
.X.
cŞs
, ());

212 
i
 = 0; i < 
‹¡
.
X
.
rows
; i +ğ
Ãt
->
b©ch
){

213 
b
 = 0; b < 
Ãt
->
b©ch
; ++b){

214 if(
i
+
b
 =ğ
‹¡
.
X
.
rows
) ;

215 
	`memıy
(
X
+
b
*
‹¡
.X.
cŞs
,e¡.X.
v®s
[
i
+b],est.X.cols*());

217 *
out
 = 
	`ÃtwÜk_´ediù
(
Ãt
, 
X
);

218 
b
 = 0; b < 
Ãt
->
b©ch
; ++b){

219 if(
i
+
b
 =ğ
‹¡
.
X
.
rows
) ;

220 
j
 = 0; j < 
k
; ++j){

221 
´ed
.
v®s
[
i
+
b
][
j
] = 
out
[j+b*
k
];

225 
	`ä“
(
X
);

226  
´ed
;

227 
	}
}

229 
	$´št_ÃtwÜk
(
ÃtwÜk
 *
Ãt
)

231 
i
,
j
;

232 
i
 = 0; i < 
Ãt
->
n
; ++i){

233 
Ïy”
 
l
 = 
Ãt
->
Ïy”s
[
i
];

234 *
ouut
 = 
l
.output;

235 
n
 = 
l
.
ouuts
;

236 
m—n
 = 
	`m—n_¬¿y
(
ouut
, 
n
);

237 
v¬i
 = 
	`v¬Ÿnû_¬¿y
(
ouut
, 
n
);

238 
	`årštf
(
¡d”r
, "Lay” %d - M—n: %f, V¬Ÿnû: %f\n",
i
,
m—n
, 
v¬i
);

239 if(
n
 > 100)‚ = 100;

240 
j
 = 0; j < 
n
; ++jè
	`årštf
(
¡d”r
, "%f, ", 
ouut
[j]);

241 if(
n
 =ğ100)
	`årštf
(
¡d”r
,".....\n");

242 
	`årštf
(
¡d”r
, "\n");

244 
	}
}

247 
	$ÃtwÜk_accu¿cy
(
ÃtwÜk
 *
Ãt
, 
d©a
 
d
)

249 
m©rix
 
guess
 = 
	`ÃtwÜk_´ediù_d©a
(
Ãt
, 
d
);

250 
acc
 = 
	`m©rix_tİk_accu¿cy
(
d
.
y
, 
guess
,1);

251 
	`ä“_m©rix
(
guess
);

252  
acc
;

253 
	}
}

255 
Ïy”
 
	$g‘_ÃtwÜk_ouut_Ïy”
(
ÃtwÜk
 *
Ãt
)

257 
i
;

258 
i
 = 
Ãt
->
n
 - 1; i >= 0; --i){

259 if(
Ãt
->
Ïy”s
[
i
].
ty³
 !ğ
COST
) ;

261  
Ãt
->
Ïy”s
[
i
];

262 
	}
}

264 
	$ä“_ÃtwÜk
(
ÃtwÜk
 *
Ãt
)

266 
i
;

267 
i
 = 0; i < 
Ãt
->
n
; ++i){

268 
	`ä“_Ïy”
(
Ãt
->
Ïy”s
[
i
]);

270 
	`ä“
(
Ãt
->
Ïy”s
);

271 if(
Ãt
->
šput
è
	`ä“
(net->input);

272 if(
Ãt
->
Œuth
è
	`ä“
(net->truth);

273 
	`ä“
(
Ãt
);

274 
	}
}

277 
Ïy”
 
	$ÃtwÜk_ouut_Ïy”
(
ÃtwÜk
 *
Ãt
)

279 
i
;

280 
i
 = 
Ãt
->
n
 - 1; i >= 0; --i){

281 if(
Ãt
->
Ïy”s
[
i
].
ty³
 !ğ
COST
) ;

283  
Ãt
->
Ïy”s
[
i
];

284 
	}
}

286 
	$ÃtwÜk_šputs
(
ÃtwÜk
 *
Ãt
)

288  
Ãt
->
Ïy”s
[0].
šputs
;

289 
	}
}

291 
	$ÃtwÜk_ouuts
(
ÃtwÜk
 *
Ãt
)

293  
	`ÃtwÜk_ouut_Ïy”
(
Ãt
).
ouuts
;

294 
	}
}

296 *
	$ÃtwÜk_ouut
(
ÃtwÜk
 *
Ãt
)

298  
	`ÃtwÜk_ouut_Ïy”
(
Ãt
).
ouut
;

299 
	}
}

301 
	$ä“_Ïy”
(
Ïy”
 
l
)

303 if(
l
.
ty³
 =ğ
DROPOUT
){

304 if(
l
.
¿nd
è
	`ä“
(l.rand);

307 if(
l
.
cweights
è
	`ä“
(l.cweights);

308 if(
l
.
šdexes
è
	`ä“
(l.indexes);

309 if(
l
.
šput_Ïy”s
è
	`ä“
(l.input_layers);

310 if(
l
.
šput_sizes
è
	`ä“
(l.input_sizes);

311 if(
l
.
m­
è
	`ä“
(l.map);

312 if(
l
.
¿nd
è
	`ä“
(l.rand);

313 if(
l
.
co¡
è
	`ä“
(l.cost);

314 if(
l
.
¡©e
è
	`ä“
(l.state);

315 if(
l
.
´ev_¡©e
è
	`ä“
(l.prev_state);

316 if(
l
.
fÜgÙ_¡©e
è
	`ä“
(l.forgot_state);

317 if(
l
.
fÜgÙ_d–
è
	`ä“
(l.forgot_delta);

318 if(
l
.
¡©e_d–
è
	`ä“
(l.state_delta);

319 if(
l
.
cÚÿt
è
	`ä“
(l.concat);

320 if(
l
.
cÚÿt_d–
è
	`ä“
(l.concat_delta);

321 if(
l
.
bš¬y_weights
è
	`ä“
(l.binary_weights);

322 if(
l
.
bŸ£s
è
	`ä“
(l.biases);

323 if(
l
.
bŸs_upd©es
è
	`ä“
(l.bias_updates);

324 if(
l
.
sÿËs
è
	`ä“
(l.scales);

325 if(
l
.
sÿË_upd©es
è
	`ä“
(l.scale_updates);

326 if(
l
.
weights
è
	`ä“
(l.weights);

327 if(
l
.
weight_upd©es
è
	`ä“
(l.weight_updates);

328 if(
l
.
d–
è
	`ä“
(l.delta);

329 if(
l
.
ouut
è
	`ä“
(l.output);

330 if(
l
.
squ¬ed
è
	`ä“
(l.squared);

331 if(
l
.
nÜms
è
	`ä“
(l.norms);

332 if(
l
.
¥©Ÿl_m—n
è
	`ä“
(l.spatial_mean);

333 if(
l
.
m—n
è
	`ä“
(l.mean);

334 if(
l
.
v¬Ÿnû
è
	`ä“
(l.variance);

335 if(
l
.
m—n_d–
è
	`ä“
(l.mean_delta);

336 if(
l
.
v¬Ÿnû_d–
è
	`ä“
(l.variance_delta);

337 if(
l
.
rŞlšg_m—n
è
	`ä“
(l.rolling_mean);

338 if(
l
.
rŞlšg_v¬Ÿnû
è
	`ä“
(l.rolling_variance);

339 if(
l
.
x
è
	`ä“
(l.x);

340 if(
l
.
x_nÜm
è
	`ä“
(l.x_norm);

341 if(
l
.
m
è
	`ä“
(l.m);

342 if(
l
.
v
è
	`ä“
(l.v);

343 if(
l
.
z_ıu
è
	`ä“
(l.z_cpu);

344 if(
l
.
r_ıu
è
	`ä“
(l.r_cpu);

345 if(
l
.
h_ıu
è
	`ä“
(l.h_cpu);

346 if(
l
.
bš¬y_šput
è
	`ä“
(l.binary_input);

347 
	}
}

	@App/network.h

2 #iâdeà
NETWORK_H


3 
	#NETWORK_H


	)

4 
	~"d¬kÃt.h
"

6 
	~"image.h
"

7 
	~"Ïy”.h
"

8 
	~"d©a.h
"

9 
	~"Œ“.h
"

12 
com·»_ÃtwÜks
(
ÃtwÜk
 *
n1
,‚‘wÜk *
n2
, 
d©a
 
d
);

13 *
g‘_Ïy”_¡ršg
(
LAYER_TYPE
 
a
);

15 
ÃtwÜk
 *
make_ÃtwÜk
(
n
);

18 
´št_ÃtwÜk
(
ÃtwÜk
 *
Ãt
);

19 
ÿlc_ÃtwÜk_co¡
(
ÃtwÜk
 *
Ãt
);

	@App/option_list.cpp

1 
	~<¡dlib.h
>

2 
	~<¡dio.h
>

3 
	~<¡ršg.h
>

4 
	~"İtiÚ_li¡.h
"

5 
	~"uts.h
"

7 
li¡
 *
	$»ad_d©a_cfg
(*
f’ame
)

9 
FILE
 *
fe
 = 
	`fİ’
(
f’ame
, "r");

10 if(
fe
 =ğ0è
	`fe_”rÜ
(
f’ame
);

11 *
lše
;

12 
nu
 = 0;

13 
li¡
 *
İtiÚs
 = 
	`make_li¡
();

14 (
lše
=
	`fg‘l
(
fe
)) != 0){

15 ++ 
nu
;

16 
	`¡r
(
lše
);

17 
lše
[0]){

21 
	`ä“
(
lše
);

24 if(!
	`»ad_İtiÚ
(
lše
, 
İtiÚs
)){

25 
	`årštf
(
¡d”r
, "CÚfig f”rÜ†š%d, could…¬£: %s\n", 
nu
, 
lše
);

26 
	`ä“
(
lše
);

31 
	`fşo£
(
fe
);

32  
İtiÚs
;

33 
	}
}

35 
	$»ad_İtiÚ
(*
s
, 
li¡
 *
İtiÚs
)

37 
size_t
 
i
;

38 
size_t
 
Ën
 = 
	`¡¾’
(
s
);

39 *
v®
 = 0;

40 
i
 = 0; i < 
Ën
; ++i){

41 if(
s
[
i
] == '='){

42 
s
[
i
] = '\0';

43 
v®
 = 
s
+
i
+1;

47 if(
i
 =ğ
Ën
-1)  0;

48 *
key
 = 
s
;

49 
	`İtiÚ_š£¹
(
İtiÚs
, 
key
, 
v®
);

51 
	}
}

53 
	$İtiÚ_š£¹
(
li¡
 *
l
, *
key
, *
v®
)

55 
kvp
 *
p
 = (kv°*)
	`m®loc
((kvp));

56 
p
->
key
 = key;

57 
p
->
v®
 = val;

58 
p
->
u£d
 = 0;

59 
	`li¡_š£¹
(
l
, 
p
);

60 
	}
}

62 
	$İtiÚ_unu£d
(
li¡
 *
l
)

64 
node
 *
n
 = 
l
->
äÚt
;

65 
n
){

66 
kvp
 *
p
 = (kv°*)
n
->
v®
;

67 if(!
p
->
u£d
){

68 
	`årštf
(
¡d”r
, "Unu£d f›ld: '% ğ%s'\n", 
p
->
key
,…->
v®
);

70 
n
 =‚->
Ãxt
;

72 
	}
}

74 *
	$İtiÚ_fšd
(
li¡
 *
l
, *
key
)

76 
node
 *
n
 = 
l
->
äÚt
;

77 
n
){

78 
kvp
 *
p
 = (kv°*)
n
->
v®
;

79 if(
	`¡rcmp
(
p
->
key
, key) == 0){

80 
p
->
u£d
 = 1;

81  
p
->
v®
;

83 
n
 =‚->
Ãxt
;

86 
	}
}

87 *
	$İtiÚ_fšd_¡r
(
li¡
 *
l
, *
key
, *
def
)

89 *
v
 = 
	`İtiÚ_fšd
(
l
, 
key
);

90 if(
v
)  v;

91 if(
def
è
	`årštf
(
¡d”r
, "%s: Usšg deçuÉ '%s'\n", 
key
, def);

92  
def
;

93 
	}
}

95 
	$İtiÚ_fšd_št
(
li¡
 *
l
, *
key
, 
def
)

97 *
v
 = 
	`İtiÚ_fšd
(
l
, 
key
);

98 if(
v
è 
	`©oi
(v);

99 
	`årštf
(
¡d”r
, "%s: Usšg deçuÉ '%d'\n", 
key
, 
def
);

100  
def
;

101 
	}
}

103 
	$İtiÚ_fšd_št_qu›t
(
li¡
 *
l
, *
key
, 
def
)

105 *
v
 = 
	`İtiÚ_fšd
(
l
, 
key
);

106 if(
v
è 
	`©oi
(v);

107  
def
;

108 
	}
}

110 
	$İtiÚ_fšd_æßt_qu›t
(
li¡
 *
l
, *
key
, 
def
)

112 *
v
 = 
	`İtiÚ_fšd
(
l
, 
key
);

113 if(
v
è 
	`©of
(v);

114  
def
;

115 
	}
}

117 
	$İtiÚ_fšd_æßt
(
li¡
 *
l
, *
key
, 
def
)

119 *
v
 = 
	`İtiÚ_fšd
(
l
, 
key
);

120 if(
v
è 
	`©of
(v);

121 
	`årštf
(
¡d”r
, "%s: Usšg deçuÉ '%lf'\n", 
key
, 
def
);

122  
def
;

123 
	}
}

	@App/option_list.h

1 #iâdeà
OPTION_LIST_H


2 
	#OPTION_LIST_H


	)

3 
	~"li¡.h
"

6 *
	mkey
;

7 *
	mv®
;

8 
	mu£d
;

9 } 
	tkvp
;

12 
»ad_İtiÚ
(*
s
, 
li¡
 *
İtiÚs
);

13 
İtiÚ_š£¹
(
li¡
 *
l
, *
key
, *
v®
);

14 *
İtiÚ_fšd
(
li¡
 *
l
, *
key
);

15 
İtiÚ_fšd_æßt
(
li¡
 *
l
, *
key
, 
def
);

16 
İtiÚ_fšd_æßt_qu›t
(
li¡
 *
l
, *
key
, 
def
);

17 
İtiÚ_unu£d
(
li¡
 *
l
);

	@App/parser.cpp

1 
	~<¡dio.h
>

2 
	~<¡ršg.h
>

3 
	~<¡dlib.h
>

4 
	~<as£¹.h
>

6 
	~"Enşave_u.h
"

7 
	~"Aµ.h
"

8 
	~"d¬kÃt.h
"

10 
	~"aùiv©iÚs.h
"

11 
	~"bÏs.h
"

12 
	~"cÚÃùed_Ïy”.h
"

13 
	~"cÚvŞutiÚ®_Ïy”.h
"

14 
	~"co¡_Ïy”.h
"

15 
	~"drİout_Ïy”.h
"

16 
	~"li¡.h
"

17 
	~"maxpoŞ_Ïy”.h
"

18 
	~"İtiÚ_li¡.h
"

19 
	~"·r£r.h
"

20 
	~"soámax_Ïy”.h
"

21 
	~"avgpoŞ_Ïy”.h
"

22 
	~"uts.h
"

23 
	~"sock‘_­i.h
"

26 
	gcouÁ_glob®
 = 0;

27 
	gglob®_dp
 = 0;

30 *
	mty³
;

31 
li¡
 *
	mİtiÚs
;

32 }
	t£ùiÚ
;

34 
	ssize_·¿ms
{

35 
	mb©ch
;

36 
	mšputs
;

37 
	mh
;

38 
	mw
;

39 
	mc
;

40 
	mšdex
;

41 
	mtime_¡•s
;

42 
ÃtwÜk
 *
	mÃt
;

43 } 
	tsize_·¿ms
;

45 
li¡
 *
»ad_cfg
(*
f’ame
);

47 
LAYER_TYPE
 
	$¡ršg_to_Ïy”_ty³
(* 
ty³
)

50 ià(
	`¡rcmp
(
ty³
, "[shÜtcut]")==0è 
SHORTCUT
;

51 ià(
	`¡rcmp
(
ty³
, "[üİ]")==0è 
CROP
;

52 ià(
	`¡rcmp
(
ty³
, "[co¡]")==0è 
COST
;

53 ià(
	`¡rcmp
(
ty³
, "[d‘eùiÚ]")==0è 
DETECTION
;

54 ià(
	`¡rcmp
(
ty³
, "[»giÚ]")==0è 
REGION
;

55 ià(
	`¡rcmp
(
ty³
, "[yŞo]")==0è 
YOLO
;

56 ià(
	`¡rcmp
(
ty³
, "[i£g]")==0è 
ISEG
;

57 ià(
	`¡rcmp
(
ty³
, "[loÿl]")==0è 
LOCAL
;

58 ià(
	`¡rcmp
(
ty³
, "[conv]")==0

59 || 
	`¡rcmp
(
ty³
, "[cÚvŞutiÚ®]")==0è 
CONVOLUTIONAL
;

60 ià(
	`¡rcmp
(
ty³
, "[deconv]")==0

61 || 
	`¡rcmp
(
ty³
, "[decÚvŞutiÚ®]")==0è 
DECONVOLUTIONAL
;

62 ià(
	`¡rcmp
(
ty³
, "[aùiv©iÚ]")==0è 
ACTIVE
;

63 ià(
	`¡rcmp
(
ty³
, "[logi¡ic]")==0è 
LOGXENT
;

64 ià(
	`¡rcmp
(
ty³
, "[l2nÜm]")==0è 
L2NORM
;

65 ià(
	`¡rcmp
(
ty³
, "[net]")==0

66 || 
	`¡rcmp
(
ty³
, "[ÃtwÜk]")==0è 
NETWORK
;

67 ià(
	`¡rcmp
(
ty³
, "[üÂ]")==0è 
CRNN
;

68 ià(
	`¡rcmp
(
ty³
, "[gru]")==0è 
GRU
;

69 ià(
	`¡rcmp
(
ty³
, "[l¡m]"è=ğ0è 
LSTM
;

70 ià(
	`¡rcmp
(
ty³
, "[ºn]")==0è 
RNN
;

71 ià(
	`¡rcmp
(
ty³
, "[conn]")==0

72 || 
	`¡rcmp
(
ty³
, "[cÚÃùed]")==0è 
CONNECTED
;

73 ià(
	`¡rcmp
(
ty³
, "[max]")==0

74 || 
	`¡rcmp
(
ty³
, "[maxpoŞ]")==0è 
MAXPOOL
;

75 ià(
	`¡rcmp
(
ty³
, "[»Üg]")==0è 
REORG
;

76 ià(
	`¡rcmp
(
ty³
, "[avg]")==0

77 || 
	`¡rcmp
(
ty³
, "[avgpoŞ]")==0è 
AVGPOOL
;

78 ià(
	`¡rcmp
(
ty³
, "[drİout]")==0è 
DROPOUT
;

79 ià(
	`¡rcmp
(
ty³
, "[lrn]")==0

80 || 
	`¡rcmp
(
ty³
, "[nÜm®iz©iÚ]")==0è 
NORMALIZATION
;

81 ià(
	`¡rcmp
(
ty³
, "[b©chnÜm]")==0è 
BATCHNORM
;

82 ià(
	`¡rcmp
(
ty³
, "[soft]")==0

83 || 
	`¡rcmp
(
ty³
, "[soámax]")==0è 
SOFTMAX
;

84 ià(
	`¡rcmp
(
ty³
, "[rou‹]")==0è 
ROUTE
;

85 ià(
	`¡rcmp
(
ty³
, "[up§m¶e]")==0è 
UPSAMPLE
;

86  
BLANK
;

87 
	}
}

89 
	$ä“_£ùiÚ
(
£ùiÚ
 *
s
)

91 
	`ä“
(
s
->
ty³
);

92 
node
 *
n
 = 
s
->
İtiÚs
->
äÚt
;

93 
n
){

94 
kvp
 *
·œ
 = (kv°*)
n
->
v®
;

95 
	`ä“
(
·œ
->
key
);

96 
	`ä“
(
·œ
);

97 
node
 *
Ãxt
 = 
n
->next;

98 
	`ä“
(
n
);

99 
n
 = 
Ãxt
;

101 
	`ä“
(
s
->
İtiÚs
);

102 
	`ä“
(
s
);

103 
	}
}

105 
	$·r£_d©a
(*
d©a
, *
a
, 
n
)

107 
i
;

108 if(!
d©a
) ;

109 *
cu¼
 = 
d©a
;

110 *
Ãxt
 = 
d©a
;

111 
dÚe
 = 0;

112 
i
 = 0; i < 
n
 && !
dÚe
; ++i){

113 *++
Ãxt
 !='\0' && *next != ',');

114 if(*
Ãxt
 =ğ'\0'è
dÚe
 = 1;

115 *
Ãxt
 = '\0';

116 
	`ssÿnf
(
cu¼
, "%g", &
a
[
i
]);

117 
cu¼
 = 
Ãxt
+1;

119 
	}
}

121 
	$cÚvŞutiÚ®_out_height
(
cÚvŞutiÚ®_Ïy”
 
l
)

123  (
l
.
h
 + 2*l.
·d
 -†.
size
è/†.
¡ride
 + 1;

124 
	}
}

126 
	$cÚvŞutiÚ®_out_width
(
cÚvŞutiÚ®_Ïy”
 
l
)

128  (
l
.
w
 + 2*l.
·d
 -†.
size
è/†.
¡ride
 + 1;

129 
	}
}

131 
size_t
 
	$g‘_wÜk¥aû_size
(
Ïy”
 
l
){

132  (
size_t
)
l
.
out_h
*l.
out_w
*l.
size
*l.size*l.
c
/l.
groups
*();

133 
	}
}

135 
	$add_bŸs
(*
ouut
, *
bŸ£s
, 
b©ch
, 
n
, 
size
)

137 
i
,
j
,
b
;

138 
b
 = 0; b < 
b©ch
; ++b){

139 
i
 = 0; i < 
n
; ++i){

140 
j
 = 0; j < 
size
; ++j){

141 
ouut
[(
b
*
n
 + 
i
)*
size
 + 
j
] +ğ
bŸ£s
[i];

145 
	}
}

147 
cÚvŞutiÚ®_Ïy”
 
	$make_cÚvŞutiÚ®_Ïy”
(
b©ch
, 
h
, 
w
, 
c
, 
n
, 
groups
, 
size
, 
¡ride
, 
·ddšg
, 
ACTIVATION
 
aùiv©iÚ
, 
b©ch_nÜm®ize
, 
bš¬y
, 
xnÜ
, 
adam
, 
šdex
)

149 
i
;

150 
Ïy”
 
l
;

151 
	`mem£t
((*)&
l
, 0, (
Ïy”
));

152 
l
.
ty³
 = 
CONVOLUTIONAL
;

154 
l
.
groups
 = groups;

155 
l
.
h
 = h;

156 
l
.
w
 = w;

157 
l
.
c
 = c;

158 
l
.
n
 =‚;

159 
l
.
bš¬y
 = binary;

160 
l
.
xnÜ
 = xnor;

161 
l
.
b©ch
 = batch;

162 
l
.
¡ride
 = stride;

163 
l
.
size
 = size;

164 
l
.
·d
 = 
·ddšg
;

165 
l
.
b©ch_nÜm®ize
 = batch_normalize;

167 
l
.
weights
 = (*)
	`ÿÎoc
(
c
/
groups
*
n
*
size
*size, ());

168 
l
.
weight_upd©es
 = (*)
	`ÿÎoc
(
c
/
groups
*
n
*
size
*size, ());

170 
l
.
bŸ£s
 = (*)
	`ÿÎoc
(
n
, ());

171 
l
.
bŸs_upd©es
 = (*)
	`ÿÎoc
(
n
, ());

173 
l
.
nweights
 = 
c
/
groups
*
n
*
size
*size;

174 
l
.
nbŸ£s
 = 
n
;

177 
sÿË
 = 
	`sq¹
(2./(
size
*size*
c
/
l
.
groups
));

181 
i
 = 0; i < 
l
.
nweights
; ++i) {

182 
l
.
weights
[
i
] = 
sÿË
*
	`¿nd_nÜm®
();

186 
out_w
 = 
	`cÚvŞutiÚ®_out_width
(
l
);

187 
out_h
 = 
	`cÚvŞutiÚ®_out_height
(
l
);

188 
l
.
out_h
 = out_h;

189 
l
.
out_w
 = out_w;

190 
l
.
out_c
 = 
n
;

191 
l
.
ouuts
 =†.
out_h
 *†.
out_w
 *†.
out_c
;

192 
l
.
šputs
 =†.
w
 *†.
h
 *†.
c
;

194 
l
.
ouut
 = (*)
	`ÿÎoc
Ö.
b©ch
*l.
ouuts
, ());

196 
l
.
d–
 = (*)
	`ÿÎoc
Ö.
b©ch
*l.
ouuts
, ());

201 
l
.
fÜw¬d
 = 
NULL
;

202 
l
.
backw¬d
 = 
NULL
;

203 
l
.
upd©e
 = 
NULL
;

204 if(
bš¬y
){

205 
l
.
bš¬y_weights
 = (*)
	`ÿÎoc
Ö.
nweights
, ());

206 
l
.
cweights
 = (*)
	`ÿÎoc
Ö.
nweights
, ());

207 
l
.
sÿËs
 = (*)
	`ÿÎoc
(
n
, ());

209 if(
xnÜ
){

210 
l
.
bš¬y_weights
 = (*)
	`ÿÎoc
Ö.
nweights
, ());

211 
l
.
bš¬y_šput
 = (*)
	`ÿÎoc
Ö.
šputs
*l.
b©ch
, ());

214 if(
b©ch_nÜm®ize
){

215 
l
.
sÿËs
 = (*)
	`ÿÎoc
(
n
, ());

216 
l
.
sÿË_upd©es
 = (*)
	`ÿÎoc
(
n
, ());

217 
i
 = 0; i < 
n
; ++i){

218 
l
.
sÿËs
[
i
] = 1;

221 
l
.
m—n
 = (*)
	`ÿÎoc
(
n
, ());

222 
l
.
v¬Ÿnû
 = (*)
	`ÿÎoc
(
n
, ());

224 
l
.
m—n_d–
 = (*)
	`ÿÎoc
(
n
, ());

225 
l
.
v¬Ÿnû_d–
 = (*)
	`ÿÎoc
(
n
, ());

227 
l
.
rŞlšg_m—n
 = (*)
	`ÿÎoc
(
n
, ());

228 
l
.
rŞlšg_v¬Ÿnû
 = (*)
	`ÿÎoc
(
n
, ());

229 
l
.
x
 = (*)
	`ÿÎoc
Ö.
b©ch
*l.
ouuts
, ());

230 
l
.
x_nÜm
 = (*)
	`ÿÎoc
Ö.
b©ch
*l.
ouuts
, ());

232 if(
adam
){

233 
l
.
m
 = (*)
	`ÿÎoc
Ö.
nweights
, ());

234 
l
.
v
 = (*)
	`ÿÎoc
Ö.
nweights
, ());

235 
l
.
bŸs_m
 = (*)
	`ÿÎoc
(
n
, ());

236 
l
.
sÿË_m
 = (*)
	`ÿÎoc
(
n
, ());

237 
l
.
bŸs_v
 = (*)
	`ÿÎoc
(
n
, ());

238 
l
.
sÿË_v
 = (*)
	`ÿÎoc
(
n
, ());

240 
l
.
wÜk¥aû_size
 = 
	`g‘_wÜk¥aû_size
(l);

241 
l
.
aùiv©iÚ
 =‡ctivation;

243 if(
šdex
 >ğ
glob®_¡¬t_šdex
)

245 
	`årštf
(
¡d”r
, "cÚv_TA%5d %2d x%2d /%2d %4d x%4d x%4d -> %4d x%4d x%4d %5.3àBFLOPs\n", 
n
, 
size
, size, 
¡ride
, 
w
, 
h
, 
c
, 
l
.
out_w
,†.
out_h
,†.
out_c
, (2.0 *†.À*†.size*l.size*l.c/l.
groups
 *†.out_h*l.out_w)/1000000000.);

247  
l
;

248 
	}
}

250 
	gdebug_num
 = 0;

300 
cÚvŞutiÚ®_Ïy”
 
	$·r£_cÚvŞutiÚ®
(
li¡
 *
İtiÚs
, 
size_·¿ms
 
·¿ms
)

302 
n
 = 
	`İtiÚ_fšd_št
(
İtiÚs
, (*)"filters",1);

303 
size
 = 
	`İtiÚ_fšd_št
(
İtiÚs
, (*)"size",1);

304 
¡ride
 = 
	`İtiÚ_fšd_št
(
İtiÚs
, (*)"stride",1);

305 
·d
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"pad",0);

306 
·ddšg
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"padding",0);

307 
groups
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"groups", 1);

308 if(
·d
è
·ddšg
 = 
size
/2;

310 *
aùiv©iÚ_s
 = 
	`İtiÚ_fšd_¡r
(
İtiÚs
, (*)"activation", (*)"logistic");

311 
ACTIVATION
 
aùiv©iÚ
 = 
	`g‘_aùiv©iÚ
(
aùiv©iÚ_s
);

312 
aùi_Ën
 = 
	`¡¾’
(
aùiv©iÚ_s
) + 1;

314 
b©ch
,
h
,
w
,
c
;

315 
h
 = 
·¿ms
.h;

316 
w
 = 
·¿ms
.w;

317 
c
 = 
·¿ms
.c;

318 
b©ch
=
·¿ms
.batch;

319 if(!(
h
 && 
w
 && 
c
)è
	`”rÜ
("Layer before convolutional†ayer must output image.");

320 
b©ch_nÜm®ize
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"batch_normalize", 0);

321 
bš¬y
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"binary", 0);

322 
xnÜ
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"xnor", 0);

324 
cÚvŞutiÚ®_Ïy”
 
Ïy”
 = 
	`make_cÚvŞutiÚ®_Ïy”
(
b©ch
,
h
,
w
,
c
,
n
,
groups
,
size
,
¡ride
,
·ddšg
,
aùiv©iÚ
, 
b©ch_nÜm®ize
, 
bš¬y
, 
xnÜ
, 
·¿ms
.
Ãt
->
adam
,…¬ams.
šdex
);

325 
Ïy”
.
æ³d
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"flipped", 0);

326 
Ïy”
.
dÙ
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"dot", 0);

328 if(
·¿ms
.
šdex
 >ğ
glob®_¡¬t_šdex
)

330 
şock_t
 
time
 = 
	`şock
();

331 
±r
;

332 
	`eÿÎ_make_cÚvŞutiÚ®_Ïy”
(
glob®_eid
, &
±r
,
b©ch
,
h
,
w
,
c
,
n
,
groups
,
size
,
¡ride
,
·ddšg
,
aùiv©iÚ_s
,
aùi_Ën
,
b©ch_nÜm®ize
, 
bš¬y
, 
xnÜ
, 
·¿ms
.
Ãt
->
adam
, 
Ïy”
.
æ³d
,†ay”.
dÙ
);

333 
	`årštf
(
¡d”r
, "\nLay”…roûs£d iÀ%à£cÚds.\n", ()(
	`şock
()-
time
)/
CLOCKS_PER_SEC
);

335  
Ïy”
;

336 
	}
}

338 
Ïy”
 
	$make_cÚÃùed_Ïy”
(
b©ch
, 
šputs
, 
ouuts
, 
ACTIVATION
 
aùiv©iÚ
, 
b©ch_nÜm®ize
, 
adam
, 
šdex
)

340 
i
;

341 
Ïy”
 
l
;

342 
	`mem£t
((*)&
l
, 0, (
Ïy”
));

343 
l
.
Ë¬nšg_¿‹_sÿË
 = 1;

344 
l
.
ty³
 = 
CONNECTED
;

346 
l
.
šputs
 = inputs;

347 
l
.
ouuts
 = outputs;

348 
l
.
b©ch
 = batch;

349 
l
.
b©ch_nÜm®ize
 = batch_normalize;

350 
l
.
h
 = 1;

351 
l
.
w
 = 1;

352 
l
.
c
 = 
šputs
;

353 
l
.
out_h
 = 1;

354 
l
.
out_w
 = 1;

355 
l
.
out_c
 = 
ouuts
;

357 
l
.
ouut
 = (*)
	`ÿÎoc
(
b©ch
*
ouuts
, ());

358 
l
.
d–
 = (*)
	`ÿÎoc
(
b©ch
*
ouuts
, ());

360 
l
.
weight_upd©es
 = (*)
	`ÿÎoc
(
šputs
*
ouuts
, ());

361 
l
.
bŸs_upd©es
 = (*)
	`ÿÎoc
(
ouuts
, ());

363 
l
.
weights
 = (*)
	`ÿÎoc
(
ouuts
*
šputs
, ());

364 
l
.
bŸ£s
 = (*)
	`ÿÎoc
(
ouuts
, ());

369 
l
.
fÜw¬d
 = 
NULL
;

370 
l
.
backw¬d
 = 
NULL
;

371 
l
.
upd©e
 = 
NULL
;

374 
sÿË
 = 
	`sq¹
(2./
šputs
);

375 
i
 = 0; i < 
ouuts
*
šputs
; ++i){

376 
l
.
weights
[
i
] = 
sÿË
*
	`¿nd_unifÜm
(-1, 1);

379 
i
 = 0; i < 
ouuts
; ++i){

380 
l
.
bŸ£s
[
i
] = 0;

383 if(
adam
){

384 
l
.
m
 = (*)
	`ÿÎoc
Ö.
šputs
*l.
ouuts
, ());

385 
l
.
v
 = (*)
	`ÿÎoc
Ö.
šputs
*l.
ouuts
, ());

386 
l
.
bŸs_m
 = (*)
	`ÿÎoc
Ö.
ouuts
, ());

387 
l
.
sÿË_m
 = (*)
	`ÿÎoc
Ö.
ouuts
, ());

388 
l
.
bŸs_v
 = (*)
	`ÿÎoc
Ö.
ouuts
, ());

389 
l
.
sÿË_v
 = (*)
	`ÿÎoc
Ö.
ouuts
, ());

391 if(
b©ch_nÜm®ize
){

392 
l
.
sÿËs
 = (*)
	`ÿÎoc
(
ouuts
, ());

393 
l
.
sÿË_upd©es
 = (*)
	`ÿÎoc
(
ouuts
, ());

394 
i
 = 0; i < 
ouuts
; ++i){

395 
l
.
sÿËs
[
i
] = 1;

398 
l
.
m—n
 = (*)
	`ÿÎoc
(
ouuts
, ());

399 
l
.
m—n_d–
 = (*)
	`ÿÎoc
(
ouuts
, ());

400 
l
.
v¬Ÿnû
 = (*)
	`ÿÎoc
(
ouuts
, ());

401 
l
.
v¬Ÿnû_d–
 = (*)
	`ÿÎoc
(
ouuts
, ());

403 
l
.
rŞlšg_m—n
 = (*)
	`ÿÎoc
(
ouuts
, ());

404 
l
.
rŞlšg_v¬Ÿnû
 = (*)
	`ÿÎoc
(
ouuts
, ());

406 
l
.
x
 = (*)
	`ÿÎoc
(
b©ch
*
ouuts
, ());

407 
l
.
x_nÜm
 = (*)
	`ÿÎoc
(
b©ch
*
ouuts
, ());

410 
l
.
aùiv©iÚ
 =‡ctivation;

412 if(
šdex
 >ğ
glob®_¡¬t_šdex
)

414 
	`årštf
(
¡d”r
, "cÚÃùed_TA %4d -> %4d\n", 
šputs
, 
ouuts
);

416  
l
;

417 
	}
}

441 
Ïy”
 
	$·r£_cÚÃùed
(
li¡
 *
İtiÚs
, 
size_·¿ms
 
·¿ms
)

443 
ouut
 = 
	`İtiÚ_fšd_št
(
İtiÚs
, (*)"output",1);

444 *
aùiv©iÚ_s
 = 
	`İtiÚ_fšd_¡r
(
İtiÚs
, (*)"activation", (*)"logistic");

445 
ACTIVATION
 
aùiv©iÚ
 = 
	`g‘_aùiv©iÚ
(
aùiv©iÚ_s
);

446 
aùi_Ën
 = 
	`¡¾’
(
aùiv©iÚ_s
) + 1;

447 
b©ch_nÜm®ize
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"batch_normalize", 0);

449 
Ïy”
 
l
 = 
	`make_cÚÃùed_Ïy”
(
·¿ms
.
b©ch
,…¬ams.
šputs
, 
ouut
, 
aùiv©iÚ
, 
b©ch_nÜm®ize
,…¬ams.
Ãt
->
adam
,…¬ams.
šdex
);

451 if(
·¿ms
.
šdex
 >ğ
glob®_¡¬t_šdex
)

453 
şock_t
 
time
 = 
	`şock
();

454 
±r
;

455 
	`eÿÎ_make_cÚÃùed_Ïy”
(
glob®_eid
, &
±r
, 
·¿ms
.
b©ch
,…¬ams.
šputs
, 
ouut
, 
aùiv©iÚ_s
, 
aùi_Ën
, 
b©ch_nÜm®ize
,…¬ams.
Ãt
->
adam
);

456 
	`årštf
(
¡d”r
, "\nLay”…roûs£d iÀ%à£cÚds.\n", ()(
	`şock
()-
time
)/
CLOCKS_PER_SEC
);

458  
l
;

459 
	}
}

461 
soámax_Ïy”
 
	$make_soámax_Ïy”
(
b©ch
, 
šputs
, 
groups
)

463 
	`as£¹
(
šputs
%
groups
 == 0);

467 
	`årštf
(
¡d”r
, "soámax_TA %4d\n", 
šputs
);

469 
Ïy”
 
l
;

470 
	`mem£t
((*)&
l
, 0, (
Ïy”
));

471 
l
.
ty³
 = 
SOFTMAX
;

472 
l
.
b©ch
 = batch;

473 
l
.
groups
 = groups;

474 
l
.
šputs
 = inputs;

475 
l
.
ouuts
 = 
šputs
;

476 
l
.
loss
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

477 
l
.
ouut
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

478 
l
.
d–
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

479 
l
.
co¡
 = (*)
	`ÿÎoc
(1, ());

483 
l
.
fÜw¬d
 = 
NULL
;

484 
l
.
backw¬d
 = 
NULL
;

486  
l
;

487 
	}
}

489 
Ïy”
 
	$·r£_soámax
(
li¡
 *
İtiÚs
, 
size_·¿ms
 
·¿ms
)

491 
groups
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"groups",1);

492 
Ïy”
 
l
 = 
	`make_soámax_Ïy”
(
·¿ms
.
b©ch
,…¬ams.
šputs
, 
groups
);

493 
l
.
‹m³¿tu»
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"temperature", 1);

494 *
Œ“_fe
 = 
	`İtiÚ_fšd_¡r
(
İtiÚs
, (*)"tree", 0);

495 ià(
Œ“_fe
è
l
.
soámax_Œ“
 = 
	`»ad_Œ“
(tree_file);

496 
l
.
w
 = 
·¿ms
.w;

497 
l
.
h
 = 
·¿ms
.h;

498 
l
.
c
 = 
·¿ms
.c;

499 
l
.
¥©Ÿl
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"spatial", 0);

500 
l
.
nŞoss
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"noloss", 0);

505 
±r
;

506 
	`eÿÎ_make_soámax_Ïy”
(
glob®_eid
, &
±r
, 
·¿ms
.
b©ch
,…¬ams.
šputs
, 
groups
, 
l
.
‹m³¿tu»
,†.
w
,†.
h
,†.
c
,†.
¥©Ÿl
,†.
nŞoss
);

509  
l
;

510 
	}
}

513 
COST_TYPE
 
	$g‘_co¡_ty³
(*
s
)

515 ià(
	`¡rcmp
(
s
, (*)"£g")==0è 
SEG
;

516 ià(
	`¡rcmp
(
s
, (*)"s£")==0è 
SSE
;

517 ià(
	`¡rcmp
(
s
, (*)"masked")==0è 
MASKED
;

518 ià(
	`¡rcmp
(
s
, (*)"smoÙh")==0è 
SMOOTH
;

519 ià(
	`¡rcmp
(
s
, (*)"L1")==0è 
L1
;

520 ià(
	`¡rcmp
(
s
, (*)"wgª")==0è 
WGAN
;

521 
	`årštf
(
¡d”r
, "Couldn'ˆfšd co¡y³ %s, gošg w™h SSE\n", 
s
);

522  
SSE
;

523 
	}
}

525 *
	$g‘_co¡_¡ršg
(
COST_TYPE
 
a
)

527 
a
){

528 
SEG
:

530 
SSE
:

532 
MASKED
:

534 
SMOOTH
:

536 
L1
:

538 
WGAN
:

542 
	}
}

544 
co¡_Ïy”
 
	$make_co¡_Ïy”
(
b©ch
, 
šputs
, 
COST_TYPE
 
co¡_ty³
, 
sÿË
, 
šdex
)

546 if(
šdex
 >ğ
glob®_¡¬t_šdex
)

548 
	`årštf
(
¡d”r
, "co¡_TA %4d\n", 
šputs
);

550 
Ïy”
 
l
;

551 
	`mem£t
((*)&
l
, 0, (
Ïy”
));

552 
l
.
ty³
 = 
COST
;

554 
l
.
sÿË
 = scale;

555 
l
.
b©ch
 = batch;

556 
l
.
šputs
 = inputs;

557 
l
.
ouuts
 = 
šputs
;

558 
l
.
co¡_ty³
 = cost_type;

559 
l
.
d–
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

560 
l
.
ouut
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

561 
l
.
co¡
 = (*)
	`ÿÎoc
(1, ());

565 
l
.
fÜw¬d
 = 
NULL
;

566 
l
.
backw¬d
 = 
NULL
;

567  
l
;

568 
	}
}

570 
co¡_Ïy”
 
	$·r£_co¡
(
li¡
 *
İtiÚs
, 
size_·¿ms
 
·¿ms
)

572 *
ty³_s
 = 
	`İtiÚ_fšd_¡r
(
İtiÚs
, (*)"type", (*)"sse");

573 
COST_TYPE
 
ty³
 = 
	`g‘_co¡_ty³
(
ty³_s
);

574 
co¡_size
 = 
	`¡¾’
(
ty³_s
) + 1;

575 
sÿË
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"scale",1);

576 
co¡_Ïy”
 
Ïy”
 = 
	`make_co¡_Ïy”
(
·¿ms
.
b©ch
,…¬ams.
šputs
, 
ty³
, 
sÿË
,…¬ams.
šdex
);

577 
Ïy”
.
¿tio
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"ratio",0);

578 
Ïy”
.
noobjeù_sÿË
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"noobj", 1);

579 
Ïy”
.
th»sh
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"thresh",0);

581 if(
·¿ms
.
šdex
 >ğ
glob®_¡¬t_šdex
)

583 
şock_t
 
time
 = 
	`şock
();

584 
±r
;

585 
	`eÿÎ_make_co¡_Ïy”
(
glob®_eid
, &
±r
, 
·¿ms
.
b©ch
,…¬ams.
šputs
, 
ty³_s
, 
co¡_size
, 
sÿË
, 
Ïy”
.
¿tio
,†ay”.
noobjeù_sÿË
,†ay”.
th»sh
);

586 
	`årštf
(
¡d”r
, "\nLay”…roûs£d iÀ%à£cÚds.\n", ()(
	`şock
()-
time
)/
CLOCKS_PER_SEC
);

589  
Ïy”
;

590 
	}
}

592 
maxpoŞ_Ïy”
 
	$make_maxpoŞ_Ïy”
(
b©ch
, 
h
, 
w
, 
c
, 
size
, 
¡ride
, 
·ddšg
, 
šdex
)

594 
Ïy”
 
l
;

595 
	`mem£t
((*)&
l
, 0, (
Ïy”
));

596 
l
.
ty³
 = 
MAXPOOL
;

597 
l
.
b©ch
 = batch;

598 
l
.
h
 = h;

599 
l
.
w
 = w;

600 
l
.
c
 = c;

601 
l
.
·d
 = 
·ddšg
;

602 
l
.
out_w
 = (
w
 + 
·ddšg
 - 
size
)/
¡ride
 + 1;

603 
l
.
out_h
 = (
h
 + 
·ddšg
 - 
size
)/
¡ride
 + 1;

604 
l
.
out_c
 = 
c
;

605 
l
.
ouuts
 =†.
out_h
 *†.
out_w
 *†.
out_c
;

606 
l
.
šputs
 = 
h
*
w
*
c
;

607 
l
.
size
 = size;

608 
l
.
¡ride
 = stride;

609 
ouut_size
 = 
l
.
out_h
 *†.
out_w
 *†.
out_c
 * 
b©ch
;

610 
l
.
šdexes
 = (*)
	`ÿÎoc
(
ouut_size
, ());

611 
l
.
ouut
 = (*)
	`ÿÎoc
(
ouut_size
, ());

612 
l
.
d–
 = (*)
	`ÿÎoc
(
ouut_size
, ());

615 
l
.
fÜw¬d
 = 
NULL
;

616 
l
.
backw¬d
 = 
NULL
;

618 if(
šdex
 >ğ
glob®_¡¬t_šdex
)

620 
	`årštf
(
¡d”r
, "max_TA %d x %d / %d %4d x%4d x%4d -> %4d x%4d x%4d\n", 
size
, size, 
¡ride
, 
w
, 
h
, 
c
, 
l
.
out_w
,†.
out_h
,†.
out_c
);

622  
l
;

623 
	}
}

625 
maxpoŞ_Ïy”
 
	$·r£_maxpoŞ
(
li¡
 *
İtiÚs
, 
size_·¿ms
 
·¿ms
)

627 
¡ride
 = 
	`İtiÚ_fšd_št
(
İtiÚs
, (*)"stride",1);

628 
size
 = 
	`İtiÚ_fšd_št
(
İtiÚs
, (*)"size",
¡ride
);

629 
·ddšg
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"·ddšg", 
size
-1);

631 
b©ch
,
h
,
w
,
c
;

632 
h
 = 
·¿ms
.h;

633 
w
 = 
·¿ms
.w;

634 
c
 = 
·¿ms
.c;

635 
b©ch
=
·¿ms
.batch;

636 if(!(
h
 && 
w
 && 
c
)è
	`”rÜ
("Layer before maxpool†ayer must output image.");

638 
maxpoŞ_Ïy”
 
Ïy”
 = 
	`make_maxpoŞ_Ïy”
(
b©ch
,
h
,
w
,
c
,
size
,
¡ride
,
·ddšg
,
·¿ms
.
šdex
);

640 if(
·¿ms
.
šdex
 >ğ
glob®_¡¬t_šdex
)

642 
şock_t
 
time
 = 
	`şock
();

643 
±r
;

644 
	`eÿÎ_make_maxpoŞ_Ïy”
(
glob®_eid
, &
±r
, 
b©ch
,
h
,
w
,
c
,
size
,
¡ride
,
·ddšg
);

645 
	`årštf
(
¡d”r
, "\nLay”…roûs£d iÀ%à£cÚds.\n", ()(
	`şock
()-
time
)/
CLOCKS_PER_SEC
);

648  
Ïy”
;

649 
	}
}

651 
drİout_Ïy”
 
	$make_drİout_Ïy”
(
b©ch
, 
šputs
, 
´obab™y
, 
šdex
)

653 
Ïy”
 
l
;

654 
	`mem£t
((*)&
l
, 0, (
Ïy”
));

655 
l
.
ty³
 = 
DROPOUT
;

656 
l
.
´obab™y
 =…robability;

657 
l
.
šputs
 = inputs;

658 
l
.
ouuts
 = 
šputs
;

659 
l
.
b©ch
 = batch;

660 
l
.
¿nd
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

661 
l
.
sÿË
 = 1./(1.-
´obab™y
);

664 
l
.
fÜw¬d
 = 
NULL
;

665 
l
.
backw¬d
 = 
NULL
;

667 if(
šdex
 >ğ
glob®_¡¬t_šdex
)

669 
	`årštf
(
¡d”r
, "drİout_TA… = %.2à %4d -> %4d\n", 
´obab™y
, 
šputs
, inputs);

671  
l
;

672 
	}
}

674 
drİout_Ïy”
 
	$·r£_drİout
(
li¡
 *
İtiÚs
, 
size_·¿ms
 
·¿ms
, *
Ãt_´ev_ouut
, *
Ãt_´ev_d–
)

676 
´obab™y
 = 
	`İtiÚ_fšd_æßt
(
İtiÚs
, (*)"probability", .5);

677 
drİout_Ïy”
 
Ïy”
 = 
	`make_drİout_Ïy”
(
·¿ms
.
b©ch
,…¬ams.
šputs
, 
´obab™y
,…¬ams.
šdex
);

678 
Ïy”
.
out_w
 = 
·¿ms
.
w
;

679 
Ïy”
.
out_h
 = 
·¿ms
.
h
;

680 
Ïy”
.
out_c
 = 
·¿ms
.
c
;

682 
Ïy”
.
ouut
 = 
Ãt_´ev_ouut
;

683 
Ïy”
.
d–
 = 
Ãt_´ev_d–
;

685 if(
·¿ms
.
šdex
 >ğ
glob®_¡¬t_šdex
)

687 
şock_t
 
time
 = 
	`şock
();

688 
±r
;

689 
	`eÿÎ_make_drİout_Ïy”
(
glob®_eid
, &
±r
, 
·¿ms
.
b©ch
,…¬ams.
šputs
, 
´obab™y
,…¬ams.
w
,…¬ams.
h
,…¬ams.
c
, 
Ãt_´ev_ouut
, ()*·¿ms.šputs*·¿ms.b©ch, 
Ãt_´ev_d–
, ()*params.inputs*params.batch);

690 
	`årštf
(
¡d”r
, "\nLay”…roûs£d iÀ%à£cÚds.\n", ()(
	`şock
()-
time
)/
CLOCKS_PER_SEC
);

693  
Ïy”
;

694 
	}
}

696 
avgpoŞ_Ïy”
 
	$make_avgpoŞ_Ïy”
(
b©ch
, 
w
, 
h
, 
c
, 
šdex
)

698 if(
šdex
 >ğ
glob®_¡¬t_šdex
)

700 
	`årštf
(
¡d”r
, "avg %4d x%4d x%4d -> %4d\n", 
w
, 
h
, 
c
, c);

702 
Ïy”
 
l
;

703 
	`mem£t
((*)&
l
, 0, (
Ïy”
));

704 
l
.
ty³
 = 
AVGPOOL
;

705 
l
.
b©ch
 = batch;

706 
l
.
h
 = h;

707 
l
.
w
 = w;

708 
l
.
c
 = c;

709 
l
.
out_w
 = 1;

710 
l
.
out_h
 = 1;

711 
l
.
out_c
 = 
c
;

712 
l
.
ouuts
 =†.
out_c
;

713 
l
.
šputs
 = 
h
*
w
*
c
;

714 
ouut_size
 = 
l
.
ouuts
 * 
b©ch
;

715 
l
.
ouut
 = (*)
	`ÿÎoc
(
ouut_size
, ());

716 
l
.
d–
 = (*)
	`ÿÎoc
(
ouut_size
, ());

717 
l
.
fÜw¬d
 = 
NULL
;

718 
l
.
backw¬d
 = 
NULL
;

719  
l
;

720 
	}
}

722 
avgpoŞ_Ïy”
 
	$·r£_avgpoŞ
(
li¡
 *
İtiÚs
, 
size_·¿ms
 
·¿ms
)

724 
b©ch
,
w
,
h
,
c
;

725 
w
 = 
·¿ms
.w;

726 
h
 = 
·¿ms
.h;

727 
c
 = 
·¿ms
.c;

728 
b©ch
=
·¿ms
.batch;

729 if(!(
h
 && 
w
 && 
c
)è
	`”rÜ
("Layer before‡vgpool†ayer must output image.");

731 
avgpoŞ_Ïy”
 
Ïy”
 = 
	`make_avgpoŞ_Ïy”
(
b©ch
,
w
,
h
,
c
,
·¿ms
.
šdex
);

733 if(
·¿ms
.
šdex
 >ğ
glob®_¡¬t_šdex
)

735 
şock_t
 
time
 = 
	`şock
();

736 
±r
;

737 
	`eÿÎ_make_avgpoŞ_Ïy”
(
glob®_eid
, &
±r
, 
b©ch
, 
w
, 
h
, 
c
);

738 
	`årštf
(
¡d”r
, "\nLay”…roûs£d iÀ%à£cÚds.\n", ()(
	`şock
()-
time
)/
CLOCKS_PER_SEC
);

741  
Ïy”
;

742 
	}
}

744 
Ë¬nšg_¿‹_pŞicy
 
	$g‘_pŞicy
(*
s
)

746 ià(
	`¡rcmp
(
s
, (*)"¿ndom")==0è 
RANDOM
;

747 ià(
	`¡rcmp
(
s
, (*)"pŞy")==0è 
POLY
;

748 ià(
	`¡rcmp
(
s
, (*)"cÚ¡ªt")==0è 
CONSTANT
;

749 ià(
	`¡rcmp
(
s
, (*)"¡•")==0è 
STEP
;

750 ià(
	`¡rcmp
(
s
, (*)"exp")==0è 
EXP
;

751 ià(
	`¡rcmp
(
s
, (*)"sigmoid")==0è 
SIG
;

752 ià(
	`¡rcmp
(
s
, (*)"¡•s")==0è 
STEPS
;

753 
	`årštf
(
¡d”r
, "Couldn'ˆfšd…Şicy %s, gošg w™h cÚ¡ªt\n", 
s
);

754  
CONSTANT
;

755 
	}
}

757 
	$·r£_Ãt_İtiÚs
(
li¡
 *
İtiÚs
, 
ÃtwÜk
 *
Ãt
)

759 
Ãt
->
b©ch
 = 
	`İtiÚ_fšd_št
(
İtiÚs
, (*)"batch", 1);

761 
Ãt
->
b©ch
 = 1;

763 
Ãt
->
Ë¬nšg_¿‹
 = 
	`İtiÚ_fšd_æßt
(
İtiÚs
, (*)"learning_rate", .001);

764 
Ãt
->
mom’tum
 = 
	`İtiÚ_fšd_æßt
(
İtiÚs
, (*)"momentum", .9);

765 
Ãt
->
deÿy
 = 
	`İtiÚ_fšd_æßt
(
İtiÚs
, (*)"decay", .0001);

766 
subdivs
 = 
	`İtiÚ_fšd_št
(
İtiÚs
, (*)"subdivisions",1);

767 
Ãt
->
time_¡•s
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"time_steps",1);

768 
Ãt
->
nÙruth
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"notruth",0);

769 
Ãt
->
b©ch
 /ğ
subdivs
;

770 
Ãt
->
b©ch
 *ğÃt->
time_¡•s
;

771 
Ãt
->
subdivisiÚs
 = 
subdivs
;

772 
Ãt
->
¿ndom
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"random", 0);

774 
Ãt
->
adam
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"adam", 0);

775 if(
Ãt
->
adam
){

776 
Ãt
->
B1
 = 
	`İtiÚ_fšd_æßt
(
İtiÚs
, (*)"B1", .9);

777 
Ãt
->
B2
 = 
	`İtiÚ_fšd_æßt
(
İtiÚs
, (*)"B2", .999);

778 
Ãt
->
•s
 = 
	`İtiÚ_fšd_æßt
(
İtiÚs
, (*)"eps", .0000001);

781 
Ãt
->
h
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"height",0);

782 
Ãt
->
w
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"width",0);

783 
Ãt
->
c
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"channels",0);

784 
Ãt
->
šputs
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"šputs",‚‘->
h
 *‚‘->
w
 *‚‘->
c
);

785 
Ãt
->
max_üİ
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"max_üİ",Ãt->
w
*2);

786 
Ãt
->
mš_üİ
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"mš_üİ",Ãt->
w
);

787 
Ãt
->
max_¿tio
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"max_¿tio", (èÃt->
max_üİ
 /‚‘->
w
);

788 
Ãt
->
mš_¿tio
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"mš_¿tio", (èÃt->
mš_üİ
 /‚‘->
w
);

789 
Ãt
->
ûÁ”
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"center",0);

790 
Ãt
->
ş
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"clip", 0);

792 
Ãt
->
ªgË
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"angle", 0);

793 
Ãt
->
a¥eù
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"aspect", 1);

794 
Ãt
->
§tu¿tiÚ
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"saturation", 1);

795 
Ãt
->
exposu»
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"exposure", 1);

796 
Ãt
->
hue
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"hue", 0);

798 if(!
Ãt
->
šputs
 && !Ò‘->
h
 &&‚‘->
w
 &&‚‘->
c
)è
	`”rÜ
("No input…arameters supplied");

800 *
pŞicy_s
 = 
	`İtiÚ_fšd_¡r
(
İtiÚs
, (*)"policy", (*)"constant");

801 
Ãt
->
pŞicy
 = 
	`g‘_pŞicy
(
pŞicy_s
);

802 
Ãt
->
buº_š
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"burn_in", 0);

803 
Ãt
->
pow”
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"power", 4);

804 if(
Ãt
->
pŞicy
 =ğ
STEP
){

805 
Ãt
->
¡•
 = 
	`İtiÚ_fšd_št
(
İtiÚs
, (*)"step", 1);

806 
Ãt
->
sÿË
 = 
	`İtiÚ_fšd_æßt
(
İtiÚs
, (*)"scale", 1);

807 } ià(
Ãt
->
pŞicy
 =ğ
STEPS
){

808 *
l
 = 
	`İtiÚ_fšd
(
İtiÚs
, (*)"steps");

809 *
p
 = 
	`İtiÚ_fšd
(
İtiÚs
, (*)"scales");

810 if(!
l
 || !
p
è
	`”rÜ
("STEPS…olicy must have steps‡nd scales in cfg file");

812 
Ën
 = 
	`¡¾’
(
l
);

813 
n
 = 1;

814 
i
;

815 
i
 = 0; i < 
Ën
; ++i){

816 ià(
l
[
i
] =ğ','è++
n
;

818 *
¡•s
 = (*)
	`ÿÎoc
(
n
, ());

819 *
sÿËs
 = (*)
	`ÿÎoc
(
n
, ());

820 
i
 = 0; i < 
n
; ++i){

821 
¡•
 = 
	`©oi
(
l
);

822 
sÿË
 = 
	`©of
(
p
);

823 
l
 = 
	`¡rchr
(l, ',')+1;

824 
p
 = 
	`¡rchr
(p, ',')+1;

825 
¡•s
[
i
] = 
¡•
;

826 
sÿËs
[
i
] = 
sÿË
;

828 
Ãt
->
sÿËs
 = scales;

829 
Ãt
->
¡•s
 = steps;

830 
Ãt
->
num_¡•s
 = 
n
;

831 } ià(
Ãt
->
pŞicy
 =ğ
EXP
){

832 
Ãt
->
gamma
 = 
	`İtiÚ_fšd_æßt
(
İtiÚs
, (*)"gamma", 1);

833 } ià(
Ãt
->
pŞicy
 =ğ
SIG
){

834 
Ãt
->
gamma
 = 
	`İtiÚ_fšd_æßt
(
İtiÚs
, (*)"gamma", 1);

835 
Ãt
->
¡•
 = 
	`İtiÚ_fšd_št
(
İtiÚs
, (*)"step", 1);

836 } ià(
Ãt
->
pŞicy
 =ğ
POLY
 ||‚‘->pŞicy =ğ
RANDOM
){

838 
Ãt
->
max_b©ches
 = 
	`İtiÚ_fšd_št
(
İtiÚs
, (*)"max_batches", 0);

840 
±r
;

841 
num_Ïy”s
 = 
Ãt
->
n
 - 
glob®_¡¬t_šdex
 - 1;

842 
	`eÿÎ_make_ÃtwÜk
(
glob®_eid
, &
±r
, 
num_Ïy”s
, 
Ãt
->
Ë¬nšg_¿‹
,‚‘->
mom’tum
,‚‘->
deÿy
,‚‘->
time_¡•s
,‚‘->
nÙruth
,‚‘->
b©ch
,‚‘->
subdivisiÚs
,‚‘->
¿ndom
,‚‘->
adam
,‚‘->
B1
,‚‘->
B2
,‚‘->
•s
,‚‘->
h
,‚‘->
w
,‚‘->
c
,‚‘->
šputs
,‚‘->
max_üİ
,‚‘->
mš_üİ
,‚‘->
max_¿tio
,‚‘->
mš_¿tio
,‚‘->
ûÁ”
,‚‘->
ş
,‚‘->
ªgË
,‚‘->
a¥eù
,‚‘->
§tu¿tiÚ
,‚‘->
exposu»
,‚‘->
hue
,‚‘->
buº_š
,‚‘->
pow”
,‚‘->
max_b©ches
, 
glob®_¡¬t_šdex
);

843 
	}
}

845 
	$is_ÃtwÜk
(
£ùiÚ
 *
s
)

847  (
	`¡rcmp
(
s
->
ty³
, (*)"[net]")==0

848 || 
	`¡rcmp
(
s
->
ty³
, (*)"[network]")==0);

849 
	}
}

851 
ÃtwÜk
 *
	$·r£_ÃtwÜk_cfg
(*
f’ame
)

853 
li¡
 *
£ùiÚs
 = 
	`»ad_cfg
(
f’ame
);

854 
node
 *
n
 = 
£ùiÚs
->
äÚt
;

855 if(!
n
è
	`”rÜ
("Config file has‚o sections");

856 
ÃtwÜk
 *
Ãt
 = 
	`make_ÃtwÜk
(
£ùiÚs
->
size
 - 1);

859 
Ãt
->
gpu_šdex
 = -1;

860 
size_·¿ms
 
·¿ms
;

862 
£ùiÚ
 *
s
 = (£ùiÚ *)
n
->
v®
;

863 
li¡
 *
İtiÚs
 = 
s
->options;

864 if(!
	`is_ÃtwÜk
(
s
)è
	`”rÜ
("First section must be [net] or [network]");

865 
	`·r£_Ãt_İtiÚs
(
İtiÚs
, 
Ãt
);

867 
·¿ms
.
h
 = 
Ãt
->h;

868 
·¿ms
.
w
 = 
Ãt
->w;

869 
·¿ms
.
c
 = 
Ãt
->c;

870 
·¿ms
.
šputs
 = 
Ãt
->inputs;

871 
·¿ms
.
b©ch
 = 
Ãt
->batch;

872 
·¿ms
.
time_¡•s
 = 
Ãt
->time_steps;

873 
·¿ms
.
Ãt
 =‚et;

875 
size_t
 
wÜk¥aû_size
 = 0;

876 
n
 =‚->
Ãxt
;

877 
couÁ
 = 0;

878 
	`ä“_£ùiÚ
(
s
);

879 
	`årštf
(
¡d”r
, "layer filters size input output\n");

881 
n
){

882 
·¿ms
.
šdex
 = 
couÁ
;

883 if((
couÁ
 >ğ
glob®_¡¬t_šdex
è&& (couÁ < 
Ãt
->
n
 - 1))

885 
	`årštf
(
¡d”r
, "%5d ", 
couÁ
);

887 
s
 = (
£ùiÚ
 *)
n
->
v®
;

888 
İtiÚs
 = 
s
->options;

889 
Ïy”
 
l
;

890 
	`mem£t
((*)&
l
, 0, (
Ïy”
));

891 
LAYER_TYPE
 
É
 = 
	`¡ršg_to_Ïy”_ty³
(
s
->
ty³
);

893 if(
É
 =ğ
CONVOLUTIONAL
){

894 
l
 = 
	`·r£_cÚvŞutiÚ®
(
İtiÚs
, 
·¿ms
);

895 }if(
É
 =ğ
CONNECTED
){

896 
l
 = 
	`·r£_cÚÃùed
(
İtiÚs
, 
·¿ms
);

897 }if(
É
 =ğ
COST
){

898 
l
 = 
	`·r£_co¡
(
İtiÚs
, 
·¿ms
);

899 }if(
É
 =ğ
SOFTMAX
){

900 
l
 = 
	`·r£_soámax
(
İtiÚs
, 
·¿ms
);

901 
Ãt
->
h›¿rchy
 = 
l
.
soámax_Œ“
;

902 }if(
É
 =ğ
MAXPOOL
){

903 
l
 = 
	`·r£_maxpoŞ
(
İtiÚs
, 
·¿ms
);

904 }if(
É
 =ğ
DROPOUT
){

905 
l
 = 
	`·r£_drİout
(
İtiÚs
, 
·¿ms
, 
Ãt
->
Ïy”s
[
couÁ
-1].
ouut
,‚‘->Ïy”s[couÁ-1].
d–
);

906 }if(
É
 =ğ
AVGPOOL
){

907 
l
 = 
	`·r£_avgpoŞ
(
İtiÚs
, 
·¿ms
);

909 
	`årštf
(
¡d”r
, "Ty³‚Ù„ecognized: %s\n", 
s
->
ty³
);

911 
l
.
ş
 = 
Ãt
->clip;

912 
l
.
Œuth
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"truth", 0);

913 
l
.
ÚlyfÜw¬d
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"onlyforward", 0);

914 
l
.
¡İbackw¬d
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"stopbackward", 0);

915 
l
.
dÚt§ve
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"dontsave", 0);

916 
l
.
dÚßd
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"dontload", 0);

917 
l
.
numlßd
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"numload", 0);

918 
l
.
dÚßdsÿËs
 = 
	`İtiÚ_fšd_št_qu›t
(
İtiÚs
, (*)"dontloadscales", 0);

919 
l
.
Ë¬nšg_¿‹_sÿË
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"learning_rate", 1);

920 
l
.
smoÙh
 = 
	`İtiÚ_fšd_æßt_qu›t
(
İtiÚs
, (*)"smooth", 0);

921 
	`İtiÚ_unu£d
(
İtiÚs
);

923 
Ãt
->
Ïy”s
[
couÁ
] = 
l
;

925 ià(
l
.
wÜk¥aû_size
 > workspace_size) workspace_size =†.workspace_size;

926 
	`ä“_£ùiÚ
(
s
);

927 
n
 =‚->
Ãxt
;

928 ++
couÁ
;

929 
couÁ_glob®
 = 
couÁ
;

931 if(
n
){

932 
·¿ms
.
h
 = 
l
.
out_h
;

933 
·¿ms
.
w
 = 
l
.
out_w
;

934 
·¿ms
.
c
 = 
l
.
out_c
;

935 
·¿ms
.
šputs
 = 
l
.
ouuts
;

939 
	`ä“_li¡
(
£ùiÚs
);

940 
Ïy”
 
out
 = 
	`g‘_ÃtwÜk_ouut_Ïy”
(
Ãt
);

941 
Ãt
->
ouuts
 = 
out
.outputs;

942 
Ãt
->
Œuths
 = 
out
.
ouuts
;

943 if(
Ãt
->
Ïy”s
[Ãt->
n
-1].
Œuths
)‚et->truths =‚et->layers[net->n-1].truths;

944 
Ãt
->
ouut
 = 
out
.output;

945 
Ãt
->
šput
 = (*)
	`ÿÎoc
Ò‘->
šputs
*Ãt->
b©ch
, ());

946 
Ãt
->
Œuth
 = (*)
	`ÿÎoc
Ò‘->
Œuths
*Ãt->
b©ch
, ());

947 if(
wÜk¥aû_size
){

948 
±r
;

949 
Ãt
->
wÜk¥aû
 = (*)
	`ÿÎoc
(1, 
wÜk¥aû_size
);

950 
	`eÿÎ_®loÿ‹_wÜk¥aû
(
glob®_eid
, &
±r
, 
wÜk¥aû_size
);

954  
Ãt
;

955 
	}
}

958 
li¡
 *
	$»ad_cfg
(*
f’ame
)

960 
FILE
 *
fe
 = 
	`fİ’
(
f’ame
, "r");

961 if(
fe
 =ğ0è
	`fe_”rÜ
(
f’ame
);

962 *
lše
;

963 
nu
 = 0;

964 
li¡
 *
İtiÚs
 = 
	`make_li¡
();

965 
£ùiÚ
 *
cu¼’t
 = 0;

966 (
lše
=
	`fg‘l
(
fe
)) != 0){

967 ++ 
nu
;

968 
	`¡r
(
lše
);

969 
lše
[0]){

971 
cu¼’t
 = (
£ùiÚ
 *)
	`m®loc
((section));

972 
	`li¡_š£¹
(
İtiÚs
, 
cu¼’t
);

973 
cu¼’t
->
İtiÚs
 = 
	`make_li¡
();

974 
cu¼’t
->
ty³
 = 
lše
;

979 
	`ä“
(
lše
);

982 if(!
	`»ad_İtiÚ
(
lše
, 
cu¼’t
->
İtiÚs
)){

983 
	`årštf
(
¡d”r
, "CÚfig f”rÜ†š%d, could…¬£: %s\n", 
nu
, 
lše
);

984 
	`ä“
(
lše
);

989 
	`fşo£
(
fe
);

990  
İtiÚs
;

991 
	}
}

1048 
	$Œª¥o£_m©rix
(*
a
, 
rows
, 
cŞs
)

1050 *
Œª¥o£
 = (*)
	`ÿÎoc
(
rows
*
cŞs
, ());

1051 
x
, 
y
;

1052 
x
 = 0; x < 
rows
; ++x){

1053 
y
 = 0; y < 
cŞs
; ++y){

1054 
Œª¥o£
[
y
*
rows
 + 
x
] = 
a
[x*
cŞs
 + y];

1057 
	`memıy
(
a
, 
Œª¥o£
, 
rows
*
cŞs
*());

1058 
	`ä“
(
Œª¥o£
);

1059 
	}
}

1062 
	$lßd_cÚÃùed_weights_comm
(
Ïy”
 
l
, 
FILE
 *
å
, 
i
, 
Œª¥o£
)

1064 
	`ä—d
(
l
.
bŸ£s
, (),†.
ouuts
, 
å
);

1065 
	`ä—d
(
l
.
weights
, (),†.
ouuts
*l.
šputs
, 
å
);

1067 
±r
;

1068 if(
i
 >ğ
glob®_¡¬t_šdex
)

1070 
	`eÿÎ_Œªsãr_weights
(
glob®_eid
, &
±r
, 
l
.
bŸ£s
,†.
ouuts
*(), 
i
, 'b', 0);

1071 
	`eÿÎ_Œªsãr_weights
(
glob®_eid
, &
±r
, 
l
.
weights
,†.
ouuts
*l.
šputs
*(), 
i
, 'w', 
Œª¥o£
);

1074 ià(
l
.
b©ch_nÜm®ize
 && (!l.
dÚßdsÿËs
)){

1075 
	`ä—d
(
l
.
sÿËs
, (),†.
ouuts
, 
å
);

1076 
	`ä—d
(
l
.
rŞlšg_m—n
, (),†.
ouuts
, 
å
);

1077 
	`ä—d
(
l
.
rŞlšg_v¬Ÿnû
, (),†.
ouuts
, 
å
);

1079 if(
i
 >ğ
glob®_¡¬t_šdex
)

1081 
	`eÿÎ_Œªsãr_weights
(
glob®_eid
, &
±r
, 
l
.
sÿËs
,†.
ouuts
*(), 
i
, 's', 0);

1082 
	`eÿÎ_Œªsãr_weights
(
glob®_eid
, &
±r
, 
l
.
rŞlšg_m—n
,†.
ouuts
*(), 
i
, 'm', 0);

1083 
	`eÿÎ_Œªsãr_weights
(
glob®_eid
, &
±r
, 
l
.
rŞlšg_v¬Ÿnû
,†.
ouuts
*(), 
i
, 'v', 0);

1086 
	}
}

1088 
	$lßd_cÚvŞutiÚ®_weights_comm
(
Ïy”
 
l
, 
FILE
 *
å
, 
i
)

1090 if(
l
.
numlßd
èl.
n
 =†.numload;

1091 
num
 = 
l
.
c
/l.
groups
*l.
n
*l.
size
*l.size;

1092 
±r
;

1094 
	`ä—d
(
l
.
bŸ£s
, (),†.
n
, 
å
);

1095 if(
i
 >ğ
glob®_¡¬t_šdex
)

1097 
	`eÿÎ_Œªsãr_weights
(
glob®_eid
, &
±r
, 
l
.
bŸ£s
,†.
n
*(), 
i
, 'b', 0);

1100 ià(
l
.
b©ch_nÜm®ize
 && (!l.
dÚßdsÿËs
)){

1101 
	`ä—d
(
l
.
sÿËs
, (),†.
n
, 
å
);

1102 
	`ä—d
(
l
.
rŞlšg_m—n
, (),†.
n
, 
å
);

1103 
	`ä—d
(
l
.
rŞlšg_v¬Ÿnû
, (),†.
n
, 
å
);

1105 if(
i
 >ğ
glob®_¡¬t_šdex
)

1107 
	`eÿÎ_Œªsãr_weights
(
glob®_eid
, &
±r
, 
l
.
sÿËs
,†.
n
*(), 
i
, 's', 0);

1108 
	`eÿÎ_Œªsãr_weights
(
glob®_eid
, &
±r
, 
l
.
rŞlšg_m—n
,†.
n
*(), 
i
, 'm', 0);

1109 
	`eÿÎ_Œªsãr_weights
(
glob®_eid
, &
±r
, 
l
.
rŞlšg_v¬Ÿnû
,†.
n
*(), 
i
, 'v', 0);

1113 
	`ä—d
(
l
.
weights
, (), 
num
, 
å
);

1114 if(
i
 >ğ
glob®_¡¬t_šdex
)

1116 
	`eÿÎ_Œªsãr_weights
(
glob®_eid
, &
±r
, 
l
.
weights
, 
num
*(), 
i
, 'w', 0);

1118 
	}
}

1121 
	$lßd_weights_u±o
(
ÃtwÜk
 *
Ãt
, *
f’ame
, 
¡¬t
, 
cutoff
)

1123 
	`årštf
(
¡d”r
, "Lßdšg weight äom %s...", 
f’ame
);

1124 
	`fæush
(
¡dout
);

1125 
FILE
 *
å
 = 
	`fİ’
(
f’ame
, "rb");

1126 if(!
å
è
	`fe_”rÜ
(
f’ame
);

1128 
majÜ
;

1129 
mšÜ
;

1130 
»visiÚ
;

1131 
	`ä—d
(&
majÜ
, (), 1, 
å
);

1132 
	`ä—d
(&
mšÜ
, (), 1, 
å
);

1133 
	`ä—d
(&
»visiÚ
, (), 1, 
å
);

1134 ià((
majÜ
*10 + 
mšÜ
) >= 2 && major < 1000 && minor < 1000){

1135 
	`ä—d
(
Ãt
->
£’
, (
size_t
), 1, 
å
);

1137 
i£’
 = 0;

1138 
	`ä—d
(&
i£’
, (), 1, 
å
);

1139 *
Ãt
->
£’
 = 
i£’
;

1141 
Œª¥o£
 = (
majÜ
 > 1000è|| (
mšÜ
 > 1000);

1143 
i
;

1145 
şock_t
 
time
 = 
	`şock
();

1146 
i
 = 
¡¬t
; i < 
Ãt
->
n
 && i < 
cutoff
; ++i){

1149 
Ïy”
 
l
 = 
Ãt
->
Ïy”s
[
i
];

1152 ià(
l
.
dÚßd
) ;

1153 if(
l
.
ty³
 =ğ
CONVOLUTIONAL
 ||†.ty³ =ğ
DECONVOLUTIONAL
){

1154 
	`lßd_cÚvŞutiÚ®_weights_comm
(
l
, 
å
, 
i
);

1156 if(
l
.
ty³
 =ğ
CONNECTED
){

1157 
	`lßd_cÚÃùed_weights_comm
(
l
, 
å
, 
i
, 
Œª¥o£
);

1161 
	`årštf
(
¡d”r
, "Done!\n");

1162 
	`årštf
(
¡d”r
, "Weight lßded iÀ%à£cÚds.\n", ()(
	`şock
()-
time
)/
CLOCKS_PER_SEC
);

1163 
	`fşo£
(
å
);

1164 
	}
}

1166 
	$lßd_weights
(
ÃtwÜk
 *
Ãt
, *
f’ame
)

1168 
	`lßd_weights_u±o
(
Ãt
, 
f’ame
, 0,‚‘->
n
-1);

1169 
	}
}

	@App/parser.h

1 #iâdeà
PARSER_H


2 
	#PARSER_H


	)

3 
	~"d¬kÃt.h
"

4 
	~"ÃtwÜk.h
"

6 
couÁ_glob®
;

7 
glob®_dp
;

8 
glob®_¡¬t_šdex
;

	@App/socket_api.h

2 
	~<¡dio.h
>

3 
	~<¡dlib.h
>

4 
	~<¡dboŞ.h
>

5 
	~<¡ršg.h
>

6 
	~<sys/sock‘.h
>

7 
	~<¬·/š‘.h
>

8 
	~<uni¡d.h
>

9 
	~<sys/time.h
>

10 
	~<sys/»sourû.h
>

11 
	~<sys/ty³s.h
>

12 
	~<sys/¡©.h
>

13 
	~<time.h
>

15 
	#mš
(
X
,
Y
è(((Xè< (Y)è? (Xè: (Y))

	)

16 
	#max
(
X
,
Y
è(((Xè> (Y)è? (Xè: (Y))

	)

18 
fšd_št_¬g
(
¬gc
, **
¬gv
, *
¬g
, 
def
);

19 
d–_¬g
(
¬gc
, **
¬gv
, 
šdex
);

22 
Sock‘_Cl›Á
(*
f’ame
, *
f’ame1
, 
pÜt
);

23 
Sock‘C»©e_Cl›Á
();

24 
Sock‘CÚÃù
(
hSock‘
, 
pÜt
);

27 
boŞ
 
£ndfe
(
sock
, 
FILE
 *
f
);

28 
boŞ
 
£ndlÚg
(
sock
, 
v®ue
);

29 
boŞ
 
£ndd©a
(
sock
, *
buf
, 
buæ’
);

32 
Sock‘_S”v”
(*
f’ame
, *
fesize
, *
g
, *
g_size
, 
şock_t
 *
time
, 
pÜt
, 
mode
);

33 
BšdC»©edSock‘
(
hSock‘
, 
pÜt
);

34 
boŞ
 
»add©a
(
sock
, *
buf
, 
buæ’
);

35 
boŞ
 
»adlÚg
(
sock
, *
v®ue
);

36 
boŞ
 
»adfe
(
sock
, 
FILE
 *
f
, FILE *
f1
);

	@App/socket_client.cpp

4 
	~"sock‘_­i.h
"

6 
	#MAX
 1024

	)

9 
	$Sock‘C»©e_Cl›Á
()

11 
hSock‘
;

12 
	`´štf
("Createhe socket\n");

13 
hSock‘
 = 
	`sock‘
(
AF_INET
, 
SOCK_STREAM
, 0);

14  
hSock‘
;

15 
	}
}

18 
	$Sock‘CÚÃù
(
hSock‘
, 
pÜt
)

20 
iR‘v®
=-1;

22 
S”v”PÜt
 = 
pÜt
;

23 
sockaddr_š
 
»mÙe
= {0};

24 
»mÙe
.
sš_addr
.
s_addr
 = 
	`š‘_addr
("169.254.232.180");

25 
»mÙe
.
sš_çmy
 = 
AF_INET
;

26 
»mÙe
.
sš_pÜt
 = 
	`htÚs
(
S”v”PÜt
);

27 
iR‘v®
 = 
	`cÚÃù
(
hSock‘
,(
sockaddr
 *)&
»mÙe
,(
sockaddr_š
));

28  
iR‘v®
;

29 
	}
}

57 
boŞ
 
	$£ndd©a
(
sock
, *
buf
, 
buæ’
)

59 *
pbuf
 = (*)
buf
;

60 
tÙ®_by‹s_£Á
 = 0;

62 
buæ’
 > 0)

64 
num
 = 
	`£nd
(
sock
, 
pbuf
, 
buæ’
, 0);

65 ià(
num
 < 0)

72  
çl£
;

75 
pbuf
 +ğ
num
;

76 
buæ’
 -ğ
num
;

77 
tÙ®_by‹s_£Á
 +ğ
num
;

78 
	`´štf
("TÙ® By‹ S’ˆ: %d\n",
tÙ®_by‹s_£Á
);

80  
Œue
;

81 
	}
}

83 
boŞ
 
	$£ndlÚg
(
sock
, 
v®ue
)

85 
v®ue
 = 
	`htÚl
(value);

86  
	`£ndd©a
(
sock
, &
v®ue
, (value));

87 
	}
}

89 
boŞ
 
	$£ndfe
(
sock
, 
FILE
 *
f
)

91 
	`f£ek
(
f
, 0, 
SEEK_END
);

92 
fesize
 = 
	`á–l
(
f
);

93 
	`»wšd
(
f
);

94 ià(
fesize
 =ğ
EOF
)

95  
çl£
;

96 ià(!
	`£ndlÚg
(
sock
, 
fesize
))

97  
çl£
;

98 ià(
fesize
 > 0)

100 
bufãr
[
MAX
];

103 
size_t
 
num
 = 
	`mš
(
fesize
, (
bufãr
));

104 
num
 = 
	`ä—d
(
bufãr
, 1,‚um, 
f
);

105 ià(
num
 < 1)

106  
çl£
;

107 ià(!
	`£ndd©a
(
sock
, 
bufãr
, 
num
))

108  
çl£
;

109 
fesize
 -ğ
num
;

111 
fesize
 > 0);

113  
Œue
;

114 
	}
}

116 
	$Sock‘_Cl›Á
(*
f’ame
, *
f’ame1
, 
pÜt
)

118 
hSock‘
;

124 if(
f’ame
 =ğ
NULL
 || 
f’ame1
 == NULL)

126 
	`´štf
("\nIncorrect filename\n\n");

131 
FILE
 *
å
;

132 
å
 = 
	`fİ’
(
f’ame
,"rb");

133 ifĞ
å
 =ğ
NULL
 )

135 
	`´štf
("Error IN Opening File .. \n");

139 
FILE
 *
å1
;

140 
å1
 = 
	`fİ’
(
f’ame1
,"rb");

141 ifĞ
å1
 =ğ
NULL
 )

143 
	`´štf
("Error IN Opening File .. \n");

148 
hSock‘
 = 
	`Sock‘C»©e_Cl›Á
();

149 if(
hSock‘
 == -1)

151 
	`´štf
("Could‚ot create socket\n");

154 
	`´štf
("Socket is created\n");

157 
»u£
 = 1;

158 ià(
	`£tsockİt
(
hSock‘
, 
SOL_SOCKET
, 
SO_REUSEADDR
, (cÚ¡ *)&
»u£
, (reuse)) < 0)

159 
	`³¼Ü
("setsockopt(SO_REUSEADDR) failed");

161 ià(
	`£tsockİt
(
hSock‘
, 
SOL_SOCKET
, 
SO_REUSEPORT
, (cÚ¡ *)&
»u£
, (reuse)) < 0)

162 
	`³¼Ü
("setsockopt(SO_REUSEPORT) failed");

173 ià(
	`Sock‘CÚÃù
(
hSock‘
, 
pÜt
) < 0)

175 
	`³¼Ü
("connect failed.\n");

178 
	`´štf
("Sucessfully conected with server\n");

183 if(
	`£ndfe
(
hSock‘
, 
å
è=ğ
çl£
)

185 
	`´štf
("File Send failed\n");

190 if(
	`£ndfe
(
hSock‘
, 
å1
è=ğ
çl£
)

192 
	`´štf
("File Send failed\n");

197 
	`şo£
(
hSock‘
);

198 
	`shutdown
(
hSock‘
,0);

199 
	`shutdown
(
hSock‘
,1);

200 
	`shutdown
(
hSock‘
,2);

201 
	`fşo£
 (
å
);

202 
	`fşo£
 (
å1
);

203 
	`¦“p
(1);

205 
	}
}

	@App/socket_server.cpp

4 
	~"sock‘_­i.h
"

6 
	$Sock‘C»©e
()

8 
hSock‘
;

9 
	`´štf
("Createhe socket\n");

10 
hSock‘
 = 
	`sock‘
(
AF_INET
, 
SOCK_STREAM
, 0);

11  
hSock‘
;

12 
	}
}

14 
	$BšdC»©edSock‘
(
hSock‘
, 
pÜt
)

16 
iR‘v®
=-1;

18 
Cl›ÁPÜt
 = 
pÜt
;

19 
sockaddr_š
 
»mÙe
= {0};

21 
»mÙe
.
sš_çmy
 = 
AF_INET
;

23 
»mÙe
.
sš_addr
.
s_addr
 = 
	`htÚl
(
INADDR_ANY
);

25 
»mÙe
.
sš_çmy
 = 
AF_INET
;

26 
»mÙe
.
sš_pÜt
 = 
	`htÚs
(
Cl›ÁPÜt
);

27 
iR‘v®
 = 
	`bšd
(
hSock‘
,(
sockaddr
 *)&
»mÙe
,(remote));

28  
iR‘v®
;

29 
	}
}

31 
boŞ
 
	$»add©a
(
sock
, *
buf
, 
buæ’
)

33 *
pbuf
 = (*è
buf
;

34 
tÙ®_by‹s_rcvd
 = 0;

36 
buæ’
 > 0)

38 
num
 = 
	`»cv
(
sock
, 
pbuf
, 
buæ’
, 0);

48 ià(
num
 <= 0)

49  
çl£
;

51 
pbuf
 +ğ
num
;

52 
buæ’
 -ğ
num
;

53 
tÙ®_by‹s_rcvd
 +ğ
num
;

54 
	`´štf
("TÙ® By‹ Reûived : %d\n",
tÙ®_by‹s_rcvd
);

57  
Œue
;

58 
	}
}

60 
boŞ
 
	$»adlÚg
(
sock
, *
v®ue
)

62 ià(!
	`»add©a
(
sock
, 
v®ue
, (value)))

63  
çl£
;

64 *
v®ue
 = 
	`Áohl
(*value);

65  
Œue
;

66 
	}
}

68 
	#MAX
 4096

	)

70 
boŞ
 
	$»adfe
(
sock
, 
FILE
 *
f
, FILE *
f1
)

72 
fesize
;

73 ià(!
	`»adlÚg
(
sock
, &
fesize
))

74  
çl£
;

75 ià(
fesize
 > 0)

77 
bufãr
[
MAX
];

79 
	`´štf
("Fesizğ%ld\n",
fesize
);

81 
	`årštf
(
f1
, "%ld",
fesize
);

84 
num
 = 
	`mš
(
fesize
, (
bufãr
));

85 ià(!
	`»add©a
(
sock
, 
bufãr
, 
num
))

86  
çl£
;

87 
off£t
 = 0;

90 
size_t
 
wr™‹n
 = 
	`fwr™e
(&
bufãr
[
off£t
], 1, 
num
-off£t, 
f
);

91 ià(
wr™‹n
 < 1)

92  
çl£
;

93 
off£t
 +ğ
wr™‹n
;

95 
off£t
 < 
num
);

96 
fesize
 -ğ
num
;

98 
fesize
 > 0);

100  
Œue
;

101 
	}
}

103 
	$Sock‘_S”v”
(*
f’ame
, *
fesize
, *
g
, *
g_size
, 
şock_t
 *
time
, 
pÜt
, 
mode
)

105 
sock‘_desc
, 
sock
, 
ş›ÁL’
, 
»ad_size
;

106 
sockaddr_š
 
£rv”
, 
ş›Á
;

108 if(
f’ame
 =ğ
NULL
 || 
fesize
 =ğNULL || ((
mode
 =ğ0è&& (
g
 =ğNULL || 
g_size
 == NULL)))

110 
	`´štf
("Invalid filename\n");

115 
sock‘_desc
 = 
	`Sock‘C»©e
();

116 ià(
sock‘_desc
 == -1)

118 
	`´štf
("Could‚ot create socket");

121 
	`´štf
("Socket created\n");

123 
»u£
 = 1;

124 ià(
	`£tsockİt
(
sock‘_desc
, 
SOL_SOCKET
, 
SO_REUSEADDR
, (cÚ¡ *)&
»u£
, (reuse)) < 0)

125 
	`³¼Ü
("setsockopt(SO_REUSEADDR) failed");

127 ià(
	`£tsockİt
(
sock‘_desc
, 
SOL_SOCKET
, 
SO_REUSEPORT
, (cÚ¡ *)&
»u£
, (reuse)) < 0)

128 
	`³¼Ü
("setsockopt(SO_REUSEPORT) failed");

139 ifĞ
	`BšdC»©edSock‘
(
sock‘_desc
, 
pÜt
) < 0)

142 
	`³¼Ü
("bind failed.");

145 
	`´štf
("bind done\n");

147 if(
	`li¡’
(
sock‘_desc
, 5) != 0)

150 
	`³¼Ü
("listen failed");

157 
	`´štf
("Waiting for incoming connections...\n");

158 
ş›ÁL’
 = (
sockaddr_š
);

160 
sock
 = 
	`acû±
(
sock‘_desc
,(
sockaddr
 *)&
ş›Á
,(
sockËn_t
*)&
ş›ÁL’
);

161 ià(
sock
 < 0)

163 
	`³¼Ü
("accept failed");

166 
	`´štf
("Connection‡ccepted\n");

168 if(
mode
 == 0)

170 
FILE
 *
å
;

171 
FILE
 *
å1
;

172 
FILE
 *
å2
;

173 
FILE
 *
å3
;

174 
å
 = 
	`fİ’
(
f’ame
, "wb");

175 
å1
 = 
	`fİ’
(
fesize
, "wb");

176 
å2
 = 
	`fİ’
(
g
, "wb");

177 
å3
 = 
	`fİ’
(
g_size
, "wb");

178 *
time
 = 
	`şock
();

179 if(
å
 =ğ
NULL
 || 
å1
 =ğNULL || 
å2
 =ğNULL || 
å3
 == NULL)

181 
	`´štf
("ERROR, could‚ot open file\n");

185 if(
	`»adfe
(
sock
, 
å
, 
å1
è=ğ
çl£
)

187 
	`´štf
("ERROR, could‚ot„eadhe data\n");

191 if(
	`»adfe
(
sock
, 
å2
, 
å3
è=ğ
çl£
)

193 
	`´štf
("ERROR, could‚ot„eadhe data\n");

197 
	`şo£
(
sock
);

198 
	`fşo£
(
å
);

199 
	`fşo£
(
å1
);

200 
	`fşo£
(
å2
);

201 
	`fşo£
(
å3
);

202 
	`¦“p
(1);

206 
FILE
 *
å
;

207 
FILE
 *
å1
;

208 
å
 = 
	`fİ’
(
f’ame
, "wb");

209 
å1
 = 
	`fİ’
(
fesize
, "wb");

210 if(
å
 =ğ
NULL
 || 
å1
 == NULL)

212 
	`´štf
("ERROR, could‚ot open file\n");

215 if(
	`»adfe
(
sock
, 
å
, 
å1
è=ğ
çl£
)

217 
	`´štf
("ERROR, could‚ot„eadhe data\n");

221 
	`şo£
(
sock
);

222 
	`fşo£
(
å
);

223 
	`fşo£
(
å1
);

224 
	`¦“p
(1);

230 
	}
}

	@App/softmax_layer.h

1 #iâdeà
SOFTMAX_LAYER_H


2 
	#SOFTMAX_LAYER_H


	)

3 
	~"Ïy”.h
"

4 
	~"ÃtwÜk.h
"

6 
Ïy”
 
	tsoámax_Ïy”
;

8 
soámax_¬¿y
(*
šput
, 
n
, 
‹mp
, *
ouut
);

9 
soámax_Ïy”
 
make_soámax_Ïy”
(
b©ch
, 
šputs
, 
groups
);

	@App/stb_image.h

106 #iâdeà
STBI_INCLUDE_STB_IMAGE_H


107 
	#STBI_INCLUDE_STB_IMAGE_H


	)

306 #iâdeà
STBI_NO_STDIO


307 
	~<¡dio.h
>

310 
	#STBI_VERSION
 1

	)

314 
	mSTBI_deçuÉ
 = 0,

316 
	mSTBI_g»y
 = 1,

317 
	mSTBI_g»y_®pha
 = 2,

318 
	mSTBI_rgb
 = 3,

319 
	mSTBI_rgb_®pha
 = 4

322 
	t¡bi_uc
;

323 
	t¡bi_us
;

325 #ifdeà
__ılu¥lus


329 #ifdeà
STB_IMAGE_STATIC


330 
	#STBIDEF
 

	)

332 
	#STBIDEF
 

	)

346 (*
»ad
è(*
u£r
,*
d©a
,
size
);

347 (*
sk
è(*
u£r
,
n
);

348 (*
eof
è(*
u£r
);

349 } 
	t¡bi_io_ÿÎbacks
;

356 
STBIDEF
 
¡bi_uc
 *
¡bi_lßd_äom_memÜy
 (¡bi_uøcÚ¡ *
bufãr
, 
Ën
 , *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

357 
STBIDEF
 
¡bi_uc
 *
¡bi_lßd_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
 , *
u£r
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

358 #iâdeà
STBI_NO_GIF


359 
STBIDEF
 
¡bi_uc
 *
¡bi_lßd_gif_äom_memÜy
(¡bi_uøcÚ¡ *
bufãr
, 
Ën
, **
d–ays
, *
x
, *
y
, *
z
, *
comp
, 
»q_comp
);

363 #iâdeà
STBI_NO_STDIO


364 
STBIDEF
 
¡bi_uc
 *
¡bi_lßd
 (cÚ¡ *
f’ame
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

365 
STBIDEF
 
¡bi_uc
 *
¡bi_lßd_äom_fe
 (
FILE
 *
f
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

374 
STBIDEF
 
¡bi_us
 *
¡bi_lßd_16_äom_memÜy
 (
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

375 
STBIDEF
 
¡bi_us
 *
¡bi_lßd_16_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

377 #iâdeà
STBI_NO_STDIO


378 
STBIDEF
 
¡bi_us
 *
¡bi_lßd_16
 (cÚ¡ *
f’ame
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

379 
STBIDEF
 
¡bi_us
 *
¡bi_lßd_äom_fe_16
(
FILE
 *
f
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

386 #iâdeà
STBI_NO_LINEAR


387 
STBIDEF
 *
¡bi_lßdf_äom_memÜy
 (
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

388 
STBIDEF
 *
¡bi_lßdf_äom_ÿÎbacks
 (
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

390 #iâdeà
STBI_NO_STDIO


391 
STBIDEF
 *
¡bi_lßdf
 (cÚ¡ *
f’ame
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

392 
STBIDEF
 *
¡bi_lßdf_äom_fe
 (
FILE
 *
f
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

396 #iâdeà
STBI_NO_HDR


397 
STBIDEF
 
¡bi_hdr_to_ldr_gamma
(
gamma
);

398 
STBIDEF
 
¡bi_hdr_to_ldr_sÿË
(
sÿË
);

401 #iâdeà
STBI_NO_LINEAR


402 
STBIDEF
 
¡bi_ldr_to_hdr_gamma
(
gamma
);

403 
STBIDEF
 
¡bi_ldr_to_hdr_sÿË
(
sÿË
);

407 
STBIDEF
 
¡bi_is_hdr_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
);

408 
STBIDEF
 
¡bi_is_hdr_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
);

409 #iâdeà
STBI_NO_STDIO


410 
STBIDEF
 
¡bi_is_hdr
 (cÚ¡ *
f’ame
);

411 
STBIDEF
 
¡bi_is_hdr_äom_fe
(
FILE
 *
f
);

417 
STBIDEF
 cÚ¡ *
¡bi_çu»_»asÚ
 ();

420 
STBIDEF
 
¡bi_image_ä“
 (*
»tv®_äom_¡bi_lßd
);

423 
STBIDEF
 
¡bi_šfo_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
comp
);

424 
STBIDEF
 
¡bi_šfo_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
comp
);

425 
STBIDEF
 
¡bi_is_16_b™_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
);

426 
STBIDEF
 
¡bi_is_16_b™_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
);

428 #iâdeà
STBI_NO_STDIO


429 
STBIDEF
 
¡bi_šfo
 (cÚ¡ *
f’ame
, *
x
, *
y
, *
comp
);

430 
STBIDEF
 
¡bi_šfo_äom_fe
 (
FILE
 *
f
, *
x
, *
y
, *
comp
);

431 
STBIDEF
 
¡bi_is_16_b™
 (cÚ¡ *
f’ame
);

432 
STBIDEF
 
¡bi_is_16_b™_äom_fe
(
FILE
 *
f
);

440 
STBIDEF
 
¡bi_£t_uÅ»muÉly_Ú_lßd
(
æag_Œue_if_should_uÅ»muÉly
);

444 
STBIDEF
 
¡bi_cÚv”t_hÚe_²g_to_rgb
(
æag_Œue_if_should_cÚv”t
);

447 
STBIDEF
 
¡bi_£t_æ_v”tiÿÎy_Ú_lßd
(
æag_Œue_if_should_æ
);

451 
STBIDEF
 *
¡bi_zlib_decode_m®loc_guesssize
(cÚ¡ *
bufãr
, 
Ën
, 
š™Ÿl_size
, *
ou’
);

452 
STBIDEF
 *
¡bi_zlib_decode_m®loc_guesssize_h—d”æag
(cÚ¡ *
bufãr
, 
Ën
, 
š™Ÿl_size
, *
ou’
, 
·r£_h—d”
);

453 
STBIDEF
 *
¡bi_zlib_decode_m®loc
(cÚ¡ *
bufãr
, 
Ën
, *
ou’
);

454 
STBIDEF
 
¡bi_zlib_decode_bufãr
(*
obufãr
, 
Ş’
, cÚ¡ *
ibufãr
, 
’
);

456 
STBIDEF
 *
¡bi_zlib_decode_noh—d”_m®loc
(cÚ¡ *
bufãr
, 
Ën
, *
ou’
);

457 
STBIDEF
 
¡bi_zlib_decode_noh—d”_bufãr
(*
obufãr
, 
Ş’
, cÚ¡ *
ibufãr
, 
’
);

460 #ifdeà
__ılu¥lus


469 #ifdeà
STB_IMAGE_IMPLEMENTATION


471 #ià
defšed
(
STBI_ONLY_JPEG
è|| defšed(
STBI_ONLY_PNG
è|| defšed(
STBI_ONLY_BMP
) \

472 || 
defšed
(
STBI_ONLY_TGA
è|| defšed(
STBI_ONLY_GIF
è|| defšed(
STBI_ONLY_PSD
) \

473 || 
defšed
(
STBI_ONLY_HDR
è|| defšed(
STBI_ONLY_PIC
è|| defšed(
STBI_ONLY_PNM
) \

474 || 
	$defšed
(
STBI_ONLY_ZLIB
)

475 #iâdeà
STBI_ONLY_JPEG


476 
	#STBI_NO_JPEG


	)

478 #iâdeà
STBI_ONLY_PNG


479 
	#STBI_NO_PNG


	)

481 #iâdeà
STBI_ONLY_BMP


482 
	#STBI_NO_BMP


	)

484 #iâdeà
STBI_ONLY_PSD


485 
	#STBI_NO_PSD


	)

487 #iâdeà
STBI_ONLY_TGA


488 
	#STBI_NO_TGA


	)

490 #iâdeà
STBI_ONLY_GIF


491 
	#STBI_NO_GIF


	)

493 #iâdeà
STBI_ONLY_HDR


494 
	#STBI_NO_HDR


	)

496 #iâdeà
STBI_ONLY_PIC


497 
	#STBI_NO_PIC


	)

499 #iâdeà
STBI_ONLY_PNM


500 
	#STBI_NO_PNM


	)

504 #ià
	`defšed
(
STBI_NO_PNG
è&& !defšed(
STBI_SUPPORT_ZLIB
è&& !defšed(
STBI_NO_ZLIB
)

505 
	#STBI_NO_ZLIB


	)

509 
	~<¡d¬g.h
>

510 
	~<¡ddef.h
>

511 
	~<¡dlib.h
>

512 
	~<¡ršg.h
>

513 
	~<lim™s.h
>

515 #ià!
	`defšed
(
STBI_NO_LINEAR
è|| !defšed(
STBI_NO_HDR
)

516 
	~<m©h.h
>

519 #iâdeà
STBI_NO_STDIO


520 
	~<¡dio.h
>

523 #iâdeà
STBI_ASSERT


524 
	~<as£¹.h
>

525 
	#STBI_ASSERT
(
x
è
	`as£¹
(x)

	)

529 #iâdeà
_MSC_VER


530 #ifdeà
__ılu¥lus


531 
	#¡bi_šlše
 
šlše


	)

533 
	#¡bi_šlše


	)

536 
	#¡bi_šlše
 
__fÜûšlše


	)

540 #ifdeà
_MSC_VER


541 
	t¡bi__ušt16
;

542 sigÃd 
	t¡bi__št16
;

543 
	t¡bi__ušt32
;

544 sigÃd 
	t¡bi__št32
;

546 
	~<¡dšt.h
>

547 
ušt16_t
 
	t¡bi__ušt16
;

548 
št16_t
 
	t¡bi__št16
;

549 
ušt32_t
 
	t¡bi__ušt32
;

550 
št32_t
 
	t¡bi__št32
;

554 
	tv®id©e_ušt32
[(
¡bi__ušt32
)==4 ? 1 : -1];

556 #ifdeà
_MSC_VER


557 
	#STBI_NOTUSED
(
v
è()(v)

	)

559 
	#STBI_NOTUSED
(
v
è()(v)

	)

562 #ifdeà
_MSC_VER


563 
	#STBI_HAS_LROTL


	)

566 #ifdeà
STBI_HAS_LROTL


567 
	#¡bi_ÌÙ
(
x
,
y
è
	`_ÌÙl
(x,y)

	)

569 
	#¡bi_ÌÙ
(
x
,
y
è(((xè<< (y)è| ((xè>> (32 - (y))))

	)

572 #ià
	`defšed
(
STBI_MALLOC
è&& defšed(
STBI_FREE
è&& (defšed(
STBI_REALLOC
è|| defšed(
STBI_REALLOC_SIZED
))

574 #–ià!
	`defšed
(
STBI_MALLOC
è&& !defšed(
STBI_FREE
è&& !defšed(
STBI_REALLOC
è&& !defšed(
STBI_REALLOC_SIZED
)

580 #iâdeà
STBI_MALLOC


581 
	#STBI_MALLOC
(
sz
è
	`m®loc
(sz)

	)

582 
	#STBI_REALLOC
(
p
,
Ãwsz
è
	`»®loc
Õ,Ãwsz)

	)

583 
	#STBI_FREE
(
p
è
	`ä“
Õ)

	)

586 #iâdeà
STBI_REALLOC_SIZED


587 
	#STBI_REALLOC_SIZED
(
p
,
Şdsz
,
Ãwsz
è
	`STBI_REALLOC
Õ,Ãwsz)

	)

591 #ià
	`defšed
(
__x86_64__
è|| defšed(
_M_X64
)

592 
	#STBI__X64_TARGET


	)

593 #–ià
	`defšed
(
__i386
è|| defšed(
_M_IX86
)

594 
	#STBI__X86_TARGET


	)

597 #ià
	`defšed
(
__GNUC__
è&& defšed(
STBI__X86_TARGET
è&& !defšed(
__SSE2__
è&& !defšed(
STBI_NO_SIMD
)

605 
	#STBI_NO_SIMD


	)

608 #ià
	`defšed
(
__MINGW32__
è&& defšed(
STBI__X86_TARGET
è&& !defšed(
STBI_MINGW_ENABLE_SSE2
è&& !defšed(
STBI_NO_SIMD
)

620 
	#STBI_NO_SIMD


	)

623 #ià!
	`defšed
(
STBI_NO_SIMD
è&& (defšed(
STBI__X86_TARGET
è|| defšed(
STBI__X64_TARGET
))

624 
	#STBI_SSE2


	)

625 
	~<emmšŒš.h
>

627 #ifdeà
_MSC_VER


629 #ià
_MSC_VER
 >= 1400

630 
	~<šŒš.h
>

631 
	$¡bi__ıuid3
()

633 
šfo
[4];

634 
	`__ıuid
(
šfo
,1);

635  
šfo
[3];

636 
	}
}

638 
	$¡bi__ıuid3
()

640 
»s
;

641 
__asm
 {

642 
mov
 
—x
,1

643 
ıuid


644 
mov
 
»s
,
edx


646  
»s
;

647 
	}
}

650 
	#STBI_SIMD_ALIGN
(
ty³
, 
Çme
è
	`__deş¥ec
(
	`®ign
(16)èty³ 
	)
name

652 
	$¡bi__s£2_avaabË
()

654 
šfo3
 = 
	`¡bi__ıuid3
();

655  ((
šfo3
 >> 26) & 1) != 0;

656 
	}
}

658 
	#STBI_SIMD_ALIGN
(
ty³
, 
Çme
èty³‚am
	`__©Œibu‹__
((
	`®igÃd
(16)))

	)

660 
	$¡bi__s£2_avaabË
()

666 
	}
}

671 #ià
defšed
(
STBI_NO_SIMD
è&& defšed(
STBI_NEON
)

672 #undeà
STBI_NEON


675 #ifdeà
STBI_NEON


676 
	~<¬m_ÃÚ.h
>

678 
	#STBI_SIMD_ALIGN
(
ty³
, 
Çme
èty³‚am
	`__©Œibu‹__
((
	`®igÃd
(16)))

	)

681 #iâdeà
STBI_SIMD_ALIGN


682 
	#STBI_SIMD_ALIGN
(
ty³
, 
Çme
èty³ 
	)
name

693 
¡bi__ušt32
 
	mimg_x
, 
	mimg_y
;

694 
	mimg_n
, 
	mimg_out_n
;

696 
¡bi_io_ÿÎbacks
 
	mio
;

697 *
	mio_u£r_d©a
;

699 
	m»ad_äom_ÿÎbacks
;

700 
	mbuæ’
;

701 
¡bi_uc
 
	mbufãr_¡¬t
[128];

703 
¡bi_uc
 *
	mimg_bufãr
, *
	mimg_bufãr_’d
;

704 
¡bi_uc
 *
	mimg_bufãr_Üigš®
, *
	mimg_bufãr_Üigš®_’d
;

705 } 
	t¡bi__cÚ‹xt
;

708 
¡bi__»fl_bufãr
(
¡bi__cÚ‹xt
 *
s
);

711 
	$¡bi__¡¬t_mem
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
)

713 
s
->
io
.
»ad
 = 
NULL
;

714 
s
->
»ad_äom_ÿÎbacks
 = 0;

715 
s
->
img_bufãr
 = s->
img_bufãr_Üigš®
 = (
¡bi_uc
 *è
bufãr
;

716 
s
->
img_bufãr_’d
 = s->
img_bufãr_Üigš®_’d
 = (
¡bi_uc
 *è
bufãr
+
Ën
;

717 
	}
}

720 
	$¡bi__¡¬t_ÿÎbacks
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_io_ÿÎbacks
 *
c
, *
u£r
)

722 
s
->
io
 = *
c
;

723 
s
->
io_u£r_d©a
 = 
u£r
;

724 
s
->
buæ’
 = (s->
bufãr_¡¬t
);

725 
s
->
»ad_äom_ÿÎbacks
 = 1;

726 
s
->
img_bufãr_Üigš®
 = s->
bufãr_¡¬t
;

727 
	`¡bi__»fl_bufãr
(
s
);

728 
s
->
img_bufãr_Üigš®_’d
 = s->
img_bufãr_’d
;

729 
	}
}

731 #iâdeà
STBI_NO_STDIO


733 
	$¡bi__¡dio_»ad
(*
u£r
, *
d©a
, 
size
)

735  (è
	`ä—d
(
d©a
,1,
size
,(
FILE
*è
u£r
);

736 
	}
}

738 
	$¡bi__¡dio_sk
(*
u£r
, 
n
)

740 
	`f£ek
((
FILE
*è
u£r
, 
n
, 
SEEK_CUR
);

741 
	}
}

743 
	$¡bi__¡dio_eof
(*
u£r
)

745  
	`ãof
((
FILE
*è
u£r
);

746 
	}
}

748 
¡bi_io_ÿÎbacks
 
	g¡bi__¡dio_ÿÎbacks
 =

750 
¡bi__¡dio_»ad
,

751 
¡bi__¡dio_sk
,

752 
¡bi__¡dio_eof
,

755 
	$¡bi__¡¬t_fe
(
¡bi__cÚ‹xt
 *
s
, 
FILE
 *
f
)

757 
	`¡bi__¡¬t_ÿÎbacks
(
s
, &
¡bi__¡dio_ÿÎbacks
, (*è
f
);

758 
	}
}

764 
	$¡bi__»wšd
(
¡bi__cÚ‹xt
 *
s
)

769 
s
->
img_bufãr
 = s->
img_bufãr_Üigš®
;

770 
s
->
img_bufãr_’d
 = s->
img_bufãr_Üigš®_’d
;

771 
	}
}

775 
	mSTBI_ORDER_RGB
,

776 
	mSTBI_ORDER_BGR


781 
	mb™s_³r_chªÃl
;

782 
	mnum_chªÃls
;

783 
	mchªÃl_Üd”
;

784 } 
	t¡bi__»suÉ_šfo
;

786 #iâdeà
STBI_NO_JPEG


787 
¡bi__j³g_‹¡
(
¡bi__cÚ‹xt
 *
s
);

788 *
¡bi__j³g_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

789 
¡bi__j³g_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

792 #iâdeà
STBI_NO_PNG


793 
¡bi__²g_‹¡
(
¡bi__cÚ‹xt
 *
s
);

794 *
¡bi__²g_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

795 
¡bi__²g_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

796 
¡bi__²g_is16
(
¡bi__cÚ‹xt
 *
s
);

799 #iâdeà
STBI_NO_BMP


800 
¡bi__bmp_‹¡
(
¡bi__cÚ‹xt
 *
s
);

801 *
¡bi__bmp_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

802 
¡bi__bmp_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

805 #iâdeà
STBI_NO_TGA


806 
¡bi__tga_‹¡
(
¡bi__cÚ‹xt
 *
s
);

807 *
¡bi__tga_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

808 
¡bi__tga_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

811 #iâdeà
STBI_NO_PSD


812 
¡bi__psd_‹¡
(
¡bi__cÚ‹xt
 *
s
);

813 *
¡bi__psd_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
, 
bpc
);

814 
¡bi__psd_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

815 
¡bi__psd_is16
(
¡bi__cÚ‹xt
 *
s
);

818 #iâdeà
STBI_NO_HDR


819 
¡bi__hdr_‹¡
(
¡bi__cÚ‹xt
 *
s
);

820 *
¡bi__hdr_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

821 
¡bi__hdr_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

824 #iâdeà
STBI_NO_PIC


825 
¡bi__pic_‹¡
(
¡bi__cÚ‹xt
 *
s
);

826 *
¡bi__pic_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

827 
¡bi__pic_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

830 #iâdeà
STBI_NO_GIF


831 
¡bi__gif_‹¡
(
¡bi__cÚ‹xt
 *
s
);

832 *
¡bi__gif_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

833 *
¡bi__lßd_gif_maš
(
¡bi__cÚ‹xt
 *
s
, **
d–ays
, *
x
, *
y
, *
z
, *
comp
, 
»q_comp
);

834 
¡bi__gif_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

837 #iâdeà
STBI_NO_PNM


838 
¡bi__²m_‹¡
(
¡bi__cÚ‹xt
 *
s
);

839 *
¡bi__²m_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

840 
¡bi__²m_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

844 cÚ¡ *
	g¡bi__g_çu»_»asÚ
;

846 
STBIDEF
 cÚ¡ *
	$¡bi_çu»_»asÚ
()

848  
¡bi__g_çu»_»asÚ
;

849 
	}
}

851 
	$¡bi__”r
(cÚ¡ *
¡r
)

853 
¡bi__g_çu»_»asÚ
 = 
¡r
;

855 
	}
}

857 *
	$¡bi__m®loc
(
size_t
 
size
)

859  
	`STBI_MALLOC
(
size
);

860 
	}
}

874 
	$¡bi__addsizes_v®id
(
a
, 
b
)

876 ià(
b
 < 0)  0;

881  
a
 <ğ
INT_MAX
 - 
b
;

882 
	}
}

886 
	$¡bi__mul2sizes_v®id
(
a
, 
b
)

888 ià(
a
 < 0 || 
b
 < 0)  0;

889 ià(
b
 == 0)  1;

891  
a
 <ğ
INT_MAX
/
b
;

892 
	}
}

895 
	$¡bi__mad2sizes_v®id
(
a
, 
b
, 
add
)

897  
	`¡bi__mul2sizes_v®id
(
a
, 
b
è&& 
	`¡bi__addsizes_v®id
×*b, 
add
);

898 
	}
}

901 
	$¡bi__mad3sizes_v®id
(
a
, 
b
, 
c
, 
add
)

903  
	`¡bi__mul2sizes_v®id
(
a
, 
b
è&& stbi__mul2sizes_v®id×*b, 
c
) &&

904 
	`¡bi__addsizes_v®id
(
a
*
b
*
c
, 
add
);

905 
	}
}

908 #ià!
defšed
(
STBI_NO_LINEAR
è|| !defšed(
STBI_NO_HDR
)

909 
	$¡bi__mad4sizes_v®id
(
a
, 
b
, 
c
, 
d
, 
add
)

911  
	`¡bi__mul2sizes_v®id
(
a
, 
b
è&& stbi__mul2sizes_v®id×*b, 
c
) &&

912 
	`¡bi__mul2sizes_v®id
(
a
*
b
*
c
, 
d
è&& 
	`¡bi__addsizes_v®id
×*b*c*d, 
add
);

913 
	}
}

917 *
	$¡bi__m®loc_mad2
(
a
, 
b
, 
add
)

919 ià(!
	`¡bi__mad2sizes_v®id
(
a
, 
b
, 
add
)è 
NULL
;

920  
	`¡bi__m®loc
(
a
*
b
 + 
add
);

921 
	}
}

923 *
	$¡bi__m®loc_mad3
(
a
, 
b
, 
c
, 
add
)

925 ià(!
	`¡bi__mad3sizes_v®id
(
a
, 
b
, 
c
, 
add
)è 
NULL
;

926  
	`¡bi__m®loc
(
a
*
b
*
c
 + 
add
);

927 
	}
}

929 #ià!
defšed
(
STBI_NO_LINEAR
è|| !defšed(
STBI_NO_HDR
)

930 *
	$¡bi__m®loc_mad4
(
a
, 
b
, 
c
, 
d
, 
add
)

932 ià(!
	`¡bi__mad4sizes_v®id
(
a
, 
b
, 
c
, 
d
, 
add
)è 
NULL
;

933  
	`¡bi__m®loc
(
a
*
b
*
c
*
d
 + 
add
);

934 
	}
}

941 #ifdeà
STBI_NO_FAILURE_STRINGS


942 
	#¡bi__”r
(
x
,
y
è0

	)

943 #–ià
defšed
(
STBI_FAILURE_USERMSG
)

944 
	#¡bi__”r
(
x
,
y
è
	`¡bi__”r
(y)

	)

946 
	#¡bi__”r
(
x
,
y
è
	`¡bi__”r
(x)

	)

949 
	#¡bi__”½f
(
x
,
y
è((*)(
size_t
è(
	`¡bi__”r
(x,y)?
NULL
:NULL))

	)

950 
	#¡bi__”½uc
(
x
,
y
è((*)(
size_t
è(
	`¡bi__”r
(x,y)?
NULL
:NULL))

	)

952 
STBIDEF
 
	$¡bi_image_ä“
(*
»tv®_äom_¡bi_lßd
)

954 
	`STBI_FREE
(
»tv®_äom_¡bi_lßd
);

955 
	}
}

957 #iâdeà
STBI_NO_LINEAR


958 *
¡bi__ldr_to_hdr
(
¡bi_uc
 *
d©a
, 
x
, 
y
, 
comp
);

961 #iâdeà
STBI_NO_HDR


962 
¡bi_uc
 *
¡bi__hdr_to_ldr
(*
d©a
, 
x
, 
y
, 
comp
);

965 
	g¡bi__v”tiÿÎy_æ_Ú_lßd
 = 0;

967 
STBIDEF
 
	$¡bi_£t_æ_v”tiÿÎy_Ú_lßd
(
æag_Œue_if_should_æ
)

969 
¡bi__v”tiÿÎy_æ_Ú_lßd
 = 
æag_Œue_if_should_æ
;

970 
	}
}

972 *
	$¡bi__lßd_maš
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
, 
bpc
)

974 
	`mem£t
(
ri
, 0, (*ri));

975 
ri
->
b™s_³r_chªÃl
 = 8;

976 
ri
->
chªÃl_Üd”
 = 
STBI_ORDER_RGB
;

977 
ri
->
num_chªÃls
 = 0;

979 #iâdeà
STBI_NO_JPEG


980 ià(
	`¡bi__j³g_‹¡
(
s
)è 
	`¡bi__j³g_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

982 #iâdeà
STBI_NO_PNG


983 ià(
	`¡bi__²g_‹¡
(
s
)è 
	`¡bi__²g_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

985 #iâdeà
STBI_NO_BMP


986 ià(
	`¡bi__bmp_‹¡
(
s
)è 
	`¡bi__bmp_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

988 #iâdeà
STBI_NO_GIF


989 ià(
	`¡bi__gif_‹¡
(
s
)è 
	`¡bi__gif_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

991 #iâdeà
STBI_NO_PSD


992 ià(
	`¡bi__psd_‹¡
(
s
)è 
	`¡bi__psd_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
, 
bpc
);

994 #iâdeà
STBI_NO_PIC


995 ià(
	`¡bi__pic_‹¡
(
s
)è 
	`¡bi__pic_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

997 #iâdeà
STBI_NO_PNM


998 ià(
	`¡bi__²m_‹¡
(
s
)è 
	`¡bi__²m_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

1001 #iâdeà
STBI_NO_HDR


1002 ià(
	`¡bi__hdr_‹¡
(
s
)) {

1003 *
hdr
 = 
	`¡bi__hdr_lßd
(
s
, 
x
,
y
,
comp
,
»q_comp
, 
ri
);

1004  
	`¡bi__hdr_to_ldr
(
hdr
, *
x
, *
y
, 
»q_comp
 ?„eq_com°: *
comp
);

1008 #iâdeà
STBI_NO_TGA


1010 ià(
	`¡bi__tga_‹¡
(
s
))

1011  
	`¡bi__tga_lßd
(
s
,
x
,
y
,
comp
,
»q_comp
, 
ri
);

1014  
	`¡bi__”½uc
("unknown imageype", "Image‚ot of‡ny knownype, or corrupt");

1015 
	}
}

1017 
¡bi_uc
 *
	$¡bi__cÚv”t_16_to_8
(
¡bi__ušt16
 *
Üig
, 
w
, 
h
, 
chªÃls
)

1019 
i
;

1020 
img_Ën
 = 
w
 * 
h
 * 
chªÃls
;

1021 
¡bi_uc
 *
»duûd
;

1023 
»duûd
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(
img_Ën
);

1024 ià(
»duûd
 =ğ
NULL
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

1026 
i
 = 0; i < 
img_Ën
; ++i)

1027 
»duûd
[
i
] = (
¡bi_uc
)((
Üig
[i] >> 8) & 0xFF);

1029 
	`STBI_FREE
(
Üig
);

1030  
»duûd
;

1031 
	}
}

1033 
¡bi__ušt16
 *
	$¡bi__cÚv”t_8_to_16
(
¡bi_uc
 *
Üig
, 
w
, 
h
, 
chªÃls
)

1035 
i
;

1036 
img_Ën
 = 
w
 * 
h
 * 
chªÃls
;

1037 
¡bi__ušt16
 *
’Ïrged
;

1039 
’Ïrged
 = (
¡bi__ušt16
 *è
	`¡bi__m®loc
(
img_Ën
*2);

1040 ià(
’Ïrged
 =ğ
NULL
è (
¡bi__ušt16
 *è
	`¡bi__”½uc
("outofmem", "Out of memory");

1042 
i
 = 0; i < 
img_Ën
; ++i)

1043 
’Ïrged
[
i
] = (
¡bi__ušt16
)((
Üig
[i] << 8) + orig[i]);

1045 
	`STBI_FREE
(
Üig
);

1046  
’Ïrged
;

1047 
	}
}

1049 
	$¡bi__v”tiÿl_æ
(*
image
, 
w
, 
h
, 
by‹s_³r_pix–
)

1051 
row
;

1052 
size_t
 
by‹s_³r_row
 = (size_t)
w
 * 
by‹s_³r_pix–
;

1053 
¡bi_uc
 
‹mp
[2048];

1054 
¡bi_uc
 *
by‹s
 = (¡bi_uø*)
image
;

1056 
row
 = 0;„ow < (
h
>>1);„ow++) {

1057 
¡bi_uc
 *
row0
 = 
by‹s
 + 
row
*
by‹s_³r_row
;

1058 
¡bi_uc
 *
row1
 = 
by‹s
 + (
h
 - 
row
 - 1)*
by‹s_³r_row
;

1060 
size_t
 
by‹s_Ëá
 = 
by‹s_³r_row
;

1061 
by‹s_Ëá
) {

1062 
size_t
 
by‹s_cİy
 = (
by‹s_Ëá
 < (
‹mp
)) ? bytes_left : (temp);

1063 
	`memıy
(
‹mp
, 
row0
, 
by‹s_cİy
);

1064 
	`memıy
(
row0
, 
row1
, 
by‹s_cİy
);

1065 
	`memıy
(
row1
, 
‹mp
, 
by‹s_cİy
);

1066 
row0
 +ğ
by‹s_cİy
;

1067 
row1
 +ğ
by‹s_cİy
;

1068 
by‹s_Ëá
 -ğ
by‹s_cİy
;

1071 
	}
}

1073 
	$¡bi__v”tiÿl_æ_¦iûs
(*
image
, 
w
, 
h
, 
z
, 
by‹s_³r_pix–
)

1075 
¦iû
;

1076 
¦iû_size
 = 
w
 * 
h
 * 
by‹s_³r_pix–
;

1078 
¡bi_uc
 *
by‹s
 = (¡bi_uø*)
image
;

1079 
¦iû
 = 0; sliû < 
z
; ++slice) {

1080 
	`¡bi__v”tiÿl_æ
(
by‹s
, 
w
, 
h
, 
by‹s_³r_pix–
);

1081 
by‹s
 +ğ
¦iû_size
;

1083 
	}
}

1085 *
	$¡bi__lßd_ªd_po¡´oûss_8b™
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
)

1087 
¡bi__»suÉ_šfo
 
ri
;

1088 *
»suÉ
 = 
	`¡bi__lßd_maš
(
s
, 
x
, 
y
, 
comp
, 
»q_comp
, &
ri
, 8);

1090 ià(
»suÉ
 =ğ
NULL
)

1091  
NULL
;

1093 ià(
ri
.
b™s_³r_chªÃl
 != 8) {

1094 
	`STBI_ASSERT
(
ri
.
b™s_³r_chªÃl
 == 16);

1095 
»suÉ
 = 
	`¡bi__cÚv”t_16_to_8
((
¡bi__ušt16
 *è»suÉ, *
x
, *
y
, 
»q_comp
 =ğ0 ? *
comp
 :„eq_comp);

1096 
ri
.
b™s_³r_chªÃl
 = 8;

1101 ià(
¡bi__v”tiÿÎy_æ_Ú_lßd
) {

1102 
chªÃls
 = 
»q_comp
 ?„eq_com°: *
comp
;

1103 
	`¡bi__v”tiÿl_æ
(
»suÉ
, *
x
, *
y
, 
chªÃls
 * (
¡bi_uc
));

1106  (*è
»suÉ
;

1107 
	}
}

1109 
¡bi__ušt16
 *
	$¡bi__lßd_ªd_po¡´oûss_16b™
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
)

1111 
¡bi__»suÉ_šfo
 
ri
;

1112 *
»suÉ
 = 
	`¡bi__lßd_maš
(
s
, 
x
, 
y
, 
comp
, 
»q_comp
, &
ri
, 16);

1114 ià(
»suÉ
 =ğ
NULL
)

1115  
NULL
;

1117 ià(
ri
.
b™s_³r_chªÃl
 != 16) {

1118 
	`STBI_ASSERT
(
ri
.
b™s_³r_chªÃl
 == 8);

1119 
»suÉ
 = 
	`¡bi__cÚv”t_8_to_16
((
¡bi_uc
 *è»suÉ, *
x
, *
y
, 
»q_comp
 =ğ0 ? *
comp
 :„eq_comp);

1120 
ri
.
b™s_³r_chªÃl
 = 16;

1126 ià(
¡bi__v”tiÿÎy_æ_Ú_lßd
) {

1127 
chªÃls
 = 
»q_comp
 ?„eq_com°: *
comp
;

1128 
	`¡bi__v”tiÿl_æ
(
»suÉ
, *
x
, *
y
, 
chªÃls
 * (
¡bi__ušt16
));

1131  (
¡bi__ušt16
 *è
»suÉ
;

1132 
	}
}

1134 #ià!
defšed
(
STBI_NO_HDR
è|| !defšed(
STBI_NO_LINEAR
)

1135 
	$¡bi__æßt_po¡´oûss
(*
»suÉ
, *
x
, *
y
, *
comp
, 
»q_comp
)

1137 ià(
¡bi__v”tiÿÎy_æ_Ú_lßd
 && 
»suÉ
 !ğ
NULL
) {

1138 
chªÃls
 = 
»q_comp
 ?„eq_com°: *
comp
;

1139 
	`¡bi__v”tiÿl_æ
(
»suÉ
, *
x
, *
y
, 
chªÃls
 * ());

1141 
	}
}

1144 #iâdeà
STBI_NO_STDIO


1146 
FILE
 *
	$¡bi__fİ’
(cÚ¡ *
f’ame
, cÚ¡ *
mode
)

1148 
FILE
 *
f
;

1149 #ià
	`defšed
(
_MSC_VER
) && _MSC_VER >= 1400

1150 ià(0 !ğ
	`fİ’_s
(&
f
, 
f’ame
, 
mode
))

1151 
f
=0;

1153 
f
 = 
	`fİ’
(
f’ame
, 
mode
);

1155  
f
;

1156 
	}
}

1159 
STBIDEF
 
¡bi_uc
 *
	$¡bi_lßd
(cÚ¡ *
f’ame
, *
x
, *
y
, *
comp
, 
»q_comp
)

1161 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

1162 *
»suÉ
;

1163 ià(!
f
è 
	`¡bi__”½uc
("can't fopen", "Unableo open file");

1164 
»suÉ
 = 
	`¡bi_lßd_äom_fe
(
f
,
x
,
y
,
comp
,
»q_comp
);

1165 
	`fşo£
(
f
);

1166  
»suÉ
;

1167 
	}
}

1169 
STBIDEF
 
¡bi_uc
 *
	$¡bi_lßd_äom_fe
(
FILE
 *
f
, *
x
, *
y
, *
comp
, 
»q_comp
)

1171 *
»suÉ
;

1172 
¡bi__cÚ‹xt
 
s
;

1173 
	`¡bi__¡¬t_fe
(&
s
,
f
);

1174 
»suÉ
 = 
	`¡bi__lßd_ªd_po¡´oûss_8b™
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1175 ià(
»suÉ
) {

1177 
	`f£ek
(
f
, - (è(
s
.
img_bufãr_’d
 - s.
img_bufãr
), 
SEEK_CUR
);

1179  
»suÉ
;

1180 
	}
}

1182 
STBIDEF
 
¡bi__ušt16
 *
	$¡bi_lßd_äom_fe_16
(
FILE
 *
f
, *
x
, *
y
, *
comp
, 
»q_comp
)

1184 
¡bi__ušt16
 *
»suÉ
;

1185 
¡bi__cÚ‹xt
 
s
;

1186 
	`¡bi__¡¬t_fe
(&
s
,
f
);

1187 
»suÉ
 = 
	`¡bi__lßd_ªd_po¡´oûss_16b™
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1188 ià(
»suÉ
) {

1190 
	`f£ek
(
f
, - (è(
s
.
img_bufãr_’d
 - s.
img_bufãr
), 
SEEK_CUR
);

1192  
»suÉ
;

1193 
	}
}

1195 
STBIDEF
 
¡bi_us
 *
	$¡bi_lßd_16
(cÚ¡ *
f’ame
, *
x
, *
y
, *
comp
, 
»q_comp
)

1197 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

1198 
¡bi__ušt16
 *
»suÉ
;

1199 ià(!
f
è (
¡bi_us
 *è
	`¡bi__”½uc
("can't fopen", "Unableo open file");

1200 
»suÉ
 = 
	`¡bi_lßd_äom_fe_16
(
f
,
x
,
y
,
comp
,
»q_comp
);

1201 
	`fşo£
(
f
);

1202  
»suÉ
;

1203 
	}
}

1208 
STBIDEF
 
¡bi_us
 *
	$¡bi_lßd_16_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
)

1210 
¡bi__cÚ‹xt
 
s
;

1211 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

1212  
	`¡bi__lßd_ªd_po¡´oûss_16b™
(&
s
,
x
,
y
,
chªÃls_š_fe
,
desœed_chªÃls
);

1213 
	}
}

1215 
STBIDEF
 
¡bi_us
 *
	$¡bi_lßd_16_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
)

1217 
¡bi__cÚ‹xt
 
s
;

1218 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *)
şbk
, 
u£r
);

1219  
	`¡bi__lßd_ªd_po¡´oûss_16b™
(&
s
,
x
,
y
,
chªÃls_š_fe
,
desœed_chªÃls
);

1220 
	}
}

1222 
STBIDEF
 
¡bi_uc
 *
	$¡bi_lßd_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
comp
, 
»q_comp
)

1224 
¡bi__cÚ‹xt
 
s
;

1225 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

1226  
	`¡bi__lßd_ªd_po¡´oûss_8b™
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1227 
	}
}

1229 
STBIDEF
 
¡bi_uc
 *
	$¡bi_lßd_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
comp
, 
»q_comp
)

1231 
¡bi__cÚ‹xt
 
s
;

1232 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *è
şbk
, 
u£r
);

1233  
	`¡bi__lßd_ªd_po¡´oûss_8b™
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1234 
	}
}

1236 #iâdeà
STBI_NO_GIF


1237 
STBIDEF
 
¡bi_uc
 *
	$¡bi_lßd_gif_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, **
d–ays
, *
x
, *
y
, *
z
, *
comp
, 
»q_comp
)

1239 *
»suÉ
;

1240 
¡bi__cÚ‹xt
 
s
;

1241 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

1243 
»suÉ
 = (*è
	`¡bi__lßd_gif_maš
(&
s
, 
d–ays
, 
x
, 
y
, 
z
, 
comp
, 
»q_comp
);

1244 ià(
¡bi__v”tiÿÎy_æ_Ú_lßd
) {

1245 
	`¡bi__v”tiÿl_æ_¦iûs
Ğ
»suÉ
, *
x
, *
y
, *
z
, *
comp
 );

1248  
»suÉ
;

1249 
	}
}

1252 #iâdeà
STBI_NO_LINEAR


1253 *
	$¡bi__lßdf_maš
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
)

1255 *
d©a
;

1256 #iâdeà
STBI_NO_HDR


1257 ià(
	`¡bi__hdr_‹¡
(
s
)) {

1258 
¡bi__»suÉ_šfo
 
ri
;

1259 *
hdr_d©a
 = 
	`¡bi__hdr_lßd
(
s
,
x
,
y
,
comp
,
»q_comp
, &
ri
);

1260 ià(
hdr_d©a
)

1261 
	`¡bi__æßt_po¡´oûss
(
hdr_d©a
,
x
,
y
,
comp
,
»q_comp
);

1262  
hdr_d©a
;

1265 
d©a
 = 
	`¡bi__lßd_ªd_po¡´oûss_8b™
(
s
, 
x
, 
y
, 
comp
, 
»q_comp
);

1266 ià(
d©a
)

1267  
	`¡bi__ldr_to_hdr
(
d©a
, *
x
, *
y
, 
»q_comp
 ?„eq_com°: *
comp
);

1268  
	`¡bi__”½f
("unknown imageype", "Image‚ot of‡ny knownype, or corrupt");

1269 
	}
}

1271 
STBIDEF
 *
	$¡bi_lßdf_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
comp
, 
»q_comp
)

1273 
¡bi__cÚ‹xt
 
s
;

1274 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

1275  
	`¡bi__lßdf_maš
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1276 
	}
}

1278 
STBIDEF
 *
	$¡bi_lßdf_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
comp
, 
»q_comp
)

1280 
¡bi__cÚ‹xt
 
s
;

1281 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *è
şbk
, 
u£r
);

1282  
	`¡bi__lßdf_maš
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1283 
	}
}

1285 #iâdeà
STBI_NO_STDIO


1286 
STBIDEF
 *
	$¡bi_lßdf
(cÚ¡ *
f’ame
, *
x
, *
y
, *
comp
, 
»q_comp
)

1288 *
»suÉ
;

1289 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

1290 ià(!
f
è 
	`¡bi__”½f
("can't fopen", "Unableo open file");

1291 
»suÉ
 = 
	`¡bi_lßdf_äom_fe
(
f
,
x
,
y
,
comp
,
»q_comp
);

1292 
	`fşo£
(
f
);

1293  
»suÉ
;

1294 
	}
}

1296 
STBIDEF
 *
	$¡bi_lßdf_äom_fe
(
FILE
 *
f
, *
x
, *
y
, *
comp
, 
»q_comp
)

1298 
¡bi__cÚ‹xt
 
s
;

1299 
	`¡bi__¡¬t_fe
(&
s
,
f
);

1300  
	`¡bi__lßdf_maš
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1301 
	}
}

1310 
STBIDEF
 
	$¡bi_is_hdr_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
)

1312 #iâdeà
STBI_NO_HDR


1313 
¡bi__cÚ‹xt
 
s
;

1314 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

1315  
	`¡bi__hdr_‹¡
(&
s
);

1317 
	`STBI_NOTUSED
(
bufãr
);

1318 
	`STBI_NOTUSED
(
Ën
);

1321 
	}
}

1323 #iâdeà
STBI_NO_STDIO


1324 
STBIDEF
 
	$¡bi_is_hdr
 (cÚ¡ *
f’ame
)

1326 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

1327 
»suÉ
=0;

1328 ià(
f
) {

1329 
»suÉ
 = 
	`¡bi_is_hdr_äom_fe
(
f
);

1330 
	`fşo£
(
f
);

1332  
»suÉ
;

1333 
	}
}

1335 
STBIDEF
 
	$¡bi_is_hdr_äom_fe
(
FILE
 *
f
)

1337 #iâdeà
STBI_NO_HDR


1338 
pos
 = 
	`á–l
(
f
);

1339 
»s
;

1340 
¡bi__cÚ‹xt
 
s
;

1341 
	`¡bi__¡¬t_fe
(&
s
,
f
);

1342 
»s
 = 
	`¡bi__hdr_‹¡
(&
s
);

1343 
	`f£ek
(
f
, 
pos
, 
SEEK_SET
);

1344  
»s
;

1346 
	`STBI_NOTUSED
(
f
);

1349 
	}
}

1352 
STBIDEF
 
	$¡bi_is_hdr_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
)

1354 #iâdeà
STBI_NO_HDR


1355 
¡bi__cÚ‹xt
 
s
;

1356 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *è
şbk
, 
u£r
);

1357  
	`¡bi__hdr_‹¡
(&
s
);

1359 
	`STBI_NOTUSED
(
şbk
);

1360 
	`STBI_NOTUSED
(
u£r
);

1363 
	}
}

1365 #iâdeà
STBI_NO_LINEAR


1366 
	g¡bi__l2h_gamma
=2.2f, 
	g¡bi__l2h_sÿË
=1.0f;

1368 
STBIDEF
 
	$¡bi_ldr_to_hdr_gamma
(
gamma
è{ 
¡bi__l2h_gamma
 = gamma; 
	}
}

1369 
STBIDEF
 
	$¡bi_ldr_to_hdr_sÿË
(
sÿË
è{ 
¡bi__l2h_sÿË
 = sÿË; 
	}
}

1372 
	g¡bi__h2l_gamma_i
=1.0f/2.2f, 
	g¡bi__h2l_sÿË_i
=1.0f;

1374 
STBIDEF
 
	$¡bi_hdr_to_ldr_gamma
(
gamma
è{ 
¡bi__h2l_gamma_i
 = 1/gamma; 
	}
}

1375 
STBIDEF
 
	$¡bi_hdr_to_ldr_sÿË
(
sÿË
è{ 
¡bi__h2l_sÿË_i
 = 1/sÿË; 
	}
}

1385 
	mSTBI__SCAN_lßd
=0,

1386 
	mSTBI__SCAN_ty³
,

1387 
	mSTBI__SCAN_h—d”


1390 
	$¡bi__»fl_bufãr
(
¡bi__cÚ‹xt
 *
s
)

1392 
n
 = (
s
->
io
.
»ad
)(s->
io_u£r_d©a
,(*)s->
bufãr_¡¬t
,s->
buæ’
);

1393 ià(
n
 == 0) {

1396 
s
->
»ad_äom_ÿÎbacks
 = 0;

1397 
s
->
img_bufãr
 = s->
bufãr_¡¬t
;

1398 
s
->
img_bufãr_’d
 = s->
bufãr_¡¬t
+1;

1399 *
s
->
img_bufãr
 = 0;

1401 
s
->
img_bufãr
 = s->
bufãr_¡¬t
;

1402 
s
->
img_bufãr_’d
 = s->
bufãr_¡¬t
 + 
n
;

1404 
	}
}

1406 
¡bi_šlše
 
¡bi_uc
 
	$¡bi__g‘8
(
¡bi__cÚ‹xt
 *
s
)

1408 ià(
s
->
img_bufãr
 < s->
img_bufãr_’d
)

1409  *
s
->
img_bufãr
++;

1410 ià(
s
->
»ad_äom_ÿÎbacks
) {

1411 
	`¡bi__»fl_bufãr
(
s
);

1412  *
s
->
img_bufãr
++;

1415 
	}
}

1417 
¡bi_šlše
 
	$¡bi__©_eof
(
¡bi__cÚ‹xt
 *
s
)

1419 ià(
s
->
io
.
»ad
) {

1420 ià(!(
s
->
io
.
eof
)(s->
io_u£r_d©a
))  0;

1423 ià(
s
->
»ad_äom_ÿÎbacks
 == 0)  1;

1426  
s
->
img_bufãr
 >ğs->
img_bufãr_’d
;

1427 
	}
}

1429 
	$¡bi__sk
(
¡bi__cÚ‹xt
 *
s
, 
n
)

1431 ià(
n
 < 0) {

1432 
s
->
img_bufãr
 = s->
img_bufãr_’d
;

1435 ià(
s
->
io
.
»ad
) {

1436 
bËn
 = (è(
s
->
img_bufãr_’d
 - s->
img_bufãr
);

1437 ià(
bËn
 < 
n
) {

1438 
s
->
img_bufãr
 = s->
img_bufãr_’d
;

1439 (
s
->
io
.
sk
)(s->
io_u£r_d©a
, 
n
 - 
bËn
);

1443 
s
->
img_bufãr
 +ğ
n
;

1444 
	}
}

1446 
	$¡bi__g‘n
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_uc
 *
bufãr
, 
n
)

1448 ià(
s
->
io
.
»ad
) {

1449 
bËn
 = (è(
s
->
img_bufãr_’d
 - s->
img_bufãr
);

1450 ià(
bËn
 < 
n
) {

1451 
»s
, 
couÁ
;

1453 
	`memıy
(
bufãr
, 
s
->
img_bufãr
, 
bËn
);

1455 
couÁ
 = (
s
->
io
.
»ad
)(s->
io_u£r_d©a
, (*è
bufãr
 + 
bËn
, 
n
 - blen);

1456 
»s
 = (
couÁ
 =ğ(
n
-
bËn
));

1457 
s
->
img_bufãr
 = s->
img_bufãr_’d
;

1458  
»s
;

1462 ià(
s
->
img_bufãr
+
n
 <ğs->
img_bufãr_’d
) {

1463 
	`memıy
(
bufãr
, 
s
->
img_bufãr
, 
n
);

1464 
s
->
img_bufãr
 +ğ
n
;

1468 
	}
}

1470 
	$¡bi__g‘16be
(
¡bi__cÚ‹xt
 *
s
)

1472 
z
 = 
	`¡bi__g‘8
(
s
);

1473  (
z
 << 8è+ 
	`¡bi__g‘8
(
s
);

1474 
	}
}

1476 
¡bi__ušt32
 
	$¡bi__g‘32be
(
¡bi__cÚ‹xt
 *
s
)

1478 
¡bi__ušt32
 
z
 = 
	`¡bi__g‘16be
(
s
);

1479  (
z
 << 16è+ 
	`¡bi__g‘16be
(
s
);

1480 
	}
}

1482 #ià
defšed
(
STBI_NO_BMP
è&& defšed(
STBI_NO_TGA
è&& defšed(
STBI_NO_GIF
)

1485 
	$¡bi__g‘16Ë
(
¡bi__cÚ‹xt
 *
s
)

1487 
z
 = 
	`¡bi__g‘8
(
s
);

1488  
z
 + (
	`¡bi__g‘8
(
s
) << 8);

1489 
	}
}

1492 #iâdeà
STBI_NO_BMP


1493 
¡bi__ušt32
 
	$¡bi__g‘32Ë
(
¡bi__cÚ‹xt
 *
s
)

1495 
¡bi__ušt32
 
z
 = 
	`¡bi__g‘16Ë
(
s
);

1496  
z
 + (
	`¡bi__g‘16Ë
(
s
) << 16);

1497 
	}
}

1500 
	#STBI__BYTECAST
(
x
è((
¡bi_uc
) ((x) & 255))

1501 

	)

1514 
¡bi_uc
 
	$¡bi__compu‹_y
(
r
, 
g
, 
b
)

1516  (
¡bi_uc
è(((
r
*77è+ (
g
*150è+ (29*
b
)) >> 8);

1517 
	}
}

1519 *
	$¡bi__cÚv”t_fÜm©
(*
d©a
, 
img_n
, 
»q_comp
, 
x
, 
y
)

1521 
i
,
j
;

1522 *
good
;

1524 ià(
»q_comp
 =ğ
img_n
è 
d©a
;

1525 
	`STBI_ASSERT
(
»q_comp
 >= 1 &&„eq_comp <= 4);

1527 
good
 = (*è
	`¡bi__m®loc_mad3
(
»q_comp
, 
x
, 
y
, 0);

1528 ià(
good
 =ğ
NULL
) {

1529 
	`STBI_FREE
(
d©a
);

1530  
	`¡bi__”½uc
("outofmem", "Out of memory");

1533 
j
=0; j < (è
y
; ++j) {

1534 *
¤c
 = 
d©a
 + 
j
 * 
x
 * 
img_n
 ;

1535 *
de¡
 = 
good
 + 
j
 * 
x
 * 
»q_comp
;

1537 
	#STBI__COMBO
(
a
,
b
è(×)*8+(b))

	)

1538 
	#STBI__CASE
(
a
,
b
è
	`STBI__COMBO
×,b): 
i
=
x
-1; i >ğ0; --i, 
¤c
 +ğa, 
de¡
 +ğb)

	)

1541 
	`STBI__COMBO
(
img_n
, 
»q_comp
)) {

1542 
	`STBI__CASE
(1,2è{ 
de¡
[0]=
¤c
[0], dest[1]=255; } ;

1543 
	`STBI__CASE
(1,3è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; } ;

1544 
	`STBI__CASE
(1,4è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0], dest[3]=255; } ;

1545 
	`STBI__CASE
(2,1è{ 
de¡
[0]=
¤c
[0]; } ;

1546 
	`STBI__CASE
(2,3è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; } ;

1547 
	`STBI__CASE
(2,4è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0], dest[3]=src[1]; } ;

1548 
	`STBI__CASE
(3,4è{ 
de¡
[0]=
¤c
[0],dest[1]=src[1],dest[2]=src[2],dest[3]=255; } ;

1549 
	`STBI__CASE
(3,1è{ 
de¡
[0]=
	`¡bi__compu‹_y
(
¤c
[0],src[1],src[2]); } ;

1550 
	`STBI__CASE
(3,2è{ 
de¡
[0]=
	`¡bi__compu‹_y
(
¤c
[0],src[1],src[2]), dest[1] = 255; } ;

1551 
	`STBI__CASE
(4,1è{ 
de¡
[0]=
	`¡bi__compu‹_y
(
¤c
[0],src[1],src[2]); } ;

1552 
	`STBI__CASE
(4,2è{ 
de¡
[0]=
	`¡bi__compu‹_y
(
¤c
[0],src[1],src[2]), dest[1] = src[3]; } ;

1553 
	`STBI__CASE
(4,3è{ 
de¡
[0]=
¤c
[0],dest[1]=src[1],dest[2]=src[2]; } ;

1554 : 
	`STBI_ASSERT
(0);

1556 #undeà
STBI__CASE


1559 
	`STBI_FREE
(
d©a
);

1560  
good
;

1561 
	}
}

1563 
¡bi__ušt16
 
	$¡bi__compu‹_y_16
(
r
, 
g
, 
b
)

1565  (
¡bi__ušt16
è(((
r
*77è+ (
g
*150è+ (29*
b
)) >> 8);

1566 
	}
}

1568 
¡bi__ušt16
 *
	$¡bi__cÚv”t_fÜm©16
(
¡bi__ušt16
 *
d©a
, 
img_n
, 
»q_comp
, 
x
, 
y
)

1570 
i
,
j
;

1571 
¡bi__ušt16
 *
good
;

1573 ià(
»q_comp
 =ğ
img_n
è 
d©a
;

1574 
	`STBI_ASSERT
(
»q_comp
 >= 1 &&„eq_comp <= 4);

1576 
good
 = (
¡bi__ušt16
 *è
	`¡bi__m®loc
(
»q_comp
 * 
x
 * 
y
 * 2);

1577 ià(
good
 =ğ
NULL
) {

1578 
	`STBI_FREE
(
d©a
);

1579  (
¡bi__ušt16
 *è
	`¡bi__”½uc
("outofmem", "Out of memory");

1582 
j
=0; j < (è
y
; ++j) {

1583 
¡bi__ušt16
 *
¤c
 = 
d©a
 + 
j
 * 
x
 * 
img_n
 ;

1584 
¡bi__ušt16
 *
de¡
 = 
good
 + 
j
 * 
x
 * 
»q_comp
;

1586 
	#STBI__COMBO
(
a
,
b
è(×)*8+(b))

	)

1587 
	#STBI__CASE
(
a
,
b
è
	`STBI__COMBO
×,b): 
i
=
x
-1; i >ğ0; --i, 
¤c
 +ğa, 
de¡
 +ğb)

	)

1590 
	`STBI__COMBO
(
img_n
, 
»q_comp
)) {

1591 
	`STBI__CASE
(1,2è{ 
de¡
[0]=
¤c
[0], dest[1]=0xffff; } ;

1592 
	`STBI__CASE
(1,3è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; } ;

1593 
	`STBI__CASE
(1,4è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0], dest[3]=0xffff; } ;

1594 
	`STBI__CASE
(2,1è{ 
de¡
[0]=
¤c
[0]; } ;

1595 
	`STBI__CASE
(2,3è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; } ;

1596 
	`STBI__CASE
(2,4è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0], dest[3]=src[1]; } ;

1597 
	`STBI__CASE
(3,4è{ 
de¡
[0]=
¤c
[0],dest[1]=src[1],dest[2]=src[2],dest[3]=0xffff; } ;

1598 
	`STBI__CASE
(3,1è{ 
de¡
[0]=
	`¡bi__compu‹_y_16
(
¤c
[0],src[1],src[2]); } ;

1599 
	`STBI__CASE
(3,2è{ 
de¡
[0]=
	`¡bi__compu‹_y_16
(
¤c
[0],src[1],src[2]), dest[1] = 0xffff; } ;

1600 
	`STBI__CASE
(4,1è{ 
de¡
[0]=
	`¡bi__compu‹_y_16
(
¤c
[0],src[1],src[2]); } ;

1601 
	`STBI__CASE
(4,2è{ 
de¡
[0]=
	`¡bi__compu‹_y_16
(
¤c
[0],src[1],src[2]), dest[1] = src[3]; } ;

1602 
	`STBI__CASE
(4,3è{ 
de¡
[0]=
¤c
[0],dest[1]=src[1],dest[2]=src[2]; } ;

1603 : 
	`STBI_ASSERT
(0);

1605 #undeà
STBI__CASE


1608 
	`STBI_FREE
(
d©a
);

1609  
good
;

1610 
	}
}

1612 #iâdeà
STBI_NO_LINEAR


1613 *
	$¡bi__ldr_to_hdr
(
¡bi_uc
 *
d©a
, 
x
, 
y
, 
comp
)

1615 
i
,
k
,
n
;

1616 *
ouut
;

1617 ià(!
d©a
è 
NULL
;

1618 
ouut
 = (*è
	`¡bi__m®loc_mad4
(
x
, 
y
, 
comp
, (), 0);

1619 ià(
ouut
 =ğ
NULL
è{ 
	`STBI_FREE
(
d©a
);  
	`¡bi__”½f
("outofmem", "Out of memory"); }

1621 ià(
comp
 & 1è
n
 = comp; n = comp-1;

1622 
i
=0; i < 
x
*
y
; ++i) {

1623 
k
=0; k < 
n
; ++k) {

1624 
ouut
[
i
*
comp
 + 
k
] = (è(
	`pow
(
d©a
[i*comp+k]/255.0f, 
¡bi__l2h_gamma
è* 
¡bi__l2h_sÿË
);

1626 ià(
k
 < 
comp
è
ouut
[
i
*com°+ k] = 
d©a
[i*comp+k]/255.0f;

1628 
	`STBI_FREE
(
d©a
);

1629  
ouut
;

1630 
	}
}

1633 #iâdeà
STBI_NO_HDR


1634 
	#¡bi__æßt2št
(
x
è((è(x))

	)

1635 
¡bi_uc
 *
	$¡bi__hdr_to_ldr
(*
d©a
, 
x
, 
y
, 
comp
)

1637 
i
,
k
,
n
;

1638 
¡bi_uc
 *
ouut
;

1639 ià(!
d©a
è 
NULL
;

1640 
ouut
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
x
, 
y
, 
comp
, 0);

1641 ià(
ouut
 =ğ
NULL
è{ 
	`STBI_FREE
(
d©a
);  
	`¡bi__”½uc
("outofmem", "Out of memory"); }

1643 ià(
comp
 & 1è
n
 = comp; n = comp-1;

1644 
i
=0; i < 
x
*
y
; ++i) {

1645 
k
=0; k < 
n
; ++k) {

1646 
z
 = (è
	`pow
(
d©a
[
i
*
comp
+
k
]*
¡bi__h2l_sÿË_i
, 
¡bi__h2l_gamma_i
) * 255 + 0.5f;

1647 ià(
z
 < 0) z = 0;

1648 ià(
z
 > 255) z = 255;

1649 
ouut
[
i
*
comp
 + 
k
] = (
¡bi_uc
è
	`¡bi__æßt2št
(
z
);

1651 ià(
k
 < 
comp
) {

1652 
z
 = 
d©a
[
i
*
comp
+
k
] * 255 + 0.5f;

1653 ià(
z
 < 0) z = 0;

1654 ià(
z
 > 255) z = 255;

1655 
ouut
[
i
*
comp
 + 
k
] = (
¡bi_uc
è
	`¡bi__æßt2št
(
z
);

1658 
	`STBI_FREE
(
d©a
);

1659  
ouut
;

1660 
	}
}

1684 #iâdeà
STBI_NO_JPEG


1687 
	#FAST_BITS
 9

1688 

	)

1691 
¡bi_uc
 
	mç¡
[1 << 
FAST_BITS
];

1693 
¡bi__ušt16
 
	mcode
[256];

1694 
¡bi_uc
 
	mv®ues
[256];

1695 
¡bi_uc
 
	msize
[257];

1696 
	mmaxcode
[18];

1697 
	md–
[17];

1698 } 
	t¡bi__huffmª
;

1702 
¡bi__cÚ‹xt
 *
	ms
;

1703 
¡bi__huffmª
 
	mhuff_dc
[4];

1704 
¡bi__huffmª
 
	mhuff_ac
[4];

1705 
¡bi__ušt16
 
	mdequªt
[4][64];

1706 
¡bi__št16
 
	mç¡_ac
[4][1 << 
FAST_BITS
];

1709 
	mimg_h_max
, 
	mimg_v_max
;

1710 
	mimg_mcu_x
, 
	mimg_mcu_y
;

1711 
	mimg_mcu_w
, 
	mimg_mcu_h
;

1716 
	mid
;

1717 
	mh
,
	mv
;

1718 
	mtq
;

1719 
	mhd
,
	mha
;

1720 
	mdc_´ed
;

1722 
	mx
,
	my
,
	mw2
,
	mh2
;

1723 
¡bi_uc
 *
	md©a
;

1724 *
	m¿w_d©a
, *
	m¿w_cÛff
;

1725 
¡bi_uc
 *
	mlšebuf
;

1726 *
	mcÛff
;

1727 
	mcÛff_w
, 
	mcÛff_h
;

1728 } 
	mimg_comp
[4];

1730 
¡bi__ušt32
 
	mcode_bufãr
;

1731 
	mcode_b™s
;

1732 
	mm¬k”
;

1733 
	mnomÜe
;

1735 
	m´og»ssive
;

1736 
	m¥ec_¡¬t
;

1737 
	m¥ec_’d
;

1738 
	msucc_high
;

1739 
	msucc_low
;

1740 
	meob_run
;

1741 
	mjfif
;

1742 
	m­p14_cŞÜ_ŒªsfÜm
;

1743 
	mrgb
;

1745 
	msÿn_n
, 
	mÜd”
[4];

1746 
	m»¡¬t_š‹rv®
, 
	mtodo
;

1749 (*
	midù_block_k”Ãl
)(
¡bi_uc
 *
	mout
, 
	mout_¡ride
, 
	md©a
[64]);

1750 (*
	mYCbCr_to_RGB_k”Ãl
)(
¡bi_uc
 *
	mout
, cÚ¡ stbi_uø*
	my
, cÚ¡ stbi_uø*
	mpcb
, cÚ¡ stbi_uø*
	mpü
, 
	mcouÁ
, 
	m¡•
);

1751 
	m¡bi_uc
 *(*
	m»§m¶e_row_hv_2_k”Ãl
)(
¡bi_uc
 *
	mout
, stbi_uø*
	mš_Ã¬
, stbi_uø*
	mš_çr
, 
	mw
, 
	mhs
);

1752 } 
	t¡bi__j³g
;

1754 
	$¡bi__bud_huffmª
(
¡bi__huffmª
 *
h
, *
couÁ
)

1756 
i
,
j
,
k
=0;

1757 
code
;

1759 
i
=0; i < 16; ++i)

1760 
j
=0; j < 
couÁ
[
i
]; ++j)

1761 
h
->
size
[
k
++] = (
¡bi_uc
è(
i
+1);

1762 
h
->
size
[
k
] = 0;

1765 
code
 = 0;

1766 
k
 = 0;

1767 
j
=1; j <= 16; ++j) {

1769 
h
->
d–
[
j
] = 
k
 - 
code
;

1770 ià(
h
->
size
[
k
] =ğ
j
) {

1771 
h
->
size
[
k
] =ğ
j
)

1772 
h
->
code
[
k
++] = (
¡bi__ušt16
) (code++);

1773 ià(
code
-1 >ğ(1u << 
j
)è 
	`¡bi__”r
("bad code†engths","Corrupt JPEG");

1776 
h
->
maxcode
[
j
] = 
code
 << (16-j);

1777 
code
 <<= 1;

1779 
h
->
maxcode
[
j
] = 0xffffffff;

1782 
	`mem£t
(
h
->
ç¡
, 255, 1 << 
FAST_BITS
);

1783 
i
=0; i < 
k
; ++i) {

1784 
s
 = 
h
->
size
[
i
];

1785 ià(
s
 <ğ
FAST_BITS
) {

1786 
c
 = 
h
->
code
[
i
] << (
FAST_BITS
-
s
);

1787 
m
 = 1 << (
FAST_BITS
-
s
);

1788 
j
=0; j < 
m
; ++j) {

1789 
h
->
ç¡
[
c
+
j
] = (
¡bi_uc
è
i
;

1794 
	}
}

1798 
	$¡bi__bud_ç¡_ac
(
¡bi__št16
 *
ç¡_ac
, 
¡bi__huffmª
 *
h
)

1800 
i
;

1801 
i
=0; i < (1 << 
FAST_BITS
); ++i) {

1802 
¡bi_uc
 
ç¡
 = 
h
->ç¡[
i
];

1803 
ç¡_ac
[
i
] = 0;

1804 ià(
ç¡
 < 255) {

1805 
rs
 = 
h
->
v®ues
[
ç¡
];

1806 
run
 = (
rs
 >> 4) & 15;

1807 
magb™s
 = 
rs
 & 15;

1808 
Ën
 = 
h
->
size
[
ç¡
];

1810 ià(
magb™s
 && 
Ën
 + magb™ <ğ
FAST_BITS
) {

1812 
k
 = ((
i
 << 
Ën
è& ((1 << 
FAST_BITS
è- 1)è>> (FAST_BITS - 
magb™s
);

1813 
m
 = 1 << (
magb™s
 - 1);

1814 ià(
k
 < 
m
èk +ğ(~0U << 
magb™s
) + 1;

1816 ià(
k
 >= -128 && k <= 127)

1817 
ç¡_ac
[
i
] = (
¡bi__št16
è((
k
 * 256è+ (
run
 * 16è+ (
Ën
 + 
magb™s
));

1821 
	}
}

1823 
	$¡bi__grow_bufãr_un§ã
(
¡bi__j³g
 *
j
)

1826 
b
 = 
j
->
nomÜe
 ? 0 : 
	`¡bi__g‘8
(j->
s
);

1827 ià(
b
 == 0xff) {

1828 
c
 = 
	`¡bi__g‘8
(
j
->
s
);

1829 
c
 =ğ0xffèøğ
	`¡bi__g‘8
(
j
->
s
);

1830 ià(
c
 != 0) {

1831 
j
->
m¬k”
 = (è
c
;

1832 
j
->
nomÜe
 = 1;

1836 
j
->
code_bufãr
 |ğ
b
 << (24 - j->
code_b™s
);

1837 
j
->
code_b™s
 += 8;

1838 } 
j
->
code_b™s
 <= 24);

1839 
	}
}

1842 cÚ¡ 
¡bi__ušt32
 
	g¡bi__bmask
[17]={0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535};

1845 
¡bi_šlše
 
	$¡bi__j³g_huff_decode
(
¡bi__j³g
 *
j
, 
¡bi__huffmª
 *
h
)

1847 
‹mp
;

1848 
c
,
k
;

1850 ià(
j
->
code_b™s
 < 16è
	`¡bi__grow_bufãr_un§ã
(j);

1854 
c
 = (
j
->
code_bufãr
 >> (32 - 
FAST_BITS
)) & ((1 << FAST_BITS)-1);

1855 
k
 = 
h
->
ç¡
[
c
];

1856 ià(
k
 < 255) {

1857 
s
 = 
h
->
size
[
k
];

1858 ià(
s
 > 
j
->
code_b™s
)

1860 
j
->
code_bufãr
 <<ğ
s
;

1861 
j
->
code_b™s
 -ğ
s
;

1862  
h
->
v®ues
[
k
];

1871 
‹mp
 = 
j
->
code_bufãr
 >> 16;

1872 
k
=
FAST_BITS
+1 ; ; ++k)

1873 ià(
‹mp
 < 
h
->
maxcode
[
k
])

1875 ià(
k
 == 17) {

1877 
j
->
code_b™s
 -= 16;

1881 ià(
k
 > 
j
->
code_b™s
)

1885 
c
 = ((
j
->
code_bufãr
 >> (32 - 
k
)è& 
¡bi__bmask
[k]è+ 
h
->
d–
[k];

1886 
	`STBI_ASSERT
((((
j
->
code_bufãr
è>> (32 - 
h
->
size
[
c
])è& 
¡bi__bmask
[h->size[c]]è=ğh->
code
[c]);

1889 
j
->
code_b™s
 -ğ
k
;

1890 
j
->
code_bufãr
 <<ğ
k
;

1891  
h
->
v®ues
[
c
];

1892 
	}
}

1895 cÚ¡ 
	g¡bi__jbŸs
[16] = {0,-1,-3,-7,-15,-31,-63,-127,-255,-511,-1023,-2047,-4095,-8191,-16383,-32767};

1899 
¡bi_šlše
 
	$¡bi__ex‹nd_»ûive
(
¡bi__j³g
 *
j
, 
n
)

1901 
k
;

1902 
sgn
;

1903 ià(
j
->
code_b™s
 < 
n
è
	`¡bi__grow_bufãr_un§ã
(j);

1905 
sgn
 = (
¡bi__št32
)
j
->
code_bufãr
 >> 31;

1906 
k
 = 
	`¡bi_ÌÙ
(
j
->
code_bufãr
, 
n
);

1907 
	`STBI_ASSERT
(
n
 >ğ0 &&‚ < (è((
¡bi__bmask
)/(*stbi__bmask)));

1908 
j
->
code_bufãr
 = 
k
 & ~
¡bi__bmask
[
n
];

1909 
k
 &ğ
¡bi__bmask
[
n
];

1910 
j
->
code_b™s
 -ğ
n
;

1911  
k
 + (
¡bi__jbŸs
[
n
] & ~
sgn
);

1912 
	}
}

1915 
¡bi_šlše
 
	$¡bi__j³g_g‘_b™s
(
¡bi__j³g
 *
j
, 
n
)

1917 
k
;

1918 ià(
j
->
code_b™s
 < 
n
è
	`¡bi__grow_bufãr_un§ã
(j);

1919 
k
 = 
	`¡bi_ÌÙ
(
j
->
code_bufãr
, 
n
);

1920 
j
->
code_bufãr
 = 
k
 & ~
¡bi__bmask
[
n
];

1921 
k
 &ğ
¡bi__bmask
[
n
];

1922 
j
->
code_b™s
 -ğ
n
;

1923  
k
;

1924 
	}
}

1926 
¡bi_šlše
 
	$¡bi__j³g_g‘_b™
(
¡bi__j³g
 *
j
)

1928 
k
;

1929 ià(
j
->
code_b™s
 < 1è
	`¡bi__grow_bufãr_un§ã
(j);

1930 
k
 = 
j
->
code_bufãr
;

1931 
j
->
code_bufãr
 <<= 1;

1932 --
j
->
code_b™s
;

1933  
k
 & 0x80000000;

1934 
	}
}

1938 cÚ¡ 
¡bi_uc
 
	g¡bi__j³g_dezigzag
[64+15] =

1954 
	$¡bi__j³g_decode_block
(
¡bi__j³g
 *
j
, 
d©a
[64], 
¡bi__huffmª
 *
hdc
, stbi__huffmª *
hac
, 
¡bi__št16
 *
çc
, 
b
, 
¡bi__ušt16
 *
dequªt
)

1956 
diff
,
dc
,
k
;

1957 
t
;

1959 ià(
j
->
code_b™s
 < 16è
	`¡bi__grow_bufãr_un§ã
(j);

1960 
t
 = 
	`¡bi__j³g_huff_decode
(
j
, 
hdc
);

1961 ià(
t
 < 0è 
	`¡bi__”r
("bad huffman code","Corrupt JPEG");

1964 
	`mem£t
(
d©a
,0,64*(data[0]));

1966 
diff
 = 
t
 ? 
	`¡bi__ex‹nd_»ûive
(
j
,) : 0;

1967 
dc
 = 
j
->
img_comp
[
b
].
dc_´ed
 + 
diff
;

1968 
j
->
img_comp
[
b
].
dc_´ed
 = 
dc
;

1969 
d©a
[0] = (è(
dc
 * 
dequªt
[0]);

1972 
k
 = 1;

1974 
zig
;

1975 
c
,
r
,
s
;

1976 ià(
j
->
code_b™s
 < 16è
	`¡bi__grow_bufãr_un§ã
(j);

1977 
c
 = (
j
->
code_bufãr
 >> (32 - 
FAST_BITS
)) & ((1 << FAST_BITS)-1);

1978 
r
 = 
çc
[
c
];

1979 ià(
r
) {

1980 
k
 +ğ(
r
 >> 4) & 15;

1981 
s
 = 
r
 & 15;

1982 
j
->
code_bufãr
 <<ğ
s
;

1983 
j
->
code_b™s
 -ğ
s
;

1985 
zig
 = 
¡bi__j³g_dezigzag
[
k
++];

1986 
d©a
[
zig
] = (è((
r
 >> 8è* 
dequªt
[zig]);

1988 
rs
 = 
	`¡bi__j³g_huff_decode
(
j
, 
hac
);

1989 ià(
rs
 < 0è 
	`¡bi__”r
("bad huffman code","Corrupt JPEG");

1990 
s
 = 
rs
 & 15;

1991 
r
 = 
rs
 >> 4;

1992 ià(
s
 == 0) {

1993 ià(
rs
 != 0xf0) ;

1994 
k
 += 16;

1996 
k
 +ğ
r
;

1998 
zig
 = 
¡bi__j³g_dezigzag
[
k
++];

1999 
d©a
[
zig
] = (è(
	`¡bi__ex‹nd_»ûive
(
j
,
s
è* 
dequªt
[zig]);

2002 } 
k
 < 64);

2004 
	}
}

2006 
	$¡bi__j³g_decode_block_´og_dc
(
¡bi__j³g
 *
j
, 
d©a
[64], 
¡bi__huffmª
 *
hdc
, 
b
)

2008 
diff
,
dc
;

2009 
t
;

2010 ià(
j
->
¥ec_’d
 !ğ0è 
	`¡bi__”r
("can't merge dc‡nd‡c", "Corrupt JPEG");

2012 ià(
j
->
code_b™s
 < 16è
	`¡bi__grow_bufãr_un§ã
(j);

2014 ià(
j
->
succ_high
 == 0) {

2016 
	`mem£t
(
d©a
,0,64*(data[0]));

2017 
t
 = 
	`¡bi__j³g_huff_decode
(
j
, 
hdc
);

2018 
diff
 = 
t
 ? 
	`¡bi__ex‹nd_»ûive
(
j
,) : 0;

2020 
dc
 = 
j
->
img_comp
[
b
].
dc_´ed
 + 
diff
;

2021 
j
->
img_comp
[
b
].
dc_´ed
 = 
dc
;

2022 
d©a
[0] = (è(
dc
 << 
j
->
succ_low
);

2025 ià(
	`¡bi__j³g_g‘_b™
(
j
))

2026 
d©a
[0] +ğ(è(1 << 
j
->
succ_low
);

2029 
	}
}

2033 
	$¡bi__j³g_decode_block_´og_ac
(
¡bi__j³g
 *
j
, 
d©a
[64], 
¡bi__huffmª
 *
hac
, 
¡bi__št16
 *
çc
)

2035 
k
;

2036 ià(
j
->
¥ec_¡¬t
 =ğ0è 
	`¡bi__”r
("can't merge dc‡nd‡c", "Corrupt JPEG");

2038 ià(
j
->
succ_high
 == 0) {

2039 
shiá
 = 
j
->
succ_low
;

2041 ià(
j
->
eob_run
) {

2042 --
j
->
eob_run
;

2046 
k
 = 
j
->
¥ec_¡¬t
;

2048 
zig
;

2049 
c
,
r
,
s
;

2050 ià(
j
->
code_b™s
 < 16è
	`¡bi__grow_bufãr_un§ã
(j);

2051 
c
 = (
j
->
code_bufãr
 >> (32 - 
FAST_BITS
)) & ((1 << FAST_BITS)-1);

2052 
r
 = 
çc
[
c
];

2053 ià(
r
) {

2054 
k
 +ğ(
r
 >> 4) & 15;

2055 
s
 = 
r
 & 15;

2056 
j
->
code_bufãr
 <<ğ
s
;

2057 
j
->
code_b™s
 -ğ
s
;

2058 
zig
 = 
¡bi__j³g_dezigzag
[
k
++];

2059 
d©a
[
zig
] = (è((
r
 >> 8è<< 
shiá
);

2061 
rs
 = 
	`¡bi__j³g_huff_decode
(
j
, 
hac
);

2062 ià(
rs
 < 0è 
	`¡bi__”r
("bad huffman code","Corrupt JPEG");

2063 
s
 = 
rs
 & 15;

2064 
r
 = 
rs
 >> 4;

2065 ià(
s
 == 0) {

2066 ià(
r
 < 15) {

2067 
j
->
eob_run
 = (1 << 
r
);

2068 ià(
r
)

2069 
j
->
eob_run
 +ğ
	`¡bi__j³g_g‘_b™s
(j, 
r
);

2070 --
j
->
eob_run
;

2073 
k
 += 16;

2075 
k
 +ğ
r
;

2076 
zig
 = 
¡bi__j³g_dezigzag
[
k
++];

2077 
d©a
[
zig
] = (è(
	`¡bi__ex‹nd_»ûive
(
j
,
s
è<< 
shiá
);

2080 } 
k
 <ğ
j
->
¥ec_’d
);

2084 
b™
 = (è(1 << 
j
->
succ_low
);

2086 ià(
j
->
eob_run
) {

2087 --
j
->
eob_run
;

2088 
k
 = 
j
->
¥ec_¡¬t
; k <ğj->
¥ec_’d
; ++k) {

2089 *
p
 = &
d©a
[
¡bi__j³g_dezigzag
[
k
]];

2090 ià(*
p
 != 0)

2091 ià(
	`¡bi__j³g_g‘_b™
(
j
))

2092 ià((*
p
 & 
b™
)==0) {

2093 ià(*
p
 > 0)

2094 *
p
 +ğ
b™
;

2096 *
p
 -ğ
b™
;

2100 
k
 = 
j
->
¥ec_¡¬t
;

2102 
r
,
s
;

2103 
rs
 = 
	`¡bi__j³g_huff_decode
(
j
, 
hac
);

2104 ià(
rs
 < 0è 
	`¡bi__”r
("bad huffman code","Corrupt JPEG");

2105 
s
 = 
rs
 & 15;

2106 
r
 = 
rs
 >> 4;

2107 ià(
s
 == 0) {

2108 ià(
r
 < 15) {

2109 
j
->
eob_run
 = (1 << 
r
) - 1;

2110 ià(
r
)

2111 
j
->
eob_run
 +ğ
	`¡bi__j³g_g‘_b™s
(j, 
r
);

2112 
r
 = 64;

2119 ià(
s
 !ğ1è 
	`¡bi__”r
("bad huffman code", "Corrupt JPEG");

2121 ià(
	`¡bi__j³g_g‘_b™
(
j
))

2122 
s
 = 
b™
;

2124 
s
 = -
b™
;

2128 
k
 <ğ
j
->
¥ec_’d
) {

2129 *
p
 = &
d©a
[
¡bi__j³g_dezigzag
[
k
++]];

2130 ià(*
p
 != 0) {

2131 ià(
	`¡bi__j³g_g‘_b™
(
j
))

2132 ià((*
p
 & 
b™
)==0) {

2133 ià(*
p
 > 0)

2134 *
p
 +ğ
b™
;

2136 *
p
 -ğ
b™
;

2139 ià(
r
 == 0) {

2140 *
p
 = (è
s
;

2143 --
r
;

2146 } 
k
 <ğ
j
->
¥ec_’d
);

2150 
	}
}

2153 
¡bi_šlše
 
¡bi_uc
 
	$¡bi__şamp
(
x
)

2156 ià((è
x
 > 255) {

2157 ià(
x
 < 0)  0;

2158 ià(
x
 > 255)  255;

2160  (
¡bi_uc
è
x
;

2161 
	}
}

2163 
	#¡bi__f2f
(
x
è((è(((xè* 4096 + 0.5)))

	)

2164 
	#¡bi__fsh
(
x
è((xè* 4096)

	)

2167 
	#STBI__IDCT_1D
(
s0
,
s1
,
s2
,
s3
,
s4
,
s5
,
s6
,
s7
) \

2168 
t0
,
t1
,
t2
,
t3
,
p1
,
p2
,
p3
,
p4
,
p5
,
x0
,
x1
,
x2
,
x3
; \

2169 
p2
 = 
s2
; \

2170 
p3
 = 
s6
; \

2171 
p1
 = (
p2
+
p3
è* 
	`¡bi__f2f
(0.5411961f); \

2172 
t2
 = 
p1
 + 
p3
*
	`¡bi__f2f
(-1.847759065f); \

2173 
t3
 = 
p1
 + 
p2
*
	`¡bi__f2f
( 0.765366865f); \

2174 
p2
 = 
s0
; \

2175 
p3
 = 
s4
; \

2176 
t0
 = 
	`¡bi__fsh
(
p2
+
p3
); \

2177 
t1
 = 
	`¡bi__fsh
(
p2
-
p3
); \

2178 
x0
 = 
t0
+
t3
; \

2179 
x3
 = 
t0
-
t3
; \

2180 
x1
 = 
t1
+
t2
; \

2181 
x2
 = 
t1
-
t2
; \

2182 
t0
 = 
s7
; \

2183 
t1
 = 
s5
; \

2184 
t2
 = 
s3
; \

2185 
t3
 = 
s1
; \

2186 
p3
 = 
t0
+
t2
; \

2187 
p4
 = 
t1
+
t3
; \

2188 
p1
 = 
t0
+
t3
; \

2189 
p2
 = 
t1
+
t2
; \

2190 
p5
 = (
p3
+
p4
)*
	`¡bi__f2f
( 1.175875602f); \

2191 
t0
 =0*
	`¡bi__f2f
( 0.298631336f); \

2192 
t1
 =1*
	`¡bi__f2f
( 2.053119869f); \

2193 
t2
 =2*
	`¡bi__f2f
( 3.072711026f); \

2194 
t3
 =3*
	`¡bi__f2f
( 1.501321110f); \

2195 
p1
 = 
p5
 +…1*
	`¡bi__f2f
(-0.899976223f); \

2196 
p2
 = 
p5
 +…2*
	`¡bi__f2f
(-2.562915447f); \

2197 
p3
 =…3*
	`¡bi__f2f
(-1.961570560f); \

2198 
p4
 =…4*
	`¡bi__f2f
(-0.390180644f); \

2199 
t3
 +ğ
p1
+
p4
; \

2200 
t2
 +ğ
p2
+
p3
; \

2201 
t1
 +ğ
p2
+
p4
; \

2202 
t0
 +ğ
p1
+
p3
;

	)

2204 
	$¡bi__idù_block
(
¡bi_uc
 *
out
, 
out_¡ride
, 
d©a
[64])

2206 
i
,
v®
[64],*
v
=val;

2207 
¡bi_uc
 *
o
;

2208 *
d
 = 
d©a
;

2211 
i
=0; i < 8; ++i,++
d
, ++
v
) {

2213 ià(
d
[ 8]==0 && d[16]==0 && d[24]==0 && d[32]==0

2214 && 
d
[40]==0 && d[48]==0 && d[56]==0) {

2219 
dù”m
 = 
d
[0]*4;

2220 
v
[0] = v[8] = v[16] = v[24] = v[32] = v[40] = v[48] = v[56] = 
dù”m
;

2222 
	`STBI__IDCT_1D
(
d
[ 0],d[ 8],d[16],d[24],d[32],d[40],d[48],d[56])

2225 
x0
 +ğ512; 
x1
 +ğ512; 
x2
 +ğ512; 
x3
 += 512;

2226 
v
[ 0] = (
x0
+
t3
) >> 10;

2227 
v
[56] = (
x0
-
t3
) >> 10;

2228 
v
[ 8] = (
x1
+
t2
) >> 10;

2229 
v
[48] = (
x1
-
t2
) >> 10;

2230 
v
[16] = (
x2
+
t1
) >> 10;

2231 
v
[40] = (
x2
-
t1
) >> 10;

2232 
v
[24] = (
x3
+
t0
) >> 10;

2233 
v
[32] = (
x3
-
t0
) >> 10;

2237 
i
=0, 
v
=
v®
, 
o
=
out
; i < 8; ++i,v+=8,o+=
out_¡ride
) {

2239 
	`STBI__IDCT_1D
(
v
[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7])

2246 
x0
 += 65536 + (128<<17);

2247 
x1
 += 65536 + (128<<17);

2248 
x2
 += 65536 + (128<<17);

2249 
x3
 += 65536 + (128<<17);

2252 
o
[0] = 
	`¡bi__şamp
((
x0
+
t3
) >> 17);

2253 
o
[7] = 
	`¡bi__şamp
((
x0
-
t3
) >> 17);

2254 
o
[1] = 
	`¡bi__şamp
((
x1
+
t2
) >> 17);

2255 
o
[6] = 
	`¡bi__şamp
((
x1
-
t2
) >> 17);

2256 
o
[2] = 
	`¡bi__şamp
((
x2
+
t1
) >> 17);

2257 
o
[5] = 
	`¡bi__şamp
((
x2
-
t1
) >> 17);

2258 
o
[3] = 
	`¡bi__şamp
((
x3
+
t0
) >> 17);

2259 
o
[4] = 
	`¡bi__şamp
((
x3
-
t0
) >> 17);

2261 
	}
}

2263 #ifdeà
STBI_SSE2


2267 
	$¡bi__idù_simd
(
¡bi_uc
 *
out
, 
out_¡ride
, 
d©a
[64])

2270 
__m128i
 
row0
, 
row1
, 
row2
, 
row3
, 
row4
, 
row5
, 
row6
, 
row7
;

2271 
__m128i
 
tmp
;

2274 
	#dù_cÚ¡
(
x
,
y
è
	`_mm_£Œ_•i16
((x),(y),(x),(y),(x),(y),(x),(y))

	)

2278 
	#dù_rÙ
(
out0
,
out1
, 
x
,
y
,
c0
,
c1
) \

2279 
__m128i
 
c0
##
lo
 = 
	`_mm_uÅacklo_•i16
((
x
),(
y
)); \

2280 
__m128i
 
c0
##
hi
 = 
	`_mm_uÅackhi_•i16
((
x
),(
y
)); \

2281 
__m128i
 
out0
##
_l
 = 
	`_mm_madd_•i16
(
c0
##
lo
, c0); \

2282 
__m128i
 
out0
##
_h
 = 
	`_mm_madd_•i16
(
c0
##
hi
, c0); \

2283 
__m128i
 
out1
##
_l
 = 
	`_mm_madd_•i16
(
c0
##
lo
, 
c1
); \

2284 
__m128i
 
out1
##
_h
 = 
	`_mm_madd_•i16
(
c0
##
hi
, 
c1
)

	)

2287 
	#dù_wid’
(
out
, 
š
) \

2288 
__m128i
 
out
##
_l
 = 
	`_mm_¤ai_•i32
(
	`_mm_uÅacklo_•i16
(
	`_mm_£tz”o_si128
(), (
š
)), 4); \

2289 
__m128i
 
out
##
_h
 = 
	`_mm_¤ai_•i32
(
	`_mm_uÅackhi_•i16
(
	`_mm_£tz”o_si128
(), (
š
)), 4)

	)

2292 
	#dù_wadd
(
out
, 
a
, 
b
) \

2293 
__m128i
 
out
##
_l
 = 
	`_mm_add_•i32
(
a
##_l, 
b
##_l); \

2294 
__m128i
 
out
##
_h
 = 
	`_mm_add_•i32
(
a
##_h, 
b
##_h)

	)

2297 
	#dù_wsub
(
out
, 
a
, 
b
) \

2298 
__m128i
 
out
##
_l
 = 
	`_mm_sub_•i32
(
a
##_l, 
b
##_l); \

2299 
__m128i
 
out
##
_h
 = 
	`_mm_sub_•i32
(
a
##_h, 
b
##_h)

	)

2302 
	#dù_bæy32o
(
out0
, 
out1
, 
a
,
b
,
bŸs
,
s
) \

2304 
__m128i
 
abŸ£d_l
 = 
	`_mm_add_•i32
(
a
##
_l
, 
bŸs
); \

2305 
__m128i
 
abŸ£d_h
 = 
	`_mm_add_•i32
(
a
##
_h
, 
bŸs
); \

2306 
	`dù_wadd
(
sum
, 
abŸ£d
, 
b
); \

2307 
	`dù_wsub
(
dif
, 
abŸ£d
, 
b
); \

2308 
out0
 = 
	`_mm_·cks_•i32
(
	`_mm_¤ai_•i32
(
sum_l
, 
s
), _mm_¤ai_•i32(
sum_h
, s)); \

2309 
out1
 = 
	`_mm_·cks_•i32
(
	`_mm_¤ai_•i32
(
dif_l
, 
s
), _mm_¤ai_•i32(
dif_h
, s)); \

2310 }

	)

2313 
	#dù_š‹¾—ve8
(
a
, 
b
) \

2314 
tmp
 = 
a
; \

2315 
a
 = 
	`_mm_uÅacklo_•i8
×, 
b
); \

2316 
b
 = 
	`_mm_uÅackhi_•i8
(
tmp
, b)

	)

2319 
	#dù_š‹¾—ve16
(
a
, 
b
) \

2320 
tmp
 = 
a
; \

2321 
a
 = 
	`_mm_uÅacklo_•i16
×, 
b
); \

2322 
b
 = 
	`_mm_uÅackhi_•i16
(
tmp
, b)

	)

2324 
	#dù_·ss
(
bŸs
,
shiá
) \

2327 
	`dù_rÙ
(
t2e
,
t3e
, 
row2
,
row6
, 
rÙ0_0
,
rÙ0_1
); \

2328 
__m128i
 
sum04
 = 
	`_mm_add_•i16
(
row0
, 
row4
); \

2329 
__m128i
 
dif04
 = 
	`_mm_sub_•i16
(
row0
, 
row4
); \

2330 
	`dù_wid’
(
t0e
, 
sum04
); \

2331 
	`dù_wid’
(
t1e
, 
dif04
); \

2332 
	`dù_wadd
(
x0
, 
t0e
, 
t3e
); \

2333 
	`dù_wsub
(
x3
, 
t0e
, 
t3e
); \

2334 
	`dù_wadd
(
x1
, 
t1e
, 
t2e
); \

2335 
	`dù_wsub
(
x2
, 
t1e
, 
t2e
); \

2337 
	`dù_rÙ
(
y0o
,
y2o
, 
row7
,
row3
, 
rÙ2_0
,
rÙ2_1
); \

2338 
	`dù_rÙ
(
y1o
,
y3o
, 
row5
,
row1
, 
rÙ3_0
,
rÙ3_1
); \

2339 
__m128i
 
sum17
 = 
	`_mm_add_•i16
(
row1
, 
row7
); \

2340 
__m128i
 
sum35
 = 
	`_mm_add_•i16
(
row3
, 
row5
); \

2341 
	`dù_rÙ
(
y4o
,
y5o
, 
sum17
,
sum35
, 
rÙ1_0
,
rÙ1_1
); \

2342 
	`dù_wadd
(
x4
, 
y0o
, 
y4o
); \

2343 
	`dù_wadd
(
x5
, 
y1o
, 
y5o
); \

2344 
	`dù_wadd
(
x6
, 
y2o
, 
y5o
); \

2345 
	`dù_wadd
(
x7
, 
y3o
, 
y4o
); \

2346 
	`dù_bæy32o
(
row0
,
row7
, 
x0
,
x7
,
bŸs
,
shiá
); \

2347 
	`dù_bæy32o
(
row1
,
row6
, 
x1
,
x6
,
bŸs
,
shiá
); \

2348 
	`dù_bæy32o
(
row2
,
row5
, 
x2
,
x5
,
bŸs
,
shiá
); \

2349 
	`dù_bæy32o
(
row3
,
row4
, 
x3
,
x4
,
bŸs
,
shiá
); \

2350 }

	)

2352 
__m128i
 
rÙ0_0
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(0.5411961f), stbi__f2f(0.5411961f) + stbi__f2f(-1.847759065f));

2353 
__m128i
 
rÙ0_1
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(0.5411961f) + stbi__f2f( 0.765366865f), stbi__f2f(0.5411961f));

2354 
__m128i
 
rÙ1_0
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(1.175875602f) + stbi__f2f(-0.899976223f), stbi__f2f(1.175875602f));

2355 
__m128i
 
rÙ1_1
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(1.175875602f), stbi__f2f(1.175875602f) + stbi__f2f(-2.562915447f));

2356 
__m128i
 
rÙ2_0
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(-1.961570560f) + stbi__f2f( 0.298631336f), stbi__f2f(-1.961570560f));

2357 
__m128i
 
rÙ2_1
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(-1.961570560f), stbi__f2f(-1.961570560f) + stbi__f2f( 3.072711026f));

2358 
__m128i
 
rÙ3_0
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(-0.390180644f) + stbi__f2f( 2.053119869f), stbi__f2f(-0.390180644f));

2359 
__m128i
 
rÙ3_1
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(-0.390180644f), stbi__f2f(-0.390180644f) + stbi__f2f( 1.501321110f));

2362 
__m128i
 
bŸs_0
 = 
	`_mm_£t1_•i32
(512);

2363 
__m128i
 
bŸs_1
 = 
	`_mm_£t1_•i32
(65536 + (128<<17));

2366 
row0
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 0*8));

2367 
row1
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 1*8));

2368 
row2
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 2*8));

2369 
row3
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 3*8));

2370 
row4
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 4*8));

2371 
row5
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 5*8));

2372 
row6
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 6*8));

2373 
row7
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 7*8));

2376 
	`dù_·ss
(
bŸs_0
, 10);

2380 
	`dù_š‹¾—ve16
(
row0
, 
row4
);

2381 
	`dù_š‹¾—ve16
(
row1
, 
row5
);

2382 
	`dù_š‹¾—ve16
(
row2
, 
row6
);

2383 
	`dù_š‹¾—ve16
(
row3
, 
row7
);

2386 
	`dù_š‹¾—ve16
(
row0
, 
row2
);

2387 
	`dù_š‹¾—ve16
(
row1
, 
row3
);

2388 
	`dù_š‹¾—ve16
(
row4
, 
row6
);

2389 
	`dù_š‹¾—ve16
(
row5
, 
row7
);

2392 
	`dù_š‹¾—ve16
(
row0
, 
row1
);

2393 
	`dù_š‹¾—ve16
(
row2
, 
row3
);

2394 
	`dù_š‹¾—ve16
(
row4
, 
row5
);

2395 
	`dù_š‹¾—ve16
(
row6
, 
row7
);

2399 
	`dù_·ss
(
bŸs_1
, 17);

2403 
__m128i
 
p0
 = 
	`_mm_·ckus_•i16
(
row0
, 
row1
);

2404 
__m128i
 
p1
 = 
	`_mm_·ckus_•i16
(
row2
, 
row3
);

2405 
__m128i
 
p2
 = 
	`_mm_·ckus_•i16
(
row4
, 
row5
);

2406 
__m128i
 
p3
 = 
	`_mm_·ckus_•i16
(
row6
, 
row7
);

2409 
	`dù_š‹¾—ve8
(
p0
, 
p2
);

2410 
	`dù_š‹¾—ve8
(
p1
, 
p3
);

2413 
	`dù_š‹¾—ve8
(
p0
, 
p1
);

2414 
	`dù_š‹¾—ve8
(
p2
, 
p3
);

2417 
	`dù_š‹¾—ve8
(
p0
, 
p2
);

2418 
	`dù_š‹¾—ve8
(
p1
, 
p3
);

2421 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
p0
); ouˆ+ğ
out_¡ride
;

2422 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
	`_mm_shufæe_•i32
(
p0
, 0x4e)); ouˆ+ğ
out_¡ride
;

2423 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
p2
); ouˆ+ğ
out_¡ride
;

2424 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
	`_mm_shufæe_•i32
(
p2
, 0x4e)); ouˆ+ğ
out_¡ride
;

2425 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
p1
); ouˆ+ğ
out_¡ride
;

2426 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
	`_mm_shufæe_•i32
(
p1
, 0x4e)); ouˆ+ğ
out_¡ride
;

2427 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
p3
); ouˆ+ğ
out_¡ride
;

2428 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
	`_mm_shufæe_•i32
(
p3
, 0x4e));

2431 #undeà
dù_cÚ¡


2432 #undeà
dù_rÙ


2433 #undeà
dù_wid’


2434 #undeà
dù_wadd


2435 #undeà
dù_wsub


2436 #undeà
dù_bæy32o


2437 #undeà
dù_š‹¾—ve8


2438 #undeà
dù_š‹¾—ve16


2439 #undeà
dù_·ss


2440 
	}
}

2444 #ifdeà
STBI_NEON


2448 
	$¡bi__idù_simd
(
¡bi_uc
 *
out
, 
out_¡ride
, 
d©a
[64])

2450 
št16x8_t
 
row0
, 
row1
, 
row2
, 
row3
, 
row4
, 
row5
, 
row6
, 
row7
;

2452 
št16x4_t
 
rÙ0_0
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(0.5411961f));

2453 
št16x4_t
 
rÙ0_1
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(-1.847759065f));

2454 
št16x4_t
 
rÙ0_2
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 0.765366865f));

2455 
št16x4_t
 
rÙ1_0
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 1.175875602f));

2456 
št16x4_t
 
rÙ1_1
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(-0.899976223f));

2457 
št16x4_t
 
rÙ1_2
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(-2.562915447f));

2458 
št16x4_t
 
rÙ2_0
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(-1.961570560f));

2459 
št16x4_t
 
rÙ2_1
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(-0.390180644f));

2460 
št16x4_t
 
rÙ3_0
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 0.298631336f));

2461 
št16x4_t
 
rÙ3_1
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 2.053119869f));

2462 
št16x4_t
 
rÙ3_2
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 3.072711026f));

2463 
št16x4_t
 
rÙ3_3
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 1.501321110f));

2465 
	#dù_lÚg_mul
(
out
, 
šq
, 
cÛff
) \

2466 
št32x4_t
 
out
##
_l
 = 
	`vmuÎ_s16
(
	`vg‘_low_s16
(
šq
), 
cÛff
); \

2467 
št32x4_t
 
out
##
_h
 = 
	`vmuÎ_s16
(
	`vg‘_high_s16
(
šq
), 
cÛff
)

	)

2469 
	#dù_lÚg_mac
(
out
, 
acc
, 
šq
, 
cÛff
) \

2470 
št32x4_t
 
out
##
_l
 = 
	`vmÏl_s16
(
acc
##_l, 
	`vg‘_low_s16
(
šq
), 
cÛff
); \

2471 
št32x4_t
 
out
##
_h
 = 
	`vmÏl_s16
(
acc
##_h, 
	`vg‘_high_s16
(
šq
), 
cÛff
)

	)

2473 
	#dù_wid’
(
out
, 
šq
) \

2474 
št32x4_t
 
out
##
_l
 = 
	`vshÎ_n_s16
(
	`vg‘_low_s16
(
šq
), 12); \

2475 
št32x4_t
 
out
##
_h
 = 
	`vshÎ_n_s16
(
	`vg‘_high_s16
(
šq
), 12)

	)

2478 
	#dù_wadd
(
out
, 
a
, 
b
) \

2479 
št32x4_t
 
out
##
_l
 = 
	`vaddq_s32
(
a
##_l, 
b
##_l); \

2480 
št32x4_t
 
out
##
_h
 = 
	`vaddq_s32
(
a
##_h, 
b
##_h)

	)

2483 
	#dù_wsub
(
out
, 
a
, 
b
) \

2484 
št32x4_t
 
out
##
_l
 = 
	`vsubq_s32
(
a
##_l, 
b
##_l); \

2485 
št32x4_t
 
out
##
_h
 = 
	`vsubq_s32
(
a
##_h, 
b
##_h)

	)

2488 
	#dù_bæy32o
(
out0
,
out1
, 
a
,
b
,
shiáİ
,
s
) \

2490 
	`dù_wadd
(
sum
, 
a
, 
b
); \

2491 
	`dù_wsub
(
dif
, 
a
, 
b
); \

2492 
out0
 = 
	`vcombše_s16
(
	`shiáİ
(
sum_l
, 
s
), shiáİ(
sum_h
, s)); \

2493 
out1
 = 
	`vcombše_s16
(
	`shiáİ
(
dif_l
, 
s
), shiáİ(
dif_h
, s)); \

2494 }

	)

2496 
	#dù_·ss
(
shiáİ
, 
shiá
) \

2499 
št16x8_t
 
sum26
 = 
	`vaddq_s16
(
row2
, 
row6
); \

2500 
	`dù_lÚg_mul
(
p1e
, 
sum26
, 
rÙ0_0
); \

2501 
	`dù_lÚg_mac
(
t2e
, 
p1e
, 
row6
, 
rÙ0_1
); \

2502 
	`dù_lÚg_mac
(
t3e
, 
p1e
, 
row2
, 
rÙ0_2
); \

2503 
št16x8_t
 
sum04
 = 
	`vaddq_s16
(
row0
, 
row4
); \

2504 
št16x8_t
 
dif04
 = 
	`vsubq_s16
(
row0
, 
row4
); \

2505 
	`dù_wid’
(
t0e
, 
sum04
); \

2506 
	`dù_wid’
(
t1e
, 
dif04
); \

2507 
	`dù_wadd
(
x0
, 
t0e
, 
t3e
); \

2508 
	`dù_wsub
(
x3
, 
t0e
, 
t3e
); \

2509 
	`dù_wadd
(
x1
, 
t1e
, 
t2e
); \

2510 
	`dù_wsub
(
x2
, 
t1e
, 
t2e
); \

2512 
št16x8_t
 
sum15
 = 
	`vaddq_s16
(
row1
, 
row5
); \

2513 
št16x8_t
 
sum17
 = 
	`vaddq_s16
(
row1
, 
row7
); \

2514 
št16x8_t
 
sum35
 = 
	`vaddq_s16
(
row3
, 
row5
); \

2515 
št16x8_t
 
sum37
 = 
	`vaddq_s16
(
row3
, 
row7
); \

2516 
št16x8_t
 
sumodd
 = 
	`vaddq_s16
(
sum17
, 
sum35
); \

2517 
	`dù_lÚg_mul
(
p5o
, 
sumodd
, 
rÙ1_0
); \

2518 
	`dù_lÚg_mac
(
p1o
, 
p5o
, 
sum17
, 
rÙ1_1
); \

2519 
	`dù_lÚg_mac
(
p2o
, 
p5o
, 
sum35
, 
rÙ1_2
); \

2520 
	`dù_lÚg_mul
(
p3o
, 
sum37
, 
rÙ2_0
); \

2521 
	`dù_lÚg_mul
(
p4o
, 
sum15
, 
rÙ2_1
); \

2522 
	`dù_wadd
(
sump13o
, 
p1o
, 
p3o
); \

2523 
	`dù_wadd
(
sump24o
, 
p2o
, 
p4o
); \

2524 
	`dù_wadd
(
sump23o
, 
p2o
, 
p3o
); \

2525 
	`dù_wadd
(
sump14o
, 
p1o
, 
p4o
); \

2526 
	`dù_lÚg_mac
(
x4
, 
sump13o
, 
row7
, 
rÙ3_0
); \

2527 
	`dù_lÚg_mac
(
x5
, 
sump24o
, 
row5
, 
rÙ3_1
); \

2528 
	`dù_lÚg_mac
(
x6
, 
sump23o
, 
row3
, 
rÙ3_2
); \

2529 
	`dù_lÚg_mac
(
x7
, 
sump14o
, 
row1
, 
rÙ3_3
); \

2530 
	`dù_bæy32o
(
row0
,
row7
, 
x0
,
x7
,
shiáİ
,
shiá
); \

2531 
	`dù_bæy32o
(
row1
,
row6
, 
x1
,
x6
,
shiáİ
,
shiá
); \

2532 
	`dù_bæy32o
(
row2
,
row5
, 
x2
,
x5
,
shiáİ
,
shiá
); \

2533 
	`dù_bæy32o
(
row3
,
row4
, 
x3
,
x4
,
shiáİ
,
shiá
); \

2534 }

	)

2537 
row0
 = 
	`vld1q_s16
(
d©a
 + 0*8);

2538 
row1
 = 
	`vld1q_s16
(
d©a
 + 1*8);

2539 
row2
 = 
	`vld1q_s16
(
d©a
 + 2*8);

2540 
row3
 = 
	`vld1q_s16
(
d©a
 + 3*8);

2541 
row4
 = 
	`vld1q_s16
(
d©a
 + 4*8);

2542 
row5
 = 
	`vld1q_s16
(
d©a
 + 5*8);

2543 
row6
 = 
	`vld1q_s16
(
d©a
 + 6*8);

2544 
row7
 = 
	`vld1q_s16
(
d©a
 + 7*8);

2547 
row0
 = 
	`vaddq_s16
Ôow0, 
	`v£tq_ÏÃ_s16
(1024, 
	`vdupq_n_s16
(0), 0));

2550 
	`dù_·ss
(
vrshº_n_s32
, 10);

2556 
	#dù_Œn16
(
x
, 
y
è{ 
št16x8x2_t
 
t
 = 
	`vŒnq_s16
(x, y); x =.
v®
[0]; y =.v®[1]; }

	)

2557 
	#dù_Œn32
(
x
, 
y
è{ 
št32x4x2_t
 
t
 = 
	`vŒnq_s32
(
	`v»š‹½»tq_s32_s16
(x), v»š‹½»tq_s32_s16(y)); x = 
	`v»š‹½»tq_s16_s32
Ñ.
v®
[0]); y = v»š‹½»tq_s16_s32Ñ.v®[1]); }

	)

2558 
	#dù_Œn64
(
x
, 
y
è{ 
št16x8_t
 
x0
 = x; iÁ16x8_ˆ
y0
 = y; x = 
	`vcombše_s16
(
	`vg‘_low_s16
(x0), vg‘_low_s16(y0)); y = vcombše_s16(
	`vg‘_high_s16
(x0), vg‘_high_s16(y0)); }

	)

2561 
	`dù_Œn16
(
row0
, 
row1
);

2562 
	`dù_Œn16
(
row2
, 
row3
);

2563 
	`dù_Œn16
(
row4
, 
row5
);

2564 
	`dù_Œn16
(
row6
, 
row7
);

2567 
	`dù_Œn32
(
row0
, 
row2
);

2568 
	`dù_Œn32
(
row1
, 
row3
);

2569 
	`dù_Œn32
(
row4
, 
row6
);

2570 
	`dù_Œn32
(
row5
, 
row7
);

2573 
	`dù_Œn64
(
row0
, 
row4
);

2574 
	`dù_Œn64
(
row1
, 
row5
);

2575 
	`dù_Œn64
(
row2
, 
row6
);

2576 
	`dù_Œn64
(
row3
, 
row7
);

2578 #undeà
dù_Œn16


2579 #undeà
dù_Œn32


2580 #undeà
dù_Œn64


2587 
	`dù_·ss
(
vshº_n_s32
, 16);

2591 
ušt8x8_t
 
p0
 = 
	`vqrshrun_n_s16
(
row0
, 1);

2592 
ušt8x8_t
 
p1
 = 
	`vqrshrun_n_s16
(
row1
, 1);

2593 
ušt8x8_t
 
p2
 = 
	`vqrshrun_n_s16
(
row2
, 1);

2594 
ušt8x8_t
 
p3
 = 
	`vqrshrun_n_s16
(
row3
, 1);

2595 
ušt8x8_t
 
p4
 = 
	`vqrshrun_n_s16
(
row4
, 1);

2596 
ušt8x8_t
 
p5
 = 
	`vqrshrun_n_s16
(
row5
, 1);

2597 
ušt8x8_t
 
p6
 = 
	`vqrshrun_n_s16
(
row6
, 1);

2598 
ušt8x8_t
 
p7
 = 
	`vqrshrun_n_s16
(
row7
, 1);

2601 
	#dù_Œn8_8
(
x
, 
y
è{ 
ušt8x8x2_t
 
t
 = 
	`vŒn_u8
(x, y); x =.
v®
[0]; y =.v®[1]; }

	)

2602 
	#dù_Œn8_16
(
x
, 
y
è{ 
ušt16x4x2_t
 
t
 = 
	`vŒn_u16
(
	`v»š‹½»t_u16_u8
(x), v»š‹½»t_u16_u8(y)); x = 
	`v»š‹½»t_u8_u16
Ñ.
v®
[0]); y = v»š‹½»t_u8_u16Ñ.v®[1]); }

	)

2603 
	#dù_Œn8_32
(
x
, 
y
è{ 
ušt32x2x2_t
 
t
 = 
	`vŒn_u32
(
	`v»š‹½»t_u32_u8
(x), v»š‹½»t_u32_u8(y)); x = 
	`v»š‹½»t_u8_u32
Ñ.
v®
[0]); y = v»š‹½»t_u8_u32Ñ.v®[1]); }

	)

2609 
	`dù_Œn8_8
(
p0
, 
p1
);

2610 
	`dù_Œn8_8
(
p2
, 
p3
);

2611 
	`dù_Œn8_8
(
p4
, 
p5
);

2612 
	`dù_Œn8_8
(
p6
, 
p7
);

2615 
	`dù_Œn8_16
(
p0
, 
p2
);

2616 
	`dù_Œn8_16
(
p1
, 
p3
);

2617 
	`dù_Œn8_16
(
p4
, 
p6
);

2618 
	`dù_Œn8_16
(
p5
, 
p7
);

2621 
	`dù_Œn8_32
(
p0
, 
p4
);

2622 
	`dù_Œn8_32
(
p1
, 
p5
);

2623 
	`dù_Œn8_32
(
p2
, 
p6
);

2624 
	`dù_Œn8_32
(
p3
, 
p7
);

2627 
	`v¡1_u8
(
out
, 
p0
); ouˆ+ğ
out_¡ride
;

2628 
	`v¡1_u8
(
out
, 
p1
); ouˆ+ğ
out_¡ride
;

2629 
	`v¡1_u8
(
out
, 
p2
); ouˆ+ğ
out_¡ride
;

2630 
	`v¡1_u8
(
out
, 
p3
); ouˆ+ğ
out_¡ride
;

2631 
	`v¡1_u8
(
out
, 
p4
); ouˆ+ğ
out_¡ride
;

2632 
	`v¡1_u8
(
out
, 
p5
); ouˆ+ğ
out_¡ride
;

2633 
	`v¡1_u8
(
out
, 
p6
); ouˆ+ğ
out_¡ride
;

2634 
	`v¡1_u8
(
out
, 
p7
);

2636 #undeà
dù_Œn8_8


2637 #undeà
dù_Œn8_16


2638 #undeà
dù_Œn8_32


2641 #undeà
dù_lÚg_mul


2642 #undeà
dù_lÚg_mac


2643 #undeà
dù_wid’


2644 #undeà
dù_wadd


2645 #undeà
dù_wsub


2646 #undeà
dù_bæy32o


2647 #undeà
dù_·ss


2648 
	}
}

2652 
	#STBI__MARKER_nÚe
 0xff

	)

2656 
¡bi_uc
 
	$¡bi__g‘_m¬k”
(
¡bi__j³g
 *
j
)

2658 
¡bi_uc
 
x
;

2659 ià(
j
->
m¬k”
 !ğ
STBI__MARKER_nÚe
è{ 
x
 = j->marker; j->marker = STBI__MARKER_none;  x; }

2660 
x
 = 
	`¡bi__g‘8
(
j
->
s
);

2661 ià(
x
 !ğ0xffè 
STBI__MARKER_nÚe
;

2662 
x
 == 0xff)

2663 
x
 = 
	`¡bi__g‘8
(
j
->
s
);

2664  
x
;

2665 
	}
}

2669 
	#STBI__RESTART
(
x
è((xè>ğ0xd0 && (xè<ğ0xd7)

	)

2673 
	$¡bi__j³g_»£t
(
¡bi__j³g
 *
j
)

2675 
j
->
code_b™s
 = 0;

2676 
j
->
code_bufãr
 = 0;

2677 
j
->
nomÜe
 = 0;

2678 
j
->
img_comp
[0].
dc_´ed
 = j->img_comp[1].dc_pred = j->img_comp[2].dc_pred = j->img_comp[3].dc_pred = 0;

2679 
j
->
m¬k”
 = 
STBI__MARKER_nÚe
;

2680 
j
->
todo
 = j->
»¡¬t_š‹rv®
 ? j->restart_interval : 0x7fffffff;

2681 
j
->
eob_run
 = 0;

2684 
	}
}

2686 
	$¡bi__·r£_’Œİy_coded_d©a
(
¡bi__j³g
 *
z
)

2688 
	`¡bi__j³g_»£t
(
z
);

2689 ià(!
z
->
´og»ssive
) {

2690 ià(
z
->
sÿn_n
 == 1) {

2691 
i
,
j
;

2692 
	`STBI_SIMD_ALIGN
(, 
d©a
[64]);

2693 
n
 = 
z
->
Üd”
[0];

2698 
w
 = (
z
->
img_comp
[
n
].
x
+7) >> 3;

2699 
h
 = (
z
->
img_comp
[
n
].
y
+7) >> 3;

2700 
j
=0; j < 
h
; ++j) {

2701 
i
=0; i < 
w
; ++i) {

2702 
ha
 = 
z
->
img_comp
[
n
].ha;

2703 ià(!
	`¡bi__j³g_decode_block
(
z
, 
d©a
, z->
huff_dc
+z->
img_comp
[
n
].
hd
, z->
huff_ac
+
ha
, z->
ç¡_ac
[ha],‚, z->
dequªt
[z->img_comp[n].
tq
]))  0;

2704 
z
->
	`idù_block_k”Ãl
(z->
img_comp
[
n
].
d©a
+z->img_comp[n].
w2
*
j
*8+
i
*8, z->img_comp[n].w2, data);

2706 ià(--
z
->
todo
 <= 0) {

2707 ià(
z
->
code_b™s
 < 24è
	`¡bi__grow_bufãr_un§ã
(z);

2710 ià(!
	`STBI__RESTART
(
z
->
m¬k”
))  1;

2711 
	`¡bi__j³g_»£t
(
z
);

2717 
i
,
j
,
k
,
x
,
y
;

2718 
	`STBI_SIMD_ALIGN
(, 
d©a
[64]);

2719 
j
=0; j < 
z
->
img_mcu_y
; ++j) {

2720 
i
=0; i < 
z
->
img_mcu_x
; ++i) {

2722 
k
=0; k < 
z
->
sÿn_n
; ++k) {

2723 
n
 = 
z
->
Üd”
[
k
];

2726 
y
=0; y < 
z
->
img_comp
[
n
].
v
; ++y) {

2727 
x
=0; x < 
z
->
img_comp
[
n
].
h
; ++x) {

2728 
x2
 = (
i
*
z
->
img_comp
[
n
].
h
 + 
x
)*8;

2729 
y2
 = (
j
*
z
->
img_comp
[
n
].
v
 + 
y
)*8;

2730 
ha
 = 
z
->
img_comp
[
n
].ha;

2731 ià(!
	`¡bi__j³g_decode_block
(
z
, 
d©a
, z->
huff_dc
+z->
img_comp
[
n
].
hd
, z->
huff_ac
+
ha
, z->
ç¡_ac
[ha],‚, z->
dequªt
[z->img_comp[n].
tq
]))  0;

2732 
z
->
	`idù_block_k”Ãl
(z->
img_comp
[
n
].
d©a
+z->img_comp[n].
w2
*
y2
+
x2
, z->img_comp[n].w2, data);

2738 ià(--
z
->
todo
 <= 0) {

2739 ià(
z
->
code_b™s
 < 24è
	`¡bi__grow_bufãr_un§ã
(z);

2740 ià(!
	`STBI__RESTART
(
z
->
m¬k”
))  1;

2741 
	`¡bi__j³g_»£t
(
z
);

2748 ià(
z
->
sÿn_n
 == 1) {

2749 
i
,
j
;

2750 
n
 = 
z
->
Üd”
[0];

2755 
w
 = (
z
->
img_comp
[
n
].
x
+7) >> 3;

2756 
h
 = (
z
->
img_comp
[
n
].
y
+7) >> 3;

2757 
j
=0; j < 
h
; ++j) {

2758 
i
=0; i < 
w
; ++i) {

2759 *
d©a
 = 
z
->
img_comp
[
n
].
cÛff
 + 64 * (
i
 + 
j
 * z->img_comp[n].
cÛff_w
);

2760 ià(
z
->
¥ec_¡¬t
 == 0) {

2761 ià(!
	`¡bi__j³g_decode_block_´og_dc
(
z
, 
d©a
, &z->
huff_dc
[z->
img_comp
[
n
].
hd
],‚))

2764 
ha
 = 
z
->
img_comp
[
n
].ha;

2765 ià(!
	`¡bi__j³g_decode_block_´og_ac
(
z
, 
d©a
, &z->
huff_ac
[
ha
], z->
ç¡_ac
[ha]))

2769 ià(--
z
->
todo
 <= 0) {

2770 ià(
z
->
code_b™s
 < 24è
	`¡bi__grow_bufãr_un§ã
(z);

2771 ià(!
	`STBI__RESTART
(
z
->
m¬k”
))  1;

2772 
	`¡bi__j³g_»£t
(
z
);

2778 
i
,
j
,
k
,
x
,
y
;

2779 
j
=0; j < 
z
->
img_mcu_y
; ++j) {

2780 
i
=0; i < 
z
->
img_mcu_x
; ++i) {

2782 
k
=0; k < 
z
->
sÿn_n
; ++k) {

2783 
n
 = 
z
->
Üd”
[
k
];

2786 
y
=0; y < 
z
->
img_comp
[
n
].
v
; ++y) {

2787 
x
=0; x < 
z
->
img_comp
[
n
].
h
; ++x) {

2788 
x2
 = (
i
*
z
->
img_comp
[
n
].
h
 + 
x
);

2789 
y2
 = (
j
*
z
->
img_comp
[
n
].
v
 + 
y
);

2790 *
d©a
 = 
z
->
img_comp
[
n
].
cÛff
 + 64 * (
x2
 + 
y2
 * z->img_comp[n].
cÛff_w
);

2791 ià(!
	`¡bi__j³g_decode_block_´og_dc
(
z
, 
d©a
, &z->
huff_dc
[z->
img_comp
[
n
].
hd
],‚))

2798 ià(--
z
->
todo
 <= 0) {

2799 ià(
z
->
code_b™s
 < 24è
	`¡bi__grow_bufãr_un§ã
(z);

2800 ià(!
	`STBI__RESTART
(
z
->
m¬k”
))  1;

2801 
	`¡bi__j³g_»£t
(
z
);

2808 
	}
}

2810 
	$¡bi__j³g_dequªtize
(*
d©a
, 
¡bi__ušt16
 *
dequªt
)

2812 
i
;

2813 
i
=0; i < 64; ++i)

2814 
d©a
[
i
] *ğ
dequªt
[i];

2815 
	}
}

2817 
	$¡bi__j³g_fšish
(
¡bi__j³g
 *
z
)

2819 ià(
z
->
´og»ssive
) {

2821 
i
,
j
,
n
;

2822 
n
=0;‚ < 
z
->
s
->
img_n
; ++n) {

2823 
w
 = (
z
->
img_comp
[
n
].
x
+7) >> 3;

2824 
h
 = (
z
->
img_comp
[
n
].
y
+7) >> 3;

2825 
j
=0; j < 
h
; ++j) {

2826 
i
=0; i < 
w
; ++i) {

2827 *
d©a
 = 
z
->
img_comp
[
n
].
cÛff
 + 64 * (
i
 + 
j
 * z->img_comp[n].
cÛff_w
);

2828 
	`¡bi__j³g_dequªtize
(
d©a
, 
z
->
dequªt
[z->
img_comp
[
n
].
tq
]);

2829 
z
->
	`idù_block_k”Ãl
(z->
img_comp
[
n
].
d©a
+z->img_comp[n].
w2
*
j
*8+
i
*8, z->img_comp[n].w2, data);

2834 
	}
}

2836 
	$¡bi__´oûss_m¬k”
(
¡bi__j³g
 *
z
, 
m
)

2838 
L
;

2839 
m
) {

2840 
STBI__MARKER_nÚe
:

2841  
	`¡bi__”r
("expected marker","Corrupt JPEG");

2844 ià(
	`¡bi__g‘16be
(
z
->
s
è!ğ4è 
	`¡bi__”r
("bad DRI†en","Corrupt JPEG");

2845 
z
->
»¡¬t_š‹rv®
 = 
	`¡bi__g‘16be
(z->
s
);

2849 
L
 = 
	`¡bi__g‘16be
(
z
->
s
)-2;

2850 
L
 > 0) {

2851 
q
 = 
	`¡bi__g‘8
(
z
->
s
);

2852 
p
 = 
q
 >> 4, 
six‹’
 = (p != 0);

2853 
t
 = 
q
 & 15,
i
;

2854 ià(
p
 !ğ0 &&… !ğ1è 
	`¡bi__”r
("bad DQType","Corrupt JPEG");

2855 ià(
t
 > 3è 
	`¡bi__”r
("bad DQTable","Corrupt JPEG");

2857 
i
=0; i < 64; ++i)

2858 
z
->
dequªt
[
t
][
¡bi__j³g_dezigzag
[
i
]] = (
¡bi__ušt16
)(
six‹’
 ? 
	`¡bi__g‘16be
(z->
s
è: 
	`¡bi__g‘8
(z->s));

2859 
L
 -ğ(
six‹’
 ? 129 : 65);

2861  
L
==0;

2864 
L
 = 
	`¡bi__g‘16be
(
z
->
s
)-2;

2865 
L
 > 0) {

2866 
¡bi_uc
 *
v
;

2867 
sizes
[16],
i
,
n
=0;

2868 
q
 = 
	`¡bi__g‘8
(
z
->
s
);

2869 
tc
 = 
q
 >> 4;

2870 
th
 = 
q
 & 15;

2871 ià(
tc
 > 1 || 
th
 > 3è 
	`¡bi__”r
("bad DHT header","Corrupt JPEG");

2872 
i
=0; i < 16; ++i) {

2873 
sizes
[
i
] = 
	`¡bi__g‘8
(
z
->
s
);

2874 
n
 +ğ
sizes
[
i
];

2876 
L
 -= 17;

2877 ià(
tc
 == 0) {

2878 ià(!
	`¡bi__bud_huffmª
(
z
->
huff_dc
+
th
, 
sizes
))  0;

2879 
v
 = 
z
->
huff_dc
[
th
].
v®ues
;

2881 ià(!
	`¡bi__bud_huffmª
(
z
->
huff_ac
+
th
, 
sizes
))  0;

2882 
v
 = 
z
->
huff_ac
[
th
].
v®ues
;

2884 
i
=0; i < 
n
; ++i)

2885 
v
[
i
] = 
	`¡bi__g‘8
(
z
->
s
);

2886 ià(
tc
 != 0)

2887 
	`¡bi__bud_ç¡_ac
(
z
->
ç¡_ac
[
th
], z->
huff_ac
 +h);

2888 
L
 -ğ
n
;

2890  
L
==0;

2894 ià((
m
 >= 0xE0 && m <= 0xEF) || m == 0xFE) {

2895 
L
 = 
	`¡bi__g‘16be
(
z
->
s
);

2896 ià(
L
 < 2) {

2897 ià(
m
 == 0xFE)

2898  
	`¡bi__”r
("bad COM†en","Corrupt JPEG");

2900  
	`¡bi__”r
("bad APP†en","Corrupt JPEG");

2902 
L
 -= 2;

2904 ià(
m
 =ğ0xE0 && 
L
 >= 5) {

2905 cÚ¡ 
g
[5] = {'J','F','I','F','\0'};

2906 
ok
 = 1;

2907 
i
;

2908 
i
=0; i < 5; ++i)

2909 ià(
	`¡bi__g‘8
(
z
->
s
è!ğ
g
[
i
])

2910 
ok
 = 0;

2911 
L
 -= 5;

2912 ià(
ok
)

2913 
z
->
jfif
 = 1;

2914 } ià(
m
 =ğ0xEE && 
L
 >= 12) {

2915 cÚ¡ 
g
[6] = {'A','d','o','b','e','\0'};

2916 
ok
 = 1;

2917 
i
;

2918 
i
=0; i < 6; ++i)

2919 ià(
	`¡bi__g‘8
(
z
->
s
è!ğ
g
[
i
])

2920 
ok
 = 0;

2921 
L
 -= 6;

2922 ià(
ok
) {

2923 
	`¡bi__g‘8
(
z
->
s
);

2924 
	`¡bi__g‘16be
(
z
->
s
);

2925 
	`¡bi__g‘16be
(
z
->
s
);

2926 
z
->
­p14_cŞÜ_ŒªsfÜm
 = 
	`¡bi__g‘8
(z->
s
);

2927 
L
 -= 6;

2931 
	`¡bi__sk
(
z
->
s
, 
L
);

2935  
	`¡bi__”r
("unknown marker","Corrupt JPEG");

2936 
	}
}

2939 
	$¡bi__´oûss_sÿn_h—d”
(
¡bi__j³g
 *
z
)

2941 
i
;

2942 
Ls
 = 
	`¡bi__g‘16be
(
z
->
s
);

2943 
z
->
sÿn_n
 = 
	`¡bi__g‘8
(z->
s
);

2944 ià(
z
->
sÿn_n
 < 1 || z->sÿn_À> 4 || z->sÿn_À> (èz->
s
->
img_n
è 
	`¡bi__”r
("bad SOS component count","Corrupt JPEG");

2945 ià(
Ls
 !ğ6+2*
z
->
sÿn_n
è 
	`¡bi__”r
("bad SOS†en","Corrupt JPEG");

2946 
i
=0; i < 
z
->
sÿn_n
; ++i) {

2947 
id
 = 
	`¡bi__g‘8
(
z
->
s
), 
which
;

2948 
q
 = 
	`¡bi__g‘8
(
z
->
s
);

2949 
which
 = 0; which < 
z
->
s
->
img_n
; ++which)

2950 ià(
z
->
img_comp
[
which
].
id
 == id)

2952 ià(
which
 =ğ
z
->
s
->
img_n
)  0;

2953 
z
->
img_comp
[
which
].
hd
 = 
q
 >> 4; ià(z->img_comp[which].hd > 3è 
	`¡bi__”r
("bad DC huff","Corrupt JPEG");

2954 
z
->
img_comp
[
which
].
ha
 = 
q
 & 15; ià(z->img_comp[which].h¨> 3è 
	`¡bi__”r
("bad AC huff","Corrupt JPEG");

2955 
z
->
Üd”
[
i
] = 
which
;

2959 
¯
;

2960 
z
->
¥ec_¡¬t
 = 
	`¡bi__g‘8
(z->
s
);

2961 
z
->
¥ec_’d
 = 
	`¡bi__g‘8
(z->
s
);

2962 
¯
 = 
	`¡bi__g‘8
(
z
->
s
);

2963 
z
->
succ_high
 = (
¯
 >> 4);

2964 
z
->
succ_low
 = (
¯
 & 15);

2965 ià(
z
->
´og»ssive
) {

2966 ià(
z
->
¥ec_¡¬t
 > 63 || z->
¥ec_’d
 > 63 || z->¥ec_¡¬ˆ> z->¥ec_’d || z->
succ_high
 > 13 || z->
succ_low
 > 13)

2967  
	`¡bi__”r
("bad SOS", "Corrupt JPEG");

2969 ià(
z
->
¥ec_¡¬t
 !ğ0è 
	`¡bi__”r
("bad SOS","Corrupt JPEG");

2970 ià(
z
->
succ_high
 !ğ0 || z->
succ_low
 !ğ0è 
	`¡bi__”r
("bad SOS","Corrupt JPEG");

2971 
z
->
¥ec_’d
 = 63;

2976 
	}
}

2978 
	$¡bi__ä“_j³g_compÚ’ts
(
¡bi__j³g
 *
z
, 
ncomp
, 
why
)

2980 
i
;

2981 
i
=0; i < 
ncomp
; ++i) {

2982 ià(
z
->
img_comp
[
i
].
¿w_d©a
) {

2983 
	`STBI_FREE
(
z
->
img_comp
[
i
].
¿w_d©a
);

2984 
z
->
img_comp
[
i
].
¿w_d©a
 = 
NULL
;

2985 
z
->
img_comp
[
i
].
d©a
 = 
NULL
;

2987 ià(
z
->
img_comp
[
i
].
¿w_cÛff
) {

2988 
	`STBI_FREE
(
z
->
img_comp
[
i
].
¿w_cÛff
);

2989 
z
->
img_comp
[
i
].
¿w_cÛff
 = 0;

2990 
z
->
img_comp
[
i
].
cÛff
 = 0;

2992 ià(
z
->
img_comp
[
i
].
lšebuf
) {

2993 
	`STBI_FREE
(
z
->
img_comp
[
i
].
lšebuf
);

2994 
z
->
img_comp
[
i
].
lšebuf
 = 
NULL
;

2997  
why
;

2998 
	}
}

3000 
	$¡bi__´oûss_äame_h—d”
(
¡bi__j³g
 *
z
, 
sÿn
)

3002 
¡bi__cÚ‹xt
 *
s
 = 
z
->s;

3003 
Lf
,
p
,
i
,
q
, 
h_max
=1,
v_max
=1,
c
;

3004 
Lf
 = 
	`¡bi__g‘16be
(
s
); ià(Là< 11è 
	`¡bi__”r
("bad SOF†en","Corrupt JPEG");

3005 
p
 = 
	`¡bi__g‘8
(
s
); iàÕ !ğ8è 
	`¡bi__”r
("only 8-bit","JPEG format‚ot supported: 8-bit only");

3006 
s
->
img_y
 = 
	`¡bi__g‘16be
(s); ià(s->img_y =ğ0è 
	`¡bi__”r
("no header height", "JPEG format‚ot supported: delayed height");

3007 
s
->
img_x
 = 
	`¡bi__g‘16be
(s); ià(s->img_x =ğ0è 
	`¡bi__”r
("0 width","Corrupt JPEG");

3008 
c
 = 
	`¡bi__g‘8
(
s
);

3009 ià(
c
 !ğ3 && c !ğ1 && c !ğ4è 
	`¡bi__”r
("bad component count","Corrupt JPEG");

3010 
s
->
img_n
 = 
c
;

3011 
i
=0; i < 
c
; ++i) {

3012 
z
->
img_comp
[
i
].
d©a
 = 
NULL
;

3013 
z
->
img_comp
[
i
].
lšebuf
 = 
NULL
;

3016 ià(
Lf
 !ğ8+3*
s
->
img_n
è 
	`¡bi__”r
("bad SOF†en","Corrupt JPEG");

3018 
z
->
rgb
 = 0;

3019 
i
=0; i < 
s
->
img_n
; ++i) {

3020 cÚ¡ 
rgb
[3] = { 'R', 'G', 'B' };

3021 
z
->
img_comp
[
i
].
id
 = 
	`¡bi__g‘8
(
s
);

3022 ià(
s
->
img_n
 =ğ3 && 
z
->
img_comp
[
i
].
id
 =ğ
rgb
[i])

3023 ++
z
->
rgb
;

3024 
q
 = 
	`¡bi__g‘8
(
s
);

3025 
z
->
img_comp
[
i
].
h
 = (
q
 >> 4); ià(!z->img_comp[i].h || z->img_comp[i].h > 4è 
	`¡bi__”r
("bad H","Corrupt JPEG");

3026 
z
->
img_comp
[
i
].
v
 = 
q
 & 15; ià(!z->img_comp[i].v || z->img_comp[i].v > 4è 
	`¡bi__”r
("bad V","Corrupt JPEG");

3027 
z
->
img_comp
[
i
].
tq
 = 
	`¡bi__g‘8
(
s
); ià(z->img_comp[i].tq > 3è 
	`¡bi__”r
("bad TQ","Corrupt JPEG");

3030 ià(
sÿn
 !ğ
STBI__SCAN_lßd
)  1;

3032 ià(!
	`¡bi__mad3sizes_v®id
(
s
->
img_x
, s->
img_y
, s->
img_n
, 0)è 
	`¡bi__”r
("too†arge", "Imageoo†argeo decode");

3034 
i
=0; i < 
s
->
img_n
; ++i) {

3035 ià(
z
->
img_comp
[
i
].
h
 > 
h_max
) h_max = z->img_comp[i].h;

3036 ià(
z
->
img_comp
[
i
].
v
 > 
v_max
) v_max = z->img_comp[i].v;

3040 
z
->
img_h_max
 = 
h_max
;

3041 
z
->
img_v_max
 = 
v_max
;

3042 
z
->
img_mcu_w
 = 
h_max
 * 8;

3043 
z
->
img_mcu_h
 = 
v_max
 * 8;

3045 
z
->
img_mcu_x
 = (
s
->
img_x
 + z->
img_mcu_w
-1) / z->img_mcu_w;

3046 
z
->
img_mcu_y
 = (
s
->
img_y
 + z->
img_mcu_h
-1) / z->img_mcu_h;

3048 
i
=0; i < 
s
->
img_n
; ++i) {

3050 
z
->
img_comp
[
i
].
x
 = (
s
->
img_x
 * z->img_comp[i].
h
 + 
h_max
-1) / h_max;

3051 
z
->
img_comp
[
i
].
y
 = (
s
->
img_y
 * z->img_comp[i].
v
 + 
v_max
-1) / v_max;

3059 
z
->
img_comp
[
i
].
w2
 = z->
img_mcu_x
 * z->img_comp[i].
h
 * 8;

3060 
z
->
img_comp
[
i
].
h2
 = z->
img_mcu_y
 * z->img_comp[i].
v
 * 8;

3061 
z
->
img_comp
[
i
].
cÛff
 = 0;

3062 
z
->
img_comp
[
i
].
¿w_cÛff
 = 0;

3063 
z
->
img_comp
[
i
].
lšebuf
 = 
NULL
;

3064 
z
->
img_comp
[
i
].
¿w_d©a
 = 
	`¡bi__m®loc_mad2
(z->img_comp[i].
w2
, z->img_comp[i].
h2
, 15);

3065 ià(
z
->
img_comp
[
i
].
¿w_d©a
 =ğ
NULL
)

3066  
	`¡bi__ä“_j³g_compÚ’ts
(
z
, 
i
+1, 
	`¡bi__”r
("outofmem", "Out of memory"));

3068 
z
->
img_comp
[
i
].
d©a
 = (
¡bi_uc
*è(((
size_t
èz->img_comp[i].
¿w_d©a
 + 15) & ~15);

3069 ià(
z
->
´og»ssive
) {

3071 
z
->
img_comp
[
i
].
cÛff_w
 = z->img_comp[i].
w2
 / 8;

3072 
z
->
img_comp
[
i
].
cÛff_h
 = z->img_comp[i].
h2
 / 8;

3073 
z
->
img_comp
[
i
].
¿w_cÛff
 = 
	`¡bi__m®loc_mad3
(z->img_comp[i].
w2
, z->img_comp[i].
h2
, (), 15);

3074 ià(
z
->
img_comp
[
i
].
¿w_cÛff
 =ğ
NULL
)

3075  
	`¡bi__ä“_j³g_compÚ’ts
(
z
, 
i
+1, 
	`¡bi__”r
("outofmem", "Out of memory"));

3076 
z
->
img_comp
[
i
].
cÛff
 = (*è(((
size_t
èz->img_comp[i].
¿w_cÛff
 + 15) & ~15);

3081 
	}
}

3084 
	#¡bi__DNL
(
x
è((xè=ğ0xdc)

	)

3085 
	#¡bi__SOI
(
x
è((xè=ğ0xd8)

	)

3086 
	#¡bi__EOI
(
x
è((xè=ğ0xd9)

	)

3087 
	#¡bi__SOF
(
x
è((xè=ğ0xc0 || (xè=ğ0xc1 || (xè=ğ0xc2)

	)

3088 
	#¡bi__SOS
(
x
è((xè=ğ0xda)

	)

3090 
	#¡bi__SOF_´og»ssive
(
x
è((xè=ğ0xc2)

	)

3092 
	$¡bi__decode_j³g_h—d”
(
¡bi__j³g
 *
z
, 
sÿn
)

3094 
m
;

3095 
z
->
jfif
 = 0;

3096 
z
->
­p14_cŞÜ_ŒªsfÜm
 = -1;

3097 
z
->
m¬k”
 = 
STBI__MARKER_nÚe
;

3098 
m
 = 
	`¡bi__g‘_m¬k”
(
z
);

3099 ià(!
	`¡bi__SOI
(
m
)è 
	`¡bi__”r
("no SOI","Corrupt JPEG");

3100 ià(
sÿn
 =ğ
STBI__SCAN_ty³
)  1;

3101 
m
 = 
	`¡bi__g‘_m¬k”
(
z
);

3102 !
	`¡bi__SOF
(
m
)) {

3103 ià(!
	`¡bi__´oûss_m¬k”
(
z
,
m
))  0;

3104 
m
 = 
	`¡bi__g‘_m¬k”
(
z
);

3105 
m
 =ğ
STBI__MARKER_nÚe
) {

3107 ià(
	`¡bi__©_eof
(
z
->
s
)è 
	`¡bi__”r
("no SOF", "Corrupt JPEG");

3108 
m
 = 
	`¡bi__g‘_m¬k”
(
z
);

3111 
z
->
´og»ssive
 = 
	`¡bi__SOF_´og»ssive
(
m
);

3112 ià(!
	`¡bi__´oûss_äame_h—d”
(
z
, 
sÿn
))  0;

3114 
	}
}

3117 
	$¡bi__decode_j³g_image
(
¡bi__j³g
 *
j
)

3119 
m
;

3120 
m
 = 0; m < 4; m++) {

3121 
j
->
img_comp
[
m
].
¿w_d©a
 = 
NULL
;

3122 
j
->
img_comp
[
m
].
¿w_cÛff
 = 
NULL
;

3124 
j
->
»¡¬t_š‹rv®
 = 0;

3125 ià(!
	`¡bi__decode_j³g_h—d”
(
j
, 
STBI__SCAN_lßd
))  0;

3126 
m
 = 
	`¡bi__g‘_m¬k”
(
j
);

3127 !
	`¡bi__EOI
(
m
)) {

3128 ià(
	`¡bi__SOS
(
m
)) {

3129 ià(!
	`¡bi__´oûss_sÿn_h—d”
(
j
))  0;

3130 ià(!
	`¡bi__·r£_’Œİy_coded_d©a
(
j
))  0;

3131 ià(
j
->
m¬k”
 =ğ
STBI__MARKER_nÚe
 ) {

3133 !
	`¡bi__©_eof
(
j
->
s
)) {

3134 
x
 = 
	`¡bi__g‘8
(
j
->
s
);

3135 ià(
x
 == 255) {

3136 
j
->
m¬k”
 = 
	`¡bi__g‘8
(j->
s
);

3142 } ià(
	`¡bi__DNL
(
m
)) {

3143 
Ld
 = 
	`¡bi__g‘16be
(
j
->
s
);

3144 
¡bi__ušt32
 
NL
 = 
	`¡bi__g‘16be
(
j
->
s
);

3145 ià(
Ld
 !ğ4è 
	`¡bi__”r
("bad DNL†en", "Corrupt JPEG");

3146 ià(
NL
 !ğ
j
->
s
->
img_y
è 
	`¡bi__”r
("bad DNL height", "Corrupt JPEG");

3148 ià(!
	`¡bi__´oûss_m¬k”
(
j
, 
m
))  0;

3150 
m
 = 
	`¡bi__g‘_m¬k”
(
j
);

3152 ià(
j
->
´og»ssive
)

3153 
	`¡bi__j³g_fšish
(
j
);

3155 
	}
}

3159 
	g¡bi_uc
 *(*
	t»§m¶e_row_func
)(
	t¡bi_uc
 *
	tout
, stbi_uø*
	tš0
, stbi_uø*
	tš1
,

3160 
	tw
, 
	ths
);

3162 
	#¡bi__div4
(
x
è((
¡bi_uc
è((xè>> 2))

	)

3164 
¡bi_uc
 *
	$»§m¶e_row_1
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3166 
	`STBI_NOTUSED
(
out
);

3167 
	`STBI_NOTUSED
(
š_çr
);

3168 
	`STBI_NOTUSED
(
w
);

3169 
	`STBI_NOTUSED
(
hs
);

3170  
š_Ã¬
;

3171 
	}
}

3173 
¡bi_uc
* 
	$¡bi__»§m¶e_row_v_2
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3176 
i
;

3177 
	`STBI_NOTUSED
(
hs
);

3178 
i
=0; i < 
w
; ++i)

3179 
out
[
i
] = 
	`¡bi__div4
(3*
š_Ã¬
[i] + 
š_çr
[i] + 2);

3180  
out
;

3181 
	}
}

3183 
¡bi_uc
* 
	$¡bi__»§m¶e_row_h_2
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3186 
i
;

3187 
¡bi_uc
 *
šput
 = 
š_Ã¬
;

3189 ià(
w
 == 1) {

3191 
out
[0] = out[1] = 
šput
[0];

3192  
out
;

3195 
out
[0] = 
šput
[0];

3196 
out
[1] = 
	`¡bi__div4
(
šput
[0]*3 + input[1] + 2);

3197 
i
=1; i < 
w
-1; ++i) {

3198 
n
 = 3*
šput
[
i
]+2;

3199 
out
[
i
*2+0] = 
	`¡bi__div4
(
n
+
šput
[i-1]);

3200 
out
[
i
*2+1] = 
	`¡bi__div4
(
n
+
šput
[i+1]);

3202 
out
[
i
*2+0] = 
	`¡bi__div4
(
šput
[
w
-2]*3 + input[w-1] + 2);

3203 
out
[
i
*2+1] = 
šput
[
w
-1];

3205 
	`STBI_NOTUSED
(
š_çr
);

3206 
	`STBI_NOTUSED
(
hs
);

3208  
out
;

3209 
	}
}

3211 
	#¡bi__div16
(
x
è((
¡bi_uc
è((xè>> 4))

	)

3213 
¡bi_uc
 *
	$¡bi__»§m¶e_row_hv_2
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3216 
i
,
t0
,
t1
;

3217 ià(
w
 == 1) {

3218 
out
[0] = out[1] = 
	`¡bi__div4
(3*
š_Ã¬
[0] + 
š_çr
[0] + 2);

3219  
out
;

3222 
t1
 = 3*
š_Ã¬
[0] + 
š_çr
[0];

3223 
out
[0] = 
	`¡bi__div4
(
t1
+2);

3224 
i
=1; i < 
w
; ++i) {

3225 
t0
 = 
t1
;

3226 
t1
 = 3*
š_Ã¬
[
i
]+
š_çr
[i];

3227 
out
[
i
*2-1] = 
	`¡bi__div16
(3*
t0
 + 
t1
 + 8);

3228 
out
[
i
*2 ] = 
	`¡bi__div16
(3*
t1
 + 
t0
 + 8);

3230 
out
[
w
*2-1] = 
	`¡bi__div4
(
t1
+2);

3232 
	`STBI_NOTUSED
(
hs
);

3234  
out
;

3235 
	}
}

3237 #ià
defšed
(
STBI_SSE2
è|| defšed(
STBI_NEON
)

3238 
¡bi_uc
 *
	$¡bi__»§m¶e_row_hv_2_simd
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3241 
i
=0,
t0
,
t1
;

3243 ià(
w
 == 1) {

3244 
out
[0] = out[1] = 
	`¡bi__div4
(3*
š_Ã¬
[0] + 
š_çr
[0] + 2);

3245  
out
;

3248 
t1
 = 3*
š_Ã¬
[0] + 
š_çr
[0];

3252 ; 
i
 < ((
w
-1) & ~7); i += 8) {

3253 #ià
	`defšed
(
STBI_SSE2
)

3256 
__m128i
 
z”o
 = 
	`_mm_£tz”o_si128
();

3257 
__m128i
 
çrb
 = 
	`_mm_lßdl_•i64
((__m128˜*è(
š_çr
 + 
i
));

3258 
__m128i
 
Ã¬b
 = 
	`_mm_lßdl_•i64
((__m128˜*è(
š_Ã¬
 + 
i
));

3259 
__m128i
 
çrw
 = 
	`_mm_uÅacklo_•i8
(
çrb
, 
z”o
);

3260 
__m128i
 
Ã¬w
 = 
	`_mm_uÅacklo_•i8
(
Ã¬b
, 
z”o
);

3261 
__m128i
 
diff
 = 
	`_mm_sub_•i16
(
çrw
, 
Ã¬w
);

3262 
__m128i
 
Ã¬s
 = 
	`_mm_¦li_•i16
(
Ã¬w
, 2);

3263 
__m128i
 
cu¼
 = 
	`_mm_add_•i16
(
Ã¬s
, 
diff
);

3270 
__m128i
 
´v0
 = 
	`_mm_¦li_si128
(
cu¼
, 2);

3271 
__m128i
 
nxt0
 = 
	`_mm_¤li_si128
(
cu¼
, 2);

3272 
__m128i
 
´ev
 = 
	`_mm_š£¹_•i16
(
´v0
, 
t1
, 0);

3273 
__m128i
 
Ãxt
 = 
	`_mm_š£¹_•i16
(
nxt0
, 3*
š_Ã¬
[
i
+8] + 
š_çr
[i+8], 7);

3279 
__m128i
 
bŸs
 = 
	`_mm_£t1_•i16
(8);

3280 
__m128i
 
curs
 = 
	`_mm_¦li_•i16
(
cu¼
, 2);

3281 
__m128i
 
´vd
 = 
	`_mm_sub_•i16
(
´ev
, 
cu¼
);

3282 
__m128i
 
nxtd
 = 
	`_mm_sub_•i16
(
Ãxt
, 
cu¼
);

3283 
__m128i
 
curb
 = 
	`_mm_add_•i16
(
curs
, 
bŸs
);

3284 
__m128i
 
ev’
 = 
	`_mm_add_•i16
(
´vd
, 
curb
);

3285 
__m128i
 
odd
 = 
	`_mm_add_•i16
(
nxtd
, 
curb
);

3288 
__m128i
 
št0
 = 
	`_mm_uÅacklo_•i16
(
ev’
, 
odd
);

3289 
__m128i
 
št1
 = 
	`_mm_uÅackhi_•i16
(
ev’
, 
odd
);

3290 
__m128i
 
de0
 = 
	`_mm_¤li_•i16
(
št0
, 4);

3291 
__m128i
 
de1
 = 
	`_mm_¤li_•i16
(
št1
, 4);

3294 
__m128i
 
outv
 = 
	`_mm_·ckus_•i16
(
de0
, 
de1
);

3295 
	`_mm_¡Üeu_si128
((
__m128i
 *è(
out
 + 
i
*2), 
outv
);

3296 #–ià
	`defšed
(
STBI_NEON
)

3299 
ušt8x8_t
 
çrb
 = 
	`vld1_u8
(
š_çr
 + 
i
);

3300 
ušt8x8_t
 
Ã¬b
 = 
	`vld1_u8
(
š_Ã¬
 + 
i
);

3301 
št16x8_t
 
diff
 = 
	`v»š‹½»tq_s16_u16
(
	`vsubl_u8
(
çrb
, 
Ã¬b
));

3302 
št16x8_t
 
Ã¬s
 = 
	`v»š‹½»tq_s16_u16
(
	`vshÎ_n_u8
(
Ã¬b
, 2));

3303 
št16x8_t
 
cu¼
 = 
	`vaddq_s16
(
Ã¬s
, 
diff
);

3310 
št16x8_t
 
´v0
 = 
	`vextq_s16
(
cu¼
, curr, 7);

3311 
št16x8_t
 
nxt0
 = 
	`vextq_s16
(
cu¼
, curr, 1);

3312 
št16x8_t
 
´ev
 = 
	`v£tq_ÏÃ_s16
(
t1
, 
´v0
, 0);

3313 
št16x8_t
 
Ãxt
 = 
	`v£tq_ÏÃ_s16
(3*
š_Ã¬
[
i
+8] + 
š_çr
[i+8], 
nxt0
, 7);

3319 
št16x8_t
 
curs
 = 
	`vshlq_n_s16
(
cu¼
, 2);

3320 
št16x8_t
 
´vd
 = 
	`vsubq_s16
(
´ev
, 
cu¼
);

3321 
št16x8_t
 
nxtd
 = 
	`vsubq_s16
(
Ãxt
, 
cu¼
);

3322 
št16x8_t
 
ev’
 = 
	`vaddq_s16
(
curs
, 
´vd
);

3323 
št16x8_t
 
odd
 = 
	`vaddq_s16
(
curs
, 
nxtd
);

3326 
ušt8x8x2_t
 
o
;

3327 
o
.
v®
[0] = 
	`vqrshrun_n_s16
(
ev’
, 4);

3328 
o
.
v®
[1] = 
	`vqrshrun_n_s16
(
odd
, 4);

3329 
	`v¡2_u8
(
out
 + 
i
*2, 
o
);

3333 
t1
 = 3*
š_Ã¬
[
i
+7] + 
š_çr
[i+7];

3336 
t0
 = 
t1
;

3337 
t1
 = 3*
š_Ã¬
[
i
] + 
š_çr
[i];

3338 
out
[
i
*2] = 
	`¡bi__div16
(3*
t1
 + 
t0
 + 8);

3340 ++
i
; i < 
w
; ++i) {

3341 
t0
 = 
t1
;

3342 
t1
 = 3*
š_Ã¬
[
i
]+
š_çr
[i];

3343 
out
[
i
*2-1] = 
	`¡bi__div16
(3*
t0
 + 
t1
 + 8);

3344 
out
[
i
*2 ] = 
	`¡bi__div16
(3*
t1
 + 
t0
 + 8);

3346 
out
[
w
*2-1] = 
	`¡bi__div4
(
t1
+2);

3348 
	`STBI_NOTUSED
(
hs
);

3350  
out
;

3351 
	}
}

3354 
¡bi_uc
 *
	$¡bi__»§m¶e_row_g’”ic
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3357 
i
,
j
;

3358 
	`STBI_NOTUSED
(
š_çr
);

3359 
i
=0; i < 
w
; ++i)

3360 
j
=0; j < 
hs
; ++j)

3361 
out
[
i
*
hs
+
j
] = 
š_Ã¬
[i];

3362  
out
;

3363 
	}
}

3367 
	#¡bi__æßt2fixed
(
x
è(((è((xè* 4096.0à+ 0.5f)è<< 8)

	)

3368 
	$¡bi__YCbCr_to_RGB_row
(
¡bi_uc
 *
out
, cÚ¡ stbi_uø*
y
, cÚ¡ stbi_uø*
pcb
, cÚ¡ stbi_uø*
pü
, 
couÁ
, 
¡•
)

3370 
i
;

3371 
i
=0; i < 
couÁ
; ++i) {

3372 
y_fixed
 = (
y
[
i
] << 20) + (1<<19);

3373 
r
,
g
,
b
;

3374 
ü
 = 
pü
[
i
] - 128;

3375 
cb
 = 
pcb
[
i
] - 128;

3376 
r
 = 
y_fixed
 + 
ü
* 
	`¡bi__æßt2fixed
(1.40200f);

3377 
g
 = 
y_fixed
 + (
ü
*-
	`¡bi__æßt2fixed
(0.71414f)è+ ((
cb
*-stbi__float2fixed(0.34414f)) & 0xffff0000);

3378 
b
 = 
y_fixed
 + 
cb
* 
	`¡bi__æßt2fixed
(1.77200f);

3379 
r
 >>= 20;

3380 
g
 >>= 20;

3381 
b
 >>= 20;

3382 ià((è
r
 > 255) { if (r < 0)„ = 0; r = 255; }

3383 ià((è
g
 > 255) { if (g < 0) g = 0; g = 255; }

3384 ià((è
b
 > 255) { if (b < 0) b = 0; b = 255; }

3385 
out
[0] = (
¡bi_uc
)
r
;

3386 
out
[1] = (
¡bi_uc
)
g
;

3387 
out
[2] = (
¡bi_uc
)
b
;

3388 
out
[3] = 255;

3389 
out
 +ğ
¡•
;

3391 
	}
}

3393 #ià
defšed
(
STBI_SSE2
è|| defšed(
STBI_NEON
)

3394 
	$¡bi__YCbCr_to_RGB_simd
(
¡bi_uc
 *
out
, stbi_uøcÚ¡ *
y
, stbi_uøcÚ¡ *
pcb
, stbi_uøcÚ¡ *
pü
, 
couÁ
, 
¡•
)

3396 
i
 = 0;

3398 #ifdeà
STBI_SSE2


3402 ià(
¡•
 == 4) {

3404 
__m128i
 
signæ
 = 
	`_mm_£t1_•i8
(-0x80);

3405 
__m128i
 
ü_cÚ¡0
 = 
	`_mm_£t1_•i16
( () ( 1.40200f*4096.0f+0.5f));

3406 
__m128i
 
ü_cÚ¡1
 = 
	`_mm_£t1_•i16
( - () ( 0.71414f*4096.0f+0.5f));

3407 
__m128i
 
cb_cÚ¡0
 = 
	`_mm_£t1_•i16
( - () ( 0.34414f*4096.0f+0.5f));

3408 
__m128i
 
cb_cÚ¡1
 = 
	`_mm_£t1_•i16
( () ( 1.77200f*4096.0f+0.5f));

3409 
__m128i
 
y_bŸs
 = 
	`_mm_£t1_•i8
(() () 128);

3410 
__m128i
 
xw
 = 
	`_mm_£t1_•i16
(255);

3412 ; 
i
+7 < 
couÁ
; i += 8) {

3414 
__m128i
 
y_by‹s
 = 
	`_mm_lßdl_•i64
((__m128˜*è(
y
+
i
));

3415 
__m128i
 
ü_by‹s
 = 
	`_mm_lßdl_•i64
((__m128˜*è(
pü
+
i
));

3416 
__m128i
 
cb_by‹s
 = 
	`_mm_lßdl_•i64
((__m128˜*è(
pcb
+
i
));

3417 
__m128i
 
ü_bŸ£d
 = 
	`_mm_xÜ_si128
(
ü_by‹s
, 
signæ
);

3418 
__m128i
 
cb_bŸ£d
 = 
	`_mm_xÜ_si128
(
cb_by‹s
, 
signæ
);

3421 
__m128i
 
yw
 = 
	`_mm_uÅacklo_•i8
(
y_bŸs
, 
y_by‹s
);

3422 
__m128i
 
üw
 = 
	`_mm_uÅacklo_•i8
(
	`_mm_£tz”o_si128
(), 
ü_bŸ£d
);

3423 
__m128i
 
cbw
 = 
	`_mm_uÅacklo_•i8
(
	`_mm_£tz”o_si128
(), 
cb_bŸ£d
);

3426 
__m128i
 
yws
 = 
	`_mm_¤li_•i16
(
yw
, 4);

3427 
__m128i
 
ü0
 = 
	`_mm_mulhi_•i16
(
ü_cÚ¡0
, 
üw
);

3428 
__m128i
 
cb0
 = 
	`_mm_mulhi_•i16
(
cb_cÚ¡0
, 
cbw
);

3429 
__m128i
 
cb1
 = 
	`_mm_mulhi_•i16
(
cbw
, 
cb_cÚ¡1
);

3430 
__m128i
 
ü1
 = 
	`_mm_mulhi_•i16
(
üw
, 
ü_cÚ¡1
);

3431 
__m128i
 
rws
 = 
	`_mm_add_•i16
(
ü0
, 
yws
);

3432 
__m128i
 
gwt
 = 
	`_mm_add_•i16
(
cb0
, 
yws
);

3433 
__m128i
 
bws
 = 
	`_mm_add_•i16
(
yws
, 
cb1
);

3434 
__m128i
 
gws
 = 
	`_mm_add_•i16
(
gwt
, 
ü1
);

3437 
__m128i
 
rw
 = 
	`_mm_¤ai_•i16
(
rws
, 4);

3438 
__m128i
 
bw
 = 
	`_mm_¤ai_•i16
(
bws
, 4);

3439 
__m128i
 
gw
 = 
	`_mm_¤ai_•i16
(
gws
, 4);

3442 
__m128i
 
brb
 = 
	`_mm_·ckus_•i16
(
rw
, 
bw
);

3443 
__m128i
 
gxb
 = 
	`_mm_·ckus_•i16
(
gw
, 
xw
);

3446 
__m128i
 
t0
 = 
	`_mm_uÅacklo_•i8
(
brb
, 
gxb
);

3447 
__m128i
 
t1
 = 
	`_mm_uÅackhi_•i8
(
brb
, 
gxb
);

3448 
__m128i
 
o0
 = 
	`_mm_uÅacklo_•i16
(
t0
, 
t1
);

3449 
__m128i
 
o1
 = 
	`_mm_uÅackhi_•i16
(
t0
, 
t1
);

3452 
	`_mm_¡Üeu_si128
((
__m128i
 *è(
out
 + 0), 
o0
);

3453 
	`_mm_¡Üeu_si128
((
__m128i
 *è(
out
 + 16), 
o1
);

3454 
out
 += 32;

3459 #ifdeà
STBI_NEON


3461 ià(
¡•
 == 4) {

3463 
ušt8x8_t
 
signæ
 = 
	`vdup_n_u8
(0x80);

3464 
št16x8_t
 
ü_cÚ¡0
 = 
	`vdupq_n_s16
( () ( 1.40200f*4096.0f+0.5f));

3465 
št16x8_t
 
ü_cÚ¡1
 = 
	`vdupq_n_s16
( - () ( 0.71414f*4096.0f+0.5f));

3466 
št16x8_t
 
cb_cÚ¡0
 = 
	`vdupq_n_s16
( - () ( 0.34414f*4096.0f+0.5f));

3467 
št16x8_t
 
cb_cÚ¡1
 = 
	`vdupq_n_s16
( () ( 1.77200f*4096.0f+0.5f));

3469 ; 
i
+7 < 
couÁ
; i += 8) {

3471 
ušt8x8_t
 
y_by‹s
 = 
	`vld1_u8
(
y
 + 
i
);

3472 
ušt8x8_t
 
ü_by‹s
 = 
	`vld1_u8
(
pü
 + 
i
);

3473 
ušt8x8_t
 
cb_by‹s
 = 
	`vld1_u8
(
pcb
 + 
i
);

3474 
št8x8_t
 
ü_bŸ£d
 = 
	`v»š‹½»t_s8_u8
(
	`vsub_u8
(
ü_by‹s
, 
signæ
));

3475 
št8x8_t
 
cb_bŸ£d
 = 
	`v»š‹½»t_s8_u8
(
	`vsub_u8
(
cb_by‹s
, 
signæ
));

3478 
št16x8_t
 
yws
 = 
	`v»š‹½»tq_s16_u16
(
	`vshÎ_n_u8
(
y_by‹s
, 4));

3479 
št16x8_t
 
üw
 = 
	`vshÎ_n_s8
(
ü_bŸ£d
, 7);

3480 
št16x8_t
 
cbw
 = 
	`vshÎ_n_s8
(
cb_bŸ£d
, 7);

3483 
št16x8_t
 
ü0
 = 
	`vqdmulhq_s16
(
üw
, 
ü_cÚ¡0
);

3484 
št16x8_t
 
cb0
 = 
	`vqdmulhq_s16
(
cbw
, 
cb_cÚ¡0
);

3485 
št16x8_t
 
ü1
 = 
	`vqdmulhq_s16
(
üw
, 
ü_cÚ¡1
);

3486 
št16x8_t
 
cb1
 = 
	`vqdmulhq_s16
(
cbw
, 
cb_cÚ¡1
);

3487 
št16x8_t
 
rws
 = 
	`vaddq_s16
(
yws
, 
ü0
);

3488 
št16x8_t
 
gws
 = 
	`vaddq_s16
(vaddq_s16(
yws
, 
cb0
), 
ü1
);

3489 
št16x8_t
 
bws
 = 
	`vaddq_s16
(
yws
, 
cb1
);

3492 
ušt8x8x4_t
 
o
;

3493 
o
.
v®
[0] = 
	`vqrshrun_n_s16
(
rws
, 4);

3494 
o
.
v®
[1] = 
	`vqrshrun_n_s16
(
gws
, 4);

3495 
o
.
v®
[2] = 
	`vqrshrun_n_s16
(
bws
, 4);

3496 
o
.
v®
[3] = 
	`vdup_n_u8
(255);

3499 
	`v¡4_u8
(
out
, 
o
);

3500 
out
 += 8*4;

3505 ; 
i
 < 
couÁ
; ++i) {

3506 
y_fixed
 = (
y
[
i
] << 20) + (1<<19);

3507 
r
,
g
,
b
;

3508 
ü
 = 
pü
[
i
] - 128;

3509 
cb
 = 
pcb
[
i
] - 128;

3510 
r
 = 
y_fixed
 + 
ü
* 
	`¡bi__æßt2fixed
(1.40200f);

3511 
g
 = 
y_fixed
 + 
ü
*-
	`¡bi__æßt2fixed
(0.71414fè+ ((
cb
*-stbi__float2fixed(0.34414f)) & 0xffff0000);

3512 
b
 = 
y_fixed
 + 
cb
* 
	`¡bi__æßt2fixed
(1.77200f);

3513 
r
 >>= 20;

3514 
g
 >>= 20;

3515 
b
 >>= 20;

3516 ià((è
r
 > 255) { if (r < 0)„ = 0; r = 255; }

3517 ià((è
g
 > 255) { if (g < 0) g = 0; g = 255; }

3518 ià((è
b
 > 255) { if (b < 0) b = 0; b = 255; }

3519 
out
[0] = (
¡bi_uc
)
r
;

3520 
out
[1] = (
¡bi_uc
)
g
;

3521 
out
[2] = (
¡bi_uc
)
b
;

3522 
out
[3] = 255;

3523 
out
 +ğ
¡•
;

3525 
	}
}

3529 
	$¡bi__£tup_j³g
(
¡bi__j³g
 *
j
)

3531 
j
->
idù_block_k”Ãl
 = 
¡bi__idù_block
;

3532 
j
->
YCbCr_to_RGB_k”Ãl
 = 
¡bi__YCbCr_to_RGB_row
;

3533 
j
->
»§m¶e_row_hv_2_k”Ãl
 = 
¡bi__»§m¶e_row_hv_2
;

3535 #ifdeà
STBI_SSE2


3536 ià(
	`¡bi__s£2_avaabË
()) {

3537 
j
->
idù_block_k”Ãl
 = 
¡bi__idù_simd
;

3538 
j
->
YCbCr_to_RGB_k”Ãl
 = 
¡bi__YCbCr_to_RGB_simd
;

3539 
j
->
»§m¶e_row_hv_2_k”Ãl
 = 
¡bi__»§m¶e_row_hv_2_simd
;

3543 #ifdeà
STBI_NEON


3544 
j
->
idù_block_k”Ãl
 = 
¡bi__idù_simd
;

3545 
j
->
YCbCr_to_RGB_k”Ãl
 = 
¡bi__YCbCr_to_RGB_simd
;

3546 
j
->
»§m¶e_row_hv_2_k”Ãl
 = 
¡bi__»§m¶e_row_hv_2_simd
;

3548 
	}
}

3551 
	$¡bi__ş—nup_j³g
(
¡bi__j³g
 *
j
)

3553 
	`¡bi__ä“_j³g_compÚ’ts
(
j
, j->
s
->
img_n
, 0);

3554 
	}
}

3558 
»§m¶e_row_func
 
	m»§m¶e
;

3559 
¡bi_uc
 *
	mlše0
,*
	mlše1
;

3560 
	mhs
,
	mvs
;

3561 
	mw_lÜes
;

3562 
	my¡•
;

3563 
	mypos
;

3564 } 
	t¡bi__»§m¶e
;

3567 
¡bi_uc
 
	$¡bi__blšn_8x8
(
¡bi_uc
 
x
, stbi_uø
y
)

3569 
t
 = 
x
*
y
 + 128;

3570  (
¡bi_uc
è((
t
 + (t >>8)) >> 8);

3571 
	}
}

3573 
¡bi_uc
 *
	$lßd_j³g_image
(
¡bi__j³g
 *
z
, *
out_x
, *
out_y
, *
comp
, 
»q_comp
)

3575 
n
, 
decode_n
, 
is_rgb
;

3576 
z
->
s
->
img_n
 = 0;

3579 ià(
»q_comp
 < 0 ||„eq_com°> 4è 
	`¡bi__”½uc
("bad„eq_comp", "Internalƒrror");

3582 ià(!
	`¡bi__decode_j³g_image
(
z
)è{ 
	`¡bi__ş—nup_j³g
(z);  
NULL
; }

3585 
n
 = 
»q_comp
 ?„eq_com°: 
z
->
s
->
img_n
 >= 3 ? 3 : 1;

3587 
is_rgb
 = 
z
->
s
->
img_n
 =ğ3 && (z->
rgb
 =ğ3 || (z->
­p14_cŞÜ_ŒªsfÜm
 =ğ0 && !z->
jfif
));

3589 ià(
z
->
s
->
img_n
 =ğ3 && 
n
 < 3 && !
is_rgb
)

3590 
decode_n
 = 1;

3592 
decode_n
 = 
z
->
s
->
img_n
;

3596 
k
;

3597 
i
,
j
;

3598 
¡bi_uc
 *
ouut
;

3599 
¡bi_uc
 *
couut
[4];

3601 
¡bi__»§m¶e
 
»s_comp
[4];

3603 
k
=0; k < 
decode_n
; ++k) {

3604 
¡bi__»§m¶e
 *
r
 = &
»s_comp
[
k
];

3608 
z
->
img_comp
[
k
].
lšebuf
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(z->
s
->
img_x
 + 3);

3609 ià(!
z
->
img_comp
[
k
].
lšebuf
è{ 
	`¡bi__ş—nup_j³g
(z);  
	`¡bi__”½uc
("outofmem", "Out of memory"); }

3611 
r
->
hs
 = 
z
->
img_h_max
 / z->
img_comp
[
k
].
h
;

3612 
r
->
vs
 = 
z
->
img_v_max
 / z->
img_comp
[
k
].
v
;

3613 
r
->
y¡•
 =„->
vs
 >> 1;

3614 
r
->
w_lÜes
 = (
z
->
s
->
img_x
 +„->
hs
-1) /„->hs;

3615 
r
->
ypos
 = 0;

3616 
r
->
lše0
 =„->
lše1
 = 
z
->
img_comp
[
k
].
d©a
;

3618 ià(
r
->
hs
 =ğ1 &&„->
vs
 =ğ1èr->
»§m¶e
 = 
»§m¶e_row_1
;

3619 ià(
r
->
hs
 =ğ1 &&„->
vs
 =ğ2èr->
»§m¶e
 = 
¡bi__»§m¶e_row_v_2
;

3620 ià(
r
->
hs
 =ğ2 &&„->
vs
 =ğ1èr->
»§m¶e
 = 
¡bi__»§m¶e_row_h_2
;

3621 ià(
r
->
hs
 =ğ2 &&„->
vs
 =ğ2èr->
»§m¶e
 = 
z
->
»§m¶e_row_hv_2_k”Ãl
;

3622 
r
->
»§m¶e
 = 
¡bi__»§m¶e_row_g’”ic
;

3626 
ouut
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
n
, 
z
->
s
->
img_x
, z->s->
img_y
, 1);

3627 ià(!
ouut
è{ 
	`¡bi__ş—nup_j³g
(
z
);  
	`¡bi__”½uc
("outofmem", "Out of memory"); }

3630 
j
=0; j < 
z
->
s
->
img_y
; ++j) {

3631 
¡bi_uc
 *
out
 = 
ouut
 + 
n
 * 
z
->
s
->
img_x
 * 
j
;

3632 
k
=0; k < 
decode_n
; ++k) {

3633 
¡bi__»§m¶e
 *
r
 = &
»s_comp
[
k
];

3634 
y_bÙ
 = 
r
->
y¡•
 >ğÔ->
vs
 >> 1);

3635 
couut
[
k
] = 
r
->
	`»§m¶e
(
z
->
img_comp
[k].
lšebuf
,

3636 
y_bÙ
 ? 
r
->
lše1
 :„->
lše0
,

3637 
y_bÙ
 ? 
r
->
lše0
 :„->
lše1
,

3638 
r
->
w_lÜes
,„->
hs
);

3639 ià(++
r
->
y¡•
 >ğr->
vs
) {

3640 
r
->
y¡•
 = 0;

3641 
r
->
lše0
 =„->
lše1
;

3642 ià(++
r
->
ypos
 < 
z
->
img_comp
[
k
].
y
)

3643 
r
->
lše1
 +ğ
z
->
img_comp
[
k
].
w2
;

3646 ià(
n
 >= 3) {

3647 
¡bi_uc
 *
y
 = 
couut
[0];

3648 ià(
z
->
s
->
img_n
 == 3) {

3649 ià(
is_rgb
) {

3650 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3651 
out
[0] = 
y
[
i
];

3652 
out
[1] = 
couut
[1][
i
];

3653 
out
[2] = 
couut
[2][
i
];

3654 
out
[3] = 255;

3655 
out
 +ğ
n
;

3658 
z
->
	`YCbCr_to_RGB_k”Ãl
(
out
, 
y
, 
couut
[1], couut[2], z->
s
->
img_x
, 
n
);

3660 } ià(
z
->
s
->
img_n
 == 4) {

3661 ià(
z
->
­p14_cŞÜ_ŒªsfÜm
 == 0) {

3662 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3663 
¡bi_uc
 
m
 = 
couut
[3][
i
];

3664 
out
[0] = 
	`¡bi__blšn_8x8
(
couut
[0][
i
], 
m
);

3665 
out
[1] = 
	`¡bi__blšn_8x8
(
couut
[1][
i
], 
m
);

3666 
out
[2] = 
	`¡bi__blšn_8x8
(
couut
[2][
i
], 
m
);

3667 
out
[3] = 255;

3668 
out
 +ğ
n
;

3670 } ià(
z
->
­p14_cŞÜ_ŒªsfÜm
 == 2) {

3671 
z
->
	`YCbCr_to_RGB_k”Ãl
(
out
, 
y
, 
couut
[1], couut[2], z->
s
->
img_x
, 
n
);

3672 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3673 
¡bi_uc
 
m
 = 
couut
[3][
i
];

3674 
out
[0] = 
	`¡bi__blšn_8x8
(255 - out[0], 
m
);

3675 
out
[1] = 
	`¡bi__blšn_8x8
(255 - out[1], 
m
);

3676 
out
[2] = 
	`¡bi__blšn_8x8
(255 - out[2], 
m
);

3677 
out
 +ğ
n
;

3680 
z
->
	`YCbCr_to_RGB_k”Ãl
(
out
, 
y
, 
couut
[1], couut[2], z->
s
->
img_x
, 
n
);

3683 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3684 
out
[0] = out[1] = out[2] = 
y
[
i
];

3685 
out
[3] = 255;

3686 
out
 +ğ
n
;

3689 ià(
is_rgb
) {

3690 ià(
n
 == 1)

3691 
i
=0; i < 
z
->
s
->
img_x
; ++i)

3692 *
out
++ = 
	`¡bi__compu‹_y
(
couut
[0][
i
], coutput[1][i], coutput[2][i]);

3694 
i
=0; i < 
z
->
s
->
img_x
; ++i, 
out
 += 2) {

3695 
out
[0] = 
	`¡bi__compu‹_y
(
couut
[0][
i
], coutput[1][i], coutput[2][i]);

3696 
out
[1] = 255;

3699 } ià(
z
->
s
->
img_n
 =ğ4 && z->
­p14_cŞÜ_ŒªsfÜm
 == 0) {

3700 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3701 
¡bi_uc
 
m
 = 
couut
[3][
i
];

3702 
¡bi_uc
 
r
 = 
	`¡bi__blšn_8x8
(
couut
[0][
i
], 
m
);

3703 
¡bi_uc
 
g
 = 
	`¡bi__blšn_8x8
(
couut
[1][
i
], 
m
);

3704 
¡bi_uc
 
b
 = 
	`¡bi__blšn_8x8
(
couut
[2][
i
], 
m
);

3705 
out
[0] = 
	`¡bi__compu‹_y
(
r
, 
g
, 
b
);

3706 
out
[1] = 255;

3707 
out
 +ğ
n
;

3709 } ià(
z
->
s
->
img_n
 =ğ4 && z->
­p14_cŞÜ_ŒªsfÜm
 == 2) {

3710 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3711 
out
[0] = 
	`¡bi__blšn_8x8
(255 - 
couut
[0][
i
], coutput[3][i]);

3712 
out
[1] = 255;

3713 
out
 +ğ
n
;

3716 
¡bi_uc
 *
y
 = 
couut
[0];

3717 ià(
n
 == 1)

3718 
i
=0; i < 
z
->
s
->
img_x
; ++iè
out
[i] = 
y
[i];

3720 
i
=0; i < 
z
->
s
->
img_x
; ++iè*
out
++ = 
y
[i], *out++ = 255;

3724 
	`¡bi__ş—nup_j³g
(
z
);

3725 *
out_x
 = 
z
->
s
->
img_x
;

3726 *
out_y
 = 
z
->
s
->
img_y
;

3727 ià(
comp
è*com°ğ
z
->
s
->
img_n
 >= 3 ? 3 : 1;

3728  
ouut
;

3730 
	}
}

3732 *
	$¡bi__j³g_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

3734 * 
»suÉ
;

3735 
¡bi__j³g
* 
j
 = (¡bi__j³g*è
	`¡bi__m®loc
((stbi__jpeg));

3736 
	`STBI_NOTUSED
(
ri
);

3737 
j
->
s
 = s;

3738 
	`¡bi__£tup_j³g
(
j
);

3739 
»suÉ
 = 
	`lßd_j³g_image
(
j
, 
x
,
y
,
comp
,
»q_comp
);

3740 
	`STBI_FREE
(
j
);

3741  
»suÉ
;

3742 
	}
}

3744 
	$¡bi__j³g_‹¡
(
¡bi__cÚ‹xt
 *
s
)

3746 
r
;

3747 
¡bi__j³g
* 
j
 = (¡bi__j³g*)
	`¡bi__m®loc
((stbi__jpeg));

3748 
j
->
s
 = s;

3749 
	`¡bi__£tup_j³g
(
j
);

3750 
r
 = 
	`¡bi__decode_j³g_h—d”
(
j
, 
STBI__SCAN_ty³
);

3751 
	`¡bi__»wšd
(
s
);

3752 
	`STBI_FREE
(
j
);

3753  
r
;

3754 
	}
}

3756 
	$¡bi__j³g_šfo_¿w
(
¡bi__j³g
 *
j
, *
x
, *
y
, *
comp
)

3758 ià(!
	`¡bi__decode_j³g_h—d”
(
j
, 
STBI__SCAN_h—d”
)) {

3759 
	`¡bi__»wšd
Ğ
j
->
s
 );

3762 ià(
x
è*x = 
j
->
s
->
img_x
;

3763 ià(
y
è*y = 
j
->
s
->
img_y
;

3764 ià(
comp
è*com°ğ
j
->
s
->
img_n
 >= 3 ? 3 : 1;

3766 
	}
}

3768 
	$¡bi__j³g_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

3770 
»suÉ
;

3771 
¡bi__j³g
* 
j
 = (¡bi__j³g*è(
	`¡bi__m®loc
((stbi__jpeg)));

3772 
j
->
s
 = s;

3773 
»suÉ
 = 
	`¡bi__j³g_šfo_¿w
(
j
, 
x
, 
y
, 
comp
);

3774 
	`STBI_FREE
(
j
);

3775  
»suÉ
;

3776 
	}
}

3786 #iâdeà
STBI_NO_ZLIB


3789 
	#STBI__ZFAST_BITS
 9

3790 
	#STBI__ZFAST_MASK
 ((1 << 
STBI__ZFAST_BITS
è- 1)

	)

3796 
¡bi__ušt16
 
	mç¡
[1 << 
STBI__ZFAST_BITS
];

3797 
¡bi__ušt16
 
	mfœ¡code
[16];

3798 
	mmaxcode
[17];

3799 
¡bi__ušt16
 
	mfœ¡symbŞ
[16];

3800 
¡bi_uc
 
	msize
[288];

3801 
¡bi__ušt16
 
	mv®ue
[288];

3802 } 
	t¡bi__zhuffmª
;

3804 
¡bi_šlše
 
	$¡bi__b™»v”£16
(
n
)

3806 
n
 = ((n & 0xAAAA) >> 1) | ((n & 0x5555) << 1);

3807 
n
 = ((n & 0xCCCC) >> 2) | ((n & 0x3333) << 2);

3808 
n
 = ((n & 0xF0F0) >> 4) | ((n & 0x0F0F) << 4);

3809 
n
 = ((n & 0xFF00) >> 8) | ((n & 0x00FF) << 8);

3810  
n
;

3811 
	}
}

3813 
¡bi_šlše
 
	$¡bi__b™_»v”£
(
v
, 
b™s
)

3815 
	`STBI_ASSERT
(
b™s
 <= 16);

3818  
	`¡bi__b™»v”£16
(
v
è>> (16-
b™s
);

3819 
	}
}

3821 
	$¡bi__zbud_huffmª
(
¡bi__zhuffmª
 *
z
, cÚ¡ 
¡bi_uc
 *
siz–i¡
, 
num
)

3823 
i
,
k
=0;

3824 
code
, 
Ãxt_code
[16], 
sizes
[17];

3827 
	`mem£t
(
sizes
, 0, (sizes));

3828 
	`mem£t
(
z
->
ç¡
, 0, (z->fast));

3829 
i
=0; i < 
num
; ++i)

3830 ++
sizes
[
siz–i¡
[
i
]];

3831 
sizes
[0] = 0;

3832 
i
=1; i < 16; ++i)

3833 ià(
sizes
[
i
] > (1 << i))

3834  
	`¡bi__”r
("bad sizes", "Corrupt PNG");

3835 
code
 = 0;

3836 
i
=1; i < 16; ++i) {

3837 
Ãxt_code
[
i
] = 
code
;

3838 
z
->
fœ¡code
[
i
] = (
¡bi__ušt16
è
code
;

3839 
z
->
fœ¡symbŞ
[
i
] = (
¡bi__ušt16
è
k
;

3840 
code
 = (cod+ 
sizes
[
i
]);

3841 ià(
sizes
[
i
])

3842 ià(
code
-1 >ğ(1 << 
i
)è 
	`¡bi__”r
("bad codelengths","Corrupt PNG");

3843 
z
->
maxcode
[
i
] = 
code
 << (16-i);

3844 
code
 <<= 1;

3845 
k
 +ğ
sizes
[
i
];

3847 
z
->
maxcode
[16] = 0x10000;

3848 
i
=0; i < 
num
; ++i) {

3849 
s
 = 
siz–i¡
[
i
];

3850 ià(
s
) {

3851 
c
 = 
Ãxt_code
[
s
] - 
z
->
fœ¡code
[s] + z->
fœ¡symbŞ
[s];

3852 
¡bi__ušt16
 
ç¡v
 = (¡bi__ušt16è((
s
 << 9è| 
i
);

3853 
z
->
size
 [
c
] = (
¡bi_uc
 ) 
s
;

3854 
z
->
v®ue
[
c
] = (
¡bi__ušt16
è
i
;

3855 ià(
s
 <ğ
STBI__ZFAST_BITS
) {

3856 
j
 = 
	`¡bi__b™_»v”£
(
Ãxt_code
[
s
],s);

3857 
j
 < (1 << 
STBI__ZFAST_BITS
)) {

3858 
z
->
ç¡
[
j
] = 
ç¡v
;

3859 
j
 +ğ(1 << 
s
);

3862 ++
Ãxt_code
[
s
];

3866 
	}
}

3876 
¡bi_uc
 *
	mzbufãr
, *
	mzbufãr_’d
;

3877 
	mnum_b™s
;

3878 
¡bi__ušt32
 
	mcode_bufãr
;

3880 *
	mzout
;

3881 *
	mzout_¡¬t
;

3882 *
	mzout_’d
;

3883 
	mz_ex·ndabË
;

3885 
¡bi__zhuffmª
 
	mz_Ëngth
, 
	mz_di¡ªû
;

3886 } 
	t¡bi__zbuf
;

3888 
¡bi_šlše
 
¡bi_uc
 
	$¡bi__zg‘8
(
¡bi__zbuf
 *
z
)

3890 ià(
z
->
zbufãr
 >ğz->
zbufãr_’d
)  0;

3891  *
z
->
zbufãr
++;

3892 
	}
}

3894 
	$¡bi__fl_b™s
(
¡bi__zbuf
 *
z
)

3897 
	`STBI_ASSERT
(
z
->
code_bufãr
 < (1U << z->
num_b™s
));

3898 
z
->
code_bufãr
 |ğ(è
	`¡bi__zg‘8
(zè<< z->
num_b™s
;

3899 
z
->
num_b™s
 += 8;

3900 } 
z
->
num_b™s
 <= 24);

3901 
	}
}

3903 
¡bi_šlše
 
	$¡bi__z»ûive
(
¡bi__zbuf
 *
z
, 
n
)

3905 
k
;

3906 ià(
z
->
num_b™s
 < 
n
è
	`¡bi__fl_b™s
(z);

3907 
k
 = 
z
->
code_bufãr
 & ((1 << 
n
) - 1);

3908 
z
->
code_bufãr
 >>ğ
n
;

3909 
z
->
num_b™s
 -ğ
n
;

3910  
k
;

3911 
	}
}

3913 
	$¡bi__zhuffmª_decode_¦ow·th
(
¡bi__zbuf
 *
a
, 
¡bi__zhuffmª
 *
z
)

3915 
b
,
s
,
k
;

3918 
k
 = 
	`¡bi__b™_»v”£
(
a
->
code_bufãr
, 16);

3919 
s
=
STBI__ZFAST_BITS
+1; ; ++s)

3920 ià(
k
 < 
z
->
maxcode
[
s
])

3922 ià(
s
 == 16)  -1;

3924 
b
 = (
k
 >> (16-
s
)è- 
z
->
fœ¡code
[s] + z->
fœ¡symbŞ
[s];

3925 
	`STBI_ASSERT
(
z
->
size
[
b
] =ğ
s
);

3926 
a
->
code_bufãr
 >>ğ
s
;

3927 
a
->
num_b™s
 -ğ
s
;

3928  
z
->
v®ue
[
b
];

3929 
	}
}

3931 
¡bi_šlše
 
	$¡bi__zhuffmª_decode
(
¡bi__zbuf
 *
a
, 
¡bi__zhuffmª
 *
z
)

3933 
b
,
s
;

3934 ià(
a
->
num_b™s
 < 16è
	`¡bi__fl_b™s
(a);

3935 
b
 = 
z
->
ç¡
[
a
->
code_bufãr
 & 
STBI__ZFAST_MASK
];

3936 ià(
b
) {

3937 
s
 = 
b
 >> 9;

3938 
a
->
code_bufãr
 >>ğ
s
;

3939 
a
->
num_b™s
 -ğ
s
;

3940  
b
 & 511;

3942  
	`¡bi__zhuffmª_decode_¦ow·th
(
a
, 
z
);

3943 
	}
}

3945 
	$¡bi__zex·nd
(
¡bi__zbuf
 *
z
, *
zout
, 
n
)

3947 *
q
;

3948 
cur
, 
lim™
, 
Şd_lim™
;

3949 
z
->
zout
 = zout;

3950 ià(!
z
->
z_ex·ndabË
è 
	`¡bi__”r
("output buffer†imit","Corrupt PNG");

3951 
cur
 = (è(
z
->
zout
 - z->
zout_¡¬t
);

3952 
lim™
 = 
Şd_lim™
 = (è(
z
->
zout_’d
 - z->
zout_¡¬t
);

3953 
cur
 + 
n
 > 
lim™
)

3954 
lim™
 *= 2;

3955 
q
 = (*è
	`STBI_REALLOC_SIZED
(
z
->
zout_¡¬t
, 
Şd_lim™
, 
lim™
);

3956 
	`STBI_NOTUSED
(
Şd_lim™
);

3957 ià(
q
 =ğ
NULL
è 
	`¡bi__”r
("outofmem", "Out of memory");

3958 
z
->
zout_¡¬t
 = 
q
;

3959 
z
->
zout
 = 
q
 + 
cur
;

3960 
z
->
zout_’d
 = 
q
 + 
lim™
;

3962 
	}
}

3964 cÚ¡ 
	g¡bi__zËngth_ba£
[31] = {

3969 cÚ¡ 
	g¡bi__zËngth_exŒa
[31]=

3972 cÚ¡ 
	g¡bi__zdi¡_ba£
[32] = { 1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,

3975 cÚ¡ 
	g¡bi__zdi¡_exŒa
[32] =

3978 
	$¡bi__·r£_huffmª_block
(
¡bi__zbuf
 *
a
)

3980 *
zout
 = 
a
->zout;

3982 
z
 = 
	`¡bi__zhuffmª_decode
(
a
, &a->
z_Ëngth
);

3983 ià(
z
 < 256) {

3984 ià(
z
 < 0è 
	`¡bi__”r
("bad huffman code","Corrupt PNG");

3985 ià(
zout
 >ğ
a
->
zout_’d
) {

3986 ià(!
	`¡bi__zex·nd
(
a
, 
zout
, 1))  0;

3987 
zout
 = 
a
->zout;

3989 *
zout
++ = (è
z
;

3991 
¡bi_uc
 *
p
;

3992 
Ën
,
di¡
;

3993 ià(
z
 == 256) {

3994 
a
->
zout
 = zout;

3997 
z
 -= 257;

3998 
Ën
 = 
¡bi__zËngth_ba£
[
z
];

3999 ià(
¡bi__zËngth_exŒa
[
z
]è
Ën
 +ğ
	`¡bi__z»ûive
(
a
, stbi__zlength_extra[z]);

4000 
z
 = 
	`¡bi__zhuffmª_decode
(
a
, &a->
z_di¡ªû
);

4001 ià(
z
 < 0è 
	`¡bi__”r
("bad huffman code","Corrupt PNG");

4002 
di¡
 = 
¡bi__zdi¡_ba£
[
z
];

4003 ià(
¡bi__zdi¡_exŒa
[
z
]è
di¡
 +ğ
	`¡bi__z»ûive
(
a
, stbi__zdist_extra[z]);

4004 ià(
zout
 - 
a
->
zout_¡¬t
 < 
di¡
è 
	`¡bi__”r
("bad dist","Corrupt PNG");

4005 ià(
zout
 + 
Ën
 > 
a
->
zout_’d
) {

4006 ià(!
	`¡bi__zex·nd
(
a
, 
zout
, 
Ën
))  0;

4007 
zout
 = 
a
->zout;

4009 
p
 = (
¡bi_uc
 *è(
zout
 - 
di¡
);

4010 ià(
di¡
 == 1) {

4011 
¡bi_uc
 
v
 = *
p
;

4012 ià(
Ën
è{ dØ*
zout
++ = 
v
; --len); }

4014 ià(
Ën
è{ dØ*
zout
++ = *
p
++; --len); }

4018 
	}
}

4020 
	$¡bi__compu‹_huffmª_codes
(
¡bi__zbuf
 *
a
)

4022 cÚ¡ 
¡bi_uc
 
Ëngth_dezigzag
[19] = { 16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15 };

4023 
¡bi__zhuffmª
 
z_cod–’gth
;

4024 
¡bi_uc
 
Ëncodes
[286+32+137];

4025 
¡bi_uc
 
cod–’gth_sizes
[19];

4026 
i
,
n
;

4028 
hl™
 = 
	`¡bi__z»ûive
(
a
,5) + 257;

4029 
hdi¡
 = 
	`¡bi__z»ûive
(
a
,5) + 1;

4030 
hş’
 = 
	`¡bi__z»ûive
(
a
,4) + 4;

4031 
ÁÙ
 = 
hl™
 + 
hdi¡
;

4033 
	`mem£t
(
cod–’gth_sizes
, 0, (codelength_sizes));

4034 
i
=0; i < 
hş’
; ++i) {

4035 
s
 = 
	`¡bi__z»ûive
(
a
,3);

4036 
cod–’gth_sizes
[
Ëngth_dezigzag
[
i
]] = (
¡bi_uc
è
s
;

4038 ià(!
	`¡bi__zbud_huffmª
(&
z_cod–’gth
, 
cod–’gth_sizes
, 19))  0;

4040 
n
 = 0;

4041 
n
 < 
ÁÙ
) {

4042 
c
 = 
	`¡bi__zhuffmª_decode
(
a
, &
z_cod–’gth
);

4043 ià(
c
 < 0 || c >ğ19è 
	`¡bi__”r
("bad codelengths", "Corrupt PNG");

4044 ià(
c
 < 16)

4045 
Ëncodes
[
n
++] = (
¡bi_uc
è
c
;

4047 
¡bi_uc
 
fl
 = 0;

4048 ià(
c
 == 16) {

4049 
c
 = 
	`¡bi__z»ûive
(
a
,2)+3;

4050 ià(
n
 =ğ0è 
	`¡bi__”r
("bad codelengths", "Corrupt PNG");

4051 
fl
 = 
Ëncodes
[
n
-1];

4052 } ià(
c
 == 17)

4053 
c
 = 
	`¡bi__z»ûive
(
a
,3)+3;

4055 
	`STBI_ASSERT
(
c
 == 18);

4056 
c
 = 
	`¡bi__z»ûive
(
a
,7)+11;

4058 ià(
ÁÙ
 - 
n
 < 
c
è 
	`¡bi__”r
("bad codelengths", "Corrupt PNG");

4059 
	`mem£t
(
Ëncodes
+
n
, 
fl
, 
c
);

4060 
n
 +ğ
c
;

4063 ià(
n
 !ğ
ÁÙ
è 
	`¡bi__”r
("bad codelengths","Corrupt PNG");

4064 ià(!
	`¡bi__zbud_huffmª
(&
a
->
z_Ëngth
, 
Ëncodes
, 
hl™
))  0;

4065 ià(!
	`¡bi__zbud_huffmª
(&
a
->
z_di¡ªû
, 
Ëncodes
+
hl™
, 
hdi¡
))  0;

4067 
	}
}

4069 
	$¡bi__·r£_uncom´es£d_block
(
¡bi__zbuf
 *
a
)

4071 
¡bi_uc
 
h—d”
[4];

4072 
Ën
,
Æ’
,
k
;

4073 ià(
a
->
num_b™s
 & 7)

4074 
	`¡bi__z»ûive
(
a
,‡->
num_b™s
 & 7);

4076 
k
 = 0;

4077 
a
->
num_b™s
 > 0) {

4078 
h—d”
[
k
++] = (
¡bi_uc
è(
a
->
code_bufãr
 & 255);

4079 
a
->
code_bufãr
 >>= 8;

4080 
a
->
num_b™s
 -= 8;

4082 
	`STBI_ASSERT
(
a
->
num_b™s
 == 0);

4084 
k
 < 4)

4085 
h—d”
[
k
++] = 
	`¡bi__zg‘8
(
a
);

4086 
Ën
 = 
h—d”
[1] * 256 + header[0];

4087 
Æ’
 = 
h—d”
[3] * 256 + header[2];

4088 ià(
Æ’
 !ğ(
Ën
 ^ 0xffff)è 
	`¡bi__”r
("zlib corrupt","Corrupt PNG");

4089 ià(
a
->
zbufãr
 + 
Ën
 >‡->
zbufãr_’d
è 
	`¡bi__”r
("read…ast buffer","Corrupt PNG");

4090 ià(
a
->
zout
 + 
Ën
 >‡->
zout_’d
)

4091 ià(!
	`¡bi__zex·nd
(
a
,‡->
zout
, 
Ën
))  0;

4092 
	`memıy
(
a
->
zout
,‡->
zbufãr
, 
Ën
);

4093 
a
->
zbufãr
 +ğ
Ën
;

4094 
a
->
zout
 +ğ
Ën
;

4096 
	}
}

4098 
	$¡bi__·r£_zlib_h—d”
(
¡bi__zbuf
 *
a
)

4100 
cmf
 = 
	`¡bi__zg‘8
(
a
);

4101 
cm
 = 
cmf
 & 15;

4103 
æg
 = 
	`¡bi__zg‘8
(
a
);

4104 ià((
cmf
*256+
æg
è% 31 !ğ0è 
	`¡bi__”r
("bad zlib header","Corrupt PNG");

4105 ià(
æg
 & 32è 
	`¡bi__”r
("no…reset dict","Corrupt PNG");

4106 ià(
cm
 !ğ8è 
	`¡bi__”r
("bad compression","Corrupt PNG");

4109 
	}
}

4111 cÚ¡ 
¡bi_uc
 
	g¡bi__zdeçuÉ_Ëngth
[288] =

4123 cÚ¡ 
¡bi_uc
 
	g¡bi__zdeçuÉ_di¡ªû
[32] =

4140 
	$¡bi__·r£_zlib
(
¡bi__zbuf
 *
a
, 
·r£_h—d”
)

4142 
fš®
, 
ty³
;

4143 ià(
·r£_h—d”
)

4144 ià(!
	`¡bi__·r£_zlib_h—d”
(
a
))  0;

4145 
a
->
num_b™s
 = 0;

4146 
a
->
code_bufãr
 = 0;

4148 
fš®
 = 
	`¡bi__z»ûive
(
a
,1);

4149 
ty³
 = 
	`¡bi__z»ûive
(
a
,2);

4150 ià(
ty³
 == 0) {

4151 ià(!
	`¡bi__·r£_uncom´es£d_block
(
a
))  0;

4152 } ià(
ty³
 == 3) {

4155 ià(
ty³
 == 1) {

4157 ià(!
	`¡bi__zbud_huffmª
(&
a
->
z_Ëngth
 , 
¡bi__zdeçuÉ_Ëngth
 , 288))  0;

4158 ià(!
	`¡bi__zbud_huffmª
(&
a
->
z_di¡ªû
, 
¡bi__zdeçuÉ_di¡ªû
, 32))  0;

4160 ià(!
	`¡bi__compu‹_huffmª_codes
(
a
))  0;

4162 ià(!
	`¡bi__·r£_huffmª_block
(
a
))  0;

4164 } !
fš®
);

4166 
	}
}

4168 
	$¡bi__do_zlib
(
¡bi__zbuf
 *
a
, *
obuf
, 
Ş’
, 
exp
, 
·r£_h—d”
)

4170 
a
->
zout_¡¬t
 = 
obuf
;

4171 
a
->
zout
 = 
obuf
;

4172 
a
->
zout_’d
 = 
obuf
 + 
Ş’
;

4173 
a
->
z_ex·ndabË
 = 
exp
;

4175  
	`¡bi__·r£_zlib
(
a
, 
·r£_h—d”
);

4176 
	}
}

4178 
STBIDEF
 *
	$¡bi_zlib_decode_m®loc_guesssize
(cÚ¡ *
bufãr
, 
Ën
, 
š™Ÿl_size
, *
ou’
)

4180 
¡bi__zbuf
 
a
;

4181 *
p
 = (*è
	`¡bi__m®loc
(
š™Ÿl_size
);

4182 ià(
p
 =ğ
NULL
)  NULL;

4183 
a
.
zbufãr
 = (
¡bi_uc
 *è
bufãr
;

4184 
a
.
zbufãr_’d
 = (
¡bi_uc
 *è
bufãr
 + 
Ën
;

4185 ià(
	`¡bi__do_zlib
(&
a
, 
p
, 
š™Ÿl_size
, 1, 1)) {

4186 ià(
ou’
è*ou’ = (è(
a
.
zout
 -‡.
zout_¡¬t
);

4187  
a
.
zout_¡¬t
;

4189 
	`STBI_FREE
(
a
.
zout_¡¬t
);

4190  
NULL
;

4192 
	}
}

4194 
STBIDEF
 *
	$¡bi_zlib_decode_m®loc
(cÚ¡ *
bufãr
, 
Ën
, *
ou’
)

4196  
	`¡bi_zlib_decode_m®loc_guesssize
(
bufãr
, 
Ën
, 16384, 
ou’
);

4197 
	}
}

4199 
STBIDEF
 *
	$¡bi_zlib_decode_m®loc_guesssize_h—d”æag
(cÚ¡ *
bufãr
, 
Ën
, 
š™Ÿl_size
, *
ou’
, 
·r£_h—d”
)

4201 
¡bi__zbuf
 
a
;

4202 *
p
 = (*è
	`¡bi__m®loc
(
š™Ÿl_size
);

4203 ià(
p
 =ğ
NULL
)  NULL;

4204 
a
.
zbufãr
 = (
¡bi_uc
 *è
bufãr
;

4205 
a
.
zbufãr_’d
 = (
¡bi_uc
 *è
bufãr
 + 
Ën
;

4206 ià(
	`¡bi__do_zlib
(&
a
, 
p
, 
š™Ÿl_size
, 1, 
·r£_h—d”
)) {

4207 ià(
ou’
è*ou’ = (è(
a
.
zout
 -‡.
zout_¡¬t
);

4208  
a
.
zout_¡¬t
;

4210 
	`STBI_FREE
(
a
.
zout_¡¬t
);

4211  
NULL
;

4213 
	}
}

4215 
STBIDEF
 
	$¡bi_zlib_decode_bufãr
(*
obufãr
, 
Ş’
, cÚ¡ *
ibufãr
, 
’
)

4217 
¡bi__zbuf
 
a
;

4218 
a
.
zbufãr
 = (
¡bi_uc
 *è
ibufãr
;

4219 
a
.
zbufãr_’d
 = (
¡bi_uc
 *è
ibufãr
 + 
’
;

4220 ià(
	`¡bi__do_zlib
(&
a
, 
obufãr
, 
Ş’
, 0, 1))

4221  (è(
a
.
zout
 -‡.
zout_¡¬t
);

4224 
	}
}

4226 
STBIDEF
 *
	$¡bi_zlib_decode_noh—d”_m®loc
(cÚ¡ *
bufãr
, 
Ën
, *
ou’
)

4228 
¡bi__zbuf
 
a
;

4229 *
p
 = (*è
	`¡bi__m®loc
(16384);

4230 ià(
p
 =ğ
NULL
)  NULL;

4231 
a
.
zbufãr
 = (
¡bi_uc
 *è
bufãr
;

4232 
a
.
zbufãr_’d
 = (
¡bi_uc
 *è
bufãr
+
Ën
;

4233 ià(
	`¡bi__do_zlib
(&
a
, 
p
, 16384, 1, 0)) {

4234 ià(
ou’
è*ou’ = (è(
a
.
zout
 -‡.
zout_¡¬t
);

4235  
a
.
zout_¡¬t
;

4237 
	`STBI_FREE
(
a
.
zout_¡¬t
);

4238  
NULL
;

4240 
	}
}

4242 
STBIDEF
 
	$¡bi_zlib_decode_noh—d”_bufãr
(*
obufãr
, 
Ş’
, cÚ¡ *
ibufãr
, 
’
)

4244 
¡bi__zbuf
 
a
;

4245 
a
.
zbufãr
 = (
¡bi_uc
 *è
ibufãr
;

4246 
a
.
zbufãr_’d
 = (
¡bi_uc
 *è
ibufãr
 + 
’
;

4247 ià(
	`¡bi__do_zlib
(&
a
, 
obufãr
, 
Ş’
, 0, 0))

4248  (è(
a
.
zout
 -‡.
zout_¡¬t
);

4251 
	}
}

4264 #iâdeà
STBI_NO_PNG


4267 
¡bi__ušt32
 
	mËngth
;

4268 
¡bi__ušt32
 
	mty³
;

4269 } 
	t¡bi__²gchunk
;

4271 
¡bi__²gchunk
 
	$¡bi__g‘_chunk_h—d”
(
¡bi__cÚ‹xt
 *
s
)

4273 
¡bi__²gchunk
 
c
;

4274 
c
.
Ëngth
 = 
	`¡bi__g‘32be
(
s
);

4275 
c
.
ty³
 = 
	`¡bi__g‘32be
(
s
);

4276  
c
;

4277 
	}
}

4279 
	$¡bi__check_²g_h—d”
(
¡bi__cÚ‹xt
 *
s
)

4281 cÚ¡ 
¡bi_uc
 
²g_sig
[8] = { 137,80,78,71,13,10,26,10 };

4282 
i
;

4283 
i
=0; i < 8; ++i)

4284 ià(
	`¡bi__g‘8
(
s
è!ğ
²g_sig
[
i
]è 
	`¡bi__”r
("bad…ng sig","Not‡ PNG");

4286 
	}
}

4290 
¡bi__cÚ‹xt
 *
	ms
;

4291 
¡bi_uc
 *
	mid©a
, *
	mex·nded
, *
	mout
;

4292 
	md•th
;

4293 } 
	t¡bi__²g
;

4297 
	mSTBI__F_nÚe
=0,

4298 
	mSTBI__F_sub
=1,

4299 
	mSTBI__F_up
=2,

4300 
	mSTBI__F_avg
=3,

4301 
	mSTBI__F_·‘h
=4,

4303 
	mSTBI__F_avg_fœ¡
,

4304 
	mSTBI__F_·‘h_fœ¡


4307 
¡bi_uc
 
	gfœ¡_row_f‹r
[5] =

4309 
STBI__F_nÚe
,

4310 
STBI__F_sub
,

4311 
STBI__F_nÚe
,

4312 
STBI__F_avg_fœ¡
,

4313 
STBI__F_·‘h_fœ¡


4316 
	$¡bi__·‘h
(
a
, 
b
, 
c
)

4318 
p
 = 
a
 + 
b
 - 
c
;

4319 
·
 = 
	`abs
(
p
-
a
);

4320 
pb
 = 
	`abs
(
p
-
b
);

4321 
pc
 = 
	`abs
(
p
-
c
);

4322 ià(
·
 <ğ
pb
 &&…¨<ğ
pc
è 
a
;

4323 ià(
pb
 <ğ
pc
è 
b
;

4324  
c
;

4325 
	}
}

4327 cÚ¡ 
¡bi_uc
 
	g¡bi__d•th_sÿË_bË
[9] = { 0, 0xff, 0x55, 0, 0x11, 0,0,0, 0x01 };

4330 
	$¡bi__ü—‹_²g_image_¿w
(
¡bi__²g
 *
a
, 
¡bi_uc
 *
¿w
, 
¡bi__ušt32
 
¿w_Ën
, 
out_n
, stbi__ušt32 
x
, stbi__ušt32 
y
, 
d•th
, 
cŞÜ
)

4332 
by‹s
 = (
d•th
 == 16? 2 : 1);

4333 
¡bi__cÚ‹xt
 *
s
 = 
a
->s;

4334 
¡bi__ušt32
 
i
,
j
,
¡ride
 = 
x
*
out_n
*
by‹s
;

4335 
¡bi__ušt32
 
img_Ën
, 
img_width_by‹s
;

4336 
k
;

4337 
img_n
 = 
s
->img_n;

4339 
ouut_by‹s
 = 
out_n
*
by‹s
;

4340 
f‹r_by‹s
 = 
img_n
*
by‹s
;

4341 
width
 = 
x
;

4343 
	`STBI_ASSERT
(
out_n
 =ğ
s
->
img_n
 || out_n == s->img_n+1);

4344 
a
->
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
x
, 
y
, 
ouut_by‹s
, 0);

4345 ià(!
a
->
out
è 
	`¡bi__”r
("outofmem", "Out of memory");

4347 ià(!
	`¡bi__mad3sizes_v®id
(
img_n
, 
x
, 
d•th
, 7)è 
	`¡bi__”r
("too†arge", "Corrupt PNG");

4348 
img_width_by‹s
 = (((
img_n
 * 
x
 * 
d•th
) + 7) >> 3);

4349 
img_Ën
 = (
img_width_by‹s
 + 1è* 
y
;

4354 ià(
¿w_Ën
 < 
img_Ën
è 
	`¡bi__”r
("notƒnough…ixels","Corrupt PNG");

4356 
j
=0; j < 
y
; ++j) {

4357 
¡bi_uc
 *
cur
 = 
a
->
out
 + 
¡ride
*
j
;

4358 
¡bi_uc
 *
´iÜ
;

4359 
f‹r
 = *
¿w
++;

4361 ià(
f‹r
 > 4)

4362  
	`¡bi__”r
("invalid filter","Corrupt PNG");

4364 ià(
d•th
 < 8) {

4365 
	`STBI_ASSERT
(
img_width_by‹s
 <ğ
x
);

4366 
cur
 +ğ
x
*
out_n
 - 
img_width_by‹s
;

4367 
f‹r_by‹s
 = 1;

4368 
width
 = 
img_width_by‹s
;

4370 
´iÜ
 = 
cur
 - 
¡ride
;

4373 ià(
j
 =ğ0è
f‹r
 = 
fœ¡_row_f‹r
[filter];

4376 
k
=0; k < 
f‹r_by‹s
; ++k) {

4377 
f‹r
) {

4378 
STBI__F_nÚe
 : 
cur
[
k
] = 
¿w
[k]; ;

4379 
STBI__F_sub
 : 
cur
[
k
] = 
¿w
[k]; ;

4380 
STBI__F_up
 : 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
´iÜ
[k]); ;

4381 
STBI__F_avg
 : 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + (
´iÜ
[k]>>1)); ;

4382 
STBI__F_·‘h
 : 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
	`¡bi__·‘h
(0,
´iÜ
[k],0)); ;

4383 
STBI__F_avg_fœ¡
 : 
cur
[
k
] = 
¿w
[k]; ;

4384 
STBI__F_·‘h_fœ¡
: 
cur
[
k
] = 
¿w
[k]; ;

4388 ià(
d•th
 == 8) {

4389 ià(
img_n
 !ğ
out_n
)

4390 
cur
[
img_n
] = 255;

4391 
¿w
 +ğ
img_n
;

4392 
cur
 +ğ
out_n
;

4393 
´iÜ
 +ğ
out_n
;

4394 } ià(
d•th
 == 16) {

4395 ià(
img_n
 !ğ
out_n
) {

4396 
cur
[
f‹r_by‹s
] = 255;

4397 
cur
[
f‹r_by‹s
+1] = 255;

4399 
¿w
 +ğ
f‹r_by‹s
;

4400 
cur
 +ğ
ouut_by‹s
;

4401 
´iÜ
 +ğ
ouut_by‹s
;

4403 
¿w
 += 1;

4404 
cur
 += 1;

4405 
´iÜ
 += 1;

4409 ià(
d•th
 < 8 || 
img_n
 =ğ
out_n
) {

4410 
nk
 = (
width
 - 1)*
f‹r_by‹s
;

4411 
	#STBI__CASE
(
f
) \

4412 
f
: \

4413 
k
=0; k < 
nk
; ++k)

	)

4414 
f‹r
) {

4416 
STBI__F_nÚe
: 
	`memıy
(
cur
, 
¿w
, 
nk
); ;

4417 
	`STBI__CASE
(
STBI__F_sub
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + cur[k-
f‹r_by‹s
]); } ;

4418 
	`STBI__CASE
(
STBI__F_up
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
´iÜ
[k]); } ;

4419 
	`STBI__CASE
(
STBI__F_avg
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + ((
´iÜ
[k] + cur[k-
f‹r_by‹s
])>>1)); } ;

4420 
	`STBI__CASE
(
STBI__F_·‘h
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
	`¡bi__·‘h
(cur[k-
f‹r_by‹s
],
´iÜ
[k],prior[k-filter_bytes])); } ;

4421 
	`STBI__CASE
(
STBI__F_avg_fœ¡
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + (cur[k-
f‹r_by‹s
] >> 1)); } ;

4422 
	`STBI__CASE
(
STBI__F_·‘h_fœ¡
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
	`¡bi__·‘h
(cur[k-
f‹r_by‹s
],0,0)); } ;

4424 #undeà
STBI__CASE


4425 
¿w
 +ğ
nk
;

4427 
	`STBI_ASSERT
(
img_n
+1 =ğ
out_n
);

4428 
	#STBI__CASE
(
f
) \

4429 
f
: \

4430 
i
=
x
-1; i >ğ1; --i, 
cur
[
f‹r_by‹s
]=255,
¿w
+=f‹r_by‹s,cur+=
ouut_by‹s
,
´iÜ
+=output_bytes) \

4431 
k
=0; k < 
f‹r_by‹s
; ++k)

	)

4432 
f‹r
) {

4433 
	`STBI__CASE
(
STBI__F_nÚe
è{ 
cur
[
k
] = 
¿w
[k]; } ;

4434 
	`STBI__CASE
(
STBI__F_sub
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + cur[k- 
ouut_by‹s
]); } ;

4435 
	`STBI__CASE
(
STBI__F_up
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
´iÜ
[k]); } ;

4436 
	`STBI__CASE
(
STBI__F_avg
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + ((
´iÜ
[k] + cur[k- 
ouut_by‹s
])>>1)); } ;

4437 
	`STBI__CASE
(
STBI__F_·‘h
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
	`¡bi__·‘h
(cur[k- 
ouut_by‹s
],
´iÜ
[k],prior[k- output_bytes])); } ;

4438 
	`STBI__CASE
(
STBI__F_avg_fœ¡
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + (cur[k- 
ouut_by‹s
] >> 1)); } ;

4439 
	`STBI__CASE
(
STBI__F_·‘h_fœ¡
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
	`¡bi__·‘h
(cur[k- 
ouut_by‹s
],0,0)); } ;

4441 #undeà
STBI__CASE


4445 ià(
d•th
 == 16) {

4446 
cur
 = 
a
->
out
 + 
¡ride
*
j
;

4447 
i
=0; i < 
x
; ++i,
cur
+=
ouut_by‹s
) {

4448 
cur
[
f‹r_by‹s
+1] = 255;

4457 ià(
d•th
 < 8) {

4458 
j
=0; j < 
y
; ++j) {

4459 
¡bi_uc
 *
cur
 = 
a
->
out
 + 
¡ride
*
j
;

4460 
¡bi_uc
 *
š
 = 
a
->
out
 + 
¡ride
*
j
 + 
x
*
out_n
 - 
img_width_by‹s
;

4463 
¡bi_uc
 
sÿË
 = (
cŞÜ
 =ğ0è? 
¡bi__d•th_sÿË_bË
[
d•th
] : 1;

4471 ià(
d•th
 == 4) {

4472 
k
=
x
*
img_n
; k >ğ2; k-=2, ++
š
) {

4473 *
cur
++ = 
sÿË
 * ((*
š
 >> 4) );

4474 *
cur
++ = 
sÿË
 * ((*
š
 ) & 0x0f);

4476 ià(
k
 > 0è*
cur
++ = 
sÿË
 * ((*
š
 >> 4) );

4477 } ià(
d•th
 == 2) {

4478 
k
=
x
*
img_n
; k >ğ4; k-=4, ++
š
) {

4479 *
cur
++ = 
sÿË
 * ((*
š
 >> 6) );

4480 *
cur
++ = 
sÿË
 * ((*
š
 >> 4) & 0x03);

4481 *
cur
++ = 
sÿË
 * ((*
š
 >> 2) & 0x03);

4482 *
cur
++ = 
sÿË
 * ((*
š
 ) & 0x03);

4484 ià(
k
 > 0è*
cur
++ = 
sÿË
 * ((*
š
 >> 6) );

4485 ià(
k
 > 1è*
cur
++ = 
sÿË
 * ((*
š
 >> 4) & 0x03);

4486 ià(
k
 > 2è*
cur
++ = 
sÿË
 * ((*
š
 >> 2) & 0x03);

4487 } ià(
d•th
 == 1) {

4488 
k
=
x
*
img_n
; k >ğ8; k-=8, ++
š
) {

4489 *
cur
++ = 
sÿË
 * ((*
š
 >> 7) );

4490 *
cur
++ = 
sÿË
 * ((*
š
 >> 6) & 0x01);

4491 *
cur
++ = 
sÿË
 * ((*
š
 >> 5) & 0x01);

4492 *
cur
++ = 
sÿË
 * ((*
š
 >> 4) & 0x01);

4493 *
cur
++ = 
sÿË
 * ((*
š
 >> 3) & 0x01);

4494 *
cur
++ = 
sÿË
 * ((*
š
 >> 2) & 0x01);

4495 *
cur
++ = 
sÿË
 * ((*
š
 >> 1) & 0x01);

4496 *
cur
++ = 
sÿË
 * ((*
š
 ) & 0x01);

4498 ià(
k
 > 0è*
cur
++ = 
sÿË
 * ((*
š
 >> 7) );

4499 ià(
k
 > 1è*
cur
++ = 
sÿË
 * ((*
š
 >> 6) & 0x01);

4500 ià(
k
 > 2è*
cur
++ = 
sÿË
 * ((*
š
 >> 5) & 0x01);

4501 ià(
k
 > 3è*
cur
++ = 
sÿË
 * ((*
š
 >> 4) & 0x01);

4502 ià(
k
 > 4è*
cur
++ = 
sÿË
 * ((*
š
 >> 3) & 0x01);

4503 ià(
k
 > 5è*
cur
++ = 
sÿË
 * ((*
š
 >> 2) & 0x01);

4504 ià(
k
 > 6è*
cur
++ = 
sÿË
 * ((*
š
 >> 1) & 0x01);

4506 ià(
img_n
 !ğ
out_n
) {

4507 
q
;

4509 
cur
 = 
a
->
out
 + 
¡ride
*
j
;

4510 ià(
img_n
 == 1) {

4511 
q
=
x
-1; q >= 0; --q) {

4512 
cur
[
q
*2+1] = 255;

4513 
cur
[
q
*2+0] = cur[q];

4516 
	`STBI_ASSERT
(
img_n
 == 3);

4517 
q
=
x
-1; q >= 0; --q) {

4518 
cur
[
q
*4+3] = 255;

4519 
cur
[
q
*4+2] = cur[q*3+2];

4520 
cur
[
q
*4+1] = cur[q*3+1];

4521 
cur
[
q
*4+0] = cur[q*3+0];

4526 } ià(
d•th
 == 16) {

4531 
¡bi_uc
 *
cur
 = 
a
->
out
;

4532 
¡bi__ušt16
 *
cur16
 = (¡bi__ušt16*)
cur
;

4534 
i
=0; i < 
x
*
y
*
out_n
; ++i,
cur16
++,
cur
+=2) {

4535 *
cur16
 = (
cur
[0] << 8) | cur[1];

4540 
	}
}

4542 
	$¡bi__ü—‹_²g_image
(
¡bi__²g
 *
a
, 
¡bi_uc
 *
image_d©a
, 
¡bi__ušt32
 
image_d©a_Ën
, 
out_n
, 
d•th
, 
cŞÜ
, 
š‹¾aûd
)

4544 
by‹s
 = (
d•th
 == 16 ? 2 : 1);

4545 
out_by‹s
 = 
out_n
 * 
by‹s
;

4546 
¡bi_uc
 *
fš®
;

4547 
p
;

4548 ià(!
š‹¾aûd
)

4549  
	`¡bi__ü—‹_²g_image_¿w
(
a
, 
image_d©a
, 
image_d©a_Ën
, 
out_n
,‡->
s
->
img_x
,‡->s->
img_y
, 
d•th
, 
cŞÜ
);

4552 
fš®
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
a
->
s
->
img_x
,‡->s->
img_y
, 
out_by‹s
, 0);

4553 
p
=0;… < 7; ++p) {

4554 
xÜig
[] = { 0,4,0,2,0,1,0 };

4555 
yÜig
[] = { 0,0,4,0,2,0,1 };

4556 
x¥c
[] = { 8,8,4,4,2,2,1 };

4557 
y¥c
[] = { 8,8,8,4,4,2,2 };

4558 
i
,
j
,
x
,
y
;

4560 
x
 = (
a
->
s
->
img_x
 - 
xÜig
[
p
] + 
x¥c
[p]-1) / xspc[p];

4561 
y
 = (
a
->
s
->
img_y
 - 
yÜig
[
p
] + 
y¥c
[p]-1) / yspc[p];

4562 ià(
x
 && 
y
) {

4563 
¡bi__ušt32
 
img_Ën
 = ((((
a
->
s
->
img_n
 * 
x
 * 
d•th
è+ 7è>> 3è+ 1è* 
y
;

4564 ià(!
	`¡bi__ü—‹_²g_image_¿w
(
a
, 
image_d©a
, 
image_d©a_Ën
, 
out_n
, 
x
, 
y
, 
d•th
, 
cŞÜ
)) {

4565 
	`STBI_FREE
(
fš®
);

4568 
j
=0; j < 
y
; ++j) {

4569 
i
=0; i < 
x
; ++i) {

4570 
out_y
 = 
j
*
y¥c
[
p
]+
yÜig
[p];

4571 
out_x
 = 
i
*
x¥c
[
p
]+
xÜig
[p];

4572 
	`memıy
(
fš®
 + 
out_y
*
a
->
s
->
img_x
*
out_by‹s
 + 
out_x
*out_bytes,

4573 
a
->
out
 + (
j
*
x
+
i
)*
out_by‹s
, out_bytes);

4576 
	`STBI_FREE
(
a
->
out
);

4577 
image_d©a
 +ğ
img_Ën
;

4578 
image_d©a_Ën
 -ğ
img_Ën
;

4581 
a
->
out
 = 
fš®
;

4584 
	}
}

4586 
	$¡bi__compu‹_Œª¥¬’cy
(
¡bi__²g
 *
z
, 
¡bi_uc
 
tc
[3], 
out_n
)

4588 
¡bi__cÚ‹xt
 *
s
 = 
z
->s;

4589 
¡bi__ušt32
 
i
, 
pix–_couÁ
 = 
s
->
img_x
 * s->
img_y
;

4590 
¡bi_uc
 *
p
 = 
z
->
out
;

4594 
	`STBI_ASSERT
(
out_n
 == 2 || out_n == 4);

4596 ià(
out_n
 == 2) {

4597 
i
=0; i < 
pix–_couÁ
; ++i) {

4598 
p
[1] = (p[0] =ğ
tc
[0] ? 0 : 255);

4599 
p
 += 2;

4602 
i
=0; i < 
pix–_couÁ
; ++i) {

4603 ià(
p
[0] =ğ
tc
[0] &&…[1] ==c[1] &&…[2] ==c[2])

4604 
p
[3] = 0;

4605 
p
 += 4;

4609 
	}
}

4611 
	$¡bi__compu‹_Œª¥¬’cy16
(
¡bi__²g
 *
z
, 
¡bi__ušt16
 
tc
[3], 
out_n
)

4613 
¡bi__cÚ‹xt
 *
s
 = 
z
->s;

4614 
¡bi__ušt32
 
i
, 
pix–_couÁ
 = 
s
->
img_x
 * s->
img_y
;

4615 
¡bi__ušt16
 *
p
 = (¡bi__ušt16*è
z
->
out
;

4619 
	`STBI_ASSERT
(
out_n
 == 2 || out_n == 4);

4621 ià(
out_n
 == 2) {

4622 
i
 = 0; i < 
pix–_couÁ
; ++i) {

4623 
p
[1] = (p[0] =ğ
tc
[0] ? 0 : 65535);

4624 
p
 += 2;

4627 
i
 = 0; i < 
pix–_couÁ
; ++i) {

4628 ià(
p
[0] =ğ
tc
[0] &&…[1] ==c[1] &&…[2] ==c[2])

4629 
p
[3] = 0;

4630 
p
 += 4;

4634 
	}
}

4636 
	$¡bi__ex·nd_²g_·Ë‰e
(
¡bi__²g
 *
a
, 
¡bi_uc
 *
·Ë‰e
, 
Ën
, 
·l_img_n
)

4638 
¡bi__ušt32
 
i
, 
pix–_couÁ
 = 
a
->
s
->
img_x
 *‡->s->
img_y
;

4639 
¡bi_uc
 *
p
, *
‹mp_out
, *
Üig
 = 
a
->
out
;

4641 
p
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad2
(
pix–_couÁ
, 
·l_img_n
, 0);

4642 ià(
p
 =ğ
NULL
è 
	`¡bi__”r
("outofmem", "Out of memory");

4645 
‹mp_out
 = 
p
;

4647 ià(
·l_img_n
 == 3) {

4648 
i
=0; i < 
pix–_couÁ
; ++i) {

4649 
n
 = 
Üig
[
i
]*4;

4650 
p
[0] = 
·Ë‰e
[
n
 ];

4651 
p
[1] = 
·Ë‰e
[
n
+1];

4652 
p
[2] = 
·Ë‰e
[
n
+2];

4653 
p
 += 3;

4656 
i
=0; i < 
pix–_couÁ
; ++i) {

4657 
n
 = 
Üig
[
i
]*4;

4658 
p
[0] = 
·Ë‰e
[
n
 ];

4659 
p
[1] = 
·Ë‰e
[
n
+1];

4660 
p
[2] = 
·Ë‰e
[
n
+2];

4661 
p
[3] = 
·Ë‰e
[
n
+3];

4662 
p
 += 4;

4665 
	`STBI_FREE
(
a
->
out
);

4666 
a
->
out
 = 
‹mp_out
;

4668 
	`STBI_NOTUSED
(
Ën
);

4671 
	}
}

4673 
	g¡bi__uÅ»muÉly_Ú_lßd
 = 0;

4674 
	g¡bi__de_hÚe_æag
 = 0;

4676 
STBIDEF
 
	$¡bi_£t_uÅ»muÉly_Ú_lßd
(
æag_Œue_if_should_uÅ»muÉly
)

4678 
¡bi__uÅ»muÉly_Ú_lßd
 = 
æag_Œue_if_should_uÅ»muÉly
;

4679 
	}
}

4681 
STBIDEF
 
	$¡bi_cÚv”t_hÚe_²g_to_rgb
(
æag_Œue_if_should_cÚv”t
)

4683 
¡bi__de_hÚe_æag
 = 
æag_Œue_if_should_cÚv”t
;

4684 
	}
}

4686 
	$¡bi__de_hÚe
(
¡bi__²g
 *
z
)

4688 
¡bi__cÚ‹xt
 *
s
 = 
z
->s;

4689 
¡bi__ušt32
 
i
, 
pix–_couÁ
 = 
s
->
img_x
 * s->
img_y
;

4690 
¡bi_uc
 *
p
 = 
z
->
out
;

4692 ià(
s
->
img_out_n
 == 3) {

4693 
i
=0; i < 
pix–_couÁ
; ++i) {

4694 
¡bi_uc
 
t
 = 
p
[0];

4695 
p
[0] =…[2];

4696 
p
[2] = 
t
;

4697 
p
 += 3;

4700 
	`STBI_ASSERT
(
s
->
img_out_n
 == 4);

4701 ià(
¡bi__uÅ»muÉly_Ú_lßd
) {

4703 
i
=0; i < 
pix–_couÁ
; ++i) {

4704 
¡bi_uc
 
a
 = 
p
[3];

4705 
¡bi_uc
 
t
 = 
p
[0];

4706 ià(
a
) {

4707 
¡bi_uc
 
h®f
 = 
a
 / 2;

4708 
p
[0] = (p[2] * 255 + 
h®f
è/ 
a
;

4709 
p
[1] = (p[1] * 255 + 
h®f
è/ 
a
;

4710 
p
[2] = ( 
t
 * 255 + 
h®f
è/ 
a
;

4712 
p
[0] =…[2];

4713 
p
[2] = 
t
;

4715 
p
 += 4;

4719 
i
=0; i < 
pix–_couÁ
; ++i) {

4720 
¡bi_uc
 
t
 = 
p
[0];

4721 
p
[0] =…[2];

4722 
p
[2] = 
t
;

4723 
p
 += 4;

4727 
	}
}

4729 
	#STBI__PNG_TYPE
(
a
,
b
,
c
,
d
è(((è×è<< 24è+ ((è(bè<< 16è+ ((è(cè<< 8è+ (è(d))

	)

4731 
	$¡bi__·r£_²g_fe
(
¡bi__²g
 *
z
, 
sÿn
, 
»q_comp
)

4733 
¡bi_uc
 
·Ë‰e
[1024], 
·l_img_n
=0;

4734 
¡bi_uc
 
has_Œªs
=0, 
tc
[3];

4735 
¡bi__ušt16
 
tc16
[3];

4736 
¡bi__ušt32
 
ioff
=0, 
id©a_lim™
=0, 
i
, 
·l_Ën
=0;

4737 
fœ¡
=1,
k
,
š‹¾aû
=0, 
cŞÜ
=0, 
is_hÚe
=0;

4738 
¡bi__cÚ‹xt
 *
s
 = 
z
->s;

4740 
z
->
ex·nded
 = 
NULL
;

4741 
z
->
id©a
 = 
NULL
;

4742 
z
->
out
 = 
NULL
;

4744 ià(!
	`¡bi__check_²g_h—d”
(
s
))  0;

4746 ià(
sÿn
 =ğ
STBI__SCAN_ty³
)  1;

4749 
¡bi__²gchunk
 
c
 = 
	`¡bi__g‘_chunk_h—d”
(
s
);

4750 
c
.
ty³
) {

4751 
	`STBI__PNG_TYPE
('C','g','B','I'):

4752 
is_hÚe
 = 1;

4753 
	`¡bi__sk
(
s
, 
c
.
Ëngth
);

4755 
	`STBI__PNG_TYPE
('I','H','D','R'): {

4756 
comp
,
f‹r
;

4757 ià(!
fœ¡
è 
	`¡bi__”r
("multiple IHDR","Corrupt PNG");

4758 
fœ¡
 = 0;

4759 ià(
c
.
Ëngth
 !ğ13è 
	`¡bi__”r
("bad IHDR†en","Corrupt PNG");

4760 
s
->
img_x
 = 
	`¡bi__g‘32be
(s); ià(s->img_x > (1 << 24)è 
	`¡bi__”r
("too†arge","Very†arge image (corrupt?)");

4761 
s
->
img_y
 = 
	`¡bi__g‘32be
(s); ià(s->img_y > (1 << 24)è 
	`¡bi__”r
("too†arge","Very†arge image (corrupt?)");

4762 
z
->
d•th
 = 
	`¡bi__g‘8
(
s
); ià(z->d•th !ğ1 && z->d•th !ğ2 && z->d•th !ğ4 && z->d•th !ğ8 && z->d•th !ğ16è 
	`¡bi__”r
("1/2/4/8/16-bit only","PNG‚ot supported: 1/2/4/8/16-bit only");

4763 
cŞÜ
 = 
	`¡bi__g‘8
(
s
); ià(cŞÜ > 6è 
	`¡bi__”r
("bad ctype","Corrupt PNG");

4764 ià(
cŞÜ
 =ğ3 && 
z
->
d•th
 =ğ16è 
	`¡bi__”r
("bad ctype","Corrupt PNG");

4765 ià(
cŞÜ
 =ğ3è
·l_img_n
 = 3; ià(cŞÜ & 1è 
	`¡bi__”r
("bad ctype","Corrupt PNG");

4766 
comp
 = 
	`¡bi__g‘8
(
s
); ià(compè 
	`¡bi__”r
("bad comp method","Corrupt PNG");

4767 
f‹r
ğ
	`¡bi__g‘8
(
s
); ià(f‹rè 
	`¡bi__”r
("bad filter method","Corrupt PNG");

4768 
š‹¾aû
 = 
	`¡bi__g‘8
(
s
); ià(š‹¾aû>1è 
	`¡bi__”r
("bad interlace method","Corrupt PNG");

4769 ià(!
s
->
img_x
 || !s->
img_y
è 
	`¡bi__”r
("0-pixel image","Corrupt PNG");

4770 ià(!
·l_img_n
) {

4771 
s
->
img_n
 = (
cŞÜ
 & 2 ? 3 : 1) + (color & 4 ? 1 : 0);

4772 ià((1 << 30è/ 
s
->
img_x
 / s->
img_n
 < s->
img_y
è 
	`¡bi__”r
("too†arge", "Imageoo†argeo decode");

4773 ià(
sÿn
 =ğ
STBI__SCAN_h—d”
)  1;

4777 
s
->
img_n
 = 1;

4778 ià((1 << 30è/ 
s
->
img_x
 / 4 < s->
img_y
è 
	`¡bi__”r
("too†arge","Corrupt PNG");

4784 
	`STBI__PNG_TYPE
('P','L','T','E'): {

4785 ià(
fœ¡
è 
	`¡bi__”r
("first‚ot IHDR", "Corrupt PNG");

4786 ià(
c
.
Ëngth
 > 256*3è 
	`¡bi__”r
("invalid PLTE","Corrupt PNG");

4787 
·l_Ën
 = 
c
.
Ëngth
 / 3;

4788 ià(
·l_Ën
 * 3 !ğ
c
.
Ëngth
è 
	`¡bi__”r
("invalid PLTE","Corrupt PNG");

4789 
i
=0; i < 
·l_Ën
; ++i) {

4790 
·Ë‰e
[
i
*4+0] = 
	`¡bi__g‘8
(
s
);

4791 
·Ë‰e
[
i
*4+1] = 
	`¡bi__g‘8
(
s
);

4792 
·Ë‰e
[
i
*4+2] = 
	`¡bi__g‘8
(
s
);

4793 
·Ë‰e
[
i
*4+3] = 255;

4798 
	`STBI__PNG_TYPE
('t','R','N','S'): {

4799 ià(
fœ¡
è 
	`¡bi__”r
("first‚ot IHDR", "Corrupt PNG");

4800 ià(
z
->
id©a
è 
	`¡bi__”r
("tRNS‡fter IDAT","Corrupt PNG");

4801 ià(
·l_img_n
) {

4802 ià(
sÿn
 =ğ
STBI__SCAN_h—d”
è{ 
s
->
img_n
 = 4;  1; }

4803 ià(
·l_Ën
 =ğ0è 
	`¡bi__”r
("tRNS before PLTE","Corrupt PNG");

4804 ià(
c
.
Ëngth
 > 
·l_Ën
è 
	`¡bi__”r
("badRNS†en","Corrupt PNG");

4805 
·l_img_n
 = 4;

4806 
i
=0; i < 
c
.
Ëngth
; ++i)

4807 
·Ë‰e
[
i
*4+3] = 
	`¡bi__g‘8
(
s
);

4809 ià(!(
s
->
img_n
 & 1)è 
	`¡bi__”r
("tRNS with‡lpha","Corrupt PNG");

4810 ià(
c
.
Ëngth
 !ğ(
¡bi__ušt32
è
s
->
img_n
*2è 
	`¡bi__”r
("badRNS†en","Corrupt PNG");

4811 
has_Œªs
 = 1;

4812 ià(
z
->
d•th
 == 16) {

4813 
k
 = 0; k < 
s
->
img_n
; ++kè
tc16
[k] = (
¡bi__ušt16
)
	`¡bi__g‘16be
(s);

4815 
k
 = 0; k < 
s
->
img_n
; ++kè
tc
[k] = (
¡bi_uc
)(
	`¡bi__g‘16be
(sè& 255è* 
¡bi__d•th_sÿË_bË
[
z
->
d•th
];

4821 
	`STBI__PNG_TYPE
('I','D','A','T'): {

4822 ià(
fœ¡
è 
	`¡bi__”r
("first‚ot IHDR", "Corrupt PNG");

4823 ià(
·l_img_n
 && !
·l_Ën
è 
	`¡bi__”r
("no PLTE","Corrupt PNG");

4824 ià(
sÿn
 =ğ
STBI__SCAN_h—d”
è{ 
s
->
img_n
 = 
·l_img_n
;  1; }

4825 ià(()(
ioff
 + 
c
.
Ëngth
) < ()ioff)  0;

4826 ià(
ioff
 + 
c
.
Ëngth
 > 
id©a_lim™
) {

4827 
¡bi__ušt32
 
id©a_lim™_Şd
 = 
id©a_lim™
;

4828 
¡bi_uc
 *
p
;

4829 ià(
id©a_lim™
 =ğ0èid©a_lim™ = 
c
.
Ëngth
 > 4096 ? c.length : 4096;

4830 
ioff
 + 
c
.
Ëngth
 > 
id©a_lim™
)

4831 
id©a_lim™
 *= 2;

4832 
	`STBI_NOTUSED
(
id©a_lim™_Şd
);

4833 
p
 = (
¡bi_uc
 *è
	`STBI_REALLOC_SIZED
(
z
->
id©a
, 
id©a_lim™_Şd
, 
id©a_lim™
); iàÕ =ğ
NULL
è 
	`¡bi__”r
("outofmem", "Out of memory");

4834 
z
->
id©a
 = 
p
;

4836 ià(!
	`¡bi__g‘n
(
s
, 
z
->
id©a
+
ioff
,
c
.
Ëngth
)è 
	`¡bi__”r
("outofdata","Corrupt PNG");

4837 
ioff
 +ğ
c
.
Ëngth
;

4841 
	`STBI__PNG_TYPE
('I','E','N','D'): {

4842 
¡bi__ušt32
 
¿w_Ën
, 
b¶
;

4843 ià(
fœ¡
è 
	`¡bi__”r
("first‚ot IHDR", "Corrupt PNG");

4844 ià(
sÿn
 !ğ
STBI__SCAN_lßd
)  1;

4845 ià(
z
->
id©a
 =ğ
NULL
è 
	`¡bi__”r
("no IDAT","Corrupt PNG");

4847 
b¶
 = (
s
->
img_x
 * 
z
->
d•th
 + 7) / 8;

4848 
¿w_Ën
 = 
b¶
 * 
s
->
img_y
 * s->
img_n
 + s->img_y ;

4849 
z
->
ex·nded
 = (
¡bi_uc
 *è
	`¡bi_zlib_decode_m®loc_guesssize_h—d”æag
((*èz->
id©a
, 
ioff
, 
¿w_Ën
, (*è&¿w_Ën, !
is_hÚe
);

4850 ià(
z
->
ex·nded
 =ğ
NULL
)  0;

4851 
	`STBI_FREE
(
z
->
id©a
); z->id©¨ğ
NULL
;

4852 ià((
»q_comp
 =ğ
s
->
img_n
+1 &&„eq_com°!ğ3 && !
·l_img_n
è|| 
has_Œªs
)

4853 
s
->
img_out_n
 = s->
img_n
+1;

4855 
s
->
img_out_n
 = s->
img_n
;

4856 ià(!
	`¡bi__ü—‹_²g_image
(
z
, z->
ex·nded
, 
¿w_Ën
, 
s
->
img_out_n
, z->
d•th
, 
cŞÜ
, 
š‹¾aû
))  0;

4857 ià(
has_Œªs
) {

4858 ià(
z
->
d•th
 == 16) {

4859 ià(!
	`¡bi__compu‹_Œª¥¬’cy16
(
z
, 
tc16
, 
s
->
img_out_n
))  0;

4861 ià(!
	`¡bi__compu‹_Œª¥¬’cy
(
z
, 
tc
, 
s
->
img_out_n
))  0;

4864 ià(
is_hÚe
 && 
¡bi__de_hÚe_æag
 && 
s
->
img_out_n
 > 2)

4865 
	`¡bi__de_hÚe
(
z
);

4866 ià(
·l_img_n
) {

4868 
s
->
img_n
 = 
·l_img_n
;

4869 
s
->
img_out_n
 = 
·l_img_n
;

4870 ià(
»q_comp
 >ğ3è
s
->
img_out_n
 =„eq_comp;

4871 ià(!
	`¡bi__ex·nd_²g_·Ë‰e
(
z
, 
·Ë‰e
, 
·l_Ën
, 
s
->
img_out_n
))

4873 } ià(
has_Œªs
) {

4875 ++
s
->
img_n
;

4877 
	`STBI_FREE
(
z
->
ex·nded
); z->ex·nded = 
NULL
;

4883 ià(
fœ¡
è 
	`¡bi__”r
("first‚ot IHDR", "Corrupt PNG");

4884 ià((
c
.
ty³
 & (1 << 29)) == 0) {

4885 #iâdeà
STBI_NO_FAILURE_STRINGS


4887 
šv®id_chunk
[] = "XXXX PNG chunk‚ot known";

4888 
šv®id_chunk
[0] = 
	`STBI__BYTECAST
(
c
.
ty³
 >> 24);

4889 
šv®id_chunk
[1] = 
	`STBI__BYTECAST
(
c
.
ty³
 >> 16);

4890 
šv®id_chunk
[2] = 
	`STBI__BYTECAST
(
c
.
ty³
 >> 8);

4891 
šv®id_chunk
[3] = 
	`STBI__BYTECAST
(
c
.
ty³
 >> 0);

4893  
	`¡bi__”r
(
šv®id_chunk
, "PNG‚ot supported: unknown PNG chunkype");

4895 
	`¡bi__sk
(
s
, 
c
.
Ëngth
);

4899 
	`¡bi__g‘32be
(
s
);

4901 
	}
}

4903 *
	$¡bi__do_²g
(
¡bi__²g
 *
p
, *
x
, *
y
, *
n
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

4905 *
»suÉ
=
NULL
;

4906 ià(
»q_comp
 < 0 ||„eq_com°> 4è 
	`¡bi__”½uc
("bad„eq_comp", "Internalƒrror");

4907 ià(
	`¡bi__·r£_²g_fe
(
p
, 
STBI__SCAN_lßd
, 
»q_comp
)) {

4908 ià(
p
->
d•th
 < 8)

4909 
ri
->
b™s_³r_chªÃl
 = 8;

4911 
ri
->
b™s_³r_chªÃl
 = 
p
->
d•th
;

4912 
»suÉ
 = 
p
->
out
;

4913 
p
->
out
 = 
NULL
;

4914 ià(
»q_comp
 &&„eq_com°!ğ
p
->
s
->
img_out_n
) {

4915 ià(
ri
->
b™s_³r_chªÃl
 == 8)

4916 
»suÉ
 = 
	`¡bi__cÚv”t_fÜm©
((*è»suÉ, 
p
->
s
->
img_out_n
, 
»q_comp
,…->s->
img_x
,…->s->
img_y
);

4918 
»suÉ
 = 
	`¡bi__cÚv”t_fÜm©16
((
¡bi__ušt16
 *è»suÉ, 
p
->
s
->
img_out_n
, 
»q_comp
,…->s->
img_x
,…->s->
img_y
);

4919 
p
->
s
->
img_out_n
 = 
»q_comp
;

4920 ià(
»suÉ
 =ğ
NULL
) „esult;

4922 *
x
 = 
p
->
s
->
img_x
;

4923 *
y
 = 
p
->
s
->
img_y
;

4924 ià(
n
è*Àğ
p
->
s
->
img_n
;

4926 
	`STBI_FREE
(
p
->
out
);…->ouˆğ
NULL
;

4927 
	`STBI_FREE
(
p
->
ex·nded
);…->ex·nded = 
NULL
;

4928 
	`STBI_FREE
(
p
->
id©a
);…->id©¨ğ
NULL
;

4930  
»suÉ
;

4931 
	}
}

4933 *
	$¡bi__²g_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

4935 
¡bi__²g
 
p
;

4936 
p
.
s
 = s;

4937  
	`¡bi__do_²g
(&
p
, 
x
,
y
,
comp
,
»q_comp
, 
ri
);

4938 
	}
}

4940 
	$¡bi__²g_‹¡
(
¡bi__cÚ‹xt
 *
s
)

4942 
r
;

4943 
r
 = 
	`¡bi__check_²g_h—d”
(
s
);

4944 
	`¡bi__»wšd
(
s
);

4945  
r
;

4946 
	}
}

4948 
	$¡bi__²g_šfo_¿w
(
¡bi__²g
 *
p
, *
x
, *
y
, *
comp
)

4950 ià(!
	`¡bi__·r£_²g_fe
(
p
, 
STBI__SCAN_h—d”
, 0)) {

4951 
	`¡bi__»wšd
Ğ
p
->
s
 );

4954 ià(
x
è*x = 
p
->
s
->
img_x
;

4955 ià(
y
è*y = 
p
->
s
->
img_y
;

4956 ià(
comp
è*com°ğ
p
->
s
->
img_n
;

4958 
	}
}

4960 
	$¡bi__²g_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

4962 
¡bi__²g
 
p
;

4963 
p
.
s
 = s;

4964  
	`¡bi__²g_šfo_¿w
(&
p
, 
x
, 
y
, 
comp
);

4965 
	}
}

4967 
	$¡bi__²g_is16
(
¡bi__cÚ‹xt
 *
s
)

4969 
¡bi__²g
 
p
;

4970 
p
.
s
 = s;

4971 ià(!
	`¡bi__²g_šfo_¿w
(&
p
, 
NULL
, NULL, NULL))

4973 ià(
p
.
d•th
 != 16) {

4974 
	`¡bi__»wšd
(
p
.
s
);

4978 
	}
}

4983 #iâdeà
STBI_NO_BMP


4984 
	$¡bi__bmp_‹¡_¿w
(
¡bi__cÚ‹xt
 *
s
)

4986 
r
;

4987 
sz
;

4988 ià(
	`¡bi__g‘8
(
s
) != 'B')  0;

4989 ià(
	`¡bi__g‘8
(
s
) != 'M')  0;

4990 
	`¡bi__g‘32Ë
(
s
);

4991 
	`¡bi__g‘16Ë
(
s
);

4992 
	`¡bi__g‘16Ë
(
s
);

4993 
	`¡bi__g‘32Ë
(
s
);

4994 
sz
 = 
	`¡bi__g‘32Ë
(
s
);

4995 
r
 = (
sz
 == 12 || sz == 40 || sz == 56 || sz == 108 || sz == 124);

4996  
r
;

4997 
	}
}

4999 
	$¡bi__bmp_‹¡
(
¡bi__cÚ‹xt
 *
s
)

5001 
r
 = 
	`¡bi__bmp_‹¡_¿w
(
s
);

5002 
	`¡bi__»wšd
(
s
);

5003  
r
;

5004 
	}
}

5008 
	$¡bi__high_b™
(
z
)

5010 
n
=0;

5011 ià(
z
 == 0)  -1;

5012 ià(
z
 >ğ0x10000è
n
 += 16, z >>= 16;

5013 ià(
z
 >ğ0x00100è
n
 += 8, z >>= 8;

5014 ià(
z
 >ğ0x00010è
n
 += 4, z >>= 4;

5015 ià(
z
 >ğ0x00004è
n
 += 2, z >>= 2;

5016 ià(
z
 >ğ0x00002è
n
 += 1, z >>= 1;

5017  
n
;

5018 
	}
}

5020 
	$¡bi__b™couÁ
(
a
)

5022 
a
 = (a & 0x55555555) + ((a >> 1) & 0x55555555);

5023 
a
 = (a & 0x33333333) + ((a >> 2) & 0x33333333);

5024 
a
 = (a + (a >> 4)) & 0x0f0f0f0f;

5025 
a
 = (a + (a >> 8));

5026 
a
 = (a + (a >> 16));

5027  
a
 & 0xff;

5028 
	}
}

5033 
	$¡bi__shiásigÃd
(
v
, 
shiá
, 
b™s
)

5035 
mul_bË
[9] = {

5040 
shiá_bË
[9] = {

5043 ià(
shiá
 < 0)

5044 
v
 <<ğ-
shiá
;

5046 
v
 >>ğ
shiá
;

5047 
	`STBI_ASSERT
(
v
 >= 0 && v < 256);

5048 
v
 >>ğ(8-
b™s
);

5049 
	`STBI_ASSERT
(
b™s
 >= 0 && bits <= 8);

5050  (è((è
v
 * 
mul_bË
[
b™s
]è>> 
shiá_bË
[bits];

5051 
	}
}

5055 
	mbµ
, 
	moff£t
, 
	mhsz
;

5056 
	mmr
,
	mmg
,
	mmb
,
	mma
, 
	m®l_a
;

5057 } 
	t¡bi__bmp_d©a
;

5059 *
	$¡bi__bmp_·r£_h—d”
(
¡bi__cÚ‹xt
 *
s
, 
¡bi__bmp_d©a
 *
šfo
)

5061 
hsz
;

5062 ià(
	`¡bi__g‘8
(
s
è!ğ'B' || stbi__g‘8(sè!ğ'M'è 
	`¡bi__”½uc
("not BMP", "Corrupt BMP");

5063 
	`¡bi__g‘32Ë
(
s
);

5064 
	`¡bi__g‘16Ë
(
s
);

5065 
	`¡bi__g‘16Ë
(
s
);

5066 
šfo
->
off£t
 = 
	`¡bi__g‘32Ë
(
s
);

5067 
šfo
->
hsz
 = hsz = 
	`¡bi__g‘32Ë
(
s
);

5068 
šfo
->
mr
 = info->
mg
 = info->
mb
 = info->
ma
 = 0;

5070 ià(
hsz
 !ğ12 && hsz !ğ40 && hsz !ğ56 && hsz !ğ108 && hsz !ğ124è 
	`¡bi__”½uc
("unknown BMP", "BMPype‚ot supported: unknown");

5071 ià(
hsz
 == 12) {

5072 
s
->
img_x
 = 
	`¡bi__g‘16Ë
(s);

5073 
s
->
img_y
 = 
	`¡bi__g‘16Ë
(s);

5075 
s
->
img_x
 = 
	`¡bi__g‘32Ë
(s);

5076 
s
->
img_y
 = 
	`¡bi__g‘32Ë
(s);

5078 ià(
	`¡bi__g‘16Ë
(
s
è!ğ1è 
	`¡bi__”½uc
("bad BMP", "bad BMP");

5079 
šfo
->
bµ
 = 
	`¡bi__g‘16Ë
(
s
);

5080 ià(
hsz
 != 12) {

5081 
com´ess
 = 
	`¡bi__g‘32Ë
(
s
);

5082 ià(
com´ess
 =ğ1 || com´es =ğ2è 
	`¡bi__”½uc
("BMP RLE", "BMPype‚ot supported: RLE");

5083 
	`¡bi__g‘32Ë
(
s
);

5084 
	`¡bi__g‘32Ë
(
s
);

5085 
	`¡bi__g‘32Ë
(
s
);

5086 
	`¡bi__g‘32Ë
(
s
);

5087 
	`¡bi__g‘32Ë
(
s
);

5088 ià(
hsz
 == 40 || hsz == 56) {

5089 ià(
hsz
 == 56) {

5090 
	`¡bi__g‘32Ë
(
s
);

5091 
	`¡bi__g‘32Ë
(
s
);

5092 
	`¡bi__g‘32Ë
(
s
);

5093 
	`¡bi__g‘32Ë
(
s
);

5095 ià(
šfo
->
bµ
 == 16 || info->bpp == 32) {

5096 ià(
com´ess
 == 0) {

5097 ià(
šfo
->
bµ
 == 32) {

5098 
šfo
->
mr
 = 0xffu << 16;

5099 
šfo
->
mg
 = 0xffu << 8;

5100 
šfo
->
mb
 = 0xffu << 0;

5101 
šfo
->
ma
 = 0xffu << 24;

5102 
šfo
->
®l_a
 = 0;

5104 
šfo
->
mr
 = 31u << 10;

5105 
šfo
->
mg
 = 31u << 5;

5106 
šfo
->
mb
 = 31u << 0;

5108 } ià(
com´ess
 == 3) {

5109 
šfo
->
mr
 = 
	`¡bi__g‘32Ë
(
s
);

5110 
šfo
->
mg
 = 
	`¡bi__g‘32Ë
(
s
);

5111 
šfo
->
mb
 = 
	`¡bi__g‘32Ë
(
s
);

5113 ià(
šfo
->
mr
 =ğšfo->
mg
 && info->mg =ğšfo->
mb
) {

5115  
	`¡bi__”½uc
("bad BMP", "bad BMP");

5118  
	`¡bi__”½uc
("bad BMP", "bad BMP");

5121 
i
;

5122 ià(
hsz
 != 108 && hsz != 124)

5123  
	`¡bi__”½uc
("bad BMP", "bad BMP");

5124 
šfo
->
mr
 = 
	`¡bi__g‘32Ë
(
s
);

5125 
šfo
->
mg
 = 
	`¡bi__g‘32Ë
(
s
);

5126 
šfo
->
mb
 = 
	`¡bi__g‘32Ë
(
s
);

5127 
šfo
->
ma
 = 
	`¡bi__g‘32Ë
(
s
);

5128 
	`¡bi__g‘32Ë
(
s
);

5129 
i
=0; i < 12; ++i)

5130 
	`¡bi__g‘32Ë
(
s
);

5131 ià(
hsz
 == 124) {

5132 
	`¡bi__g‘32Ë
(
s
);

5133 
	`¡bi__g‘32Ë
(
s
);

5134 
	`¡bi__g‘32Ë
(
s
);

5135 
	`¡bi__g‘32Ë
(
s
);

5140 
	}
}

5143 *
	$¡bi__bmp_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

5145 
¡bi_uc
 *
out
;

5146 
mr
=0,
mg
=0,
mb
=0,
ma
=0, 
®l_a
;

5147 
¡bi_uc
 
·l
[256][4];

5148 
psize
=0,
i
,
j
,
width
;

5149 
æ_v”tiÿÎy
, 
·d
, 
rg‘
;

5150 
¡bi__bmp_d©a
 
šfo
;

5151 
	`STBI_NOTUSED
(
ri
);

5153 
šfo
.
®l_a
 = 255;

5154 ià(
	`¡bi__bmp_·r£_h—d”
(
s
, &
šfo
è=ğ
NULL
)

5155  
NULL
;

5157 
æ_v”tiÿÎy
 = ((è
s
->
img_y
) > 0;

5158 
s
->
img_y
 = 
	`abs
(() s->img_y);

5160 
mr
 = 
šfo
.mr;

5161 
mg
 = 
šfo
.mg;

5162 
mb
 = 
šfo
.mb;

5163 
ma
 = 
šfo
.ma;

5164 
®l_a
 = 
šfo
.all_a;

5166 ià(
šfo
.
hsz
 == 12) {

5167 ià(
šfo
.
bµ
 < 24)

5168 
psize
 = (
šfo
.
off£t
 - 14 - 24) / 3;

5170 ià(
šfo
.
bµ
 < 16)

5171 
psize
 = (
šfo
.
off£t
 - 14 - info.
hsz
) >> 2;

5174 
s
->
img_n
 = 
ma
 ? 4 : 3;

5175 ià(
»q_comp
 &&„eq_comp >= 3)

5176 
rg‘
 = 
»q_comp
;

5178 
rg‘
 = 
s
->
img_n
;

5181 ià(!
	`¡bi__mad3sizes_v®id
(
rg‘
, 
s
->
img_x
, s->
img_y
, 0))

5182  
	`¡bi__”½uc
("too†arge", "Corrupt BMP");

5184 
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
rg‘
, 
s
->
img_x
, s->
img_y
, 0);

5185 ià(!
out
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

5186 ià(
šfo
.
bµ
 < 16) {

5187 
z
=0;

5188 ià(
psize
 =ğ0 ||…siz> 256è{ 
	`STBI_FREE
(
out
);  
	`¡bi__”½uc
("invalid", "Corrupt BMP"); }

5189 
i
=0; i < 
psize
; ++i) {

5190 
·l
[
i
][2] = 
	`¡bi__g‘8
(
s
);

5191 
·l
[
i
][1] = 
	`¡bi__g‘8
(
s
);

5192 
·l
[
i
][0] = 
	`¡bi__g‘8
(
s
);

5193 ià(
šfo
.
hsz
 !ğ12è
	`¡bi__g‘8
(
s
);

5194 
·l
[
i
][3] = 255;

5196 
	`¡bi__sk
(
s
, 
šfo
.
off£t
 - 14 - info.
hsz
 - 
psize
 * (info.hsz == 12 ? 3 : 4));

5197 ià(
šfo
.
bµ
 =ğ1è
width
 = (
s
->
img_x
 + 7) >> 3;

5198 ià(
šfo
.
bµ
 =ğ4è
width
 = (
s
->
img_x
 + 1) >> 1;

5199 ià(
šfo
.
bµ
 =ğ8è
width
 = 
s
->
img_x
;

5200 { 
	`STBI_FREE
(
out
);  
	`¡bi__”½uc
("bad bpp", "Corrupt BMP"); }

5201 
·d
 = (-
width
)&3;

5202 ià(
šfo
.
bµ
 == 1) {

5203 
j
=0; j < (è
s
->
img_y
; ++j) {

5204 
b™_off£t
 = 7, 
v
 = 
	`¡bi__g‘8
(
s
);

5205 
i
=0; i < (è
s
->
img_x
; ++i) {

5206 
cŞÜ
 = (
v
>>
b™_off£t
)&0x1;

5207 
out
[
z
++] = 
·l
[
cŞÜ
][0];

5208 
out
[
z
++] = 
·l
[
cŞÜ
][1];

5209 
out
[
z
++] = 
·l
[
cŞÜ
][2];

5210 if((--
b™_off£t
) < 0) {

5211 
b™_off£t
 = 7;

5212 
v
 = 
	`¡bi__g‘8
(
s
);

5215 
	`¡bi__sk
(
s
, 
·d
);

5218 
j
=0; j < (è
s
->
img_y
; ++j) {

5219 
i
=0; i < (è
s
->
img_x
; i += 2) {

5220 
v
=
	`¡bi__g‘8
(
s
),
v2
=0;

5221 ià(
šfo
.
bµ
 == 4) {

5222 
v2
 = 
v
 & 15;

5223 
v
 >>= 4;

5225 
out
[
z
++] = 
·l
[
v
][0];

5226 
out
[
z
++] = 
·l
[
v
][1];

5227 
out
[
z
++] = 
·l
[
v
][2];

5228 ià(
rg‘
 =ğ4è
out
[
z
++] = 255;

5229 ià(
i
+1 =ğ(è
s
->
img_x
) ;

5230 
v
 = (
šfo
.
bµ
 =ğ8è? 
	`¡bi__g‘8
(
s
è: 
v2
;

5231 
out
[
z
++] = 
·l
[
v
][0];

5232 
out
[
z
++] = 
·l
[
v
][1];

5233 
out
[
z
++] = 
·l
[
v
][2];

5234 ià(
rg‘
 =ğ4è
out
[
z
++] = 255;

5236 
	`¡bi__sk
(
s
, 
·d
);

5240 
rshiá
=0,
gshiá
=0,
bshiá
=0,
ashiá
=0,
rcouÁ
=0,
gcouÁ
=0,
bcouÁ
=0,
acouÁ
=0;

5241 
z
 = 0;

5242 
—sy
=0;

5243 
	`¡bi__sk
(
s
, 
šfo
.
off£t
 - 14 - info.
hsz
);

5244 ià(
šfo
.
bµ
 =ğ24è
width
 = 3 * 
s
->
img_x
;

5245 ià(
šfo
.
bµ
 =ğ16è
width
 = 2*
s
->
img_x
;

5246 
width
=0;

5247 
·d
 = (-
width
) & 3;

5248 ià(
šfo
.
bµ
 == 24) {

5249 
—sy
 = 1;

5250 } ià(
šfo
.
bµ
 == 32) {

5251 ià(
mb
 =ğ0xfà&& 
mg
 =ğ0xff00 && 
mr
 =ğ0x00ff0000 && 
ma
 == 0xff000000)

5252 
—sy
 = 2;

5254 ià(!
—sy
) {

5255 ià(!
mr
 || !
mg
 || !
mb
è{ 
	`STBI_FREE
(
out
);  
	`¡bi__”½uc
("bad masks", "Corrupt BMP"); }

5257 
rshiá
 = 
	`¡bi__high_b™
(
mr
)-7; 
rcouÁ
 = 
	`¡bi__b™couÁ
(mr);

5258 
gshiá
 = 
	`¡bi__high_b™
(
mg
)-7; 
gcouÁ
 = 
	`¡bi__b™couÁ
(mg);

5259 
bshiá
 = 
	`¡bi__high_b™
(
mb
)-7; 
bcouÁ
 = 
	`¡bi__b™couÁ
(mb);

5260 
ashiá
 = 
	`¡bi__high_b™
(
ma
)-7; 
acouÁ
 = 
	`¡bi__b™couÁ
(ma);

5262 
j
=0; j < (è
s
->
img_y
; ++j) {

5263 ià(
—sy
) {

5264 
i
=0; i < (è
s
->
img_x
; ++i) {

5265 
a
;

5266 
out
[
z
+2] = 
	`¡bi__g‘8
(
s
);

5267 
out
[
z
+1] = 
	`¡bi__g‘8
(
s
);

5268 
out
[
z
+0] = 
	`¡bi__g‘8
(
s
);

5269 
z
 += 3;

5270 
a
 = (
—sy
 =ğ2 ? 
	`¡bi__g‘8
(
s
) : 255);

5271 
®l_a
 |ğ
a
;

5272 ià(
rg‘
 =ğ4è
out
[
z
++] = 
a
;

5275 
bµ
 = 
šfo
.bpp;

5276 
i
=0; i < (è
s
->
img_x
; ++i) {

5277 
¡bi__ušt32
 
v
 = (
bµ
 =ğ16 ? (¡bi__ušt32è
	`¡bi__g‘16Ë
(
s
è: 
	`¡bi__g‘32Ë
(s));

5278 
a
;

5279 
out
[
z
++] = 
	`STBI__BYTECAST
(
	`¡bi__shiásigÃd
(
v
 & 
mr
, 
rshiá
, 
rcouÁ
));

5280 
out
[
z
++] = 
	`STBI__BYTECAST
(
	`¡bi__shiásigÃd
(
v
 & 
mg
, 
gshiá
, 
gcouÁ
));

5281 
out
[
z
++] = 
	`STBI__BYTECAST
(
	`¡bi__shiásigÃd
(
v
 & 
mb
, 
bshiá
, 
bcouÁ
));

5282 
a
 = (
ma
 ? 
	`¡bi__shiásigÃd
(
v
 & ma, 
ashiá
, 
acouÁ
) : 255);

5283 
®l_a
 |ğ
a
;

5284 ià(
rg‘
 =ğ4è
out
[
z
++] = 
	`STBI__BYTECAST
(
a
);

5287 
	`¡bi__sk
(
s
, 
·d
);

5292 ià(
rg‘
 =ğ4 && 
®l_a
 == 0)

5293 
i
=4*
s
->
img_x
*s->
img_y
-1; i >= 0; i -= 4)

5294 
out
[
i
] = 255;

5296 ià(
æ_v”tiÿÎy
) {

5297 
¡bi_uc
 
t
;

5298 
j
=0; j < (è
s
->
img_y
>>1; ++j) {

5299 
¡bi_uc
 *
p1
 = 
out
 + 
j
 *
s
->
img_x
*
rg‘
;

5300 
¡bi_uc
 *
p2
 = 
out
 + (
s
->
img_y
-1-
j
)*s->
img_x
*
rg‘
;

5301 
i
=0; i < (è
s
->
img_x
*
rg‘
; ++i) {

5302 
t
 = 
p1
[
i
],…1[i] = 
p2
[i],…2[i] =;

5307 ià(
»q_comp
 &&„eq_com°!ğ
rg‘
) {

5308 
out
 = 
	`¡bi__cÚv”t_fÜm©
(out, 
rg‘
, 
»q_comp
, 
s
->
img_x
, s->
img_y
);

5309 ià(
out
 =ğ
NULL
)  out;

5312 *
x
 = 
s
->
img_x
;

5313 *
y
 = 
s
->
img_y
;

5314 ià(
comp
è*com°ğ
s
->
img_n
;

5315  
out
;

5316 
	}
}

5321 #iâdeà
STBI_NO_TGA


5323 
	$¡bi__tga_g‘_comp
(
b™s_³r_pix–
, 
is_g»y
, * 
is_rgb16
)

5326 ià(
is_rgb16
) *is_rgb16 = 0;

5327 
b™s_³r_pix–
) {

5328 8:  
STBI_g»y
;

5329 16: if(
is_g»y
è 
STBI_g»y_®pha
;

5331 15: if(
is_rgb16
) *is_rgb16 = 1;

5332  
STBI_rgb
;

5334 32:  
b™s_³r_pix–
/8;

5337 
	}
}

5339 
	$¡bi__tga_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

5341 
tga_w
, 
tga_h
, 
tga_comp
, 
tga_image_ty³
, 
tga_b™s_³r_pix–
, 
tga_cŞÜm­_bµ
;

5342 
sz
, 
tga_cŞÜm­_ty³
;

5343 
	`¡bi__g‘8
(
s
);

5344 
tga_cŞÜm­_ty³
 = 
	`¡bi__g‘8
(
s
);

5345 ifĞ
tga_cŞÜm­_ty³
 > 1 ) {

5346 
	`¡bi__»wšd
(
s
);

5349 
tga_image_ty³
 = 
	`¡bi__g‘8
(
s
);

5350 iàĞ
tga_cŞÜm­_ty³
 == 1 ) {

5351 ià(
tga_image_ty³
 != 1 &&ga_image_type != 9) {

5352 
	`¡bi__»wšd
(
s
);

5355 
	`¡bi__sk
(
s
,4);

5356 
sz
 = 
	`¡bi__g‘8
(
s
);

5357 iàĞ(
sz
 != 8) && (sz != 15) && (sz != 16) && (sz != 24) && (sz != 32) ) {

5358 
	`¡bi__»wšd
(
s
);

5361 
	`¡bi__sk
(
s
,4);

5362 
tga_cŞÜm­_bµ
 = 
sz
;

5364 iàĞ(
tga_image_ty³
 != 2) && (tga_image_type != 3) && (tga_image_type != 10) && (tga_image_type != 11) ) {

5365 
	`¡bi__»wšd
(
s
);

5368 
	`¡bi__sk
(
s
,9);

5369 
tga_cŞÜm­_bµ
 = 0;

5371 
tga_w
 = 
	`¡bi__g‘16Ë
(
s
);

5372 ifĞ
tga_w
 < 1 ) {

5373 
	`¡bi__»wšd
(
s
);

5376 
tga_h
 = 
	`¡bi__g‘16Ë
(
s
);

5377 ifĞ
tga_h
 < 1 ) {

5378 
	`¡bi__»wšd
(
s
);

5381 
tga_b™s_³r_pix–
 = 
	`¡bi__g‘8
(
s
);

5382 
	`¡bi__g‘8
(
s
);

5383 ià(
tga_cŞÜm­_bµ
 != 0) {

5384 if((
tga_b™s_³r_pix–
 != 8) && (tga_bits_per_pixel != 16)) {

5387 
	`¡bi__»wšd
(
s
);

5390 
tga_comp
 = 
	`¡bi__tga_g‘_comp
(
tga_cŞÜm­_bµ
, 0, 
NULL
);

5392 
tga_comp
 = 
	`¡bi__tga_g‘_comp
(
tga_b™s_³r_pix–
, (
tga_image_ty³
 =ğ3è|| (tga_image_ty³ =ğ11), 
NULL
);

5394 if(!
tga_comp
) {

5395 
	`¡bi__»wšd
(
s
);

5398 ià(
x
è*x = 
tga_w
;

5399 ià(
y
è*y = 
tga_h
;

5400 ià(
comp
è*com°ğ
tga_comp
;

5402 
	}
}

5404 
	$¡bi__tga_‹¡
(
¡bi__cÚ‹xt
 *
s
)

5406 
»s
 = 0;

5407 
sz
, 
tga_cŞÜ_ty³
;

5408 
	`¡bi__g‘8
(
s
);

5409 
tga_cŞÜ_ty³
 = 
	`¡bi__g‘8
(
s
);

5410 iàĞ
tga_cŞÜ_ty³
 > 1 ) 
”rÜEnd
;

5411 
sz
 = 
	`¡bi__g‘8
(
s
);

5412 iàĞ
tga_cŞÜ_ty³
 == 1 ) {

5413 ià(
sz
 !ğ1 && sz !ğ9è
”rÜEnd
;

5414 
	`¡bi__sk
(
s
,4);

5415 
sz
 = 
	`¡bi__g‘8
(
s
);

5416 iàĞ(
sz
 !ğ8è&& (sz !ğ15è&& (sz !ğ16è&& (sz !ğ24è&& (sz !ğ32èè
”rÜEnd
;

5417 
	`¡bi__sk
(
s
,4);

5419 iàĞ(
sz
 !ğ2è&& (sz !ğ3è&& (sz !ğ10è&& (sz !ğ11èè
”rÜEnd
;

5420 
	`¡bi__sk
(
s
,9);

5422 iàĞ
	`¡bi__g‘16Ë
(
s
è< 1 ) 
”rÜEnd
;

5423 iàĞ
	`¡bi__g‘16Ë
(
s
è< 1 ) 
”rÜEnd
;

5424 
sz
 = 
	`¡bi__g‘8
(
s
);

5425 iàĞ(
tga_cŞÜ_ty³
 =ğ1è&& (
sz
 !ğ8è&& (sz !ğ16èè
”rÜEnd
;

5426 iàĞ(
sz
 !ğ8è&& (sz !ğ15è&& (sz !ğ16è&& (sz !ğ24è&& (sz !ğ32èè
”rÜEnd
;

5428 
»s
 = 1;

5430 
”rÜEnd
:

5431 
	`¡bi__»wšd
(
s
);

5432  
»s
;

5433 
	}
}

5436 
	$¡bi__tga_»ad_rgb16
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_uc
* 
out
)

5438 
¡bi__ušt16
 
px
 = (¡bi__ušt16)
	`¡bi__g‘16Ë
(
s
);

5439 
¡bi__ušt16
 
fiveB™Mask
 = 31;

5441 
r
 = (
px
 >> 10è& 
fiveB™Mask
;

5442 
g
 = (
px
 >> 5è& 
fiveB™Mask
;

5443 
b
 = 
px
 & 
fiveB™Mask
;

5445 
out
[0] = (
¡bi_uc
)((
r
 * 255)/31);

5446 
out
[1] = (
¡bi_uc
)((
g
 * 255)/31);

5447 
out
[2] = (
¡bi_uc
)((
b
 * 255)/31);

5453 
	}
}

5455 *
	$¡bi__tga_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

5458 
tga_off£t
 = 
	`¡bi__g‘8
(
s
);

5459 
tga_šdexed
 = 
	`¡bi__g‘8
(
s
);

5460 
tga_image_ty³
 = 
	`¡bi__g‘8
(
s
);

5461 
tga_is_RLE
 = 0;

5462 
tga_·Ë‰e_¡¬t
 = 
	`¡bi__g‘16Ë
(
s
);

5463 
tga_·Ë‰e_Ën
 = 
	`¡bi__g‘16Ë
(
s
);

5464 
tga_·Ë‰e_b™s
 = 
	`¡bi__g‘8
(
s
);

5465 
tga_x_Üigš
 = 
	`¡bi__g‘16Ë
(
s
);

5466 
tga_y_Üigš
 = 
	`¡bi__g‘16Ë
(
s
);

5467 
tga_width
 = 
	`¡bi__g‘16Ë
(
s
);

5468 
tga_height
 = 
	`¡bi__g‘16Ë
(
s
);

5469 
tga_b™s_³r_pix–
 = 
	`¡bi__g‘8
(
s
);

5470 
tga_comp
, 
tga_rgb16
=0;

5471 
tga_šv”‹d
 = 
	`¡bi__g‘8
(
s
);

5474 *
tga_d©a
;

5475 *
tga_·Ë‰e
 = 
NULL
;

5476 
i
, 
j
;

5477 
¿w_d©a
[4] = {0};

5478 
RLE_couÁ
 = 0;

5479 
RLE_»³©šg
 = 0;

5480 
»ad_Ãxt_pix–
 = 1;

5481 
	`STBI_NOTUSED
(
ri
);

5484 iàĞ
tga_image_ty³
 >= 8 )

5486 
tga_image_ty³
 -= 8;

5487 
tga_is_RLE
 = 1;

5489 
tga_šv”‹d
 = 1 - ((tga_inverted >> 5) & 1);

5492 iàĞ
tga_šdexed
 ) 
tga_comp
 = 
	`¡bi__tga_g‘_comp
(
tga_·Ë‰e_b™s
, 0, &
tga_rgb16
);

5493 
tga_comp
 = 
	`¡bi__tga_g‘_comp
(
tga_b™s_³r_pix–
, (
tga_image_ty³
 =ğ3), &
tga_rgb16
);

5495 if(!
tga_comp
)

5496  
	`¡bi__”½uc
("bad format", "Can't find out TGA…ixelformat");

5499 *
x
 = 
tga_width
;

5500 *
y
 = 
tga_height
;

5501 ià(
comp
è*com°ğ
tga_comp
;

5503 ià(!
	`¡bi__mad3sizes_v®id
(
tga_width
, 
tga_height
, 
tga_comp
, 0))

5504  
	`¡bi__”½uc
("too†arge", "Corrupt TGA");

5506 
tga_d©a
 = (*)
	`¡bi__m®loc_mad3
(
tga_width
, 
tga_height
, 
tga_comp
, 0);

5507 ià(!
tga_d©a
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

5510 
	`¡bi__sk
(
s
, 
tga_off£t
 );

5512 iàĞ!
tga_šdexed
 && !
tga_is_RLE
 && !
tga_rgb16
 ) {

5513 
i
=0; i < 
tga_height
; ++i) {

5514 
row
 = 
tga_šv”‹d
 ? 
tga_height
 -
i
 - 1 : i;

5515 
¡bi_uc
 *
tga_row
 = 
tga_d©a
 + 
row
*
tga_width
*
tga_comp
;

5516 
	`¡bi__g‘n
(
s
, 
tga_row
, 
tga_width
 * 
tga_comp
);

5520 iàĞ
tga_šdexed
)

5523 
	`¡bi__sk
(
s
, 
tga_·Ë‰e_¡¬t
 );

5525 
tga_·Ë‰e
 = (*)
	`¡bi__m®loc_mad2
(
tga_·Ë‰e_Ën
, 
tga_comp
, 0);

5526 ià(!
tga_·Ë‰e
) {

5527 
	`STBI_FREE
(
tga_d©a
);

5528  
	`¡bi__”½uc
("outofmem", "Out of memory");

5530 ià(
tga_rgb16
) {

5531 
¡bi_uc
 *
·l_’Œy
 = 
tga_·Ë‰e
;

5532 
	`STBI_ASSERT
(
tga_comp
 =ğ
STBI_rgb
);

5533 
i
=0; i < 
tga_·Ë‰e_Ën
; ++i) {

5534 
	`¡bi__tga_»ad_rgb16
(
s
, 
·l_’Œy
);

5535 
·l_’Œy
 +ğ
tga_comp
;

5537 } ià(!
	`¡bi__g‘n
(
s
, 
tga_·Ë‰e
, 
tga_·Ë‰e_Ën
 * 
tga_comp
)) {

5538 
	`STBI_FREE
(
tga_d©a
);

5539 
	`STBI_FREE
(
tga_·Ë‰e
);

5540  
	`¡bi__”½uc
("bad…alette", "Corrupt TGA");

5544 
i
=0; i < 
tga_width
 * 
tga_height
; ++i)

5547 iàĞ
tga_is_RLE
 )

5549 iàĞ
RLE_couÁ
 == 0 )

5552 
RLE_cmd
 = 
	`¡bi__g‘8
(
s
);

5553 
RLE_couÁ
 = 1 + (
RLE_cmd
 & 127);

5554 
RLE_»³©šg
 = 
RLE_cmd
 >> 7;

5555 
»ad_Ãxt_pix–
 = 1;

5556 } iàĞ!
RLE_»³©šg
 )

5558 
»ad_Ãxt_pix–
 = 1;

5562 
»ad_Ãxt_pix–
 = 1;

5565 iàĞ
»ad_Ãxt_pix–
 )

5568 iàĞ
tga_šdexed
 )

5571 
·l_idx
 = (
tga_b™s_³r_pix–
 =ğ8è? 
	`¡bi__g‘8
(
s
è: 
	`¡bi__g‘16Ë
(s);

5572 iàĞ
·l_idx
 >ğ
tga_·Ë‰e_Ën
 ) {

5574 
·l_idx
 = 0;

5576 
·l_idx
 *ğ
tga_comp
;

5577 
j
 = 0; j < 
tga_comp
; ++j) {

5578 
¿w_d©a
[
j
] = 
tga_·Ë‰e
[
·l_idx
+j];

5580 } if(
tga_rgb16
) {

5581 
	`STBI_ASSERT
(
tga_comp
 =ğ
STBI_rgb
);

5582 
	`¡bi__tga_»ad_rgb16
(
s
, 
¿w_d©a
);

5585 
j
 = 0; j < 
tga_comp
; ++j) {

5586 
¿w_d©a
[
j
] = 
	`¡bi__g‘8
(
s
);

5590 
»ad_Ãxt_pix–
 = 0;

5594 
j
 = 0; j < 
tga_comp
; ++j)

5595 
tga_d©a
[
i
*
tga_comp
+
j
] = 
¿w_d©a
[j];

5598 --
RLE_couÁ
;

5601 iàĞ
tga_šv”‹d
 )

5603 
j
 = 0; j*2 < 
tga_height
; ++j)

5605 
šdex1
 = 
j
 * 
tga_width
 * 
tga_comp
;

5606 
šdex2
 = (
tga_height
 - 1 - 
j
è* 
tga_width
 * 
tga_comp
;

5607 
i
 = 
tga_width
 * 
tga_comp
; i > 0; --i)

5609 
‹mp
 = 
tga_d©a
[
šdex1
];

5610 
tga_d©a
[
šdex1
] =ga_d©a[
šdex2
];

5611 
tga_d©a
[
šdex2
] = 
‹mp
;

5612 ++
šdex1
;

5613 ++
šdex2
;

5618 iàĞ
tga_·Ë‰e
 !ğ
NULL
 )

5620 
	`STBI_FREE
Ğ
tga_·Ë‰e
 );

5625 ià(
tga_comp
 >ğ3 && !
tga_rgb16
)

5627 * 
tga_pix–
 = 
tga_d©a
;

5628 
i
=0; i < 
tga_width
 * 
tga_height
; ++i)

5630 
‹mp
 = 
tga_pix–
[0];

5631 
tga_pix–
[0] =ga_pixel[2];

5632 
tga_pix–
[2] = 
‹mp
;

5633 
tga_pix–
 +ğ
tga_comp
;

5638 ià(
»q_comp
 &&„eq_com°!ğ
tga_comp
)

5639 
tga_d©a
 = 
	`¡bi__cÚv”t_fÜm©
Ñga_d©a, 
tga_comp
, 
»q_comp
, 
tga_width
, 
tga_height
);

5643 
tga_·Ë‰e_¡¬t
 = 
tga_·Ë‰e_Ën
 = 
tga_·Ë‰e_b™s
 =

5644 
tga_x_Üigš
 = 
tga_y_Üigš
 = 0;

5646  
tga_d©a
;

5647 
	}
}

5653 #iâdeà
STBI_NO_PSD


5654 
	$¡bi__psd_‹¡
(
¡bi__cÚ‹xt
 *
s
)

5656 
r
 = (
	`¡bi__g‘32be
(
s
) == 0x38425053);

5657 
	`¡bi__»wšd
(
s
);

5658  
r
;

5659 
	}
}

5661 
	$¡bi__psd_decode_¾e
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_uc
 *
p
, 
pix–CouÁ
)

5663 
couÁ
, 
Æeá
, 
Ën
;

5665 
couÁ
 = 0;

5666 (
Æeá
 = 
pix–CouÁ
 - 
couÁ
) > 0) {

5667 
Ën
 = 
	`¡bi__g‘8
(
s
);

5668 ià(
Ën
 == 128) {

5670 } ià(
Ën
 < 128) {

5672 
Ën
++;

5673 ià(
Ën
 > 
Æeá
)  0;

5674 
couÁ
 +ğ
Ën
;

5675 
Ën
) {

5676 *
p
 = 
	`¡bi__g‘8
(
s
);

5677 
p
 += 4;

5678 
Ën
--;

5680 } ià(
Ën
 > 128) {

5681 
¡bi_uc
 
v®
;

5684 
Ën
 = 257 -†en;

5685 ià(
Ën
 > 
Æeá
)  0;

5686 
v®
 = 
	`¡bi__g‘8
(
s
);

5687 
couÁ
 +ğ
Ën
;

5688 
Ën
) {

5689 *
p
 = 
v®
;

5690 
p
 += 4;

5691 
Ën
--;

5697 
	}
}

5699 *
	$¡bi__psd_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
, 
bpc
)

5701 
pix–CouÁ
;

5702 
chªÃlCouÁ
, 
com´essiÚ
;

5703 
chªÃl
, 
i
;

5704 
b™d•th
;

5705 
w
,
h
;

5706 
¡bi_uc
 *
out
;

5707 
	`STBI_NOTUSED
(
ri
);

5710 ià(
	`¡bi__g‘32be
(
s
) != 0x38425053)

5711  
	`¡bi__”½uc
("not PSD", "Corrupt PSD image");

5714 ià(
	`¡bi__g‘16be
(
s
) != 1)

5715  
	`¡bi__”½uc
("wrong version", "Unsupported version of PSD image");

5718 
	`¡bi__sk
(
s
, 6 );

5721 
chªÃlCouÁ
 = 
	`¡bi__g‘16be
(
s
);

5722 ià(
chªÃlCouÁ
 < 0 || channelCount > 16)

5723  
	`¡bi__”½uc
("wrong channel count", "Unsupported‚umber of channels in PSD image");

5726 
h
 = 
	`¡bi__g‘32be
(
s
);

5727 
w
 = 
	`¡bi__g‘32be
(
s
);

5730 
b™d•th
 = 
	`¡bi__g‘16be
(
s
);

5731 ià(
b™d•th
 != 8 && bitdepth != 16)

5732  
	`¡bi__”½uc
("unsupported bit depth", "PSD bit depth is‚ot 8 or 16 bit");

5744 ià(
	`¡bi__g‘16be
(
s
) != 3)

5745  
	`¡bi__”½uc
("wrong color format", "PSD is‚ot in RGB color format");

5748 
	`¡bi__sk
(
s
,
	`¡bi__g‘32be
(s) );

5751 
	`¡bi__sk
(
s
, 
	`¡bi__g‘32be
(s) );

5754 
	`¡bi__sk
(
s
, 
	`¡bi__g‘32be
(s) );

5760 
com´essiÚ
 = 
	`¡bi__g‘16be
(
s
);

5761 ià(
com´essiÚ
 > 1)

5762  
	`¡bi__”½uc
("bad compression", "PSD has‡n unknown compression format");

5765 ià(!
	`¡bi__mad3sizes_v®id
(4, 
w
, 
h
, 0))

5766  
	`¡bi__”½uc
("too†arge", "Corrupt PSD");

5770 ià(!
com´essiÚ
 && 
b™d•th
 =ğ16 && 
bpc
 == 16) {

5771 
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(8, 
w
, 
h
, 0);

5772 
ri
->
b™s_³r_chªÃl
 = 16;

5774 
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(4 * 
w
*
h
);

5776 ià(!
out
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

5777 
pix–CouÁ
 = 
w
*
h
;

5783 ià(
com´essiÚ
) {

5794 
	`¡bi__sk
(
s
, 
h
 * 
chªÃlCouÁ
 * 2 );

5797 
chªÃl
 = 0; channel < 4; channel++) {

5798 
¡bi_uc
 *
p
;

5800 
p
 = 
out
+
chªÃl
;

5801 ià(
chªÃl
 >ğ
chªÃlCouÁ
) {

5803 
i
 = 0; i < 
pix–CouÁ
; i++, 
p
 += 4)

5804 *
p
 = (
chªÃl
 == 3 ? 255 : 0);

5807 ià(!
	`¡bi__psd_decode_¾e
(
s
, 
p
, 
pix–CouÁ
)) {

5808 
	`STBI_FREE
(
out
);

5809  
	`¡bi__”½uc
("corrupt", "bad RLE data");

5819 
chªÃl
 = 0; channel < 4; channel++) {

5820 ià(
chªÃl
 >ğ
chªÃlCouÁ
) {

5822 ià(
b™d•th
 =ğ16 && 
bpc
 == 16) {

5823 
¡bi__ušt16
 *
q
 = ((¡bi__ušt16 *è
out
è+ 
chªÃl
;

5824 
¡bi__ušt16
 
v®
 = 
chªÃl
 == 3 ? 65535 : 0;

5825 
i
 = 0; i < 
pix–CouÁ
; i++, 
q
 += 4)

5826 *
q
 = 
v®
;

5828 
¡bi_uc
 *
p
 = 
out
+
chªÃl
;

5829 
¡bi_uc
 
v®
 = 
chªÃl
 == 3 ? 255 : 0;

5830 
i
 = 0; i < 
pix–CouÁ
; i++, 
p
 += 4)

5831 *
p
 = 
v®
;

5834 ià(
ri
->
b™s_³r_chªÃl
 == 16) {

5835 
¡bi__ušt16
 *
q
 = ((¡bi__ušt16 *è
out
è+ 
chªÃl
;

5836 
i
 = 0; i < 
pix–CouÁ
; i++, 
q
 += 4)

5837 *
q
 = (
¡bi__ušt16
è
	`¡bi__g‘16be
(
s
);

5839 
¡bi_uc
 *
p
 = 
out
+
chªÃl
;

5840 ià(
b™d•th
 == 16) {

5841 
i
 = 0; i < 
pix–CouÁ
; i++, 
p
 += 4)

5842 *
p
 = (
¡bi_uc
è(
	`¡bi__g‘16be
(
s
) >> 8);

5844 
i
 = 0; i < 
pix–CouÁ
; i++, 
p
 += 4)

5845 *
p
 = 
	`¡bi__g‘8
(
s
);

5853 ià(
chªÃlCouÁ
 >= 4) {

5854 ià(
ri
->
b™s_³r_chªÃl
 == 16) {

5855 
i
=0; i < 
w
*
h
; ++i) {

5856 
¡bi__ušt16
 *
pix–
 = (¡bi__ušt16 *è
out
 + 4*
i
;

5857 ià(
pix–
[3] != 0 &&…ixel[3] != 65535) {

5858 
a
 = 
pix–
[3] / 65535.0f;

5859 
¿
 = 1.0à/ 
a
;

5860 
šv_a
 = 65535.0à* (1 - 
¿
);

5861 
pix–
[0] = (
¡bi__ušt16
èÕix–[0]*
¿
 + 
šv_a
);

5862 
pix–
[1] = (
¡bi__ušt16
èÕix–[1]*
¿
 + 
šv_a
);

5863 
pix–
[2] = (
¡bi__ušt16
èÕix–[2]*
¿
 + 
šv_a
);

5867 
i
=0; i < 
w
*
h
; ++i) {

5868 *
pix–
 = 
out
 + 4*
i
;

5869 ià(
pix–
[3] != 0 &&…ixel[3] != 255) {

5870 
a
 = 
pix–
[3] / 255.0f;

5871 
¿
 = 1.0à/ 
a
;

5872 
šv_a
 = 255.0à* (1 - 
¿
);

5873 
pix–
[0] = (èÕix–[0]*
¿
 + 
šv_a
);

5874 
pix–
[1] = (èÕix–[1]*
¿
 + 
šv_a
);

5875 
pix–
[2] = (èÕix–[2]*
¿
 + 
šv_a
);

5882 ià(
»q_comp
 &&„eq_comp != 4) {

5883 ià(
ri
->
b™s_³r_chªÃl
 == 16)

5884 
out
 = (
¡bi_uc
 *è
	`¡bi__cÚv”t_fÜm©16
((
¡bi__ušt16
 *èout, 4, 
»q_comp
, 
w
, 
h
);

5886 
out
 = 
	`¡bi__cÚv”t_fÜm©
(out, 4, 
»q_comp
, 
w
, 
h
);

5887 ià(
out
 =ğ
NULL
)  out;

5890 ià(
comp
) *comp = 4;

5891 *
y
 = 
h
;

5892 *
x
 = 
w
;

5894  
out
;

5895 
	}
}

5905 #iâdeà
STBI_NO_PIC


5906 
	$¡bi__pic_is4
(
¡bi__cÚ‹xt
 *
s
,cÚ¡ *
¡r
)

5908 
i
;

5909 
i
=0; i<4; ++i)

5910 ià(
	`¡bi__g‘8
(
s
è!ğ(
¡bi_uc
)
¡r
[
i
])

5914 
	}
}

5916 
	$¡bi__pic_‹¡_cÜe
(
¡bi__cÚ‹xt
 *
s
)

5918 
i
;

5920 ià(!
	`¡bi__pic_is4
(
s
,"\x53\x80\xF6\x34"))

5923 
i
=0;i<84;++i)

5924 
	`¡bi__g‘8
(
s
);

5926 ià(!
	`¡bi__pic_is4
(
s
,"PICT"))

5930 
	}
}

5934 
¡bi_uc
 
	msize
,
	mty³
,
	mchªÃl
;

5935 } 
	t¡bi__pic_·ck‘
;

5937 
¡bi_uc
 *
	$¡bi__»adv®
(
¡bi__cÚ‹xt
 *
s
, 
chªÃl
, 
¡bi_uc
 *
de¡
)

5939 
mask
=0x80, 
i
;

5941 
i
=0; i<4; ++i, 
mask
>>=1) {

5942 ià(
chªÃl
 & 
mask
) {

5943 ià(
	`¡bi__©_eof
(
s
)è 
	`¡bi__”½uc
("bad file","PIC fileoo short");

5944 
de¡
[
i
]=
	`¡bi__g‘8
(
s
);

5948  
de¡
;

5949 
	}
}

5951 
	$¡bi__cİyv®
(
chªÃl
,
¡bi_uc
 *
de¡
,cÚ¡ stbi_uø*
¤c
)

5953 
mask
=0x80,
i
;

5955 
i
=0;i<4; ++i, 
mask
>>=1)

5956 ià(
chªÃl
&
mask
)

5957 
de¡
[
i
]=
¤c
[i];

5958 
	}
}

5960 
¡bi_uc
 *
	$¡bi__pic_lßd_cÜe
(
¡bi__cÚ‹xt
 *
s
,
width
,
height
,*
comp
, 
¡bi_uc
 *
»suÉ
)

5962 
aù_comp
=0,
num_·ck‘s
=0,
y
,
chašed
;

5963 
¡bi__pic_·ck‘
 
·ck‘s
[10];

5968 
¡bi__pic_·ck‘
 *
·ck‘
;

5970 ià(
num_·ck‘s
==(
·ck‘s
)/(packets[0]))

5971  
	`¡bi__”½uc
("bad format","too many…ackets");

5973 
·ck‘
 = &
·ck‘s
[
num_·ck‘s
++];

5975 
chašed
 = 
	`¡bi__g‘8
(
s
);

5976 
·ck‘
->
size
 = 
	`¡bi__g‘8
(
s
);

5977 
·ck‘
->
ty³
 = 
	`¡bi__g‘8
(
s
);

5978 
·ck‘
->
chªÃl
 = 
	`¡bi__g‘8
(
s
);

5980 
aù_comp
 |ğ
·ck‘
->
chªÃl
;

5982 ià(
	`¡bi__©_eof
(
s
)è 
	`¡bi__”½uc
("bad file","fileoo short (reading…ackets)");

5983 ià(
·ck‘
->
size
 !ğ8è 
	`¡bi__”½uc
("bad format","packet isn't 8bpp");

5984 } 
chašed
);

5986 *
comp
 = (
aù_comp
 & 0x10 ? 4 : 3);

5988 
y
=0; y<
height
; ++y) {

5989 
·ck‘_idx
;

5991 
·ck‘_idx
=0;…ack‘_idx < 
num_·ck‘s
; ++packet_idx) {

5992 
¡bi__pic_·ck‘
 *
·ck‘
 = &
·ck‘s
[
·ck‘_idx
];

5993 
¡bi_uc
 *
de¡
 = 
»suÉ
+
y
*
width
*4;

5995 
·ck‘
->
ty³
) {

5997  
	`¡bi__”½uc
("bad format","packet has bad compressionype");

6000 
x
;

6002 
x
=0;x<
width
;++x, 
de¡
+=4)

6003 ià(!
	`¡bi__»adv®
(
s
,
·ck‘
->
chªÃl
,
de¡
))

6010 
Ëá
=
width
, 
i
;

6012 
Ëá
>0) {

6013 
¡bi_uc
 
couÁ
,
v®ue
[4];

6015 
couÁ
=
	`¡bi__g‘8
(
s
);

6016 ià(
	`¡bi__©_eof
(
s
)è 
	`¡bi__”½uc
("bad file","fileoo short (pure„ead count)");

6018 ià(
couÁ
 > 
Ëá
)

6019 
couÁ
 = (
¡bi_uc
è
Ëá
;

6021 ià(!
	`¡bi__»adv®
(
s
,
·ck‘
->
chªÃl
,
v®ue
))  0;

6023 
i
=0; i<
couÁ
; ++i,
de¡
+=4)

6024 
	`¡bi__cİyv®
(
·ck‘
->
chªÃl
,
de¡
,
v®ue
);

6025 
Ëá
 -ğ
couÁ
;

6031 
Ëá
=
width
;

6032 
Ëá
>0) {

6033 
couÁ
 = 
	`¡bi__g‘8
(
s
), 
i
;

6034 ià(
	`¡bi__©_eof
(
s
)è 
	`¡bi__”½uc
("bad file","fileoo short (mixed„ead count)");

6036 ià(
couÁ
 >= 128) {

6037 
¡bi_uc
 
v®ue
[4];

6039 ià(
couÁ
==128)

6040 
couÁ
 = 
	`¡bi__g‘16be
(
s
);

6042 
couÁ
 -= 127;

6043 ià(
couÁ
 > 
Ëá
)

6044  
	`¡bi__”½uc
("bad file","scanline overrun");

6046 ià(!
	`¡bi__»adv®
(
s
,
·ck‘
->
chªÃl
,
v®ue
))

6049 
i
=0;i<
couÁ
;++i, 
de¡
 += 4)

6050 
	`¡bi__cİyv®
(
·ck‘
->
chªÃl
,
de¡
,
v®ue
);

6052 ++
couÁ
;

6053 ià(
couÁ
>
Ëá
è 
	`¡bi__”½uc
("bad file","scanline overrun");

6055 
i
=0;i<
couÁ
;++i, 
de¡
+=4)

6056 ià(!
	`¡bi__»adv®
(
s
,
·ck‘
->
chªÃl
,
de¡
))

6059 
Ëá
-=
couÁ
;

6067  
»suÉ
;

6068 
	}
}

6070 *
	$¡bi__pic_lßd
(
¡bi__cÚ‹xt
 *
s
,*
px
,*
py
,*
comp
,
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

6072 
¡bi_uc
 *
»suÉ
;

6073 
i
, 
x
,
y
, 
š‹º®_comp
;

6074 
	`STBI_NOTUSED
(
ri
);

6076 ià(!
comp
ècom°ğ&
š‹º®_comp
;

6078 
i
=0; i<92; ++i)

6079 
	`¡bi__g‘8
(
s
);

6081 
x
 = 
	`¡bi__g‘16be
(
s
);

6082 
y
 = 
	`¡bi__g‘16be
(
s
);

6083 ià(
	`¡bi__©_eof
(
s
)è 
	`¡bi__”½uc
("bad file","fileoo short (pic header)");

6084 ià(!
	`¡bi__mad3sizes_v®id
(
x
, 
y
, 4, 0)è 
	`¡bi__”½uc
("too†arge", "PIC imageoo†argeo decode");

6086 
	`¡bi__g‘32be
(
s
);

6087 
	`¡bi__g‘16be
(
s
);

6088 
	`¡bi__g‘16be
(
s
);

6091 
»suÉ
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
x
, 
y
, 4, 0);

6092 
	`mem£t
(
»suÉ
, 0xff, 
x
*
y
*4);

6094 ià(!
	`¡bi__pic_lßd_cÜe
(
s
,
x
,
y
,
comp
, 
»suÉ
)) {

6095 
	`STBI_FREE
(
»suÉ
);

6096 
»suÉ
=0;

6098 *
px
 = 
x
;

6099 *
py
 = 
y
;

6100 ià(
»q_comp
 =ğ0è»q_com°ğ*
comp
;

6101 
»suÉ
=
	`¡bi__cÚv”t_fÜm©
ÔesuÉ,4,
»q_comp
,
x
,
y
);

6103  
»suÉ
;

6104 
	}
}

6106 
	$¡bi__pic_‹¡
(
¡bi__cÚ‹xt
 *
s
)

6108 
r
 = 
	`¡bi__pic_‹¡_cÜe
(
s
);

6109 
	`¡bi__»wšd
(
s
);

6110  
r
;

6111 
	}
}

6117 #iâdeà
STBI_NO_GIF


6120 
¡bi__št16
 
	m´efix
;

6121 
¡bi_uc
 
	mfœ¡
;

6122 
¡bi_uc
 
	msuffix
;

6123 } 
	t¡bi__gif_lzw
;

6127 
	mw
,
	mh
;

6128 
¡bi_uc
 *
	mout
;

6129 
¡bi_uc
 *
	mbackground
;

6130 
¡bi_uc
 *
	mhi¡Üy
;

6131 
	mæags
, 
	mbgšdex
, 
	m¿tio
, 
	mŒª¥¬’t
, 
	meæags
;

6132 
¡bi_uc
 
	m·l
[256][4];

6133 
¡bi_uc
 
	mÍ®
[256][4];

6134 
¡bi__gif_lzw
 
	mcodes
[8192];

6135 
¡bi_uc
 *
	mcŞÜ_bË
;

6136 
	m·r£
, 
	m¡•
;

6137 
	mlæags
;

6138 
	m¡¬t_x
, 
	m¡¬t_y
;

6139 
	mmax_x
, 
	mmax_y
;

6140 
	mcur_x
, 
	mcur_y
;

6141 
	mlše_size
;

6142 
	md–ay
;

6143 } 
	t¡bi__gif
;

6145 
	$¡bi__gif_‹¡_¿w
(
¡bi__cÚ‹xt
 *
s
)

6147 
sz
;

6148 ià(
	`¡bi__g‘8
(
s
) != 'G' || stbi__get8(s) != 'I' || stbi__get8(s) != 'F' || stbi__get8(s) != '8')  0;

6149 
sz
 = 
	`¡bi__g‘8
(
s
);

6150 ià(
sz
 != '9' && sz != '7')  0;

6151 ià(
	`¡bi__g‘8
(
s
) != 'a')  0;

6153 
	}
}

6155 
	$¡bi__gif_‹¡
(
¡bi__cÚ‹xt
 *
s
)

6157 
r
 = 
	`¡bi__gif_‹¡_¿w
(
s
);

6158 
	`¡bi__»wšd
(
s
);

6159  
r
;

6160 
	}
}

6162 
	$¡bi__gif_·r£_cŞÜbË
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_uc
 
·l
[256][4], 
num_’Œ›s
, 
Œª¥
)

6164 
i
;

6165 
i
=0; i < 
num_’Œ›s
; ++i) {

6166 
·l
[
i
][2] = 
	`¡bi__g‘8
(
s
);

6167 
·l
[
i
][1] = 
	`¡bi__g‘8
(
s
);

6168 
·l
[
i
][0] = 
	`¡bi__g‘8
(
s
);

6169 
·l
[
i
][3] = 
Œª¥
 == i ? 0 : 255;

6171 
	}
}

6173 
	$¡bi__gif_h—d”
(
¡bi__cÚ‹xt
 *
s
, 
¡bi__gif
 *
g
, *
comp
, 
is_šfo
)

6175 
¡bi_uc
 
v”siÚ
;

6176 ià(
	`¡bi__g‘8
(
s
) != 'G' || stbi__get8(s) != 'I' || stbi__get8(s) != 'F' || stbi__get8(s) != '8')

6177  
	`¡bi__”r
("not GIF", "Corrupt GIF");

6179 
v”siÚ
 = 
	`¡bi__g‘8
(
s
);

6180 ià(
v”siÚ
 !ğ'7' && v”siÚ !ğ'9'è 
	`¡bi__”r
("not GIF", "Corrupt GIF");

6181 ià(
	`¡bi__g‘8
(
s
è!ğ'a'è 
	`¡bi__”r
("not GIF", "Corrupt GIF");

6183 
¡bi__g_çu»_»asÚ
 = "";

6184 
g
->
w
 = 
	`¡bi__g‘16Ë
(
s
);

6185 
g
->
h
 = 
	`¡bi__g‘16Ë
(
s
);

6186 
g
->
æags
 = 
	`¡bi__g‘8
(
s
);

6187 
g
->
bgšdex
 = 
	`¡bi__g‘8
(
s
);

6188 
g
->
¿tio
 = 
	`¡bi__g‘8
(
s
);

6189 
g
->
Œª¥¬’t
 = -1;

6191 ià(
comp
 != 0) *comp = 4;

6193 ià(
is_šfo
)  1;

6195 ià(
g
->
æags
 & 0x80)

6196 
	`¡bi__gif_·r£_cŞÜbË
(
s
,
g
->
·l
, 2 << (g->
æags
 & 7), -1);

6199 
	}
}

6201 
	$¡bi__gif_šfo_¿w
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

6203 
¡bi__gif
* 
g
 = (¡bi__gif*è
	`¡bi__m®loc
((stbi__gif));

6204 ià(!
	`¡bi__gif_h—d”
(
s
, 
g
, 
comp
, 1)) {

6205 
	`STBI_FREE
(
g
);

6206 
	`¡bi__»wšd
Ğ
s
 );

6209 ià(
x
è*x = 
g
->
w
;

6210 ià(
y
è*y = 
g
->
h
;

6211 
	`STBI_FREE
(
g
);

6213 
	}
}

6215 
	$¡bi__out_gif_code
(
¡bi__gif
 *
g
, 
¡bi__ušt16
 
code
)

6217 
¡bi_uc
 *
p
, *
c
;

6218 
idx
;

6222 ià(
g
->
codes
[
code
].
´efix
 >= 0)

6223 
	`¡bi__out_gif_code
(
g
, g->
codes
[
code
].
´efix
);

6225 ià(
g
->
cur_y
 >ğg->
max_y
) ;

6227 
idx
 = 
g
->
cur_x
 + g->
cur_y
;

6228 
p
 = &
g
->
out
[
idx
];

6229 
g
->
hi¡Üy
[
idx
 / 4] = 1;

6231 
c
 = &
g
->
cŞÜ_bË
[g->
codes
[
code
].
suffix
 * 4];

6232 ià(
c
[3] > 128) {

6233 
p
[0] = 
c
[2];

6234 
p
[1] = 
c
[1];

6235 
p
[2] = 
c
[0];

6236 
p
[3] = 
c
[3];

6238 
g
->
cur_x
 += 4;

6240 ià(
g
->
cur_x
 >ğg->
max_x
) {

6241 
g
->
cur_x
 = g->
¡¬t_x
;

6242 
g
->
cur_y
 +ğg->
¡•
;

6244 
g
->
cur_y
 >ğg->
max_y
 && g->
·r£
 > 0) {

6245 
g
->
¡•
 = (1 << g->
·r£
è* g->
lše_size
;

6246 
g
->
cur_y
 = g->
¡¬t_y
 + (g->
¡•
 >> 1);

6247 --
g
->
·r£
;

6250 
	}
}

6252 
¡bi_uc
 *
	$¡bi__´oûss_gif_¿¡”
(
¡bi__cÚ‹xt
 *
s
, 
¡bi__gif
 *
g
)

6254 
¡bi_uc
 
lzw_cs
;

6255 
¡bi__št32
 
Ën
, 
š™_code
;

6256 
¡bi__ušt32
 
fœ¡
;

6257 
¡bi__št32
 
codesize
, 
codemask
, 
ava
, 
Şdcode
, 
b™s
, 
v®id_b™s
, 
ş—r
;

6258 
¡bi__gif_lzw
 *
p
;

6260 
lzw_cs
 = 
	`¡bi__g‘8
(
s
);

6261 ià(
lzw_cs
 > 12è 
NULL
;

6262 
ş—r
 = 1 << 
lzw_cs
;

6263 
fœ¡
 = 1;

6264 
codesize
 = 
lzw_cs
 + 1;

6265 
codemask
 = (1 << 
codesize
) - 1;

6266 
b™s
 = 0;

6267 
v®id_b™s
 = 0;

6268 
š™_code
 = 0; in™_cod< 
ş—r
; init_code++) {

6269 
g
->
codes
[
š™_code
].
´efix
 = -1;

6270 
g
->
codes
[
š™_code
].
fœ¡
 = (
¡bi_uc
) init_code;

6271 
g
->
codes
[
š™_code
].
suffix
 = (
¡bi_uc
) init_code;

6275 
ava
 = 
ş—r
+2;

6276 
Şdcode
 = -1;

6278 
Ën
 = 0;

6280 ià(
v®id_b™s
 < 
codesize
) {

6281 ià(
Ën
 == 0) {

6282 
Ën
 = 
	`¡bi__g‘8
(
s
);

6283 ià(
Ën
 == 0)

6284  
g
->
out
;

6286 --
Ën
;

6287 
b™s
 |ğ(
¡bi__št32
è
	`¡bi__g‘8
(
s
è<< 
v®id_b™s
;

6288 
v®id_b™s
 += 8;

6290 
¡bi__št32
 
code
 = 
b™s
 & 
codemask
;

6291 
b™s
 >>ğ
codesize
;

6292 
v®id_b™s
 -ğ
codesize
;

6294 ià(
code
 =ğ
ş—r
) {

6295 
codesize
 = 
lzw_cs
 + 1;

6296 
codemask
 = (1 << 
codesize
) - 1;

6297 
ava
 = 
ş—r
 + 2;

6298 
Şdcode
 = -1;

6299 
fœ¡
 = 0;

6300 } ià(
code
 =ğ
ş—r
 + 1) {

6301 
	`¡bi__sk
(
s
, 
Ën
);

6302 (
Ën
 = 
	`¡bi__g‘8
(
s
)) > 0)

6303 
	`¡bi__sk
(
s
,
Ën
);

6304  
g
->
out
;

6305 } ià(
code
 <ğ
ava
) {

6306 ià(
fœ¡
) {

6307  
	`¡bi__”½uc
("no clear code", "Corrupt GIF");

6310 ià(
Şdcode
 >= 0) {

6311 
p
 = &
g
->
codes
[
ava
++];

6312 ià(
ava
 > 8192) {

6313  
	`¡bi__”½uc
("too many codes", "Corrupt GIF");

6316 
p
->
´efix
 = (
¡bi__št16
è
Şdcode
;

6317 
p
->
fœ¡
 = 
g
->
codes
[
Şdcode
].first;

6318 
p
->
suffix
 = (
code
 =ğ
ava
è?…->
fœ¡
 : 
g
->
codes
[code].first;

6319 } ià(
code
 =ğ
ava
)

6320  
	`¡bi__”½uc
("illegal code in„aster", "Corrupt GIF");

6322 
	`¡bi__out_gif_code
(
g
, (
¡bi__ušt16
è
code
);

6324 ià((
ava
 & 
codemask
) == 0 &&‡vail <= 0x0FFF) {

6325 
codesize
++;

6326 
codemask
 = (1 << 
codesize
) - 1;

6329 
Şdcode
 = 
code
;

6331  
	`¡bi__”½uc
("illegal code in„aster", "Corrupt GIF");

6335 
	}
}

6339 
¡bi_uc
 *
	$¡bi__gif_lßd_Ãxt
(
¡bi__cÚ‹xt
 *
s
, 
¡bi__gif
 *
g
, *
comp
, 
»q_comp
, 
¡bi_uc
 *
two_back
)

6341 
di¥o£
;

6342 
fœ¡_äame
;

6343 
pi
;

6344 
pcouÁ
;

6347 
fœ¡_äame
 = 0;

6348 ià(
g
->
out
 == 0) {

6349 ià(!
	`¡bi__gif_h—d”
(
s
, 
g
, 
comp
,0))  0;

6350 
g
->
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(4 * g->
w
 * g->
h
);

6351 
g
->
background
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(4 * g->
w
 * g->
h
);

6352 
g
->
hi¡Üy
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(g->
w
 * g->
h
);

6353 ià(
g
->
out
 =ğ0è 
	`¡bi__”½uc
("outofmem", "Out of memory");

6358 
	`mem£t
Ğ
g
->
out
, 0x00, 4 * g->
w
 * g->
h
 );

6359 
	`mem£t
Ğ
g
->
background
, 0x00, 4 * g->
w
 * g->
h
 );

6360 
	`mem£t
Ğ
g
->
hi¡Üy
, 0x00, g->
w
 * g->
h
 );

6361 
fœ¡_äame
 = 1;

6364 
di¥o£
 = (
g
->
eæags
 & 0x1C) >> 2;

6365 
pcouÁ
 = 
g
->
w
 * g->
h
;

6367 ià((
di¥o£
 =ğ3è&& (
two_back
 == 0)) {

6368 
di¥o£
 = 2;

6371 ià(
di¥o£
 == 3) {

6372 
pi
 = 0;…˜< 
pcouÁ
; ++pi) {

6373 ià(
g
->
hi¡Üy
[
pi
]) {

6374 
	`memıy
Ğ&
g
->
out
[
pi
 * 4], &
two_back
[pi * 4], 4 );

6377 } ià(
di¥o£
 == 2) {

6379 
pi
 = 0;…˜< 
pcouÁ
; ++pi) {

6380 ià(
g
->
hi¡Üy
[
pi
]) {

6381 
	`memıy
Ğ&
g
->
out
[
pi
 * 4], &g->
background
[pi * 4], 4 );

6392 
	`memıy
Ğ
g
->
background
, g->
out
, 4 * g->
w
 * g->
h
 );

6396 
	`mem£t
Ğ
g
->
hi¡Üy
, 0x00, g->
w
 * g->
h
 );

6399 
g
 = 
	`¡bi__g‘8
(
s
);

6400 
g
) {

6403 
¡bi__št32
 
x
, 
y
, 
w
, 
h
;

6404 
¡bi_uc
 *
o
;

6406 
x
 = 
	`¡bi__g‘16Ë
(
s
);

6407 
y
 = 
	`¡bi__g‘16Ë
(
s
);

6408 
w
 = 
	`¡bi__g‘16Ë
(
s
);

6409 
h
 = 
	`¡bi__g‘16Ë
(
s
);

6410 ià(((
x
 + 
w
è> (
g
->w)è|| ((
y
 + 
h
) > (g->h)))

6411  
	`¡bi__”½uc
("bad Image Descriptor", "Corrupt GIF");

6413 
g
->
lše_size
 = g->
w
 * 4;

6414 
g
->
¡¬t_x
 = 
x
 * 4;

6415 
g
->
¡¬t_y
 = 
y
 * g->
lše_size
;

6416 
g
->
max_x
 = g->
¡¬t_x
 + 
w
 * 4;

6417 
g
->
max_y
 = g->
¡¬t_y
 + 
h
 * g->
lše_size
;

6418 
g
->
cur_x
 = g->
¡¬t_x
;

6419 
g
->
cur_y
 = g->
¡¬t_y
;

6421 
g
->
læags
 = 
	`¡bi__g‘8
(
s
);

6423 ià(
g
->
læags
 & 0x40) {

6424 
g
->
¡•
 = 8 * g->
lše_size
;

6425 
g
->
·r£
 = 3;

6427 
g
->
¡•
 = g->
lše_size
;

6428 
g
->
·r£
 = 0;

6431 ià(
g
->
læags
 & 0x80) {

6432 
	`¡bi__gif_·r£_cŞÜbË
(
s
,
g
->
Í®
, 2 << (g->
læags
 & 7), g->
eæags
 & 0x01 ? g->
Œª¥¬’t
 : -1);

6433 
g
->
cŞÜ_bË
 = (
¡bi_uc
 *èg->
Í®
;

6434 } ià(
g
->
æags
 & 0x80) {

6435 
g
->
cŞÜ_bË
 = (
¡bi_uc
 *èg->
·l
;

6437  
	`¡bi__”½uc
("missing colorable", "Corrupt GIF");

6439 
o
 = 
	`¡bi__´oûss_gif_¿¡”
(
s
, 
g
);

6440 ià(
o
 =ğ
NULL
)  NULL;

6443 
pcouÁ
 = 
g
->
w
 * g->
h
;

6444 ià(
fœ¡_äame
 && (
g
->
bgšdex
 > 0)) {

6446 
pi
 = 0;…˜< 
pcouÁ
; ++pi) {

6447 ià(
g
->
hi¡Üy
[
pi
] == 0) {

6448 
g
->
·l
[g->
bgšdex
][3] = 255;

6449 
	`memıy
Ğ&
g
->
out
[
pi
 * 4], &g->
·l
[g->
bgšdex
], 4 );

6454  
o
;

6459 
Ën
;

6460 
ext
 = 
	`¡bi__g‘8
(
s
);

6461 ià(
ext
 == 0xF9) {

6462 
Ën
 = 
	`¡bi__g‘8
(
s
);

6463 ià(
Ën
 == 4) {

6464 
g
->
eæags
 = 
	`¡bi__g‘8
(
s
);

6465 
g
->
d–ay
 = 10 * 
	`¡bi__g‘16Ë
(
s
);

6468 ià(
g
->
Œª¥¬’t
 >= 0) {

6469 
g
->
·l
[g->
Œª¥¬’t
][3] = 255;

6471 ià(
g
->
eæags
 & 0x01) {

6472 
g
->
Œª¥¬’t
 = 
	`¡bi__g‘8
(
s
);

6473 ià(
g
->
Œª¥¬’t
 >= 0) {

6474 
g
->
·l
[g->
Œª¥¬’t
][3] = 0;

6478 
	`¡bi__sk
(
s
, 1);

6479 
g
->
Œª¥¬’t
 = -1;

6482 
	`¡bi__sk
(
s
, 
Ën
);

6486 (
Ën
 = 
	`¡bi__g‘8
(
s
)) != 0) {

6487 
	`¡bi__sk
(
s
, 
Ën
);

6493  (
¡bi_uc
 *è
s
;

6496  
	`¡bi__”½uc
("unknown code", "Corrupt GIF");

6499 
	}
}

6501 *
	$¡bi__lßd_gif_maš
(
¡bi__cÚ‹xt
 *
s
, **
d–ays
, *
x
, *
y
, *
z
, *
comp
, 
»q_comp
)

6503 ià(
	`¡bi__gif_‹¡
(
s
)) {

6504 
Ïy”s
 = 0;

6505 
¡bi_uc
 *
u
 = 0;

6506 
¡bi_uc
 *
out
 = 0;

6507 
¡bi_uc
 *
two_back
 = 0;

6508 
¡bi__gif
 
g
;

6509 
¡ride
;

6510 
	`mem£t
(&
g
, 0, (g));

6511 ià(
d–ays
) {

6512 *
d–ays
 = 0;

6516 
u
 = 
	`¡bi__gif_lßd_Ãxt
(
s
, &
g
, 
comp
, 
»q_comp
, 
two_back
);

6517 ià(
u
 =ğ(
¡bi_uc
 *è
s
) u = 0;

6519 ià(
u
) {

6520 *
x
 = 
g
.
w
;

6521 *
y
 = 
g
.
h
;

6522 ++
Ïy”s
;

6523 
¡ride
 = 
g
.
w
 * g.
h
 * 4;

6525 ià(
out
) {

6526 
out
 = (
¡bi_uc
*è
	`STBI_REALLOC
Ğout, 
Ïy”s
 * 
¡ride
 );

6527 ià(
d–ays
) {

6528 *
d–ays
 = (*è
	`STBI_REALLOC
Ğ*d–ays, (è* 
Ïy”s
 );

6531 
out
 = (
¡bi_uc
*)
	`¡bi__m®loc
Ğ
Ïy”s
 * 
¡ride
 );

6532 ià(
d–ays
) {

6533 *
d–ays
 = (*è
	`¡bi__m®loc
Ğ
Ïy”s
 * () );

6536 
	`memıy
Ğ
out
 + ((
Ïy”s
 - 1è* 
¡ride
), 
u
, stride );

6537 ià(
Ïy”s
 >= 2) {

6538 
two_back
 = 
out
 - 2 * 
¡ride
;

6541 ià(
d–ays
) {

6542 (*
d–ays
)[
Ïy”s
 - 1U] = 
g
.
d–ay
;

6545 } 
u
 != 0);

6548 
	`STBI_FREE
(
g
.
out
);

6549 
	`STBI_FREE
(
g
.
hi¡Üy
);

6550 
	`STBI_FREE
(
g
.
background
);

6553 ià(
»q_comp
 &&„eq_comp != 4)

6554 
out
 = 
	`¡bi__cÚv”t_fÜm©
(out, 4, 
»q_comp
, 
Ïy”s
 * 
g
.
w
, g.
h
);

6556 *
z
 = 
Ïy”s
;

6557  
out
;

6559  
	`¡bi__”½uc
("not GIF", "Image was‚ot‡s‡ gifype.");

6561 
	}
}

6563 *
	$¡bi__gif_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

6565 
¡bi_uc
 *
u
 = 0;

6566 
¡bi__gif
 
g
;

6567 
	`mem£t
(&
g
, 0, (g));

6569 
u
 = 
	`¡bi__gif_lßd_Ãxt
(
s
, &
g
, 
comp
, 
»q_comp
, 0);

6570 ià(
u
 =ğ(
¡bi_uc
 *è
s
) u = 0;

6571 ià(
u
) {

6572 *
x
 = 
g
.
w
;

6573 *
y
 = 
g
.
h
;

6577 ià(
»q_comp
 &&„eq_comp != 4)

6578 
u
 = 
	`¡bi__cÚv”t_fÜm©
(u, 4, 
»q_comp
, 
g
.
w
, g.
h
);

6582 
	`STBI_FREE
(
g
.
hi¡Üy
);

6583 
	`STBI_FREE
(
g
.
background
);

6585  
u
;

6586 
	}
}

6588 
	$¡bi__gif_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

6590  
	`¡bi__gif_šfo_¿w
(
s
,
x
,
y
,
comp
);

6591 
	}
}

6597 #iâdeà
STBI_NO_HDR


6598 
	$¡bi__hdr_‹¡_cÜe
(
¡bi__cÚ‹xt
 *
s
, cÚ¡ *
sigÇtu»
)

6600 
i
;

6601 
i
=0; 
sigÇtu»
[i]; ++i)

6602 ià(
	`¡bi__g‘8
(
s
è!ğ
sigÇtu»
[
i
])

6604 
	`¡bi__»wšd
(
s
);

6606 
	}
}

6608 
	$¡bi__hdr_‹¡
(
¡bi__cÚ‹xt
* 
s
)

6610 
r
 = 
	`¡bi__hdr_‹¡_cÜe
(
s
, "#?RADIANCE\n");

6611 
	`¡bi__»wšd
(
s
);

6612 if(!
r
) {

6613 
r
 = 
	`¡bi__hdr_‹¡_cÜe
(
s
, "#?RGBE\n");

6614 
	`¡bi__»wšd
(
s
);

6616  
r
;

6617 
	}
}

6619 
	#STBI__HDR_BUFLEN
 1024

	)

6620 *
	$¡bi__hdr_g‘tok’
(
¡bi__cÚ‹xt
 *
z
, *
bufãr
)

6622 
Ën
=0;

6623 
c
 = '\0';

6625 
c
 = (è
	`¡bi__g‘8
(
z
);

6627 !
	`¡bi__©_eof
(
z
è&& 
c
 != '\n') {

6628 
bufãr
[
Ën
++] = 
c
;

6629 ià(
Ën
 =ğ
STBI__HDR_BUFLEN
-1) {

6631 !
	`¡bi__©_eof
(
z
è&& 
	`¡bi__g‘8
(z) != '\n')

6635 
c
 = (è
	`¡bi__g‘8
(
z
);

6638 
bufãr
[
Ën
] = 0;

6639  
bufãr
;

6640 
	}
}

6642 
	$¡bi__hdr_cÚv”t
(*
ouut
, 
¡bi_uc
 *
šput
, 
»q_comp
)

6644 iàĞ
šput
[3] != 0 ) {

6645 
f1
;

6647 
f1
 = (è
	`ldexp
(1.0f, 
šput
[3] - ()(128 + 8));

6648 ià(
»q_comp
 <= 2)

6649 
ouut
[0] = (
šput
[0] + iÅut[1] + iÅut[2]è* 
f1
 / 3;

6651 
ouut
[0] = 
šput
[0] * 
f1
;

6652 
ouut
[1] = 
šput
[1] * 
f1
;

6653 
ouut
[2] = 
šput
[2] * 
f1
;

6655 ià(
»q_comp
 =ğ2è
ouut
[1] = 1;

6656 ià(
»q_comp
 =ğ4è
ouut
[3] = 1;

6658 
»q_comp
) {

6659 4: 
ouut
[3] = 1;

6660 3: 
ouut
[0] = output[1] = output[2] = 0;

6662 2: 
ouut
[1] = 1;

6663 1: 
ouut
[0] = 0;

6667 
	}
}

6669 *
	$¡bi__hdr_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

6671 
bufãr
[
STBI__HDR_BUFLEN
];

6672 *
tok’
;

6673 
v®id
 = 0;

6674 
width
, 
height
;

6675 
¡bi_uc
 *
sÿÆše
;

6676 *
hdr_d©a
;

6677 
Ën
;

6678 
couÁ
, 
v®ue
;

6679 
i
, 
j
, 
k
, 
c1
,
c2
, 
z
;

6680 cÚ¡ *
h—d”Tok’
;

6681 
	`STBI_NOTUSED
(
ri
);

6684 
h—d”Tok’
 = 
	`¡bi__hdr_g‘tok’
(
s
,
bufãr
);

6685 ià(
	`¡rcmp
(
h—d”Tok’
, "#?RADIANCE") != 0 && strcmp(headerToken, "#?RGBE") != 0)

6686  
	`¡bi__”½f
("not HDR", "Corrupt HDR image");

6690 
tok’
 = 
	`¡bi__hdr_g‘tok’
(
s
,
bufãr
);

6691 ià(
tok’
[0] == 0) ;

6692 ià(
	`¡rcmp
(
tok’
, "FORMAT=32-b™_¾e_rgbe"è=ğ0è
v®id
 = 1;

6695 ià(!
v®id
è 
	`¡bi__”½f
("unsupported format", "Unsupported HDR format");

6699 
tok’
 = 
	`¡bi__hdr_g‘tok’
(
s
,
bufãr
);

6700 ià(
	`¡ºcmp
(
tok’
, "-Y ", 3)è 
	`¡bi__”½f
("unsupported data†ayout", "Unsupported HDR format");

6701 
tok’
 += 3;

6702 
height
 = (è
	`¡¹Ş
(
tok’
, &token, 10);

6703 *
tok’
 == ' ') ++token;

6704 ià(
	`¡ºcmp
(
tok’
, "+X ", 3)è 
	`¡bi__”½f
("unsupported data†ayout", "Unsupported HDR format");

6705 
tok’
 += 3;

6706 
width
 = (è
	`¡¹Ş
(
tok’
, 
NULL
, 10);

6708 *
x
 = 
width
;

6709 *
y
 = 
height
;

6711 ià(
comp
) *comp = 3;

6712 ià(
»q_comp
 == 0)„eq_comp = 3;

6714 ià(!
	`¡bi__mad4sizes_v®id
(
width
, 
height
, 
»q_comp
, (), 0))

6715  
	`¡bi__”½f
("too†arge", "HDR image isoo†arge");

6718 
hdr_d©a
 = (*è
	`¡bi__m®loc_mad4
(
width
, 
height
, 
»q_comp
, (), 0);

6719 ià(!
hdr_d©a
)

6720  
	`¡bi__”½f
("outofmem", "Out of memory");

6724 iàĞ
width
 < 8 || width >= 32768) {

6726 
j
=0; j < 
height
; ++j) {

6727 
i
=0; i < 
width
; ++i) {

6728 
¡bi_uc
 
rgbe
[4];

6729 
maš_decode_loİ
:

6730 
	`¡bi__g‘n
(
s
, 
rgbe
, 4);

6731 
	`¡bi__hdr_cÚv”t
(
hdr_d©a
 + 
j
 * 
width
 * 
»q_comp
 + 
i
 *„eq_comp, 
rgbe
,„eq_comp);

6736 
sÿÆše
 = 
NULL
;

6738 
j
 = 0; j < 
height
; ++j) {

6739 
c1
 = 
	`¡bi__g‘8
(
s
);

6740 
c2
 = 
	`¡bi__g‘8
(
s
);

6741 
Ën
 = 
	`¡bi__g‘8
(
s
);

6742 ià(
c1
 !ğ2 || 
c2
 !ğ2 || (
Ën
 & 0x80)) {

6745 
¡bi_uc
 
rgbe
[4];

6746 
rgbe
[0] = (
¡bi_uc
è
c1
;

6747 
rgbe
[1] = (
¡bi_uc
è
c2
;

6748 
rgbe
[2] = (
¡bi_uc
è
Ën
;

6749 
rgbe
[3] = (
¡bi_uc
è
	`¡bi__g‘8
(
s
);

6750 
	`¡bi__hdr_cÚv”t
(
hdr_d©a
, 
rgbe
, 
»q_comp
);

6751 
i
 = 1;

6752 
j
 = 0;

6753 
	`STBI_FREE
(
sÿÆše
);

6754 
maš_decode_loİ
;

6756 
Ën
 <<= 8;

6757 
Ën
 |ğ
	`¡bi__g‘8
(
s
);

6758 ià(
Ën
 !ğ
width
è{ 
	`STBI_FREE
(
hdr_d©a
); STBI_FREE(
sÿÆše
);  
	`¡bi__”½f
("invalid decoded scanline†ength", "corrupt HDR"); }

6759 ià(
sÿÆše
 =ğ
NULL
) {

6760 
sÿÆše
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad2
(
width
, 4, 0);

6761 ià(!
sÿÆše
) {

6762 
	`STBI_FREE
(
hdr_d©a
);

6763  
	`¡bi__”½f
("outofmem", "Out of memory");

6767 
k
 = 0; k < 4; ++k) {

6768 
Æeá
;

6769 
i
 = 0;

6770 (
Æeá
 = 
width
 - 
i
) > 0) {

6771 
couÁ
 = 
	`¡bi__g‘8
(
s
);

6772 ià(
couÁ
 > 128) {

6774 
v®ue
 = 
	`¡bi__g‘8
(
s
);

6775 
couÁ
 -= 128;

6776 ià(
couÁ
 > 
Æeá
è{ 
	`STBI_FREE
(
hdr_d©a
); STBI_FREE(
sÿÆše
);  
	`¡bi__”½f
("corrupt", "bad RLE data in HDR"); }

6777 
z
 = 0; z < 
couÁ
; ++z)

6778 
sÿÆše
[
i
++ * 4 + 
k
] = 
v®ue
;

6781 ià(
couÁ
 > 
Æeá
è{ 
	`STBI_FREE
(
hdr_d©a
); STBI_FREE(
sÿÆše
);  
	`¡bi__”½f
("corrupt", "bad RLE data in HDR"); }

6782 
z
 = 0; z < 
couÁ
; ++z)

6783 
sÿÆše
[
i
++ * 4 + 
k
] = 
	`¡bi__g‘8
(
s
);

6787 
i
=0; i < 
width
; ++i)

6788 
	`¡bi__hdr_cÚv”t
(
hdr_d©a
+(
j
*
width
 + 
i
)*
»q_comp
, 
sÿÆše
 + i*4,„eq_comp);

6790 ià(
sÿÆše
)

6791 
	`STBI_FREE
(
sÿÆše
);

6794  
hdr_d©a
;

6795 
	}
}

6797 
	$¡bi__hdr_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

6799 
bufãr
[
STBI__HDR_BUFLEN
];

6800 *
tok’
;

6801 
v®id
 = 0;

6802 
dummy
;

6804 ià(!
x
èx = &
dummy
;

6805 ià(!
y
èy = &
dummy
;

6806 ià(!
comp
ècom°ğ&
dummy
;

6808 ià(
	`¡bi__hdr_‹¡
(
s
) == 0) {

6809 
	`¡bi__»wšd
Ğ
s
 );

6814 
tok’
 = 
	`¡bi__hdr_g‘tok’
(
s
,
bufãr
);

6815 ià(
tok’
[0] == 0) ;

6816 ià(
	`¡rcmp
(
tok’
, "FORMAT=32-b™_¾e_rgbe"è=ğ0è
v®id
 = 1;

6819 ià(!
v®id
) {

6820 
	`¡bi__»wšd
Ğ
s
 );

6823 
tok’
 = 
	`¡bi__hdr_g‘tok’
(
s
,
bufãr
);

6824 ià(
	`¡ºcmp
(
tok’
, "-Y ", 3)) {

6825 
	`¡bi__»wšd
Ğ
s
 );

6828 
tok’
 += 3;

6829 *
y
 = (è
	`¡¹Ş
(
tok’
, &token, 10);

6830 *
tok’
 == ' ') ++token;

6831 ià(
	`¡ºcmp
(
tok’
, "+X ", 3)) {

6832 
	`¡bi__»wšd
Ğ
s
 );

6835 
tok’
 += 3;

6836 *
x
 = (è
	`¡¹Ş
(
tok’
, 
NULL
, 10);

6837 *
comp
 = 3;

6839 
	}
}

6842 #iâdeà
STBI_NO_BMP


6843 
	$¡bi__bmp_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

6845 *
p
;

6846 
¡bi__bmp_d©a
 
šfo
;

6848 
šfo
.
®l_a
 = 255;

6849 
p
 = 
	`¡bi__bmp_·r£_h—d”
(
s
, &
šfo
);

6850 
	`¡bi__»wšd
Ğ
s
 );

6851 ià(
p
 =ğ
NULL
)

6853 ià(
x
è*x = 
s
->
img_x
;

6854 ià(
y
è*y = 
s
->
img_y
;

6855 ià(
comp
è*com°ğ
šfo
.
ma
 ? 4 : 3;

6857 
	}
}

6860 #iâdeà
STBI_NO_PSD


6861 
	$¡bi__psd_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

6863 
chªÃlCouÁ
, 
dummy
, 
d•th
;

6864 ià(!
x
èx = &
dummy
;

6865 ià(!
y
èy = &
dummy
;

6866 ià(!
comp
ècom°ğ&
dummy
;

6867 ià(
	`¡bi__g‘32be
(
s
) != 0x38425053) {

6868 
	`¡bi__»wšd
Ğ
s
 );

6871 ià(
	`¡bi__g‘16be
(
s
) != 1) {

6872 
	`¡bi__»wšd
Ğ
s
 );

6875 
	`¡bi__sk
(
s
, 6);

6876 
chªÃlCouÁ
 = 
	`¡bi__g‘16be
(
s
);

6877 ià(
chªÃlCouÁ
 < 0 || channelCount > 16) {

6878 
	`¡bi__»wšd
Ğ
s
 );

6881 *
y
 = 
	`¡bi__g‘32be
(
s
);

6882 *
x
 = 
	`¡bi__g‘32be
(
s
);

6883 
d•th
 = 
	`¡bi__g‘16be
(
s
);

6884 ià(
d•th
 != 8 && depth != 16) {

6885 
	`¡bi__»wšd
Ğ
s
 );

6888 ià(
	`¡bi__g‘16be
(
s
) != 3) {

6889 
	`¡bi__»wšd
Ğ
s
 );

6892 *
comp
 = 4;

6894 
	}
}

6896 
	$¡bi__psd_is16
(
¡bi__cÚ‹xt
 *
s
)

6898 
chªÃlCouÁ
, 
d•th
;

6899 ià(
	`¡bi__g‘32be
(
s
) != 0x38425053) {

6900 
	`¡bi__»wšd
Ğ
s
 );

6903 ià(
	`¡bi__g‘16be
(
s
) != 1) {

6904 
	`¡bi__»wšd
Ğ
s
 );

6907 
	`¡bi__sk
(
s
, 6);

6908 
chªÃlCouÁ
 = 
	`¡bi__g‘16be
(
s
);

6909 ià(
chªÃlCouÁ
 < 0 || channelCount > 16) {

6910 
	`¡bi__»wšd
Ğ
s
 );

6913 (è
	`¡bi__g‘32be
(
s
);

6914 (è
	`¡bi__g‘32be
(
s
);

6915 
d•th
 = 
	`¡bi__g‘16be
(
s
);

6916 ià(
d•th
 != 16) {

6917 
	`¡bi__»wšd
Ğ
s
 );

6921 
	}
}

6924 #iâdeà
STBI_NO_PIC


6925 
	$¡bi__pic_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

6927 
aù_comp
=0,
num_·ck‘s
=0,
chašed
,
dummy
;

6928 
¡bi__pic_·ck‘
 
·ck‘s
[10];

6930 ià(!
x
èx = &
dummy
;

6931 ià(!
y
èy = &
dummy
;

6932 ià(!
comp
ècom°ğ&
dummy
;

6934 ià(!
	`¡bi__pic_is4
(
s
,"\x53\x80\xF6\x34")) {

6935 
	`¡bi__»wšd
(
s
);

6939 
	`¡bi__sk
(
s
, 88);

6941 *
x
 = 
	`¡bi__g‘16be
(
s
);

6942 *
y
 = 
	`¡bi__g‘16be
(
s
);

6943 ià(
	`¡bi__©_eof
(
s
)) {

6944 
	`¡bi__»wšd
Ğ
s
);

6947 iàĞ(*
x
è!ğ0 && (1 << 28è/ (*xè< (*
y
)) {

6948 
	`¡bi__»wšd
Ğ
s
 );

6952 
	`¡bi__sk
(
s
, 8);

6955 
¡bi__pic_·ck‘
 *
·ck‘
;

6957 ià(
num_·ck‘s
==(
·ck‘s
)/(packets[0]))

6960 
·ck‘
 = &
·ck‘s
[
num_·ck‘s
++];

6961 
chašed
 = 
	`¡bi__g‘8
(
s
);

6962 
·ck‘
->
size
 = 
	`¡bi__g‘8
(
s
);

6963 
·ck‘
->
ty³
 = 
	`¡bi__g‘8
(
s
);

6964 
·ck‘
->
chªÃl
 = 
	`¡bi__g‘8
(
s
);

6965 
aù_comp
 |ğ
·ck‘
->
chªÃl
;

6967 ià(
	`¡bi__©_eof
(
s
)) {

6968 
	`¡bi__»wšd
Ğ
s
 );

6971 ià(
·ck‘
->
size
 != 8) {

6972 
	`¡bi__»wšd
Ğ
s
 );

6975 } 
chašed
);

6977 *
comp
 = (
aù_comp
 & 0x10 ? 4 : 3);

6980 
	}
}

6995 #iâdeà
STBI_NO_PNM


6997 
	$¡bi__²m_‹¡
(
¡bi__cÚ‹xt
 *
s
)

6999 
p
, 
t
;

7000 
p
 = (è
	`¡bi__g‘8
(
s
);

7001 
t
 = (è
	`¡bi__g‘8
(
s
);

7002 ià(
p
 !ğ'P' || (
t
 != '5' && != '6')) {

7003 
	`¡bi__»wšd
Ğ
s
 );

7007 
	}
}

7009 *
	$¡bi__²m_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

7011 
¡bi_uc
 *
out
;

7012 
	`STBI_NOTUSED
(
ri
);

7014 ià(!
	`¡bi__²m_šfo
(
s
, (*)&s->
img_x
, (*)&s->
img_y
, (*)&s->
img_n
))

7017 *
x
 = 
s
->
img_x
;

7018 *
y
 = 
s
->
img_y
;

7019 ià(
comp
è*com°ğ
s
->
img_n
;

7021 ià(!
	`¡bi__mad3sizes_v®id
(
s
->
img_n
, s->
img_x
, s->
img_y
, 0))

7022  
	`¡bi__”½uc
("too†arge", "PNMoo†arge");

7024 
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
s
->
img_n
, s->
img_x
, s->
img_y
, 0);

7025 ià(!
out
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

7026 
	`¡bi__g‘n
(
s
, 
out
, s->
img_n
 * s->
img_x
 * s->
img_y
);

7028 ià(
»q_comp
 &&„eq_com°!ğ
s
->
img_n
) {

7029 
out
 = 
	`¡bi__cÚv”t_fÜm©
(out, 
s
->
img_n
, 
»q_comp
, s->
img_x
, s->
img_y
);

7030 ià(
out
 =ğ
NULL
)  out;

7032  
out
;

7033 
	}
}

7035 
	$¡bi__²m_is¥aû
(
c
)

7037  
c
 == ' ' || c == '\t' || c == '\n' || c == '\v' || c == '\f' || c == '\r';

7038 
	}
}

7040 
	$¡bi__²m_sk_wh™e¥aû
(
¡bi__cÚ‹xt
 *
s
, *
c
)

7043 !
	`¡bi__©_eof
(
s
è&& 
	`¡bi__²m_is¥aû
(*
c
))

7044 *
c
 = (è
	`¡bi__g‘8
(
s
);

7046 ià(
	`¡bi__©_eof
(
s
è|| *
c
 != '#')

7049 !
	`¡bi__©_eof
(
s
è&& *
c
 != '\n' && *c != '\r' )

7050 *
c
 = (è
	`¡bi__g‘8
(
s
);

7052 
	}
}

7054 
	$¡bi__²m_isdig™
(
c
)

7056  
c
 >= '0' && c <= '9';

7057 
	}
}

7059 
	$¡bi__²m_g‘š‹g”
(
¡bi__cÚ‹xt
 *
s
, *
c
)

7061 
v®ue
 = 0;

7063 !
	`¡bi__©_eof
(
s
è&& 
	`¡bi__²m_isdig™
(*
c
)) {

7064 
v®ue
 = v®ue*10 + (*
c
 - '0');

7065 *
c
 = (è
	`¡bi__g‘8
(
s
);

7068  
v®ue
;

7069 
	}
}

7071 
	$¡bi__²m_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

7073 
maxv
, 
dummy
;

7074 
c
, 
p
, 
t
;

7076 ià(!
x
èx = &
dummy
;

7077 ià(!
y
èy = &
dummy
;

7078 ià(!
comp
ècom°ğ&
dummy
;

7080 
	`¡bi__»wšd
(
s
);

7083 
p
 = (è
	`¡bi__g‘8
(
s
);

7084 
t
 = (è
	`¡bi__g‘8
(
s
);

7085 ià(
p
 !ğ'P' || (
t
 != '5' && != '6')) {

7086 
	`¡bi__»wšd
(
s
);

7090 *
comp
 = (
t
 == '6') ? 3 : 1;

7092 
c
 = (è
	`¡bi__g‘8
(
s
);

7093 
	`¡bi__²m_sk_wh™e¥aû
(
s
, &
c
);

7095 *
x
 = 
	`¡bi__²m_g‘š‹g”
(
s
, &
c
);

7096 
	`¡bi__²m_sk_wh™e¥aû
(
s
, &
c
);

7098 *
y
 = 
	`¡bi__²m_g‘š‹g”
(
s
, &
c
);

7099 
	`¡bi__²m_sk_wh™e¥aû
(
s
, &
c
);

7101 
maxv
 = 
	`¡bi__²m_g‘š‹g”
(
s
, &
c
);

7103 ià(
maxv
 > 255)

7104  
	`¡bi__”r
("max value > 255", "PPM image‚ot 8-bit");

7107 
	}
}

7110 
	$¡bi__šfo_maš
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

7112 #iâdeà
STBI_NO_JPEG


7113 ià(
	`¡bi__j³g_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7116 #iâdeà
STBI_NO_PNG


7117 ià(
	`¡bi__²g_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7120 #iâdeà
STBI_NO_GIF


7121 ià(
	`¡bi__gif_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7124 #iâdeà
STBI_NO_BMP


7125 ià(
	`¡bi__bmp_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7128 #iâdeà
STBI_NO_PSD


7129 ià(
	`¡bi__psd_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7132 #iâdeà
STBI_NO_PIC


7133 ià(
	`¡bi__pic_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7136 #iâdeà
STBI_NO_PNM


7137 ià(
	`¡bi__²m_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7140 #iâdeà
STBI_NO_HDR


7141 ià(
	`¡bi__hdr_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7145 #iâdeà
STBI_NO_TGA


7146 ià(
	`¡bi__tga_šfo
(
s
, 
x
, 
y
, 
comp
))

7149  
	`¡bi__”r
("unknown imageype", "Image‚ot of‡ny knownype, or corrupt");

7150 
	}
}

7152 
	$¡bi__is_16_maš
(
¡bi__cÚ‹xt
 *
s
)

7154 #iâdeà
STBI_NO_PNG


7155 ià(
	`¡bi__²g_is16
(
s
))  1;

7158 #iâdeà
STBI_NO_PSD


7159 ià(
	`¡bi__psd_is16
(
s
))  1;

7163 
	}
}

7165 #iâdeà
STBI_NO_STDIO


7166 
STBIDEF
 
	$¡bi_šfo
(cÚ¡ *
f’ame
, *
x
, *
y
, *
comp
)

7168 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

7169 
»suÉ
;

7170 ià(!
f
è 
	`¡bi__”r
("can't fopen", "Unableo open file");

7171 
»suÉ
 = 
	`¡bi_šfo_äom_fe
(
f
, 
x
, 
y
, 
comp
);

7172 
	`fşo£
(
f
);

7173  
»suÉ
;

7174 
	}
}

7176 
STBIDEF
 
	$¡bi_šfo_äom_fe
(
FILE
 *
f
, *
x
, *
y
, *
comp
)

7178 
r
;

7179 
¡bi__cÚ‹xt
 
s
;

7180 
pos
 = 
	`á–l
(
f
);

7181 
	`¡bi__¡¬t_fe
(&
s
, 
f
);

7182 
r
 = 
	`¡bi__šfo_maš
(&
s
,
x
,
y
,
comp
);

7183 
	`f£ek
(
f
,
pos
,
SEEK_SET
);

7184  
r
;

7185 
	}
}

7187 
STBIDEF
 
	$¡bi_is_16_b™
(cÚ¡ *
f’ame
)

7189 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

7190 
»suÉ
;

7191 ià(!
f
è 
	`¡bi__”r
("can't fopen", "Unableo open file");

7192 
»suÉ
 = 
	`¡bi_is_16_b™_äom_fe
(
f
);

7193 
	`fşo£
(
f
);

7194  
»suÉ
;

7195 
	}
}

7197 
STBIDEF
 
	$¡bi_is_16_b™_äom_fe
(
FILE
 *
f
)

7199 
r
;

7200 
¡bi__cÚ‹xt
 
s
;

7201 
pos
 = 
	`á–l
(
f
);

7202 
	`¡bi__¡¬t_fe
(&
s
, 
f
);

7203 
r
 = 
	`¡bi__is_16_maš
(&
s
);

7204 
	`f£ek
(
f
,
pos
,
SEEK_SET
);

7205  
r
;

7206 
	}
}

7209 
STBIDEF
 
	$¡bi_šfo_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
comp
)

7211 
¡bi__cÚ‹xt
 
s
;

7212 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

7213  
	`¡bi__šfo_maš
(&
s
,
x
,
y
,
comp
);

7214 
	}
}

7216 
STBIDEF
 
	$¡bi_šfo_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
c
, *
u£r
, *
x
, *
y
, *
comp
)

7218 
¡bi__cÚ‹xt
 
s
;

7219 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *è
c
, 
u£r
);

7220  
	`¡bi__šfo_maš
(&
s
,
x
,
y
,
comp
);

7221 
	}
}

7223 
STBIDEF
 
	$¡bi_is_16_b™_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
)

7225 
¡bi__cÚ‹xt
 
s
;

7226 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

7227  
	`¡bi__is_16_maš
(&
s
);

7228 
	}
}

7230 
STBIDEF
 
	$¡bi_is_16_b™_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
c
, *
u£r
)

7232 
¡bi__cÚ‹xt
 
s
;

7233 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *è
c
, 
u£r
);

7234  
	`¡bi__is_16_maš
(&
s
);

7235 
	}
}

	@App/stb_image_write.h

148 #iâdeà
INCLUDE_STB_IMAGE_WRITE_H


149 
	#INCLUDE_STB_IMAGE_WRITE_H


	)

152 #iâdeà
STBIWDEF


153 #ifdeà
STB_IMAGE_WRITE_STATIC


154 
	#STBIWDEF
 

	)

156 #ifdeà
__ılu¥lus


157 
	#STBIWDEF
 "C"

	)

159 
	#STBIWDEF
 

	)

164 #iâdeà
STB_IMAGE_WRITE_STATIC


165 
¡bi_wr™e_tga_w™h_¾e
;

166 
¡bi_wr™e_²g_com´essiÚ_Ëv–
;

167 
¡bi_wr™e_fÜû_²g_f‹r
;

170 #iâdeà
STBI_WRITE_NO_STDIO


171 
STBIWDEF
 
¡bi_wr™e_²g
(cÚ¡ *
f’ame
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
, 
¡ride_š_by‹s
);

172 
STBIWDEF
 
¡bi_wr™e_bmp
(cÚ¡ *
f’ame
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

173 
STBIWDEF
 
¡bi_wr™e_tga
(cÚ¡ *
f’ame
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

174 
STBIWDEF
 
¡bi_wr™e_hdr
(cÚ¡ *
f’ame
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

175 
STBIWDEF
 
¡bi_wr™e_jpg
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
qu®™y
);

178 
	t¡bi_wr™e_func
(*
	tcÚ‹xt
, *
	td©a
, 
	tsize
);

180 
STBIWDEF
 
¡bi_wr™e_²g_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
, 
¡ride_š_by‹s
);

181 
STBIWDEF
 
¡bi_wr™e_bmp_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

182 
STBIWDEF
 
¡bi_wr™e_tga_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

183 
STBIWDEF
 
¡bi_wr™e_hdr_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

184 
STBIWDEF
 
¡bi_wr™e_jpg_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
qu®™y
);

186 
STBIWDEF
 
¡bi_æ_v”tiÿÎy_Ú_wr™e
(
æ_boŞ—n
);

190 #ifdeà
STB_IMAGE_WRITE_IMPLEMENTATION


192 #ifdeà
_WIN32


193 #iâdeà
_CRT_SECURE_NO_WARNINGS


194 
	#_CRT_SECURE_NO_WARNINGS


	)

196 #iâdeà
_CRT_NONSTDC_NO_DEPRECATE


197 
	#_CRT_NONSTDC_NO_DEPRECATE


	)

201 #iâdeà
STBI_WRITE_NO_STDIO


202 
	~<¡dio.h
>

205 
	~<¡d¬g.h
>

206 
	~<¡dlib.h
>

207 
	~<¡ršg.h
>

208 
	~<m©h.h
>

210 #ià
defšed
(
STBIW_MALLOC
è&& defšed(
STBIW_FREE
è&& (defšed(
STBIW_REALLOC
è|| defšed(
STBIW_REALLOC_SIZED
))

212 #–ià!
defšed
(
STBIW_MALLOC
è&& !defšed(
STBIW_FREE
è&& !defšed(
STBIW_REALLOC
è&& !defšed(
STBIW_REALLOC_SIZED
)

218 #iâdeà
STBIW_MALLOC


219 
	#STBIW_MALLOC
(
sz
è
	`m®loc
(sz)

	)

220 
	#STBIW_REALLOC
(
p
,
Ãwsz
è
	`»®loc
Õ,Ãwsz)

	)

221 
	#STBIW_FREE
(
p
è
	`ä“
Õ)

	)

224 #iâdeà
STBIW_REALLOC_SIZED


225 
	#STBIW_REALLOC_SIZED
(
p
,
Şdsz
,
Ãwsz
è
	`STBIW_REALLOC
Õ,Ãwsz)

	)

229 #iâdeà
STBIW_MEMMOVE


230 
	#STBIW_MEMMOVE
(
a
,
b
,
sz
è
	`memmove
×,b,sz)

	)

234 #iâdeà
STBIW_ASSERT


235 
	~<as£¹.h
>

236 
	#STBIW_ASSERT
(
x
è
	`as£¹
(x)

	)

239 
	#STBIW_UCHAR
(
x
è(è((xè& 0xff)

	)

241 #ifdeà
STB_IMAGE_WRITE_STATIC


242 
	g¡bi__æ_v”tiÿÎy_Ú_wr™e
=0;

243 
	g¡bi_wr™e_²g_com´essiÚ_Ëv–
 = 8;

244 
	g¡bi_wr™e_tga_w™h_¾e
 = 1;

245 
	g¡bi_wr™e_fÜû_²g_f‹r
 = -1;

247 
	g¡bi_wr™e_²g_com´essiÚ_Ëv–
 = 8;

248 
	g¡bi__æ_v”tiÿÎy_Ú_wr™e
=0;

249 
	g¡bi_wr™e_tga_w™h_¾e
 = 1;

250 
	g¡bi_wr™e_fÜû_²g_f‹r
 = -1;

253 
STBIWDEF
 
	$¡bi_æ_v”tiÿÎy_Ú_wr™e
(
æag
)

255 
¡bi__æ_v”tiÿÎy_Ú_wr™e
 = 
æag
;

256 
	}
}

260 
¡bi_wr™e_func
 *
	mfunc
;

261 *
	mcÚ‹xt
;

262 } 
	t¡bi__wr™e_cÚ‹xt
;

265 
	$¡bi__¡¬t_wr™e_ÿÎbacks
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
¡bi_wr™e_func
 *
c
, *
cÚ‹xt
)

267 
s
->
func
 = 
c
;

268 
s
->
cÚ‹xt
 = context;

269 
	}
}

271 #iâdeà
STBI_WRITE_NO_STDIO


273 
	$¡bi__¡dio_wr™e
(*
cÚ‹xt
, *
d©a
, 
size
)

275 
	`fwr™e
(
d©a
,1,
size
,(
FILE
*è
cÚ‹xt
);

276 
	}
}

278 
	$¡bi__¡¬t_wr™e_fe
(
¡bi__wr™e_cÚ‹xt
 *
s
, cÚ¡ *
f’ame
)

280 
FILE
 *
f
;

281 #ifdeà
STBI_MSC_SECURE_CRT


282 ià(
	`fİ’_s
(&
f
, 
f’ame
, "wb"))

283 
f
 = 
NULL
;

285 
f
 = 
	`fİ’
(
f’ame
, "wb");

287 
	`¡bi__¡¬t_wr™e_ÿÎbacks
(
s
, 
¡bi__¡dio_wr™e
, (*è
f
);

288  
f
 !ğ
NULL
;

289 
	}
}

291 
	$¡bi__’d_wr™e_fe
(
¡bi__wr™e_cÚ‹xt
 *
s
)

293 
	`fşo£
((
FILE
 *)
s
->
cÚ‹xt
);

294 
	}
}

298 
	t¡biw_ušt32
;

299 
	t¡b_image_wr™e_‹¡
[(
¡biw_ušt32
)==4 ? 1 : -1];

301 
	$¡biw__wr™efv
(
¡bi__wr™e_cÚ‹xt
 *
s
, cÚ¡ *
fmt
, 
va_li¡
 
v
)

303 *
fmt
) {

304 *
fmt
++) {

306 '1': { 
x
 = 
	`STBIW_UCHAR
(
	`va_¬g
(
v
, ));

307 
s
->
	`func
(s->
cÚ‹xt
,&
x
,1);

309 '2': { 
x
 = 
	`va_¬g
(
v
,);

310 
b
[2];

311 
b
[0] = 
	`STBIW_UCHAR
(
x
);

312 
b
[1] = 
	`STBIW_UCHAR
(
x
>>8);

313 
s
->
	`func
(s->
cÚ‹xt
,
b
,2);

315 '4': { 
¡biw_ušt32
 
x
 = 
	`va_¬g
(
v
,);

316 
b
[4];

317 
b
[0]=
	`STBIW_UCHAR
(
x
);

318 
b
[1]=
	`STBIW_UCHAR
(
x
>>8);

319 
b
[2]=
	`STBIW_UCHAR
(
x
>>16);

320 
b
[3]=
	`STBIW_UCHAR
(
x
>>24);

321 
s
->
	`func
(s->
cÚ‹xt
,
b
,4);

324 
	`STBIW_ASSERT
(0);

328 
	}
}

330 
	$¡biw__wr™ef
(
¡bi__wr™e_cÚ‹xt
 *
s
, cÚ¡ *
fmt
, ...)

332 
va_li¡
 
v
;

333 
	`va_¡¬t
(
v
, 
fmt
);

334 
	`¡biw__wr™efv
(
s
, 
fmt
, 
v
);

335 
	`va_’d
(
v
);

336 
	}
}

338 
	$¡biw__putc
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
c
)

340 
s
->
	`func
(s->
cÚ‹xt
, &
c
, 1);

341 
	}
}

343 
	$¡biw__wr™e3
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
a
, 
b
, 
c
)

345 
¬r
[3];

346 
¬r
[0] = 
a
,‡¼[1] = 
b
,‡¼[2] = 
c
;

347 
s
->
	`func
(s->
cÚ‹xt
, 
¬r
, 3);

348 
	}
}

350 
	$¡biw__wr™e_pix–
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
rgb_dœ
, 
comp
, 
wr™e_®pha
, 
ex·nd_mÚo
, *
d
)

352 
bg
[3] = { 255, 0, 255}, 
px
[3];

353 
k
;

355 ià(
wr™e_®pha
 < 0)

356 
s
->
	`func
(s->
cÚ‹xt
, &
d
[
comp
 - 1], 1);

358 
comp
) {

361 ià(
ex·nd_mÚo
)

362 
	`¡biw__wr™e3
(
s
, 
d
[0], d[0], d[0]);

364 
s
->
	`func
(s->
cÚ‹xt
, 
d
, 1);

367 ià(!
wr™e_®pha
) {

369 
k
 = 0; k < 3; ++k)

370 
px
[
k
] = 
bg
[k] + ((
d
[k] - bg[k]) * d[3]) / 255;

371 
	`¡biw__wr™e3
(
s
, 
px
[1 - 
rgb_dœ
],…x[1],…x[1 +„gb_dir]);

376 
	`¡biw__wr™e3
(
s
, 
d
[1 - 
rgb_dœ
], d[1], d[1 +„gb_dir]);

379 ià(
wr™e_®pha
 > 0)

380 
s
->
	`func
(s->
cÚ‹xt
, &
d
[
comp
 - 1], 1);

381 
	}
}

383 
	$¡biw__wr™e_pix–s
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
rgb_dœ
, 
vdœ
, 
x
, 
y
, 
comp
, *
d©a
, 
wr™e_®pha
, 
sÿÆše_·d
, 
ex·nd_mÚo
)

385 
¡biw_ušt32
 
z”o
 = 0;

386 
i
,
j
, 
j_’d
;

388 ià(
y
 <= 0)

391 ià(
¡bi__æ_v”tiÿÎy_Ú_wr™e
)

392 
vdœ
 *= -1;

394 ià(
vdœ
 < 0)

395 
j_’d
 = -1, 
j
 = 
y
-1;

397 
j_’d
 = 
y
, 
j
 = 0;

399 ; 
j
 !ğ
j_’d
; j +ğ
vdœ
) {

400 
i
=0; i < 
x
; ++i) {

401 *
d
 = (*è
d©a
 + (
j
*
x
+
i
)*
comp
;

402 
	`¡biw__wr™e_pix–
(
s
, 
rgb_dœ
, 
comp
, 
wr™e_®pha
, 
ex·nd_mÚo
, 
d
);

404 
s
->
	`func
(s->
cÚ‹xt
, &
z”o
, 
sÿÆše_·d
);

406 
	}
}

408 
	$¡biw__outfe
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
rgb_dœ
, 
vdœ
, 
x
, 
y
, 
comp
, 
ex·nd_mÚo
, *
d©a
, 
®pha
, 
·d
, cÚ¡ *
fmt
, ...)

410 ià(
y
 < 0 || 
x
 < 0) {

413 
va_li¡
 
v
;

414 
	`va_¡¬t
(
v
, 
fmt
);

415 
	`¡biw__wr™efv
(
s
, 
fmt
, 
v
);

416 
	`va_’d
(
v
);

417 
	`¡biw__wr™e_pix–s
(
s
,
rgb_dœ
,
vdœ
,
x
,
y
,
comp
,
d©a
,
®pha
,
·d
, 
ex·nd_mÚo
);

420 
	}
}

422 
	$¡bi_wr™e_bmp_cÜe
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

424 
·d
 = (-
x
*3) & 3;

425  
	`¡biw__outfe
(
s
,-1,-1,
x
,
y
,
comp
,1,(*è
d©a
,0,
·d
,

427 'B', 'M', 14+40+(
x
*3+
·d
)*
y
, 0,0, 14+40,

428 40, 
x
,
y
, 1,24, 0,0,0,0,0,0);

429 
	}
}

431 
STBIWDEF
 
	$¡bi_wr™e_bmp_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

433 
¡bi__wr™e_cÚ‹xt
 
s
;

434 
	`¡bi__¡¬t_wr™e_ÿÎbacks
(&
s
, 
func
, 
cÚ‹xt
);

435  
	`¡bi_wr™e_bmp_cÜe
(&
s
, 
x
, 
y
, 
comp
, 
d©a
);

436 
	}
}

438 #iâdeà
STBI_WRITE_NO_STDIO


439 
STBIWDEF
 
	$¡bi_wr™e_bmp
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

441 
¡bi__wr™e_cÚ‹xt
 
s
;

442 ià(
	`¡bi__¡¬t_wr™e_fe
(&
s
,
f’ame
)) {

443 
r
 = 
	`¡bi_wr™e_bmp_cÜe
(&
s
, 
x
, 
y
, 
comp
, 
d©a
);

444 
	`¡bi__’d_wr™e_fe
(&
s
);

445  
r
;

448 
	}
}

451 
	$¡bi_wr™e_tga_cÜe
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
x
, 
y
, 
comp
, *
d©a
)

453 
has_®pha
 = (
comp
 == 2 || comp == 4);

454 
cŞÜby‹s
 = 
has_®pha
 ? 
comp
-1 : comp;

455 
fÜm©
 = 
cŞÜby‹s
 < 2 ? 3 : 2;

457 ià(
y
 < 0 || 
x
 < 0)

460 ià(!
¡bi_wr™e_tga_w™h_¾e
) {

461  
	`¡biw__outfe
(
s
, -1, -1, 
x
, 
y
, 
comp
, 0, (*è
d©a
, 
has_®pha
, 0,

462 "111 221 2222 11", 0, 0, 
fÜm©
, 0, 0, 0, 0, 0, 
x
, 
y
, (
cŞÜby‹s
 + 
has_®pha
) * 8, has_alpha * 8);

464 
i
,
j
,
k
;

465 
j’d
, 
jdœ
;

467 
	`¡biw__wr™ef
(
s
, "111 221 2222 11", 0,0,
fÜm©
+8, 0,0,0, 0,0,
x
,
y
, (
cŞÜby‹s
 + 
has_®pha
) * 8, has_alpha * 8);

469 ià(
¡bi__æ_v”tiÿÎy_Ú_wr™e
) {

470 
j
 = 0;

471 
j’d
 = 
y
;

472 
jdœ
 = 1;

474 
j
 = 
y
-1;

475 
j’d
 = -1;

476 
jdœ
 = -1;

478 ; 
j
 !ğ
j’d
; j +ğ
jdœ
) {

479 *
row
 = (*è
d©a
 + 
j
 * 
x
 * 
comp
;

480 
Ën
;

482 
i
 = 0; i < 
x
; i +ğ
Ën
) {

483 *
begš
 = 
row
 + 
i
 * 
comp
;

484 
diff
 = 1;

485 
Ën
 = 1;

487 ià(
i
 < 
x
 - 1) {

488 ++
Ën
;

489 
diff
 = 
	`memcmp
(
begš
, 
row
 + (
i
 + 1è* 
comp
, comp);

490 ià(
diff
) {

491 cÚ¡ *
´ev
 = 
begš
;

492 
k
 = 
i
 + 2; k < 
x
 && 
Ën
 < 128; ++k) {

493 ià(
	`memcmp
(
´ev
, 
row
 + 
k
 * 
comp
, comp)) {

494 
´ev
 +ğ
comp
;

495 ++
Ën
;

497 --
Ën
;

502 
k
 = 
i
 + 2; k < 
x
 && 
Ën
 < 128; ++k) {

503 ià(!
	`memcmp
(
begš
, 
row
 + 
k
 * 
comp
, comp)) {

504 ++
Ën
;

512 ià(
diff
) {

513 
h—d”
 = 
	`STBIW_UCHAR
(
Ën
 - 1);

514 
s
->
	`func
(s->
cÚ‹xt
, &
h—d”
, 1);

515 
k
 = 0; k < 
Ën
; ++k) {

516 
	`¡biw__wr™e_pix–
(
s
, -1, 
comp
, 
has_®pha
, 0, 
begš
 + 
k
 * comp);

519 
h—d”
 = 
	`STBIW_UCHAR
(
Ën
 - 129);

520 
s
->
	`func
(s->
cÚ‹xt
, &
h—d”
, 1);

521 
	`¡biw__wr™e_pix–
(
s
, -1, 
comp
, 
has_®pha
, 0, 
begš
);

527 
	}
}

529 
STBIWDEF
 
	$¡bi_wr™e_tga_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

531 
¡bi__wr™e_cÚ‹xt
 
s
;

532 
	`¡bi__¡¬t_wr™e_ÿÎbacks
(&
s
, 
func
, 
cÚ‹xt
);

533  
	`¡bi_wr™e_tga_cÜe
(&
s
, 
x
, 
y
, 
comp
, (*è
d©a
);

534 
	}
}

536 #iâdeà
STBI_WRITE_NO_STDIO


537 
STBIWDEF
 
	$¡bi_wr™e_tga
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

539 
¡bi__wr™e_cÚ‹xt
 
s
;

540 ià(
	`¡bi__¡¬t_wr™e_fe
(&
s
,
f’ame
)) {

541 
r
 = 
	`¡bi_wr™e_tga_cÜe
(&
s
, 
x
, 
y
, 
comp
, (*è
d©a
);

542 
	`¡bi__’d_wr™e_fe
(&
s
);

543  
r
;

546 
	}
}

553 
	#¡biw__max
(
a
, 
b
è(×è> (bè? (aè: (b))

	)

555 
	$¡biw__lš—r_to_rgbe
(*
rgbe
, *
lš—r
)

557 
expÚ’t
;

558 
maxcomp
 = 
	`¡biw__max
(
lš—r
[0], stbiw__max(linear[1],†inear[2]));

560 ià(
maxcomp
 < 1e-32f) {

561 
rgbe
[0] =„gbe[1] =„gbe[2] =„gbe[3] = 0;

563 
nÜm®ize
 = (è
	`äexp
(
maxcomp
, &
expÚ’t
) * 256.0f/maxcomp;

565 
rgbe
[0] = ()(
lš—r
[0] * 
nÜm®ize
);

566 
rgbe
[1] = ()(
lš—r
[1] * 
nÜm®ize
);

567 
rgbe
[2] = ()(
lš—r
[2] * 
nÜm®ize
);

568 
rgbe
[3] = ()(
expÚ’t
 + 128);

570 
	}
}

572 
	$¡biw__wr™e_run_d©a
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
Ëngth
, 
d©aby‹
)

574 
Ëngthby‹
 = 
	`STBIW_UCHAR
(
Ëngth
+128);

575 
	`STBIW_ASSERT
(
Ëngth
+128 <= 255);

576 
s
->
	`func
(s->
cÚ‹xt
, &
Ëngthby‹
, 1);

577 
s
->
	`func
(s->
cÚ‹xt
, &
d©aby‹
, 1);

578 
	}
}

580 
	$¡biw__wr™e_dump_d©a
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
Ëngth
, *
d©a
)

582 
Ëngthby‹
 = 
	`STBIW_UCHAR
(
Ëngth
);

583 
	`STBIW_ASSERT
(
Ëngth
 <= 128);

584 
s
->
	`func
(s->
cÚ‹xt
, &
Ëngthby‹
, 1);

585 
s
->
	`func
(s->
cÚ‹xt
, 
d©a
, 
Ëngth
);

586 
	}
}

588 
	$¡biw__wr™e_hdr_sÿÆše
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
width
, 
ncomp
, *
sü©ch
, *
sÿÆše
)

590 
sÿÆšeh—d”
[4] = { 2, 2, 0, 0 };

591 
rgbe
[4];

592 
lš—r
[3];

593 
x
;

595 
sÿÆšeh—d”
[2] = (
width
&0xff00)>>8;

596 
sÿÆšeh—d”
[3] = (
width
&0x00ff);

599 ià(
width
 < 8 || width >= 32768) {

600 
x
=0; x < 
width
; x++) {

601 
ncomp
) {

603 3: 
lš—r
[2] = 
sÿÆše
[
x
*
ncomp
 + 2];

604 
lš—r
[1] = 
sÿÆše
[
x
*
ncomp
 + 1];

605 
lš—r
[0] = 
sÿÆše
[
x
*
ncomp
 + 0];

608 
lš—r
[0] =†š—r[1] =†š—r[2] = 
sÿÆše
[
x
*
ncomp
 + 0];

611 
	`¡biw__lš—r_to_rgbe
(
rgbe
, 
lš—r
);

612 
s
->
	`func
(s->
cÚ‹xt
, 
rgbe
, 4);

615 
c
,
r
;

617 
x
=0; x < 
width
; x++) {

618 
ncomp
) {

620 3: 
lš—r
[2] = 
sÿÆše
[
x
*
ncomp
 + 2];

621 
lš—r
[1] = 
sÿÆše
[
x
*
ncomp
 + 1];

622 
lš—r
[0] = 
sÿÆše
[
x
*
ncomp
 + 0];

625 
lš—r
[0] =†š—r[1] =†š—r[2] = 
sÿÆše
[
x
*
ncomp
 + 0];

628 
	`¡biw__lš—r_to_rgbe
(
rgbe
, 
lš—r
);

629 
sü©ch
[
x
 + 
width
*0] = 
rgbe
[0];

630 
sü©ch
[
x
 + 
width
*1] = 
rgbe
[1];

631 
sü©ch
[
x
 + 
width
*2] = 
rgbe
[2];

632 
sü©ch
[
x
 + 
width
*3] = 
rgbe
[3];

635 
s
->
	`func
(s->
cÚ‹xt
, 
sÿÆšeh—d”
, 4);

638 
c
=0; c < 4; c++) {

639 *
comp
 = &
sü©ch
[
width
*
c
];

641 
x
 = 0;

642 
x
 < 
width
) {

644 
r
 = 
x
;

645 
r
+2 < 
width
) {

646 ià(
comp
[
r
] == comp[r+1] && comp[r] == comp[r+2])

648 ++
r
;

650 ià(
r
+2 >ğ
width
)

651 
r
 = 
width
;

653 
x
 < 
r
) {

654 
Ën
 = 
r
-
x
;

655 ià(
Ën
 > 128)†en = 128;

656 
	`¡biw__wr™e_dump_d©a
(
s
, 
Ën
, &
comp
[
x
]);

657 
x
 +ğ
Ën
;

660 ià(
r
+2 < 
width
) {

662 
r
 < 
width
 && 
comp
[r] =ğcomp[
x
])

663 ++
r
;

665 
x
 < 
r
) {

666 
Ën
 = 
r
-
x
;

667 ià(
Ën
 > 127)†en = 127;

668 
	`¡biw__wr™e_run_d©a
(
s
, 
Ën
, 
comp
[
x
]);

669 
x
 +ğ
Ën
;

675 
	}
}

677 
	$¡bi_wr™e_hdr_cÜe
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
x
, 
y
, 
comp
, *
d©a
)

679 ià(
y
 <ğ0 || 
x
 <ğ0 || 
d©a
 =ğ
NULL
)

683 *
sü©ch
 = (*è
	`STBIW_MALLOC
(
x
*4);

684 
i
, 
Ën
;

685 
bufãr
[128];

686 
h—d”
[] = "#?RADIANCE\n# Written by stb_image_write.h\nFORMAT=32-bit_rle_rgbe\n";

687 
s
->
	`func
(s->
cÚ‹xt
, 
h—d”
, (header)-1);

689 #ifdeà
STBI_MSC_SECURE_CRT


690 
Ën
 = 
	`¥rštf_s
(
bufãr
, "EXPOSUREğ 1.0000000000000\n\n-Y %d +X %d\n", 
y
, 
x
);

692 
Ën
 = 
	`¥rštf
(
bufãr
, "EXPOSUREğ 1.0000000000000\n\n-Y %d +X %d\n", 
y
, 
x
);

694 
s
->
	`func
(s->
cÚ‹xt
, 
bufãr
, 
Ën
);

696 
i
=0; i < 
y
; i++)

697 
	`¡biw__wr™e_hdr_sÿÆše
(
s
, 
x
, 
comp
, 
sü©ch
, 
d©a
 + comp*x*(
¡bi__æ_v”tiÿÎy_Ú_wr™e
 ? 
y
-1-
i
 : i)*x);

698 
	`STBIW_FREE
(
sü©ch
);

701 
	}
}

703 
STBIWDEF
 
	$¡bi_wr™e_hdr_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

705 
¡bi__wr™e_cÚ‹xt
 
s
;

706 
	`¡bi__¡¬t_wr™e_ÿÎbacks
(&
s
, 
func
, 
cÚ‹xt
);

707  
	`¡bi_wr™e_hdr_cÜe
(&
s
, 
x
, 
y
, 
comp
, (*è
d©a
);

708 
	}
}

710 #iâdeà
STBI_WRITE_NO_STDIO


711 
STBIWDEF
 
	$¡bi_wr™e_hdr
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

713 
¡bi__wr™e_cÚ‹xt
 
s
;

714 ià(
	`¡bi__¡¬t_wr™e_fe
(&
s
,
f’ame
)) {

715 
r
 = 
	`¡bi_wr™e_hdr_cÜe
(&
s
, 
x
, 
y
, 
comp
, (*è
d©a
);

716 
	`¡bi__’d_wr™e_fe
(&
s
);

717  
r
;

720 
	}
}

729 #iâdeà
STBIW_ZLIB_COMPRESS


731 
	#¡biw__sb¿w
(
a
è((*è×è- 2)

	)

732 
	#¡biw__sbm
(
a
è
	`¡biw__sb¿w
×)[0]

	)

733 
	#¡biw__sbn
(
a
è
	`¡biw__sb¿w
×)[1]

	)

735 
	#¡biw__sbÃedgrow
(
a
,
n
è(×)==0 || 
	`¡biw__sbn
×)+À>ğ
	`¡biw__sbm
×))

	)

736 
	#¡biw__sbmaybegrow
(
a
,
n
è(
	`¡biw__sbÃedgrow
×,Ò)è? 
	`¡biw__sbgrow
×,nè: 0)

	)

737 
	#¡biw__sbgrow
(
a
,
n
è
	`¡biw__sbgrowf
((**è&×), (n), (*×)))

	)

739 
	#¡biw__sbpush
(
a
, 
v
è(
	`¡biw__sbmaybegrow
×,1), (a)[
	`¡biw__sbn
×)++] = (v))

	)

740 
	#¡biw__sbcouÁ
(
a
è(×è? 
	`¡biw__sbn
×è: 0)

	)

741 
	#¡biw__sbä“
(
a
è(×è? 
	`STBIW_FREE
(
	`¡biw__sb¿w
×)),0 : 0)

	)

743 *
	$¡biw__sbgrowf
(**
¬r
, 
šüem’t
, 
™emsize
)

745 
m
 = *
¬r
 ? 2*
	`¡biw__sbm
(*¬r)+
šüem’t
 : increment+1;

746 *
p
 = 
	`STBIW_REALLOC_SIZED
(*
¬r
 ? 
	`¡biw__sb¿w
(*¬rè: 0, *¬¸? (
	`¡biw__sbm
(*¬r)*
™emsize
 + ()*2è: 0, i‹msiz* 
m
 + ()*2);

747 
	`STBIW_ASSERT
(
p
);

748 ià(
p
) {

749 ià(!*
¬r
è((*è
p
)[1] = 0;

750 *
¬r
 = (*è((*è
p
 + 2);

751 
	`¡biw__sbm
(*
¬r
èğ
m
;

753  *
¬r
;

754 
	}
}

756 *
	$¡biw__zlib_æushf
(*
d©a
, *
b™bufãr
, *
b™couÁ
)

758 *
b™couÁ
 >= 8) {

759 
	`¡biw__sbpush
(
d©a
, 
	`STBIW_UCHAR
(*
b™bufãr
));

760 *
b™bufãr
 >>= 8;

761 *
b™couÁ
 -= 8;

763  
d©a
;

764 
	}
}

766 
	$¡biw__zlib_b™»v
(
code
, 
codeb™s
)

768 
»s
=0;

769 
codeb™s
--) {

770 
»s
 = (» << 1è| (
code
 & 1);

771 
code
 >>= 1;

773  
»s
;

774 
	}
}

776 
	$¡biw__zlib_couÁm
(*
a
, *
b
, 
lim™
)

778 
i
;

779 
i
=0; i < 
lim™
 && i < 258; ++i)

780 ià(
a
[
i
] !ğ
b
[i]) ;

781  
i
;

782 
	}
}

784 
	$¡biw__zhash
(*
d©a
)

786 
¡biw_ušt32
 
hash
 = 
d©a
[0] + (data[1] << 8) + (data[2] << 16);

787 
hash
 ^= hash << 3;

788 
hash
 += hash >> 5;

789 
hash
 ^= hash << 4;

790 
hash
 += hash >> 17;

791 
hash
 ^= hash << 25;

792 
hash
 += hash >> 6;

793  
hash
;

794 
	}
}

796 
	#¡biw__zlib_æush
(è(
out
 = 
	`¡biw__zlib_æushf
(out, &
b™buf
, &
b™couÁ
))

	)

797 
	#¡biw__zlib_add
(
code
,
codeb™s
) \

798 (
b™buf
 |ğ(
code
è<< 
b™couÁ
, b™couÁ +ğ(
codeb™s
), 
	`¡biw__zlib_æush
())

	)

799 
	#¡biw__zlib_hufç
(
b
,
c
è
	`¡biw__zlib_add
(
	`¡biw__zlib_b™»v
(b,c),c)

	)

801 
	#¡biw__zlib_huff1
(
n
è
	`¡biw__zlib_hufç
(0x30 + (n), 8)

	)

802 
	#¡biw__zlib_huff2
(
n
è
	`¡biw__zlib_hufç
(0x190 + (n)-144, 9)

	)

803 
	#¡biw__zlib_huff3
(
n
è
	`¡biw__zlib_hufç
(0 + (n)-256,7)

	)

804 
	#¡biw__zlib_huff4
(
n
è
	`¡biw__zlib_hufç
(0xc0 + (n)-280,8)

	)

805 
	#¡biw__zlib_huff
(
n
è(Òè<ğ143 ? 
	`¡biw__zlib_huff1
Òè: (nè<ğ255 ? 
	`¡biw__zlib_huff2
Òè: (nè<ğ279 ? 
	`¡biw__zlib_huff3
Òè: 
	`¡biw__zlib_huff4
Ò))

	)

806 
	#¡biw__zlib_huffb
(
n
è(Òè<ğ143 ? 
	`¡biw__zlib_huff1
Òè: 
	`¡biw__zlib_huff2
Ò))

	)

808 
	#¡biw__ZHASH
 16384

	)

812 * 
	$¡bi_zlib_com´ess
(*
d©a
, 
d©a_Ën
, *
out_Ën
, 
qu®™y
)

814 #ifdeà
STBIW_ZLIB_COMPRESS


816  
	`STBIW_ZLIB_COMPRESS
(
d©a
, 
d©a_Ën
, 
out_Ën
, 
qu®™y
);

818 
Ëngthc
[] = { 3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258, 259 };

819 
Ëngtheb
[]= { 0,0,0,0,0,0,0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0 };

820 
di¡c
[] = { 1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577, 32768 };

821 
di¡eb
[] = { 0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13 };

822 
b™buf
=0;

823 
i
,
j
, 
b™couÁ
=0;

824 *
out
 = 
NULL
;

825 ***
hash_bË
 = (***è
	`STBIW_MALLOC
(
¡biw__ZHASH
 * (**));

826 ià(
hash_bË
 =ğ
NULL
)

827  
NULL
;

828 ià(
qu®™y
 < 5) quality = 5;

830 
	`¡biw__sbpush
(
out
, 0x78);

831 
	`¡biw__sbpush
(
out
, 0x5e);

832 
	`¡biw__zlib_add
(1,1);

833 
	`¡biw__zlib_add
(1,2);

835 
i
=0; i < 
¡biw__ZHASH
; ++i)

836 
hash_bË
[
i
] = 
NULL
;

838 
i
=0;

839 
i
 < 
d©a_Ën
-3) {

841 
h
 = 
	`¡biw__zhash
(
d©a
+
i
)&(
¡biw__ZHASH
-1), 
be¡
=3;

842 *
be¡loc
 = 0;

843 **
hli¡
 = 
hash_bË
[
h
];

844 
n
 = 
	`¡biw__sbcouÁ
(
hli¡
);

845 
j
=0; j < 
n
; ++j) {

846 ià(
hli¡
[
j
]-
d©a
 > 
i
-32768) {

847 
d
 = 
	`¡biw__zlib_couÁm
(
hli¡
[
j
], 
d©a
+
i
, 
d©a_Ën
-i);

848 ià(
d
 >ğ
be¡
èbe¡=d,
be¡loc
=
hli¡
[
j
];

852 ià(
hash_bË
[
h
] && 
	`¡biw__sbn
(hash_bË[h]è=ğ2*
qu®™y
) {

853 
	`STBIW_MEMMOVE
(
hash_bË
[
h
], hash_bË[h]+
qu®™y
, (hash_table[h][0])*quality);

854 
	`¡biw__sbn
(
hash_bË
[
h
]èğ
qu®™y
;

856 
	`¡biw__sbpush
(
hash_bË
[
h
],
d©a
+
i
);

858 ià(
be¡loc
) {

860 
h
 = 
	`¡biw__zhash
(
d©a
+
i
+1)&(
¡biw__ZHASH
-1);

861 
hli¡
 = 
hash_bË
[
h
];

862 
n
 = 
	`¡biw__sbcouÁ
(
hli¡
);

863 
j
=0; j < 
n
; ++j) {

864 ià(
hli¡
[
j
]-
d©a
 > 
i
-32767) {

865 
e
 = 
	`¡biw__zlib_couÁm
(
hli¡
[
j
], 
d©a
+
i
+1, 
d©a_Ën
-i-1);

866 ià(
e
 > 
be¡
) {

867 
be¡loc
 = 
NULL
;

874 ià(
be¡loc
) {

875 
d
 = (è(
d©a
+
i
 - 
be¡loc
);

876 
	`STBIW_ASSERT
(
d
 <ğ32767 && 
be¡
 <= 258);

877 
j
=0; 
be¡
 > 
Ëngthc
[j+1]-1; ++j);

878 
	`¡biw__zlib_huff
(
j
+257);

879 ià(
Ëngtheb
[
j
]è
	`¡biw__zlib_add
(
be¡
 - 
Ëngthc
[j],†engtheb[j]);

880 
j
=0; 
d
 > 
di¡c
[j+1]-1; ++j);

881 
	`¡biw__zlib_add
(
	`¡biw__zlib_b™»v
(
j
,5),5);

882 ià(
di¡eb
[
j
]è
	`¡biw__zlib_add
(
d
 - 
di¡c
[j], disteb[j]);

883 
i
 +ğ
be¡
;

885 
	`¡biw__zlib_huffb
(
d©a
[
i
]);

886 ++
i
;

890 ;
i
 < 
d©a_Ën
; ++i)

891 
	`¡biw__zlib_huffb
(
d©a
[
i
]);

892 
	`¡biw__zlib_huff
(256);

894 
b™couÁ
)

895 
	`¡biw__zlib_add
(0,1);

897 
i
=0; i < 
¡biw__ZHASH
; ++i)

898 (è
	`¡biw__sbä“
(
hash_bË
[
i
]);

899 
	`STBIW_FREE
(
hash_bË
);

903 
s1
=1, 
s2
=0;

904 
blockËn
 = (è(
d©a_Ën
 % 5552);

905 
j
=0;

906 
j
 < 
d©a_Ën
) {

907 
i
=0; i < 
blockËn
; ++iè
s1
 +ğ
d©a
[
j
+i], 
s2
 += s1;

908 
s1
 %ğ65521, 
s2
 %= 65521;

909 
j
 +ğ
blockËn
;

910 
blockËn
 = 5552;

912 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(
s2
 >> 8));

913 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(
s2
));

914 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(
s1
 >> 8));

915 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(
s1
));

917 *
out_Ën
 = 
	`¡biw__sbn
(
out
);

919 
	`STBIW_MEMMOVE
(
	`¡biw__sb¿w
(
out
), out, *
out_Ën
);

920  (*è
	`¡biw__sb¿w
(
out
);

922 
	}
}

924 
	$¡biw__üc32
(*
bufãr
, 
Ën
)

926 
üc_bË
[256] =

962 
üc
 = ~0u;

963 
i
;

964 
i
=0; i < 
Ën
; ++i)

965 
üc
 = (üø>> 8è^ 
üc_bË
[
bufãr
[
i
] ^ (crc & 0xff)];

966  ~
üc
;

967 
	}
}

969 
	#¡biw__w²g4
(
o
,
a
,
b
,
c
,
d
è((o)[0]=
	`STBIW_UCHAR
×),(o)[1]=STBIW_UCHAR(b),(o)[2]=STBIW_UCHAR(c),(o)[3]=STBIW_UCHAR(d),(o)+=4)

	)

970 
	#¡biw__wp32
(
d©a
,
v
è
	`¡biw__w²g4
(d©a, (v)>>24,(v)>>16,(v)>>8,(v));

	)

971 
	#¡biw__w±ag
(
d©a
,
s
è
	`¡biw__w²g4
(d©a, s[0],s[1],s[2],s[3])

	)

973 
	$¡biw__wpüc
(**
d©a
, 
Ën
)

975 
üc
 = 
	`¡biw__üc32
(*
d©a
 - 
Ën
 - 4,†en+4);

976 
	`¡biw__wp32
(*
d©a
, 
üc
);

977 
	}
}

979 
	$¡biw__·‘h
(
a
, 
b
, 
c
)

981 
p
 = 
a
 + 
b
 - 
c
, 
·
 = 
	`abs
Õ-a), 
pb
 =‡bsÕ-b), 
pc
 =‡bs(p-c);

982 ià(
·
 <ğ
pb
 &&…¨<ğ
pc
è 
	`STBIW_UCHAR
(
a
);

983 ià(
pb
 <ğ
pc
è 
	`STBIW_UCHAR
(
b
);

984  
	`STBIW_UCHAR
(
c
);

985 
	}
}

988 
	$¡biw__’code_²g_lše
(*
pix–s
, 
¡ride_by‹s
, 
width
, 
height
, 
y
, 
n
, 
f‹r_ty³
, sigÃd *
lše_bufãr
)

990 
m­pšg
[] = { 0,1,2,3,4 };

991 
fœ¡m­
[] = { 0,1,0,5,6 };

992 *
mym­
 = (
y
 !ğ0è? 
m­pšg
 : 
fœ¡m­
;

993 
i
;

994 
ty³
 = 
mym­
[
f‹r_ty³
];

995 *
z
 = 
pix–s
 + 
¡ride_by‹s
 * (
¡bi__æ_v”tiÿÎy_Ú_wr™e
 ? 
height
-1-
y
 : y);

996 
sigÃd_¡ride
 = 
¡bi__æ_v”tiÿÎy_Ú_wr™e
 ? -
¡ride_by‹s
 : stride_bytes;

997 
i
 = 0; i < 
n
; ++i) {

998 
ty³
) {

999 0: 
lše_bufãr
[
i
] = 
z
[i]; ;

1000 1: 
lše_bufãr
[
i
] = 
z
[i]; ;

1001 2: 
lše_bufãr
[
i
] = 
z
[i] - z[i-
sigÃd_¡ride
]; ;

1002 3: 
lše_bufãr
[
i
] = 
z
[i] - (z[i-
sigÃd_¡ride
]>>1); ;

1003 4: 
lše_bufãr
[
i
] = (sigÃd è(
z
[i] - 
	`¡biw__·‘h
(0,z[i-
sigÃd_¡ride
],0)); ;

1004 5: 
lše_bufãr
[
i
] = 
z
[i]; ;

1005 6: 
lše_bufãr
[
i
] = 
z
[i]; ;

1008 
i
=
n
; i < 
width
*n; ++i) {

1009 
ty³
) {

1010 0: 
lše_bufãr
[
i
] = 
z
[i]; ;

1011 1: 
lše_bufãr
[
i
] = 
z
[i] - z[i-
n
]; ;

1012 2: 
lše_bufãr
[
i
] = 
z
[i] - z[i-
sigÃd_¡ride
]; ;

1013 3: 
lše_bufãr
[
i
] = 
z
[i] - ((z[i-
n
] + z[i-
sigÃd_¡ride
])>>1); ;

1014 4: 
lše_bufãr
[
i
] = 
z
[i] - 
	`¡biw__·‘h
(z[i-
n
], z[i-
sigÃd_¡ride
], z[i-signed_stride-n]); ;

1015 5: 
lše_bufãr
[
i
] = 
z
[i] - (z[i-
n
]>>1); ;

1016 6: 
lše_bufãr
[
i
] = 
z
[i] - 
	`¡biw__·‘h
(z[i-
n
], 0,0); ;

1019 
	}
}

1021 *
	$¡bi_wr™e_²g_to_mem
(*
pix–s
, 
¡ride_by‹s
, 
x
, 
y
, 
n
, *
out_Ën
)

1023 
fÜû_f‹r
 = 
¡bi_wr™e_fÜû_²g_f‹r
;

1024 
ùy³
[5] = { -1, 0, 4, 2, 6 };

1025 
sig
[8] = { 137,80,78,71,13,10,26,10 };

1026 *
out
,*
o
, *
ft
, *
zlib
;

1027 sigÃd *
lše_bufãr
;

1028 
j
,
zËn
;

1030 ià(
¡ride_by‹s
 == 0)

1031 
¡ride_by‹s
 = 
x
 * 
n
;

1033 ià(
fÜû_f‹r
 >= 5) {

1034 
fÜû_f‹r
 = -1;

1037 
ft
 = (*è
	`STBIW_MALLOC
((
x
*
n
+1è* 
y
); if (!filt)  0;

1038 
lše_bufãr
 = (sigÃd *è
	`STBIW_MALLOC
(
x
 * 
n
); ià(!lše_bufãrè{ 
	`STBIW_FREE
(
ft
);  0; }

1039 
j
=0; j < 
y
; ++j) {

1040 
f‹r_ty³
;

1041 ià(
fÜû_f‹r
 > -1) {

1042 
f‹r_ty³
 = 
fÜû_f‹r
;

1043 
	`¡biw__’code_²g_lše
(
pix–s
, 
¡ride_by‹s
, 
x
, 
y
, 
j
, 
n
, 
fÜû_f‹r
, 
lše_bufãr
);

1045 
be¡_f‹r
 = 0, 
be¡_f‹r_v®
 = 0x7fffffff, 
e¡
, 
i
;

1046 
f‹r_ty³
 = 0; filter_type < 5; filter_type++) {

1047 
	`¡biw__’code_²g_lše
(
pix–s
, 
¡ride_by‹s
, 
x
, 
y
, 
j
, 
n
, 
f‹r_ty³
, 
lše_bufãr
);

1050 
e¡
 = 0;

1051 
i
 = 0; i < 
x
*
n
; ++i) {

1052 
e¡
 +ğ
	`abs
((sigÃd è
lše_bufãr
[
i
]);

1054 ià(
e¡
 < 
be¡_f‹r_v®
) {

1055 
be¡_f‹r_v®
 = 
e¡
;

1056 
be¡_f‹r
 = 
f‹r_ty³
;

1059 ià(
f‹r_ty³
 !ğ
be¡_f‹r
) {

1060 
	`¡biw__’code_²g_lše
(
pix–s
, 
¡ride_by‹s
, 
x
, 
y
, 
j
, 
n
, 
be¡_f‹r
, 
lše_bufãr
);

1061 
f‹r_ty³
 = 
be¡_f‹r
;

1065 
ft
[
j
*(
x
*
n
+1)] = (è
f‹r_ty³
;

1066 
	`STBIW_MEMMOVE
(
ft
+
j
*(
x
*
n
+1)+1, 
lše_bufãr
, x*n);

1068 
	`STBIW_FREE
(
lše_bufãr
);

1069 
zlib
 = 
	`¡bi_zlib_com´ess
(
ft
, 
y
*Ğ
x
*
n
+1), &
zËn
, 
¡bi_wr™e_²g_com´essiÚ_Ëv–
);

1070 
	`STBIW_FREE
(
ft
);

1071 ià(!
zlib
)  0;

1074 
out
 = (*è
	`STBIW_MALLOC
(8 + 12+13 + 12+
zËn
 + 12);

1075 ià(!
out
)  0;

1076 *
out_Ën
 = 8 + 12+13 + 12+
zËn
 + 12;

1078 
o
=
out
;

1079 
	`STBIW_MEMMOVE
(
o
,
sig
,8); o+= 8;

1080 
	`¡biw__wp32
(
o
, 13);

1081 
	`¡biw__w±ag
(
o
, "IHDR");

1082 
	`¡biw__wp32
(
o
, 
x
);

1083 
	`¡biw__wp32
(
o
, 
y
);

1084 *
o
++ = 8;

1085 *
o
++ = 
	`STBIW_UCHAR
(
ùy³
[
n
]);

1086 *
o
++ = 0;

1087 *
o
++ = 0;

1088 *
o
++ = 0;

1089 
	`¡biw__wpüc
(&
o
,13);

1091 
	`¡biw__wp32
(
o
, 
zËn
);

1092 
	`¡biw__w±ag
(
o
, "IDAT");

1093 
	`STBIW_MEMMOVE
(
o
, 
zlib
, 
zËn
);

1094 
o
 +ğ
zËn
;

1095 
	`STBIW_FREE
(
zlib
);

1096 
	`¡biw__wpüc
(&
o
, 
zËn
);

1098 
	`¡biw__wp32
(
o
,0);

1099 
	`¡biw__w±ag
(
o
, "IEND");

1100 
	`¡biw__wpüc
(&
o
,0);

1102 
	`STBIW_ASSERT
(
o
 =ğ
out
 + *
out_Ën
);

1104  
out
;

1105 
	}
}

1107 #iâdeà
STBI_WRITE_NO_STDIO


1108 
STBIWDEF
 
	$¡bi_wr™e_²g
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
¡ride_by‹s
)

1110 
FILE
 *
f
;

1111 
Ën
;

1112 *
²g
 = 
	`¡bi_wr™e_²g_to_mem
((*è
d©a
, 
¡ride_by‹s
, 
x
, 
y
, 
comp
, &
Ën
);

1113 ià(
²g
 =ğ
NULL
)  0;

1114 #ifdeà
STBI_MSC_SECURE_CRT


1115 ià(
	`fİ’_s
(&
f
, 
f’ame
, "wb"))

1116 
f
 = 
NULL
;

1118 
f
 = 
	`fİ’
(
f’ame
, "wb");

1120 ià(!
f
è{ 
	`STBIW_FREE
(
²g
);  0; }

1121 
	`fwr™e
(
²g
, 1, 
Ën
, 
f
);

1122 
	`fşo£
(
f
);

1123 
	`STBIW_FREE
(
²g
);

1125 
	}
}

1128 
STBIWDEF
 
	$¡bi_wr™e_²g_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
¡ride_by‹s
)

1130 
Ën
;

1131 *
²g
 = 
	`¡bi_wr™e_²g_to_mem
((*è
d©a
, 
¡ride_by‹s
, 
x
, 
y
, 
comp
, &
Ën
);

1132 ià(
²g
 =ğ
NULL
)  0;

1133 
	`func
(
cÚ‹xt
, 
²g
, 
Ën
);

1134 
	`STBIW_FREE
(
²g
);

1136 
	}
}

1147 cÚ¡ 
	g¡biw__jpg_ZigZag
[] = { 0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,

1150 
	$¡biw__jpg_wr™eB™s
(
¡bi__wr™e_cÚ‹xt
 *
s
, *
b™BufP
, *
b™CÁP
, cÚ¡ *
bs
) {

1151 
b™Buf
 = *
b™BufP
, 
b™CÁ
 = *
b™CÁP
;

1152 
b™CÁ
 +ğ
bs
[1];

1153 
b™Buf
 |ğ
bs
[0] << (24 - 
b™CÁ
);

1154 
b™CÁ
 >= 8) {

1155 
c
 = (
b™Buf
 >> 16) & 255;

1156 
	`¡biw__putc
(
s
, 
c
);

1157 if(
c
 == 255) {

1158 
	`¡biw__putc
(
s
, 0);

1160 
b™Buf
 <<= 8;

1161 
b™CÁ
 -= 8;

1163 *
b™BufP
 = 
b™Buf
;

1164 *
b™CÁP
 = 
b™CÁ
;

1165 
	}
}

1167 
	$¡biw__jpg_DCT
(*
d0p
, *
d1p
, *
d2p
, *
d3p
, *
d4p
, *
d5p
, *
d6p
, *
d7p
) {

1168 
d0
 = *
d0p
, 
d1
 = *
d1p
, 
d2
 = *
d2p
, 
d3
 = *
d3p
, 
d4
 = *
d4p
, 
d5
 = *
d5p
, 
d6
 = *
d6p
, 
d7
 = *
d7p
;

1169 
z1
, 
z2
, 
z3
, 
z4
, 
z5
, 
z11
, 
z13
;

1171 
tmp0
 = 
d0
 + 
d7
;

1172 
tmp7
 = 
d0
 - 
d7
;

1173 
tmp1
 = 
d1
 + 
d6
;

1174 
tmp6
 = 
d1
 - 
d6
;

1175 
tmp2
 = 
d2
 + 
d5
;

1176 
tmp5
 = 
d2
 - 
d5
;

1177 
tmp3
 = 
d3
 + 
d4
;

1178 
tmp4
 = 
d3
 - 
d4
;

1181 
tmp10
 = 
tmp0
 + 
tmp3
;

1182 
tmp13
 = 
tmp0
 - 
tmp3
;

1183 
tmp11
 = 
tmp1
 + 
tmp2
;

1184 
tmp12
 = 
tmp1
 - 
tmp2
;

1186 
d0
 = 
tmp10
 + 
tmp11
;

1187 
d4
 = 
tmp10
 - 
tmp11
;

1189 
z1
 = (
tmp12
 + 
tmp13
) * 0.707106781f;

1190 
d2
 = 
tmp13
 + 
z1
;

1191 
d6
 = 
tmp13
 - 
z1
;

1194 
tmp10
 = 
tmp4
 + 
tmp5
;

1195 
tmp11
 = 
tmp5
 + 
tmp6
;

1196 
tmp12
 = 
tmp6
 + 
tmp7
;

1199 
z5
 = (
tmp10
 - 
tmp12
) * 0.382683433f;

1200 
z2
 = 
tmp10
 * 0.541196100à+ 
z5
;

1201 
z4
 = 
tmp12
 * 1.306562965à+ 
z5
;

1202 
z3
 = 
tmp11
 * 0.707106781f;

1204 
z11
 = 
tmp7
 + 
z3
;

1205 
z13
 = 
tmp7
 - 
z3
;

1207 *
d5p
 = 
z13
 + 
z2
;

1208 *
d3p
 = 
z13
 - 
z2
;

1209 *
d1p
 = 
z11
 + 
z4
;

1210 *
d7p
 = 
z11
 - 
z4
;

1212 *
d0p
 = 
d0
; *
d2p
 = 
d2
; *
d4p
 = 
d4
; *
d6p
 = 
d6
;

1213 
	}
}

1215 
	$¡biw__jpg_ÿlcB™s
(
v®
, 
b™s
[2]) {

1216 
tmp1
 = 
v®
 < 0 ? -val : val;

1217 
v®
 = val < 0 ? val-1 : val;

1218 
b™s
[1] = 1;

1219 
tmp1
 >>= 1) {

1220 ++
b™s
[1];

1222 
b™s
[0] = 
v®
 & ((1<<bits[1])-1);

1223 
	}
}

1225 
	$¡biw__jpg_´oûssDU
(
¡bi__wr™e_cÚ‹xt
 *
s
, *
b™Buf
, *
b™CÁ
, *
CDU
, *
fdtbl
, 
DC
, cÚ¡ 
HTDC
[256][2], cÚ¡ 
HTAC
[256][2]) {

1226 cÚ¡ 
EOB
[2] = { 
HTAC
[0x00][0], HTAC[0x00][1] };

1227 cÚ¡ 
M16z”Ûs
[2] = { 
HTAC
[0xF0][0], HTAC[0xF0][1] };

1228 
d©aOff
, 
i
, 
diff
, 
’d0pos
;

1229 
DU
[64];

1232 
d©aOff
=0; dataOff<64; dataOff+=8) {

1233 
	`¡biw__jpg_DCT
(&
CDU
[
d©aOff
], &CDU[dataOff+1], &CDU[dataOff+2], &CDU[dataOff+3], &CDU[dataOff+4], &CDU[dataOff+5], &CDU[dataOff+6], &CDU[dataOff+7]);

1236 
d©aOff
=0; dataOff<8; ++dataOff) {

1237 
	`¡biw__jpg_DCT
(&
CDU
[
d©aOff
], &CDU[dataOff+8], &CDU[dataOff+16], &CDU[dataOff+24], &CDU[dataOff+32], &CDU[dataOff+40], &CDU[dataOff+48], &CDU[dataOff+56]);

1240 
i
=0; i<64; ++i) {

1241 
v
 = 
CDU
[
i
]*
fdtbl
[i];

1244 
DU
[
¡biw__jpg_ZigZag
[
i
]] = ()(
v
 < 0 ? v - 0.5f : v + 0.5f);

1248 
diff
 = 
DU
[0] - 
DC
;

1249 ià(
diff
 == 0) {

1250 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
HTDC
[0]);

1252 
b™s
[2];

1253 
	`¡biw__jpg_ÿlcB™s
(
diff
, 
b™s
);

1254 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
HTDC
[
b™s
[1]]);

1255 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
b™s
);

1258 
’d0pos
 = 63;

1259 ; (
’d0pos
>0)&&(
DU
[end0pos]==0); --end0pos) {

1262 if(
’d0pos
 == 0) {

1263 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
EOB
);

1264  
DU
[0];

1266 
i
 = 1; i <ğ
’d0pos
; ++i) {

1267 
¡¬os
 = 
i
;

1268 
Äz”Ûs
;

1269 
b™s
[2];

1270 ; 
DU
[
i
]==0 && i<=
’d0pos
; ++i) {

1272 
Äz”Ûs
 = 
i
-
¡¬os
;

1273 iàĞ
Äz”Ûs
 >= 16 ) {

1274 
Êg
 = 
Äz”Ûs
>>4;

1275 
Äm¬k”
;

1276 
Äm¬k”
=1;‚rm¬k” <ğ
Êg
; ++nrmarker)

1277 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
M16z”Ûs
);

1278 
Äz”Ûs
 &= 15;

1280 
	`¡biw__jpg_ÿlcB™s
(
DU
[
i
], 
b™s
);

1281 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
HTAC
[(
Äz”Ûs
<<4)+
b™s
[1]]);

1282 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
b™s
);

1284 if(
’d0pos
 != 63) {

1285 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
EOB
);

1287  
DU
[0];

1288 
	}
}

1290 
	$¡bi_wr™e_jpg_cÜe
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
width
, 
height
, 
comp
, cÚ¡ * 
d©a
, 
qu®™y
) {

1292 cÚ¡ 
¡d_dc_lumšªû_Äcodes
[] = {0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0};

1293 cÚ¡ 
¡d_dc_lumšªû_v®ues
[] = {0,1,2,3,4,5,6,7,8,9,10,11};

1294 cÚ¡ 
¡d_ac_lumšªû_Äcodes
[] = {0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,0x7d};

1295 cÚ¡ 
¡d_ac_lumšªû_v®ues
[] = {

1304 cÚ¡ 
¡d_dc_chromšªû_Äcodes
[] = {0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0};

1305 cÚ¡ 
¡d_dc_chromšªû_v®ues
[] = {0,1,2,3,4,5,6,7,8,9,10,11};

1306 cÚ¡ 
¡d_ac_chromšªû_Äcodes
[] = {0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,0x77};

1307 cÚ¡ 
¡d_ac_chromšªû_v®ues
[] = {

1317 cÚ¡ 
YDC_HT
[256][2] = { {0,2},{2,3},{3,3},{4,3},{5,3},{6,3},{14,4},{30,5},{62,6},{126,7},{254,8},{510,9}};

1318 cÚ¡ 
UVDC_HT
[256][2] = { {0,2},{1,2},{2,2},{6,3},{14,4},{30,5},{62,6},{126,7},{254,8},{510,9},{1022,10},{2046,11}};

1319 cÚ¡ 
YAC_HT
[256][2] = {

1337 cÚ¡ 
UVAC_HT
[256][2] = {

1355 cÚ¡ 
YQT
[] = {16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,

1357 cÚ¡ 
UVQT
[] = {17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,

1359 cÚ¡ 
¯sf
[] = { 1.0f * 2.828427125f, 1.387039845f * 2.828427125f, 1.306562965f * 2.828427125f, 1.175875602f * 2.828427125f,

1362 
row
, 
cŞ
, 
i
, 
k
;

1363 
fdtbl_Y
[64], 
fdtbl_UV
[64];

1364 
YTabË
[64], 
UVTabË
[64];

1366 if(!
d©a
 || !
width
 || !
height
 || 
comp
 > 4 || comp < 1) {

1370 
qu®™y
 = quality ? quality : 90;

1371 
qu®™y
 = quality < 1 ? 1 : quality > 100 ? 100 : quality;

1372 
qu®™y
 = quality < 50 ? 5000 / quality : 200 - quality * 2;

1374 
i
 = 0; i < 64; ++i) {

1375 
uvti
, 
yti
 = (
YQT
[
i
]*
qu®™y
+50)/100;

1376 
YTabË
[
¡biw__jpg_ZigZag
[
i
]] = (è(
yti
 < 1 ? 1 : yti > 255 ? 255 : yti);

1377 
uvti
 = (
UVQT
[
i
]*
qu®™y
+50)/100;

1378 
UVTabË
[
¡biw__jpg_ZigZag
[
i
]] = (è(
uvti
 < 1 ? 1 : uvti > 255 ? 255 : uvti);

1381 
row
 = 0, 
k
 = 0;„ow < 8; ++row) {

1382 
cŞ
 = 0; cŞ < 8; ++cŞ, ++
k
) {

1383 
fdtbl_Y
[
k
] = 1 / (
YTabË
 [
¡biw__jpg_ZigZag
[k]] * 
¯sf
[
row
] *‡asf[
cŞ
]);

1384 
fdtbl_UV
[
k
] = 1 / (
UVTabË
[
¡biw__jpg_ZigZag
[k]] * 
¯sf
[
row
] *‡asf[
cŞ
]);

1390 cÚ¡ 
h—d0
[] = { 0xFF,0xD8,0xFF,0xE0,0,0x10,'J','F','I','F',0,1,1,0,0,1,0,1,0,0,0xFF,0xDB,0,0x84,0 };

1391 cÚ¡ 
h—d2
[] = { 0xFF,0xDA,0,0xC,3,1,0,2,0x11,3,0x11,0,0x3F,0 };

1392 cÚ¡ 
h—d1
[] = { 0xFF,0xC0,0,0x11,8,()(
height
>>8),
	`STBIW_UCHAR
(height),()(
width
>>8),STBIW_UCHAR(width),

1394 
s
->
	`func
(s->
cÚ‹xt
, (*)
h—d0
, (head0));

1395 
s
->
	`func
(s->
cÚ‹xt
, (*)
YTabË
, (YTable));

1396 
	`¡biw__putc
(
s
, 1);

1397 
s
->
	`func
(s->
cÚ‹xt
, 
UVTabË
, (UVTable));

1398 
s
->
	`func
(s->
cÚ‹xt
, (*)
h—d1
, (head1));

1399 
s
->
	`func
(s->
cÚ‹xt
, (*)(
¡d_dc_lumšªû_Äcodes
+1), (std_dc_luminance_nrcodes)-1);

1400 
s
->
	`func
(s->
cÚ‹xt
, (*)
¡d_dc_lumšªû_v®ues
, (std_dc_luminance_values));

1401 
	`¡biw__putc
(
s
, 0x10);

1402 
s
->
	`func
(s->
cÚ‹xt
, (*)(
¡d_ac_lumšªû_Äcodes
+1), (std_ac_luminance_nrcodes)-1);

1403 
s
->
	`func
(s->
cÚ‹xt
, (*)
¡d_ac_lumšªû_v®ues
, (std_ac_luminance_values));

1404 
	`¡biw__putc
(
s
, 1);

1405 
s
->
	`func
(s->
cÚ‹xt
, (*)(
¡d_dc_chromšªû_Äcodes
+1), (std_dc_chrominance_nrcodes)-1);

1406 
s
->
	`func
(s->
cÚ‹xt
, (*)
¡d_dc_chromšªû_v®ues
, (std_dc_chrominance_values));

1407 
	`¡biw__putc
(
s
, 0x11);

1408 
s
->
	`func
(s->
cÚ‹xt
, (*)(
¡d_ac_chromšªû_Äcodes
+1), (std_ac_chrominance_nrcodes)-1);

1409 
s
->
	`func
(s->
cÚ‹xt
, (*)
¡d_ac_chromšªû_v®ues
, (std_ac_chrominance_values));

1410 
s
->
	`func
(s->
cÚ‹xt
, (*)
h—d2
, (head2));

1415 cÚ¡ 
flB™s
[] = {0x7F, 7};

1416 cÚ¡ *
imageD©a
 = (cÚ¡ *)
d©a
;

1417 
DCY
=0, 
DCU
=0, 
DCV
=0;

1418 
b™Buf
=0, 
b™CÁ
=0;

1420 
ofsG
 = 
comp
 > 2 ? 1 : 0, 
ofsB
 = comp > 2 ? 2 : 0;

1421 
x
, 
y
, 
pos
;

1422 
y
 = 0; y < 
height
; y += 8) {

1423 
x
 = 0; x < 
width
; x += 8) {

1424 
YDU
[64], 
UDU
[64], 
VDU
[64];

1425 
row
 = 
y
, 
pos
 = 0;„ow < y+8; ++row) {

1426 
cŞ
 = 
x
; cŞ < x+8; ++cŞ, ++
pos
) {

1427 
p
 = (
¡bi__æ_v”tiÿÎy_Ú_wr™e
 ? 
height
-1-
row
 :„ow)*
width
*
comp
 + 
cŞ
*comp;

1428 
r
, 
g
, 
b
;

1429 if(
row
 >ğ
height
) {

1430 
p
 -ğ
width
*
comp
*(
row
+1 - 
height
);

1432 if(
cŞ
 >ğ
width
) {

1433 
p
 -ğ
comp
*(
cŞ
+1 - 
width
);

1436 
r
 = 
imageD©a
[
p
+0];

1437 
g
 = 
imageD©a
[
p
+
ofsG
];

1438 
b
 = 
imageD©a
[
p
+
ofsB
];

1439 
YDU
[
pos
]=+0.29900f*
r
+0.58700f*
g
+0.11400f*
b
-128;

1440 
UDU
[
pos
]=-0.16874f*
r
-0.33126f*
g
+0.50000f*
b
;

1441 
VDU
[
pos
]=+0.50000f*
r
-0.41869f*
g
-0.08131f*
b
;

1445 
DCY
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
YDU
, 
fdtbl_Y
, DCY, 
YDC_HT
, 
YAC_HT
);

1446 
DCU
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
UDU
, 
fdtbl_UV
, DCU, 
UVDC_HT
, 
UVAC_HT
);

1447 
DCV
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
VDU
, 
fdtbl_UV
, DCV, 
UVDC_HT
, 
UVAC_HT
);

1452 
	`¡biw__jpg_wr™eB™s
(
s
, &
b™Buf
, &
b™CÁ
, 
flB™s
);

1456 
	`¡biw__putc
(
s
, 0xFF);

1457 
	`¡biw__putc
(
s
, 0xD9);

1460 
	}
}

1462 
STBIWDEF
 
	$¡bi_wr™e_jpg_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
qu®™y
)

1464 
¡bi__wr™e_cÚ‹xt
 
s
;

1465 
	`¡bi__¡¬t_wr™e_ÿÎbacks
(&
s
, 
func
, 
cÚ‹xt
);

1466  
	`¡bi_wr™e_jpg_cÜe
(&
s
, 
x
, 
y
, 
comp
, (*è
d©a
, 
qu®™y
);

1467 
	}
}

1470 #iâdeà
STBI_WRITE_NO_STDIO


1471 
STBIWDEF
 
	$¡bi_wr™e_jpg
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
qu®™y
)

1473 
¡bi__wr™e_cÚ‹xt
 
s
;

1474 ià(
	`¡bi__¡¬t_wr™e_fe
(&
s
,
f’ame
)) {

1475 
r
 = 
	`¡bi_wr™e_jpg_cÜe
(&
s
, 
x
, 
y
, 
comp
, 
d©a
, 
qu®™y
);

1476 
	`¡bi__’d_wr™e_fe
(&
s
);

1477  
r
;

1480 
	}
}

	@App/tree.cpp

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~"Œ“.h
"

4 
	~"uts.h
"

5 
	~"·r£r.h
"

6 
	~"d©a.h
"

8 
	$chªge_Ëaves
(
Œ“
 *
t
, *
Ëaf_li¡
)

10 
li¡
 *
Îi¡
 = 
	`g‘_·ths
(
Ëaf_li¡
);

11 **
Ëaves
 = (**)
	`li¡_to_¬¿y
(
Îi¡
);

12 
n
 = 
Îi¡
->
size
;

13 
i
,
j
;

14 
found
 = 0;

15 
i
 = 0; i < 
t
->
n
; ++i){

16 
t
->
Ëaf
[
i
] = 0;

17 
j
 = 0; j < 
n
; ++j){

18 ià(0==
	`¡rcmp
(
t
->
Çme
[
i
], 
Ëaves
[
j
])){

19 
t
->
Ëaf
[
i
] = 1;

20 ++
found
;

25 
	`årštf
(
¡d”r
, "Found %d†—ves.\n", 
found
);

26 
	}
}

28 
	$g‘_h›¿rchy_´obab™y
(*
x
, 
Œ“
 *
h›r
, 
c
, 
¡ride
)

30 
p
 = 1;

31 
c
 >= 0){

32 
p
 =… * 
x
[
c
*
¡ride
];

33 
c
 = 
h›r
->
·»Á
[c];

35  
p
;

36 
	}
}

38 
	$h›¿rchy_´ediùiÚs
(*
´ediùiÚs
, 
n
, 
Œ“
 *
h›r
, 
Úly_Ëaves
, 
¡ride
)

40 
j
;

41 
j
 = 0; j < 
n
; ++j){

42 
·»Á
 = 
h›r
->·»Á[
j
];

43 if(
·»Á
 >= 0){

44 
´ediùiÚs
[
j
*
¡ride
] *ğ´ediùiÚs[
·»Á
*stride];

47 if(
Úly_Ëaves
){

48 
j
 = 0; j < 
n
; ++j){

49 if(!
h›r
->
Ëaf
[
j
]è
´ediùiÚs
[j*
¡ride
] = 0;

52 
	}
}

54 
	$h›¿rchy_tİ_´ediùiÚ
(*
´ediùiÚs
, 
Œ“
 *
h›r
, 
th»sh
, 
¡ride
)

56 
p
 = 1;

57 
group
 = 0;

58 
i
;

60 
max
 = 0;

61 
max_i
 = 0;

63 
i
 = 0; i < 
h›r
->
group_size
[
group
]; ++i){

64 
šdex
 = 
i
 + 
h›r
->
group_off£t
[
group
];

65 
v®
 = 
´ediùiÚs
[(
i
 + 
h›r
->
group_off£t
[
group
])*
¡ride
];

66 if(
v®
 > 
max
){

67 
max_i
 = 
šdex
;

68 
max
 = 
v®
;

71 if(
p
*
max
 > 
th»sh
){

72 
p
 =…*
max
;

73 
group
 = 
h›r
->
chd
[
max_i
];

74 if(
h›r
->
chd
[
max_i
] < 0)  max_i;

75 } ià(
group
 == 0){

76  
max_i
;

78  
h›r
->
·»Á
[h›r->
group_off£t
[
group
]];

82 
	}
}

84 
Œ“
 *
	$»ad_Œ“
(*
f’ame
)

86 
Œ“
 
t
 = {0};

87 
FILE
 *
å
 = 
	`fİ’
(
f’ame
, "r");

89 *
lše
;

90 
Ï¡_·»Á
 = -1;

91 
group_size
 = 0;

92 
groups
 = 0;

93 
n
 = 0;

94 (
lše
=
	`fg‘l
(
å
)) != 0){

95 *
id
 = (*)
	`ÿÎoc
(256, ());

96 
·»Á
 = -1;

97 
	`ssÿnf
(
lše
, "% %d", 
id
, &
·»Á
);

98 
t
.
·»Á
 = (*)
	`»®loc
Ñ.·»Á, (
n
+1)*());

99 
t
.
·»Á
[
n
] =…arent;

101 
t
.
chd
 = (*)
	`»®loc
Ñ.chd, (
n
+1)*());

102 
t
.
chd
[
n
] = -1;

104 
t
.
Çme
 = (**)
	`»®loc
Ñ.Çme, (
n
+1)*(*));

105 
t
.
Çme
[
n
] = 
id
;

106 if(
·»Á
 !ğ
Ï¡_·»Á
){

107 ++
groups
;

108 
t
.
group_off£t
 = (*)
	`»®loc
Ñ.group_off£t, 
groups
 * ());

109 
t
.
group_off£t
[
groups
 - 1] = 
n
 - 
group_size
;

110 
t
.
group_size
 = (*)
	`»®loc
Ñ.group_size, 
groups
 * ());

111 
t
.
group_size
[
groups
 - 1] = group_size;

112 
group_size
 = 0;

113 
Ï¡_·»Á
 = 
·»Á
;

115 
t
.
group
 = (*)
	`»®loc
Ñ.group, (
n
+1)*());

116 
t
.
group
[
n
] = 
groups
;

117 ià(
·»Á
 >= 0) {

118 
t
.
chd
[
·»Á
] = 
groups
;

120 ++
n
;

121 ++
group_size
;

123 ++
groups
;

124 
t
.
group_off£t
 = (*)
	`»®loc
Ñ.group_off£t, 
groups
 * ());

125 
t
.
group_off£t
[
groups
 - 1] = 
n
 - 
group_size
;

126 
t
.
group_size
 = (*)
	`»®loc
Ñ.group_size, 
groups
 * ());

127 
t
.
group_size
[
groups
 - 1] = group_size;

128 
t
.
n
 =‚;

129 
t
.
groups
 = groups;

130 
t
.
Ëaf
 = (*)
	`ÿÎoc
(
n
, ());

131 
i
;

132 
i
 = 0; i < 
n
; ++iè
t
.
Ëaf
[i] = 1;

133 
i
 = 0; i < 
n
; ++ièif(
t
.
·»Á
[i] >ğ0èt.
Ëaf
[t.parent[i]] = 0;

135 
	`fşo£
(
å
);

136 
Œ“
 *
Œ“_±r
 = (Œ“ *)
	`ÿÎoc
(1, (tree));

137 *
Œ“_±r
 = 
t
;

139  
Œ“_±r
;

140 
	}
}

	@App/tree.h

1 #iâdeà
TREE_H


2 
	#TREE_H


	)

3 
	~"d¬kÃt.h
"

5 
h›¿rchy_tİ_´ediùiÚ
(*
´ediùiÚs
, 
Œ“
 *
h›r
, 
th»sh
, 
¡ride
);

6 
g‘_h›¿rchy_´obab™y
(*
x
, 
Œ“
 *
h›r
, 
c
, 
¡ride
);

	@App/utils.cpp

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

4 
	~<m©h.h
>

5 
	~<as£¹.h
>

6 
	~<uni¡d.h
>

7 
	~<æßt.h
>

8 
	~<lim™s.h
>

12 
	~"uts.h
"

28 *
	$»ad_m­
(*
f’ame
)

30 
n
 = 0;

31 *
m­
 = 0;

32 *
¡r
;

33 
FILE
 *
fe
 = 
	`fİ’
(
f’ame
, "r");

34 if(!
fe
è
	`fe_”rÜ
(
f’ame
);

35 (
¡r
=
	`fg‘l
(
fe
))){

36 ++
n
;

37 
m­
 = (*)
	`»®loc
(m­, 
n
*());

38 
m­
[
n
-1] = 
	`©oi
(
¡r
);

40  
m­
;

41 
	}
}

68 *
	$¿ndom_šdex_Üd”
(
mš
, 
max
)

70 *
šds
 = (*)
	`ÿÎoc
(
max
-
mš
, ());

71 
i
;

72 
i
 = 
mš
; i < 
max
; ++i){

73 
šds
[
i
] = i;

75 
i
 = 
mš
; i < 
max
-1; ++i){

76 
sw­
 = 
šds
[
i
];

77 
šdex
 = 
i
 + 
	`¿nd
()%(
max
-i);

78 
šds
[
i
] = inds[
šdex
];

79 
šds
[
šdex
] = 
sw­
;

81  
šds
;

82 
	}
}

84 
	$d–_¬g
(
¬gc
, **
¬gv
, 
šdex
)

86 
i
;

87 
i
 = 
šdex
; i < 
¬gc
-1; ++iè
¬gv
[i] =‡rgv[i+1];

88 
¬gv
[
i
] = 0;

89 
	}
}

91 
	$fšd_¬g
(
¬gc
, * 
¬gv
[], *
¬g
)

93 
i
;

94 
i
 = 0; i < 
¬gc
; ++i) {

95 if(!
¬gv
[
i
]) ;

96 if(0==
	`¡rcmp
(
¬gv
[
i
], 
¬g
)) {

97 
	`d–_¬g
(
¬gc
, 
¬gv
, 
i
);

102 
	}
}

104 
	$fšd_št_¬g
(
¬gc
, **
¬gv
, *
¬g
, 
def
)

106 
i
;

107 
i
 = 0; i < 
¬gc
-1; ++i){

108 if(!
¬gv
[
i
]) ;

109 if(0==
	`¡rcmp
(
¬gv
[
i
], 
¬g
)){

110 
def
 = 
	`©oi
(
¬gv
[
i
+1]);

111 
	`d–_¬g
(
¬gc
, 
¬gv
, 
i
);

112 
	`d–_¬g
(
¬gc
, 
¬gv
, 
i
);

116  
def
;

117 
	}
}

119 
	$fšd_æßt_¬g
(
¬gc
, **
¬gv
, *
¬g
, 
def
)

121 
i
;

122 
i
 = 0; i < 
¬gc
-1; ++i){

123 if(!
¬gv
[
i
]) ;

124 if(0==
	`¡rcmp
(
¬gv
[
i
], 
¬g
)){

125 
def
 = 
	`©of
(
¬gv
[
i
+1]);

126 
	`d–_¬g
(
¬gc
, 
¬gv
, 
i
);

127 
	`d–_¬g
(
¬gc
, 
¬gv
, 
i
);

131  
def
;

132 
	}
}

134 *
	$fšd_ch¬_¬g
(
¬gc
, **
¬gv
, *
¬g
, *
def
)

136 
i
;

137 
i
 = 0; i < 
¬gc
-1; ++i){

138 if(!
¬gv
[
i
]) ;

139 if(0==
	`¡rcmp
(
¬gv
[
i
], 
¬g
)){

140 
def
 = 
¬gv
[
i
+1];

141 
	`d–_¬g
(
¬gc
, 
¬gv
, 
i
);

142 
	`d–_¬g
(
¬gc
, 
¬gv
, 
i
);

146  
def
;

147 
	}
}

150 *
	$ba£cfg
(*
cfgfe
)

152 *
c
 = 
cfgfe
;

153 *
Ãxt
;

154 (
Ãxt
 = 
	`¡rchr
(
c
, '/')))

156 
c
 = 
Ãxt
+1;

158 
c
 = 
	`cİy_¡ršg
(c);

159 
Ãxt
 = 
	`¡rchr
(
c
, '.');

160 ià(
Ãxt
) *next = 0;

161  
c
;

162 
	}
}

164 
	$®phªum_to_št
(
c
)

166  (
c
 < 58) ? c - 48 : c-87;

167 
	}
}

168 
	$št_to_®phªum
(
i
)

170 ià(
i
 == 36)  '.';

171  (
i
 < 10) ? i + 48 : i + 87;

172 
	}
}

174 
	$pm
(
M
, 
N
, *
A
)

176 
i
,
j
;

177 
i
 =0 ; i < 
M
; ++i){

178 
	`´štf
("%d ", 
i
+1);

179 
j
 = 0; j < 
N
; ++j){

180 
	`´štf
("%2.4f, ", 
A
[
i
*
N
+
j
]);

182 
	`´štf
("\n");

184 
	`´štf
("\n");

185 
	}
}

187 
	$fšd_»¶aû
(*
¡r
, *
Üig
, *
»p
, *
ouut
)

189 
bufãr
[4096] = {0};

190 *
p
;

192 
	`¥rštf
(
bufãr
, "%s", 
¡r
);

193 if(!(
p
 = 
	`¡r¡r
(
bufãr
, 
Üig
))){

194 
	`¥rštf
(
ouut
, "%s", 
¡r
);

198 *
p
 = '\0';

200 
	`¥rštf
(
ouut
, "%s%s%s", 
bufãr
, 
»p
, 
p
+
	`¡¾’
(
Üig
));

201 
	}
}

208 
	$tİ_k
(*
a
, 
n
, 
k
, *
šdex
)

210 
i
,
j
;

211 
j
 = 0; j < 
k
; ++jè
šdex
[j] = -1;

212 
i
 = 0; i < 
n
; ++i){

213 
cu¼
 = 
i
;

214 
j
 = 0; j < 
k
; ++j){

215 if((
šdex
[
j
] < 0è|| 
a
[
cu¼
] >‡[index[j]]){

216 
sw­
 = 
cu¼
;

217 
cu¼
 = 
šdex
[
j
];

218 
šdex
[
j
] = 
sw­
;

222 
	}
}

224 
	$”rÜ
(cÚ¡ *
s
)

226 
	`³¼Ü
(
s
);

227 
	`as£¹
(0);

228 
	`ex™
(-1);

229 
	}
}

231 *
	$»ad_fe
(*
f’ame
)

233 
FILE
 *
å
 = 
	`fİ’
(
f’ame
, "rb");

234 
size_t
 
size
;

236 
	`f£ek
(
å
, 0, 
SEEK_END
);

237 
size
 = 
	`á–l
(
å
);

238 
	`f£ek
(
å
, 0, 
SEEK_SET
);

240 *
‹xt
 = (*)
	`ÿÎoc
(
size
+1, ());

241 
	`ä—d
(
‹xt
, 1, 
size
, 
å
);

242 
	`fşo£
(
å
);

243  
‹xt
;

244 
	}
}

246 
	$m®loc_”rÜ
()

248 
	`årštf
(
¡d”r
, "Mallocƒrror\n");

249 
	`ex™
(-1);

250 
	}
}

252 
	$fe_”rÜ
(*
s
)

254 
	`årštf
(
¡d”r
, "Couldn'ˆİ’ fe: %s\n", 
s
);

255 
	`ex™
(0);

256 
	}
}

258 
li¡
 *
	$¥l™_¡r
(*
s
, 
d–im
)

260 
size_t
 
i
;

261 
size_t
 
Ën
 = 
	`¡¾’
(
s
);

262 
li¡
 *
l
 = 
	`make_li¡
();

263 
	`li¡_š£¹
(
l
, 
s
);

264 
i
 = 0; i < 
Ën
; ++i){

265 if(
s
[
i
] =ğ
d–im
){

266 
s
[
i
] = '\0';

267 
	`li¡_š£¹
(
l
, &(
s
[
i
+1]));

270  
l
;

271 
	}
}

273 
	$¡r
(*
s
)

275 
size_t
 
i
;

276 
size_t
 
Ën
 = 
	`¡¾’
(
s
);

277 
size_t
 
off£t
 = 0;

278 
i
 = 0; i < 
Ën
; ++i){

279 
c
 = 
s
[
i
];

280 if(
c
==' '||c=='\t'||c=='\n'è++
off£t
;

281 
s
[
i
-
off£t
] = 
c
;

283 
s
[
Ën
-
off£t
] = '\0';

284 
	}
}

286 
	$¡r_ch¬
(*
s
, 
bad
)

288 
size_t
 
i
;

289 
size_t
 
Ën
 = 
	`¡¾’
(
s
);

290 
size_t
 
off£t
 = 0;

291 
i
 = 0; i < 
Ën
; ++i){

292 
c
 = 
s
[
i
];

293 if(
c
==
bad
è++
off£t
;

294 
s
[
i
-
off£t
] = 
c
;

296 
s
[
Ën
-
off£t
] = '\0';

297 
	}
}

299 
	$ä“_±rs
(**
±rs
, 
n
)

301 
i
;

302 
i
 = 0; i < 
n
; ++iè
	`ä“
(
±rs
[i]);

303 
	`ä“
(
±rs
);

304 
	}
}

306 *
	$fg‘l
(
FILE
 *
å
)

308 if(
	`ãof
(
å
))  0;

309 
size_t
 
size
 = 512;

310 *
lše
 = (*)
	`m®loc
(
size
*());

311 if(!
	`fg‘s
(
lše
, 
size
, 
å
)){

312 
	`ä“
(
lše
);

316 
size_t
 
cu¼
 = 
	`¡¾’
(
lše
);

318 (
lše
[
cu¼
-1] !ğ'\n'è&& !
	`ãof
(
å
)){

319 if(
cu¼
 =ğ
size
-1){

320 
size
 *= 2;

321 
lše
 = (*)
	`»®loc
Öše, 
size
*());

322 if(!
lše
) {

323 
	`´štf
("%ld\n", 
size
);

324 
	`m®loc_”rÜ
();

327 
size_t
 
»adsize
 = 
size
-
cu¼
;

328 if(
»adsize
 > 
INT_MAX
)„eadsize = INT_MAX-1;

329 
	`fg‘s
(&
lše
[
cu¼
], 
»adsize
, 
å
);

330 
cu¼
 = 
	`¡¾’
(
lše
);

332 if(
lše
[
cu¼
-1] == '\n')†ine[curr-1] = '\0';

334  
lše
;

335 
	}
}

337 
	$»ad_št
(
fd
)

339 
n
 = 0;

340 
Ãxt
 = 
	`»ad
(
fd
, &
n
, ());

341 if(
Ãxt
 <= 0)  -1;

342  
n
;

343 
	}
}

345 *
	$»ad_ši¡
(*
gpu_li¡
, *
ngpus
, 
d
)

347 *
gpus
 = 0;

348 if(
gpu_li¡
){

349 
Ën
 = 
	`¡¾’
(
gpu_li¡
);

350 *
ngpus
 = 1;

351 
i
;

352 
i
 = 0; i < 
Ën
; ++i){

353 ià(
gpu_li¡
[
i
] =ğ','è++*
ngpus
;

355 
gpus
 = (*)
	`ÿÎoc
(*
ngpus
, ());

356 
i
 = 0; i < *
ngpus
; ++i){

357 
gpus
[
i
] = 
	`©oi
(
gpu_li¡
);

358 
gpu_li¡
 = 
	`¡rchr
(gpu_list, ',')+1;

361 
gpus
 = (*)
	`ÿÎoc
(1, ());

362 *
gpus
 = 
d
;

363 *
ngpus
 = 1;

365  
gpus
;

366 
	}
}

369 
	$wr™e_št
(
fd
, 
n
)

371 
Ãxt
 = 
	`wr™e
(
fd
, &
n
, ());

372 if(
Ãxt
 <ğ0è
	`”rÜ
("read failed");

373 
	}
}

375 
	$»ad_®l_ç
(
fd
, *
bufãr
, 
size_t
 
by‹s
)

377 
size_t
 
n
 = 0;

378 
n
 < 
by‹s
){

379 
Ãxt
 = 
	`»ad
(
fd
, 
bufãr
 + 
n
, 
by‹s
-n);

380 if(
Ãxt
 <= 0)  1;

381 
n
 +ğ
Ãxt
;

384 
	}
}

386 
	$wr™e_®l_ç
(
fd
, *
bufãr
, 
size_t
 
by‹s
)

388 
size_t
 
n
 = 0;

389 
n
 < 
by‹s
){

390 
size_t
 
Ãxt
 = 
	`wr™e
(
fd
, 
bufãr
 + 
n
, 
by‹s
-n);

391 if(
Ãxt
 <= 0)  1;

392 
n
 +ğ
Ãxt
;

395 
	}
}

397 
	$»ad_®l
(
fd
, *
bufãr
, 
size_t
 
by‹s
)

399 
size_t
 
n
 = 0;

400 
n
 < 
by‹s
){

401 
Ãxt
 = 
	`»ad
(
fd
, 
bufãr
 + 
n
, 
by‹s
-n);

402 if(
Ãxt
 <ğ0è
	`”rÜ
("read failed");

403 
n
 +ğ
Ãxt
;

405 
	}
}

407 
	$wr™e_®l
(
fd
, *
bufãr
, 
size_t
 
by‹s
)

409 
size_t
 
n
 = 0;

410 
n
 < 
by‹s
){

411 
size_t
 
Ãxt
 = 
	`wr™e
(
fd
, 
bufãr
 + 
n
, 
by‹s
-n);

412 if(
Ãxt
 <ğ0è
	`”rÜ
("write failed");

413 
n
 +ğ
Ãxt
;

415 
	}
}

418 *
	$cİy_¡ršg
(*
s
)

420 *
cİy
 = (*)
	`m®loc
(
	`¡¾’
(
s
)+1);

421 
	`¡ºıy
(
cİy
, 
s
, 
	`¡¾’
(s)+1);

422  
cİy
;

423 
	}
}

425 
li¡
 *
	$·r£_csv_lše
(*
lše
)

427 
li¡
 *
l
 = 
	`make_li¡
();

428 *
c
, *
p
;

429 
š
 = 0;

430 
c
 = 
lše
, 
p
 =†ine; *c != '\0'; ++c){

431 if(*
c
 =ğ'"'è
š
 = !in;

432 if(*
c
 =ğ',' && !
š
){

433 *
c
 = '\0';

434 
	`li¡_š£¹
(
l
, 
	`cİy_¡ršg
(
p
));

435 
p
 = 
c
+1;

438 
	`li¡_š£¹
(
l
, 
	`cİy_¡ršg
(
p
));

439  
l
;

440 
	}
}

442 
	$couÁ_f›lds
(*
lše
)

444 
couÁ
 = 0;

445 
dÚe
 = 0;

446 *
c
;

447 
c
 = 
lše
; !
dÚe
; ++c){

448 
dÚe
 = (*
c
 == '\0');

449 if(*
c
 =ğ',' || 
dÚe
è++
couÁ
;

451  
couÁ
;

452 
	}
}

454 *
	$·r£_f›lds
(*
lše
, 
n
)

456 *
f›ld
 = (*)
	`ÿÎoc
(
n
, ());

457 *
c
, *
p
, *
’d
;

458 
couÁ
 = 0;

459 
dÚe
 = 0;

460 
c
 = 
lše
, 
p
 =†še; !
dÚe
; ++c){

461 
dÚe
 = (*
c
 == '\0');

462 if(*
c
 =ğ',' || 
dÚe
){

463 *
c
 = '\0';

464 
f›ld
[
couÁ
] = 
	`¡¹od
(
p
, &
’d
);

465 if(
p
 =ğ
c
è
f›ld
[
couÁ
] = 
	`Çn
("");

466 if(
’d
 !ğ
c
 && (’d !ğc-1 || *’d !ğ'\r')è
f›ld
[
couÁ
] = 
	`Çn
("");

467 
p
 = 
c
+1;

468 ++
couÁ
;

471  
f›ld
;

472 
	}
}

474 
	$sum_¬¿y
(*
a
, 
n
)

476 
i
;

477 
sum
 = 0;

478 
i
 = 0; i < 
n
; ++iè
sum
 +ğ
a
[i];

479  
sum
;

480 
	}
}

482 
	$m—n_¬¿y
(*
a
, 
n
)

484  
	`sum_¬¿y
(
a
,
n
)/n;

485 
	}
}

487 
	$m—n_¬¿ys
(**
a
, 
n
, 
–s
, *
avg
)

489 
i
;

490 
j
;

491 
	`mem£t
(
avg
, 0, 
–s
*());

492 
j
 = 0; j < 
n
; ++j){

493 
i
 = 0; i < 
–s
; ++i){

494 
avg
[
i
] +ğ
a
[
j
][i];

497 
i
 = 0; i < 
–s
; ++i){

498 
avg
[
i
] /ğ
n
;

500 
	}
}

502 
	$´št_¡©i¡ics
(*
a
, 
n
)

504 
m
 = 
	`m—n_¬¿y
(
a
, 
n
);

505 
v
 = 
	`v¬Ÿnû_¬¿y
(
a
, 
n
);

506 
	`´štf
("MSE: %.6f, M—n: %.6f, V¬Ÿnû: %.6f\n", 
	`m£_¬¿y
(
a
, 
n
), 
m
, 
v
);

507 
	}
}

509 
	$v¬Ÿnû_¬¿y
(*
a
, 
n
)

511 
i
;

512 
sum
 = 0;

513 
m—n
 = 
	`m—n_¬¿y
(
a
, 
n
);

514 
i
 = 0; i < 
n
; ++iè
sum
 +ğ(
a
[i] - 
m—n
)*(a[i]-mean);

515 
v¬Ÿnû
 = 
sum
/
n
;

516  
v¬Ÿnû
;

517 
	}
}

519 
	$cÚ¡¿š_št
(
a
, 
mš
, 
max
)

521 ià(
a
 < 
mš
)  min;

522 ià(
a
 > 
max
)  max;

523  
a
;

524 
	}
}

526 
	$cÚ¡¿š
(
mš
, 
max
, 
a
)

528 ià(
a
 < 
mš
)  min;

529 ià(
a
 > 
max
)  max;

530  
a
;

531 
	}
}

533 
	$di¡_¬¿y
(*
a
, *
b
, 
n
, 
sub
)

535 
i
;

536 
sum
 = 0;

537 
i
 = 0; i < 
n
; i +ğ
sub
è
sum
 +ğ
	`pow
(
a
[i]-
b
[i], 2);

538  
	`sq¹
(
sum
);

539 
	}
}

541 
	$m£_¬¿y
(*
a
, 
n
)

543 
i
;

544 
sum
 = 0;

545 
i
 = 0; i < 
n
; ++iè
sum
 +ğ
a
[i]*a[i];

546  
	`sq¹
(
sum
/
n
);

547 
	}
}

549 
	$nÜm®ize_¬¿y
(*
a
, 
n
)

551 
i
;

552 
mu
 = 
	`m—n_¬¿y
(
a
,
n
);

553 
sigma
 = 
	`sq¹
(
	`v¬Ÿnû_¬¿y
(
a
,
n
));

554 
i
 = 0; i < 
n
; ++i){

555 
a
[
i
] = (a[i] - 
mu
)/
sigma
;

557 
mu
 = 
	`m—n_¬¿y
(
a
,
n
);

558 
sigma
 = 
	`sq¹
(
	`v¬Ÿnû_¬¿y
(
a
,
n
));

559 
	}
}

561 
	$Œª¦©e_¬¿y
(*
a
, 
n
, 
s
)

563 
i
;

564 
i
 = 0; i < 
n
; ++i){

565 
a
[
i
] +ğ
s
;

567 
	}
}

569 
	$mag_¬¿y
(*
a
, 
n
)

571 
i
;

572 
sum
 = 0;

573 
i
 = 0; i < 
n
; ++i){

574 
sum
 +ğ
a
[
i
]*a[i];

576  
	`sq¹
(
sum
);

577 
	}
}

579 
	$sÿË_¬¿y
(*
a
, 
n
, 
s
)

581 
i
;

582 
i
 = 0; i < 
n
; ++i){

583 
a
[
i
] *ğ
s
;

585 
	}
}

587 
	$§m¶e_¬¿y
(*
a
, 
n
)

589 
sum
 = 
	`sum_¬¿y
(
a
, 
n
);

590 
	`sÿË_¬¿y
(
a
, 
n
, 1./
sum
);

591 
r
 = 
	`¿nd_unifÜm
(0, 1);

592 
i
;

593 
i
 = 0; i < 
n
; ++i){

594 
r
 =„ - 
a
[
i
];

595 ià(
r
 <ğ0è 
i
;

597  
n
-1;

598 
	}
}

600 
	$max_št_šdex
(*
a
, 
n
)

602 if(
n
 <= 0)  -1;

603 
i
, 
max_i
 = 0;

604 
max
 = 
a
[0];

605 
i
 = 1; i < 
n
; ++i){

606 if(
a
[
i
] > 
max
){

607 
max
 = 
a
[
i
];

608 
max_i
 = 
i
;

611  
max_i
;

612 
	}
}

614 
	$max_šdex
(*
a
, 
n
)

616 if(
n
 <= 0)  -1;

617 
i
, 
max_i
 = 0;

618 
max
 = 
a
[0];

619 
i
 = 1; i < 
n
; ++i){

620 if(
a
[
i
] > 
max
){

621 
max
 = 
a
[
i
];

622 
max_i
 = 
i
;

625  
max_i
;

626 
	}
}

628 
	$št_šdex
(*
a
, 
v®
, 
n
)

630 
i
;

631 
i
 = 0; i < 
n
; ++i){

632 if(
a
[
i
] =ğ
v®
)  i;

635 
	}
}

637 
	$¿nd_št
(
mš
, 
max
)

639 ià(
max
 < 
mš
){

640 
s
 = 
mš
;

641 
mš
 = 
max
;

642 
max
 = 
s
;

644 
r
 = (
	`¿nd
()%(
max
 - 
mš
 + 1)) + min;

645  
r
;

646 
	}
}

649 
	$¿nd_nÜm®
()

651 
haveS·»
 = 0;

652 
¿nd1
, 
¿nd2
;

654 if(
haveS·»
)

656 
haveS·»
 = 0;

657  
	`sq¹
(
¿nd1
è* 
	`sš
(
¿nd2
);

660 
haveS·»
 = 1;

662 
¿nd1
 = 
	`¿nd
(è/ ((è
RAND_MAX
);

663 if(
¿nd1
 < 1e-100)„and1 = 1e-100;

664 
¿nd1
 = -2 * 
	`log
(rand1);

665 
¿nd2
 = (
	`¿nd
(è/ ((è
RAND_MAX
)è* 
TWO_PI
;

667  
	`sq¹
(
¿nd1
è* 
	`cos
(
¿nd2
);

668 
	}
}

670 
	$¿nd_nÜm®_ms
(
mu
, 
sigma
){

671 
U1
, 
U2
, 
W
, 
muÉ
;

672 
X1
, 
X2
;

673 
ÿÎ
 = 0;

675 ià(
ÿÎ
 == 1)

677 
ÿÎ
 = !call;

678  (
mu
 + 
sigma
 * (è
X2
);

683 
U1
 = -1 + (è
	`¿nd
 ()/
RAND_MAX
 * 2;

684 
U2
 = -1 + (è
	`¿nd
 ()/
RAND_MAX
 * 2;

685 
W
 = 
	`pow
 (
U1
, 2è+…ow (
U2
, 2);

687 
W
 >= 1 || W == 0);

689 
muÉ
 = 
	`sq¹
 ((-2 * 
	`log
 (
W
)) / W);

690 
X1
 = 
U1
 * 
muÉ
;

691 
X2
 = 
U2
 * 
muÉ
;

693 
ÿÎ
 = !call;

695  (
mu
 + 
sigma
 * (è
X1
);

696 
	}
}

709 
size_t
 
	$¿nd_size_t
()

711  ((
size_t
)(
	`¿nd
()&0xff) << 56) |

712 ((
size_t
)(
	`¿nd
()&0xff) << 48) |

713 ((
size_t
)(
	`¿nd
()&0xff) << 40) |

714 ((
size_t
)(
	`¿nd
()&0xff) << 32) |

715 ((
size_t
)(
	`¿nd
()&0xff) << 24) |

716 ((
size_t
)(
	`¿nd
()&0xff) << 16) |

717 ((
size_t
)(
	`¿nd
()&0xff) << 8) |

718 ((
size_t
)(
	`¿nd
()&0xff) << 0);

719 
	}
}

721 
	$¿nd_unifÜm
(
mš
, 
max
)

723 if(
max
 < 
mš
){

724 
sw­
 = 
mš
;

725 
mš
 = 
max
;

726 
max
 = 
sw­
;

728  (()
	`¿nd
()/
RAND_MAX
 * (
max
 - 
mš
)) + min;

729 
	}
}

731 
	$¿nd_sÿË
(
s
)

733 
sÿË
 = 
	`¿nd_unifÜm
(1, 
s
);

734 if(
	`¿nd
()%2è 
sÿË
;

735  1./
sÿË
;

736 
	}
}

738 **
	$Úe_hÙ_’code
(*
a
, 
n
, 
k
)

740 
i
;

741 **
t
 = (**)
	`ÿÎoc
(
n
, (*));

742 
i
 = 0; i < 
n
; ++i){

743 
t
[
i
] = (*)
	`ÿÎoc
(
k
, ());

744 
šdex
 = ()
a
[
i
];

745 
t
[
i
][
šdex
] = 1;

747  
t
;

748 
	}
}

	@App/utils.h

1 #iâdeà
UTILS_H


2 
	#UTILS_H


	)

3 
	~<¡dio.h
>

4 
	~<time.h
>

5 
	~"d¬kÃt.h
"

6 
	~"li¡.h
"

8 
	#TIME
(
a
) \

10 
¡¬t
 = 
	`wh©_time_is_™_now
(); \

11 
a
; \

12 
	`´štf
("% took: %à£cÚds\n", #a, 
	`wh©_time_is_™_now
(è- 
¡¬t
); \

13 } 0)

	)

15 
	#TWO_PI
 6.2831853071795864769252866f

	)

17 
wh©_time_is_™_now
();

20 
ä“_±rs
(**
±rs
, 
n
);

21 
®phªum_to_št
(
c
);

22 
št_to_®phªum
(
i
);

23 
»ad_št
(
fd
);

24 
wr™e_št
(
fd
, 
n
);

25 
»ad_®l
(
fd
, *
bufãr
, 
size_t
 
by‹s
);

26 
wr™e_®l
(
fd
, *
bufãr
, 
size_t
 
by‹s
);

27 
»ad_®l_ç
(
fd
, *
bufãr
, 
size_t
 
by‹s
);

28 
wr™e_®l_ç
(
fd
, *
bufãr
, 
size_t
 
by‹s
);

29 
fšd_»¶aû
(*
¡r
, *
Üig
, *
»p
, *
ouut
);

30 
m®loc_”rÜ
();

31 
fe_”rÜ
(*
s
);

32 
¡r
(*
s
);

33 
¡r_ch¬
(*
s
, 
bad
);

34 
li¡
 *
¥l™_¡r
(*
s
, 
d–im
);

35 *
fg‘l
(
FILE
 *
å
);

36 
li¡
 *
·r£_csv_lše
(*
lše
);

37 *
cİy_¡ršg
(*
s
);

38 
couÁ_f›lds
(*
lše
);

39 *
·r£_f›lds
(*
lše
, 
n
);

40 
Œª¦©e_¬¿y
(*
a
, 
n
, 
s
);

41 
cÚ¡¿š
(
mš
, 
max
, 
a
);

42 
cÚ¡¿š_št
(
a
, 
mš
, 
max
);

43 
¿nd_sÿË
(
s
);

44 
¿nd_št
(
mš
, 
max
);

45 
m—n_¬¿ys
(**
a
, 
n
, 
–s
, *
avg
);

46 
di¡_¬¿y
(*
a
, *
b
, 
n
, 
sub
);

47 **
Úe_hÙ_’code
(*
a
, 
n
, 
k
);

48 
£c
(
şock_t
 
şocks
);

49 
´št_¡©i¡ics
(*
a
, 
n
);

50 
št_šdex
(*
a
, 
v®
, 
n
);

52 
¿nd_nÜm®_ms
(
mu
, 
sigma
);

	@Enclave/Enclave.cpp

1 
	~"Enşave_t.h
"

2 
	~"sgx_Œts.h
"

3 
	~"sgx_tüy±o.h
"

4 
	~"¡dlib.h
"

5 
	~<¡ršg.h
>

6 
	~<¡dio.h
>

8 
	~"d¬kÃ_.h
"

9 
	~"aùiv©iÚs_TA.h
"

10 
	~"«s_TA.h
"

11 
	~"bÏs_TA.h
"

12 
	~"d¬kÃt_TA.h
"

13 
	~"gemm_TA.h
"

14 
	~"im2cŞ_TA.h
"

15 
	~"m©h_TA.h
"

16 
	~"uts_TA.h
"

17 
	~"Enşave.h
"

18 
	~"«s.h
"

19 
	~<m©h.h
>

20 
	~<æßt.h
>

21 
	~<¡ršg.h
>

23 
	#ENCRYPT_OUTPUT_DATA
 1

	)

33 
ÃtwÜk_TA
 
	gÃ‰a
;

34 
	groundnum
 = 0;

35 
	g”r_sum
 = 0;

36 
	gavg_loss
 = -1;

38 *
	g_Ãt_šput
;

39 *
	g_Ãt_d–
;

40 *
	g_Ãt_ouut
;

41 *
	gÃ‰a_Œuth
;

42 
	gÃŠum
 = 0;

43 
	g_¡¬t_šdex
 = 1;

45 
	ggGlob®BufãrCouÁ”
;

46 
ušt8_t
 *
	g_g_bufãr
;

49 
	gUID
[46] = "b8734d20-832e-43a9-bf9f-17f3e9e041e2";

51 
sgx_¡©us_t
 
	$deüy±_d©a
(
ušt8_t
 *
’üy±_In
, 
size_t
 
Ën
, ušt8_ˆ*
deüy±_Out
, size_ˆ
ËnOut
)

55  
SGX_SUCCESS
;

56 
	}
}

58 
	$eÿÎ_make_ÃtwÜk
(
n
, 
Ë¬nšg_¿‹
, 
mom’tum
, 
deÿy
, 
time_¡•s
, 
nÙruth
, 
b©ch
, 
subdivisiÚs
, 
¿ndom
, 
adam
, 
B1
, 
B2
, 
•s
, 
h
, 
w
, 
c
, 
šputs
, 
max_üİ
, 
mš_üİ
, 
max_¿tio
, 
mš_¿tio
, 
ûÁ”
, 
ş
, 
ªgË
, 
a¥eù
, 
§tu¿tiÚ
, 
exposu»
, 
hue
, 
buº_š
, 
pow”
, 
max_b©ches
, 
¡¬t_šdex
)

60 
Ã‰a
.
n
 =‚;

62 
Ã‰a
.
£’
 = (
size_t
 *)
	`ÿÎoc
(1, (size_t));

63 
Ã‰a
.
Ïy”s
 = (
Ïy”_TA
 *)
	`ÿÎoc
Ò‘.
n
, (layer_TA));

64 
Ã‰a
.
t
 = (*)
	`ÿÎoc
(1, ());

65 
Ã‰a
.
co¡
 = (*)
	`ÿÎoc
(1, ());

67 
Ã‰a
.
Ë¬nšg_¿‹
 =†earning_rate;

68 
Ã‰a
.
mom’tum
 = momentum;

69 
Ã‰a
.
deÿy
 = decay;

70 
Ã‰a
.
time_¡•s
 =ime_steps;

71 
Ã‰a
.
nÙruth
 =‚otruth;

72 
Ã‰a
.
b©ch
 = batch;

73 
Ã‰a
.
subdivisiÚs
 = subdivisions;

74 
Ã‰a
.
¿ndom
 =„andom;

75 
Ã‰a
.
adam
 =‡dam;

76 
Ã‰a
.
B1
 = B1;

77 
Ã‰a
.
B2
 = B2;

78 
Ã‰a
.
•s
 =ƒps;

79 
Ã‰a
.
h
 = h;

80 
Ã‰a
.
w
 = w;

81 
Ã‰a
.
c
 = c;

82 
Ã‰a
.
šputs
 = inputs;

83 
Ã‰a
.
max_üİ
 = max_crop;

84 
Ã‰a
.
mš_üİ
 = min_crop;

85 
Ã‰a
.
max_¿tio
 = max_ratio;

86 
Ã‰a
.
mš_¿tio
 = min_ratio;

87 
Ã‰a
.
ûÁ”
 = center;

88 
Ã‰a
.
ş
 = clip;

89 
Ã‰a
.
ªgË
 =‡ngle;

90 
Ã‰a
.
a¥eù
 =‡spect;

91 
Ã‰a
.
§tu¿tiÚ
 = saturation;

92 
Ã‰a
.
exposu»
 =ƒxposure;

93 
Ã‰a
.
hue
 = hue;

94 
Ã‰a
.
buº_š
 = burn_in;

95 
Ã‰a
.
pow”
 =…ower;

96 
Ã‰a
.
max_b©ches
 = max_batches;

98 
_¡¬t_šdex
 = 
¡¬t_šdex
;

100 
gGlob®BufãrCouÁ”
 +ğ((
size_t
è+ (è+ (è+ (
Ã‰a
.
n
 * (
Ïy”_TA
)));

101 
	`oÿÎ_´št
("MemÜy u§gš MB = ", ()
gGlob®BufãrCouÁ”
/(1024*1024));

102 
	`oÿÎ_´št
("\n",-1.0);

104 
	}
}

106 
	$bš¬ize_weights_TA
(*
weights
, 
n
, 
size
, *
bš¬y
)

108 
i
, 
f
;

109 
f
 = 0; f < 
n
; ++f){

110 
m—n
 = 0;

111 
i
 = 0; i < 
size
; ++i){

112 
m—n
 +ğ
	`çbs
(
weights
[
f
*
size
 + 
i
]);

114 
m—n
 = m—À/ 
size
;

115 
i
 = 0; i < 
size
; ++i){

116 
bš¬y
[
f
*
size
 + 
i
] = (
weights
[f*siz+ i] > 0è? 
m—n
 : -mean;

119 
	}
}

121 
	$sw­_bš¬y_TA
(
Ïy”_TA
 *
l
)

123 *
sw­
 = 
l
->
weights
;

124 
l
->
weights
 =†->
bš¬y_weights
;

125 
l
->
bš¬y_weights
 = 
sw­
;

126 
	}
}

128 
	$bš¬ize_ıu_TA
(*
šput
, 
n
, *
bš¬y
)

130 
i
;

131 
i
 = 0; i < 
n
; ++i){

132 
bš¬y
[
i
] = (
šput
[i] > 0) ? 1 : -1;

134 
	}
}

136 
	$add_bŸs_TA
(*
ouut
, *
bŸ£s
, 
b©ch
, 
n
, 
size
)

138 
i
,
j
,
b
;

139 
b
 = 0; b < 
b©ch
; ++b){

140 
i
 = 0; i < 
n
; ++i){

141 
b_v®
 = (
b
*
n
 + 
i
)*
size
;

142 #´agm¨
omp
 
·¿Î–
 

143 
j
 = 0; j < 
size
; ++j){

145 
ouut
[
b_v®
 + 
j
] +ğ
bŸ£s
[
i
];

149 
	}
}

151 
	$sÿË_bŸs_TA
(*
ouut
, *
sÿËs
, 
b©ch
, 
n
, 
size
)

153 
i
,
j
,
b
;

154 
b
 = 0; b < 
b©ch
; ++b){

155 
i
 = 0; i < 
n
; ++i){

156 
b_v®
 = (
b
*
n
 + 
i
)*
size
;

157 #´agm¨
omp
 
·¿Î–
 

158 
j
 = 0; j < 
size
; ++j){

160 
ouut
[
b_v®
 + 
j
] *ğ
sÿËs
[
i
];

164 
	}
}

166 
	$fÜw¬d_b©chnÜm_Ïy”_’şave
(
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
)

168 if(
l
.
ty³
 =ğ
BATCHNORM_TA
è
	`cİy_ıu_TA
Ö.
ouuts
*l.
b©ch
, 
Ãt
.
šput
, 1,†.
ouut
, 1);

169 
	`cİy_ıu_TA
(
l
.
ouuts
*l.
b©ch
,†.
ouut
, 1,†.
x
, 1);

170 if(
Ãt
.
Œaš
){

171 
	`m—n_ıu_TA
(
l
.
ouut
,†.
b©ch
,†.
out_c
,†.
out_h
*l.
out_w
,†.
m—n
);

172 
	`v¬Ÿnû_ıu_TA
(
l
.
ouut
,†.
m—n
,†.
b©ch
,†.
out_c
,†.
out_h
*l.
out_w
,†.
v¬Ÿnû
);

174 
	`sÿl_ıu_TA
(
l
.
out_c
, .99,†.
rŞlšg_m—n
, 1);

175 
	`axpy_ıu_TA
(
l
.
out_c
, .01,†.
m—n
, 1,†.
rŞlšg_m—n
, 1);

176 
	`sÿl_ıu_TA
(
l
.
out_c
, .99,†.
rŞlšg_v¬Ÿnû
, 1);

177 
	`axpy_ıu_TA
(
l
.
out_c
, .01,†.
v¬Ÿnû
, 1,†.
rŞlšg_v¬Ÿnû
, 1);

179 
	`nÜm®ize_ıu_TA
(
l
.
ouut
,†.
m—n
,†.
v¬Ÿnû
,†.
b©ch
,†.
out_c
,†.
out_h
*l.
out_w
);

180 
	`cİy_ıu_TA
(
l
.
ouuts
*l.
b©ch
,†.
ouut
, 1,†.
x_nÜm
, 1);

182 
	`nÜm®ize_ıu_TA
(
l
.
ouut
,†.
rŞlšg_m—n
,†.
rŞlšg_v¬Ÿnû
,†.
b©ch
,†.
out_c
,†.
out_h
*l.
out_w
);

184 
	`sÿË_bŸs_TA
(
l
.
ouut
,†.
sÿËs
,†.
b©ch
,†.
out_c
,†.
out_h
*l.
out_w
);

185 
	`add_bŸs_TA
(
l
.
ouut
,†.
bŸ£s
,†.
b©ch
,†.
out_c
,†.
out_h
*l.
out_w
);

186 
	}
}

188 
	$fÜw¬d_cÚvŞutiÚ®_Ïy”_’şave
(
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
)

190 
i
, 
j
;

192 
	`fl_ıu_TA
(
l
.
ouuts
*l.
b©ch
, 0,†.
ouut
, 1);

194 if(
l
.
xnÜ
){

195 
	`bš¬ize_weights_TA
(
l
.
weights
,†.
n
,†.
c
/l.
groups
*l.
size
*l.size,†.
bš¬y_weights
);

196 
	`sw­_bš¬y_TA
(&
l
);

197 
	`bš¬ize_ıu_TA
(
Ãt
.
šput
, 
l
.
c
*l.
h
*l.
w
*l.
b©ch
,†.
bš¬y_šput
);

198 
Ãt
.
šput
 = 
l
.
bš¬y_šput
;

201 
m
 = 
l
.
n
/l.
groups
;

202 
k
 = 
l
.
size
*l.size*l.
c
/l.
groups
;

203 
n
 = 
l
.
out_w
*l.
out_h
;

205 
i
 = 0; i < 
l
.
b©ch
; ++i){

206 
j
 = 0; j < 
l
.
groups
; ++j){

207 *
a
 = 
l
.
weights
 + 
j
*l.
nweights
/l.
groups
;

208 *
b
 = 
Ãt
.
wÜk¥aû
;

209 *
c
 = 
l
.
ouut
 + (
i
*l.
groups
 + 
j
)*
n
*
m
;

210 *
im
 = 
Ãt
.
šput
 + (
i
*
l
.
groups
 + 
j
)*l.
c
/l.groups*l.
h
*l.
w
;

212 ià(
l
.
size
 == 1) {

213 
b
 = 
im
;

215 
	`im2cŞ_ıu_TA
(
im
, 
l
.
c
/l.
groups
,†.
h
,†.
w
,†.
size
,†.
¡ride
,†.
·d
, 
b
);

218 
	`gemm_TA
(0,0,
m
,
n
,
k
,1,
a
,k,
b
,n,1,
c
,n);

223 
gGlob®BufãrCouÁ”
 += (5*() + 16);

225 if(
l
.
b©ch_nÜm®ize
){

226 
	`fÜw¬d_b©chnÜm_Ïy”_’şave
(
l
, 
Ãt
);

228 
	`add_bŸs_TA
(
l
.
ouut
,†.
bŸ£s
,†.
b©ch
,†.
n
,†.
out_h
*l.
out_w
);

231 
	`aùiv©e_¬¿y_TA
(
l
.
ouut
,†.
ouuts
*l.
b©ch
,†.
aùiv©iÚ
);

232 if(
l
.
bš¬y
 ||†.
xnÜ
è
	`sw­_bš¬y_TA
(&l);

234 
	`oÿÎ_´št
("MemÜy u§gš MB = ", ()
gGlob®BufãrCouÁ”
/(1024*1024));

235 
	`oÿÎ_´št
("\n",-1.0);

244 
	}
}

246 
	$eÿÎ_make_cÚvŞutiÚ®_Ïy”
(
b©ch
, 
h
, 
w
, 
c
, 
n
, 
groups
, 
size
, 
¡ride
, 
·ddšg
, *
aùiv©iÚ_s
, 
aùi_Ëngth
, 
b©ch_nÜm®ize
, 
bš¬y
, 
xnÜ
, 
adam
, 
æ³d
, 
dÙ
)

248 
i
;

249 
Ïy”_TA
 
l
;

251 
l
.
ty³
 = 
CONVOLUTIONAL_TA
;

253 
l
.
groups
 = groups;

254 
l
.
h
 = h;

255 
l
.
w
 = w;

256 
l
.
c
 = c;

257 
l
.
n
 =‚;

258 
l
.
bš¬y
 = binary;

259 
l
.
xnÜ
 = xnor;

260 
l
.
b©ch
 = batch;

261 
l
.
¡ride
 = stride;

262 
l
.
size
 = size;

263 
l
.
·d
 = 
·ddšg
;

264 
l
.
b©ch_nÜm®ize
 = batch_normalize;

266 
l
.
weights
 = (*)
	`ÿÎoc
(
c
/
groups
*
n
*
size
*size, ());

269 
l
.
bŸ£s
 = (*)
	`ÿÎoc
(
n
, ());

272 
l
.
nweights
 = 
c
/
groups
*
n
*
size
*size;

273 
l
.
nbŸ£s
 = 
n
;

275 
ACTIVATION_TA
 
aùiv©iÚ
 = 
	`g‘_aùiv©iÚ_TA
(
aùiv©iÚ_s
);

277 
sÿË
 = 
	`_sq¹
(2./(
size
*size*
c
/
l
.
groups
));

287 
out_w
 = (
l
.
w
 + 2*l.
·d
 -†.
size
è/†.
¡ride
 + 1;

288 
out_h
 = (
l
.
h
 + 2*l.
·d
 -†.
size
è/†.
¡ride
 + 1;

290 
l
.
out_h
 = out_h;

291 
l
.
out_w
 = out_w;

292 
l
.
out_c
 = 
n
;

293 
l
.
ouuts
 =†.
out_h
 *†.
out_w
 *†.
out_c
;

294 
l
.
šputs
 =†.
w
 *†.
h
 *†.
c
;

296 
l
.
ouut
 = (*)
	`ÿÎoc
Ö.
b©ch
*l.
ouuts
, ());

297 
l
.
d–
 = (*)
	`ÿÎoc
Ö.
b©ch
*l.
ouuts
, ());

299 
l
.
fÜw¬d_TA
 = 
fÜw¬d_cÚvŞutiÚ®_Ïy”_’şave
;

302 
l
.
backw¬d_TA
 = 
NULL
;

303 
l
.
upd©e_TA
 = 
NULL
;

304 if(
bš¬y
){

305 
l
.
bš¬y_weights
 = (*)
	`ÿÎoc
Ö.
nweights
, ());

306 
l
.
cweights
 = (*)
	`ÿÎoc
Ö.
nweights
, ());

307 
l
.
sÿËs
 = (*)
	`ÿÎoc
(
n
, ());

309 if(
xnÜ
){

310 
l
.
bš¬y_weights
 = (*)
	`ÿÎoc
Ö.
nweights
, ());

311 
l
.
bš¬y_šput
 = (*)
	`ÿÎoc
Ö.
šputs
*l.
b©ch
, ());

314 
gGlob®BufãrCouÁ”
 +ğ(((
c
/
groups
*
n
*
size
*sizeè+‚ + (2*
l
.
b©ch
*l.
ouuts
)) * ());

316 if(
b©ch_nÜm®ize
){

317 
l
.
sÿËs
 = (*)
	`ÿÎoc
(
n
, ());

319 
i
 = 0; i < 
n
; ++i){

320 
l
.
sÿËs
[
i
] = 1;

323 
l
.
m—n
 = (*)
	`ÿÎoc
(
n
, ());

324 
l
.
v¬Ÿnû
 = (*)
	`ÿÎoc
(
n
, ());

329 
l
.
rŞlšg_m—n
 = (*)
	`ÿÎoc
(
n
, ());

330 
l
.
rŞlšg_v¬Ÿnû
 = (*)
	`ÿÎoc
(
n
, ());

331 
l
.
x
 = (*)
	`ÿÎoc
Ö.
b©ch
*l.
ouuts
, ());

334 
gGlob®BufãrCouÁ”
 +ğ((5*
n
 + 
l
.
b©ch
*l.
ouuts
) * ());

336 if(
adam
){

337 
l
.
m
 = (*)
	`ÿÎoc
Ö.
nweights
, ());

338 
l
.
v
 = (*)
	`ÿÎoc
Ö.
nweights
, ());

339 
l
.
bŸs_m
 = (*)
	`ÿÎoc
(
n
, ());

340 
l
.
sÿË_m
 = (*)
	`ÿÎoc
(
n
, ());

341 
l
.
bŸs_v
 = (*)
	`ÿÎoc
(
n
, ());

342 
l
.
sÿË_v
 = (*)
	`ÿÎoc
(
n
, ());

345 
l
.
wÜk¥aû_size
 = (
size_t
)Ö.
out_h
*l.
out_w
*l.
size
*l.size*l.
c
/l.
groups
*());

346 
l
.
aùiv©iÚ
 =‡ctivation;

348 
l
.
æ³d
 = flipped;

349 
l
.
dÙ
 = dot;

351 
	`oÿÎ_´št
("MemÜy u§gš MB = ", ()
gGlob®BufãrCouÁ”
/(1024*1024));

352 
	`oÿÎ_´št
("\n",-1.0);

362 
Ã‰a
.
Ïy”s
[
ÃŠum
] = 
l
;

363 
ÃŠum
++;

365 
	}
}

367 
	$fÜw¬d_cÚÃùed_Ïy”_’şave
(
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
)

369 
	`fl_ıu_TA
(
l
.
ouuts
*l.
b©ch
, 0,†.
ouut
, 1);

371 
m
 = 
l
.
b©ch
;

372 
k
 = 
l
.
šputs
;

373 
n
 = 
l
.
ouuts
;

374 *
a
 = 
Ãt
.
šput
;

375 *
b
 = 
l
.
weights
;

376 *
c
 = 
l
.
ouut
;

378 
	`gemm_TA
(0,1,
m
,
n
,
k
,1,
a
,k,
b
,k,1,
c
,n);

380 if(
l
.
b©ch_nÜm®ize
){

381 
	`fÜw¬d_b©chnÜm_Ïy”_’şave
(
l
, 
Ãt
);

383 
	`add_bŸs_TA
(
l
.
ouut
,†.
bŸ£s
,†.
b©ch
,†.
ouuts
, 1);

385 
	`aùiv©e_¬¿y_TA
(
l
.
ouut
,†.
ouuts
*l.
b©ch
,†.
aùiv©iÚ
);

386 
	}
}

388 
	$eÿÎ_make_cÚÃùed_Ïy”
(
b©ch
, 
šputs
, 
ouuts
, *
aùiv©iÚ_s
, 
aùi_Ëngth
, 
b©ch_nÜm®ize
, 
adam
)

390 
i
;

391 
Ïy”_TA
 
l
;

393 
l
.
Ë¬nšg_¿‹_sÿË
 = 1;

394 
l
.
ty³
 = 
CONNECTED_TA
;

396 
l
.
šputs
 = inputs;

397 
l
.
ouuts
 = outputs;

398 
l
.
b©ch
 = batch;

399 
l
.
b©ch_nÜm®ize
 = batch_normalize;

400 
l
.
h
 = 1;

401 
l
.
w
 = 1;

402 
l
.
c
 = 
šputs
;

403 
l
.
out_h
 = 1;

404 
l
.
out_w
 = 1;

405 
l
.
out_c
 = 
ouuts
;

407 
l
.
ouut
 = (*)
	`ÿÎoc
(
b©ch
*
ouuts
, ());

408 
l
.
d–
 = (*)
	`ÿÎoc
(
b©ch
*
ouuts
, ());

410 
l
.
weight_upd©es
 = (*)
	`ÿÎoc
(
šputs
*
ouuts
, ());

411 
l
.
bŸs_upd©es
 = (*)
	`ÿÎoc
(
ouuts
, ());

413 
l
.
weights
 = (*)
	`ÿÎoc
(
ouuts
*
šputs
, ());

414 
l
.
bŸ£s
 = (*)
	`ÿÎoc
(
ouuts
, ());

416 
l
.
fÜw¬d_TA
 = 
fÜw¬d_cÚÃùed_Ïy”_’şave
;

419 
l
.
backw¬d_TA
 = 
NULL
;

420 
l
.
upd©e_TA
 = 
NULL
;

422 
ACTIVATION_TA
 
aùiv©iÚ
 = 
	`g‘_aùiv©iÚ_TA
(
aùiv©iÚ_s
);

425 
sÿË
 = 
	`_sq¹
(2./
šputs
);

433 
i
 = 0; i < 
ouuts
; ++i){

434 
l
.
bŸ£s
[
i
] = 0;

437 if(
adam
){

438 
l
.
m
 = (*)
	`ÿÎoc
Ö.
šputs
*l.
ouuts
, ());

439 
l
.
v
 = (*)
	`ÿÎoc
Ö.
šputs
*l.
ouuts
, ());

440 
l
.
bŸs_m
 = (*)
	`ÿÎoc
Ö.
ouuts
, ());

441 
l
.
sÿË_m
 = (*)
	`ÿÎoc
Ö.
ouuts
, ());

442 
l
.
bŸs_v
 = (*)
	`ÿÎoc
Ö.
ouuts
, ());

443 
l
.
sÿË_v
 = (*)
	`ÿÎoc
Ö.
ouuts
, ());

446 if(
b©ch_nÜm®ize
){

447 
l
.
sÿËs
 = (*)
	`ÿÎoc
(
ouuts
, ());

448 
l
.
sÿË_upd©es
 = (*)
	`ÿÎoc
(
ouuts
, ());

449 
i
 = 0; i < 
ouuts
; ++i){

450 
l
.
sÿËs
[
i
] = 1;

453 
l
.
m—n
 = (*)
	`ÿÎoc
(
ouuts
, ());

454 
l
.
m—n_d–
 = (*)
	`ÿÎoc
(
ouuts
, ());

455 
l
.
v¬Ÿnû
 = (*)
	`ÿÎoc
(
ouuts
, ());

456 
l
.
v¬Ÿnû_d–
 = (*)
	`ÿÎoc
(
ouuts
, ());

458 
l
.
rŞlšg_m—n
 = (*)
	`ÿÎoc
(
ouuts
, ());

459 
l
.
rŞlšg_v¬Ÿnû
 = (*)
	`ÿÎoc
(
ouuts
, ());

461 
l
.
x
 = (*)
	`ÿÎoc
(
b©ch
*
ouuts
, ());

462 
l
.
x_nÜm
 = (*)
	`ÿÎoc
(
b©ch
*
ouuts
, ());

465 
l
.
aùiv©iÚ
 =‡ctivation;

468 
Ã‰a
.
Ïy”s
[
ÃŠum
] = 
l
;

469 
ÃŠum
++;

471 
	}
}

473 
	$fÜw¬d_soámax_Ïy”_’şave
(cÚ¡ 
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
)

475 if(
l
.
soámax_Œ“
){

476 
i
;

477 
couÁ
 = 0;

478 
i
 = 0; i < 
l
.
soámax_Œ“
->
groups
; ++i) {

479 
group_size
 = 
l
.
soámax_Œ“
->group_size[
i
];

480 
	`soámax_ıu_TA
(
Ãt
.
šput
 + 
couÁ
, 
group_size
, 
l
.
b©ch
,†.
šputs
, 1, 0, 1,†.
‹m³¿tu»
,†.
ouut
 + count);

481 
couÁ
 +ğ
group_size
;

484 
	`soámax_ıu_TA
(
Ãt
.
šput
, 
l
.
šputs
/l.
groups
,†.
b©ch
,†.šputs,†.groups,†.šputs/l.groups, 1,†.
‹m³¿tu»
,†.
ouut
);

487 if(
Ãt
.
Œuth
 && !
l
.
nŞoss
){

488 
	`soámax_x_’t_ıu_TA
(
l
.
b©ch
*l.
šputs
,†.
ouut
, 
Ãt
.
Œuth
,†.
d–
,†.
loss
);

489 
l
.
co¡
[0] = 
	`sum_¬¿y_TA
Ö.
loss
,†.
b©ch
*l.
šputs
);

491 
	}
}

493 
	$eÿÎ_make_soámax_Ïy”
(
b©ch
, 
šputs
, 
groups
, 
‹m³¿tu»
, 
w
, 
h
, 
c
, 
¥©Ÿl
, 
nŞoss
)

495 
	`as£¹
(0);

496 
	`as£¹
(
šputs
%
groups
 == 0);

498 
Ïy”_TA
 
l
;

501 
l
.
ty³
 = 
SOFTMAX_TA
;

502 
l
.
b©ch
 = batch;

503 
l
.
groups
 = groups;

505 
l
.
šputs
 = inputs;

506 
l
.
ouuts
 = 
šputs
;

507 
l
.
loss
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

508 
l
.
ouut
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

509 
l
.
d–
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

510 
l
.
co¡
 = (*)
	`ÿÎoc
(1, ());

512 
l
.
‹m³¿tu»
 =emperature;

513 
l
.
w
 = w;

514 
l
.
h
 = h;

515 
l
.
c
 = c;

516 
l
.
¥©Ÿl
 = spatial;

517 
l
.
nŞoss
 =‚oloss;

519 
l
.
fÜw¬d_TA
 = 
fÜw¬d_soámax_Ïy”_’şave
;

521 
l
.
backw¬d_TA
 = 
NULL
;

523 
Ã‰a
.
Ïy”s
[
ÃŠum
] = 
l
;

524 
ÃŠum
++;

526 
	}
}

528 
COST_TYPE_TA
 
	$g‘_co¡_ty³_TA
(*
s
)

530 ià(
	`¡rcmp
(
s
, "£g")==0è 
SEG_TA
;

531 ià(
	`¡rcmp
(
s
, "s£")==0è 
SSE_TA
;

532 ià(
	`¡rcmp
(
s
, "masked")==0è 
MASKED_TA
;

533 ià(
	`¡rcmp
(
s
, "smoÙh")==0è 
SMOOTH_TA
;

534 ià(
	`¡rcmp
(
s
, "L1")==0è 
L1_TA
;

535 ià(
	`¡rcmp
(
s
, "wgª")==0è 
WGAN_TA
;

537  
SSE_TA
;

538 
	}
}

540 
	$fÜw¬d_co¡_Ïy”_’şave
(
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
)

542 ià(!
Ãt
.
Œuth
) ;

543 if(
l
.
co¡_ty³
 =ğ
MASKED_TA
){

544 
i
;

545 
i
 = 0; i < 
l
.
b©ch
*l.
šputs
; ++i){

546 if(
Ãt
.
Œuth
[
i
] =ğ
SECRET_NUM_TA
èÃt.
šput
[i] = SECRET_NUM_TA;

549 if(
l
.
co¡_ty³
 =ğ
SMOOTH_TA
){

550 
	`smoÙh_l1_ıu_TA
(
l
.
b©ch
*l.
šputs
, 
Ãt
.
šput
,‚‘.
Œuth
,†.
d–
,†.
ouut
);

551 }if(
l
.
co¡_ty³
 =ğ
L1_TA
){

552 
	`l1_ıu_TA
(
l
.
b©ch
*l.
šputs
, 
Ãt
.
šput
,‚‘.
Œuth
,†.
d–
,†.
ouut
);

554 
	`l2_ıu_TA
(
l
.
b©ch
*l.
šputs
, 
Ãt
.
šput
,‚‘.
Œuth
,†.
d–
,†.
ouut
);

556 
l
.
co¡
[0] = 
	`sum_¬¿y_TA
Ö.
ouut
,†.
b©ch
*l.
šputs
);

557 
	}
}

559 
	$eÿÎ_make_co¡_Ïy”
(
b©ch
, 
šputs
, *
co¡_ty³
, 
co¡_size
, 
sÿË
, 
¿tio
, 
noobjeù_sÿË
, 
th»sh
)

561 
Ïy”_TA
 
l
;

563 
l
.
ty³
 = 
COST_TA
;

565 
l
.
sÿË
 = scale;

566 
l
.
b©ch
 = batch;

567 
l
.
šputs
 = inputs;

568 
l
.
ouuts
 = 
šputs
;

569 
COST_TYPE_TA
 
co¡_ty³_
 = 
	`g‘_co¡_ty³_TA
(
co¡_ty³
);

570 
l
.
co¡_ty³
 = 
co¡_ty³_
;

571 
l
.
d–
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

572 
l
.
ouut
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

573 
l
.
co¡
 = (*)
	`ÿÎoc
(1, ());

575 
l
.
sÿË
 = scale;

576 
l
.
¿tio
 =„atio;

577 
l
.
noobjeù_sÿË
 =‚oobject_scale;

578 
l
.
th»sh
 =hresh;

580 
l
.
fÜw¬d_TA
 = 
fÜw¬d_co¡_Ïy”_’şave
;

582 
l
.
backw¬d_TA
 = 
NULL
;

584 
Ã‰a
.
Ïy”s
[
ÃŠum
] = 
l
;

585 
ÃŠum
++;

587 
	}
}

589 
	$fÜw¬d_maxpoŞ_Ïy”_’şave
(cÚ¡ 
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
)

591 
b
,
i
,
j
,
k
,
m
,
n
;

592 
w_off£t
 = -
l
.
·d
/2;

593 
h_off£t
 = -
l
.
·d
/2;

595 
h
 = 
l
.
out_h
;

596 
w
 = 
l
.
out_w
;

597 
c
 = 
l
.c;

599 
b
 = 0; b < 
l
.
b©ch
; ++b){

600 
k
 = 0; k < 
c
; ++k){

601 
i
 = 0; i < 
h
; ++i){

602 
j
 = 0; j < 
w
; ++j){

603 
out_šdex
 = 
j
 + 
w
*(
i
 + 
h
*(
k
 + 
c
*
b
));

604 
max
 = -
fœ¡_aim_mÚey
;

605 
max_i
 = -1;

606 
n
 = 0;‚ < 
l
.
size
; ++n){

607 
m
 = 0; m < 
l
.
size
; ++m){

608 
cur_h
 = 
h_off£t
 + 
i
*
l
.
¡ride
 + 
n
;

609 
cur_w
 = 
w_off£t
 + 
j
*
l
.
¡ride
 + 
m
;

610 
šdex
 = 
cur_w
 + 
l
.
w
*(
cur_h
 +†.
h
*(
k
 + 
b
*l.
c
));

611 
v®id
 = (
cur_h
 >ğ0 && cur_h < 
l
.
h
 &&

612 
cur_w
 >ğ0 && cur_w < 
l
.
w
);

613 
v®
 = (
v®id
 !ğ0è? 
Ãt
.
šput
[
šdex
] : -
fœ¡_aim_mÚey
;

614 
max_i
 = (
v®
 > 
max
è? 
šdex
 : max_i;

615 
max
 = (
v®
 > max) ? val : max;

618 
l
.
ouut
[
out_šdex
] = 
max
;

619 
l
.
šdexes
[
out_šdex
] = 
max_i
;

625 
gGlob®BufãrCouÁ”
 += (12*() + 2*());

626 
	`oÿÎ_´št
("MemÜy u§gš MB = ", ()
gGlob®BufãrCouÁ”
/(1024*1024));

627 
	`oÿÎ_´št
("\n",-1.0);

635 
	}
}

637 
	$eÿÎ_make_maxpoŞ_Ïy”
(
b©ch
, 
h
, 
w
, 
c
, 
size
, 
¡ride
, 
·ddšg
)

639 
Ïy”_TA
 
l
;

642 
l
.
ty³
 = 
MAXPOOL_TA
;

643 
l
.
b©ch
 = batch;

644 
l
.
h
 = h;

645 
l
.
w
 = w;

646 
l
.
c
 = c;

647 
l
.
·d
 = 
·ddšg
;

648 
l
.
out_w
 = (
w
 + 
·ddšg
 - 
size
)/
¡ride
 + 1;

649 
l
.
out_h
 = (
h
 + 
·ddšg
 - 
size
)/
¡ride
 + 1;

650 
l
.
out_c
 = 
c
;

651 
l
.
ouuts
 =†.
out_h
 *†.
out_w
 *†.
out_c
;

652 
l
.
šputs
 = 
h
*
w
*
c
;

653 
l
.
size
 = size;

654 
l
.
¡ride
 = stride;

655 
ouut_size
 = 
l
.
out_h
 *†.
out_w
 *†.
out_c
 * 
b©ch
;

656 
l
.
šdexes
 = (*)
	`ÿÎoc
(
ouut_size
, ());

657 
l
.
ouut
 = (*)
	`ÿÎoc
(
ouut_size
, ());

658 
l
.
d–
 = (*)
	`ÿÎoc
(
ouut_size
, ());

659 
l
.
fÜw¬d_TA
 = 
fÜw¬d_maxpoŞ_Ïy”_’şave
;

661 
l
.
backw¬d_TA
 = 
NULL
;

663 
gGlob®BufãrCouÁ”
 +ğ(
ouut_size
 * (() + 2*()));

666 
	`oÿÎ_´št
("MemÜy u§gš MB = ", ()
gGlob®BufãrCouÁ”
/(1024*1024));

667 
	`oÿÎ_´št
("\n",-1.0);

669 
Ã‰a
.
Ïy”s
[
ÃŠum
] = 
l
;

670 
ÃŠum
++;

672 
	}
}

674 
	$fÜw¬d_drİout_Ïy”_’şave
(
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
)

676 
i
;

677 ià(!
Ãt
.
Œaš
) ;

679 *
±”
;

680 if(
l
.
ÃŠum
 == 0){

681 
i
 = 0; i < 
l
.
b©ch
 *†.
šputs
; ++i){

682 
l
.
ouut
[
i
] = 
Ãt
.
šput
[i];

685 
±”
 = 
l
.
ouut
;

687 
±”
 = 
Ãt
.
šput
;

690 
i
 = 0; i < 
l
.
b©ch
 *†.
šputs
; ++i){

692 
r
 = 
	`¿nd_unifÜm_TA
(0, 1);

693 
l
.
¿nd
[
i
] = 
r
;

694 if(
r
 < 
l
.
´obab™y
è
±”
[
i
] = 0;

695 
±”
[
i
] *ğ
l
.
sÿË
;

697 
	}
}

699 
	$eÿÎ_make_drİout_Ïy”
(
b©ch
, 
šputs
, 
´obab™y
, 
w
, 
h
, 
c
, *
Ãt_´ev_ouut
, 
´ev_size
, *
Ãt_´ev_d–
, 
d–_size
)

701 
Ïy”_TA
 
l
;

703 
size
 = 
´ev_size
/();

705 
l
.
ty³
 = 
DROPOUT_TA
;

706 
l
.
´obab™y
 =…robability;

707 
l
.
šputs
 = inputs;

708 
l
.
ouuts
 = 
šputs
;

709 
l
.
b©ch
 = batch;

710 
l
.
¿nd
 = (*)
	`ÿÎoc
(
šputs
*
b©ch
, ());

711 
l
.
sÿË
 = 1./(1.-
´obab™y
);

713 
l
.
ÃŠum
 =‚etnum;

715 
l
.
ouut
 = (*)
	`m®loc
((è* 
šputs
*
b©ch
);

716 
l
.
d–
 = (*)
	`m®loc
((è* 
šputs
*
b©ch
);

718 
l
.
fÜw¬d_TA
 = 
fÜw¬d_drİout_Ïy”_’şave
;

720 
l
.
backw¬d_TA
 = 
NULL
;

721 
l
.
w
 = w;

722 
l
.
h
 = h;

723 
l
.
c
 = c;

729 if(
ÃŠum
 == 0){

730 
z
=0; z<
size
; z++){

731 
l
.
ouut
[
z
] = 
Ãt_´ev_ouut
[z];

732 
l
.
d–
[
z
] = 
Ãt_´ev_d–
[z];

735 
l
.
ouut
 = 
Ã‰a
.
Ïy”s
[
ÃŠum
-1].output;

736 
l
.
d–
 = 
Ã‰a
.
Ïy”s
[
ÃŠum
-1].delta;

739 
Ã‰a
.
Ïy”s
[
ÃŠum
] = 
l
;

740 
ÃŠum
++;

742 
	}
}

744 
	$fÜw¬d_avgpoŞ_Ïy”_’şave
(cÚ¡ 
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
)

746 
b
,
i
,
k
;

748 
b
 = 0; b < 
l
.
b©ch
; ++b){

749 
k
 = 0; k < 
l
.
c
; ++k){

750 
out_šdex
 = 
k
 + 
b
*
l
.
c
;

751 
l
.
ouut
[
out_šdex
] = 0;

752 
i
 = 0; i < 
l
.
h
*l.
w
; ++i){

753 
š_šdex
 = 
i
 + 
l
.
h
*l.
w
*(
k
 + 
b
*l.
c
);

754 
l
.
ouut
[
out_šdex
] +ğ
Ãt
.
šput
[
š_šdex
];

756 
l
.
ouut
[
out_šdex
] /ğl.
h
*l.
w
;

767 
	}
}

769 
	$eÿÎ_make_avgpoŞ_Ïy”
(
b©ch
, 
w
, 
h
, 
c
)

771 
Ïy”_TA
 
l
;

773 
l
.
ty³
 = 
AVGPOOL_TA
;

774 
l
.
b©ch
 = batch;

775 
l
.
h
 = h;

776 
l
.
w
 = w;

777 
l
.
c
 = c;

778 
l
.
out_w
 = 1;

779 
l
.
out_h
 = 1;

780 
l
.
out_c
 = 
c
;

781 
l
.
ouuts
 =†.
out_c
;

782 
l
.
šputs
 = 
h
*
w
*
c
;

783 
ouut_size
 = 
l
.
ouuts
 * 
b©ch
;

784 
l
.
ouut
 = (*)
	`ÿÎoc
(
ouut_size
, ());

785 
l
.
d–
 = (*)
	`ÿÎoc
(
ouut_size
, ());

786 
l
.
fÜw¬d_TA
 = 
fÜw¬d_avgpoŞ_Ïy”_’şave
;

787 
l
.
backw¬d_TA
 = 
NULL
;

789 
gGlob®BufãrCouÁ”
 +ğ(2*
ouut_size
*());

790 
	`oÿÎ_´št
("MemÜy u§gš MB = ", ()
gGlob®BufãrCouÁ”
/(1024*1024));

791 
	`oÿÎ_´št
("\n",-1.0);

793 
Ã‰a
.
Ïy”s
[
ÃŠum
] = 
l
;

794 
ÃŠum
++;

796 
	}
}

798 
	$eÿÎ_®loÿ‹_wÜk¥aû
(
wÜk¥aû_size
)

800 
Ã‰a
.
wÜk¥aû
 = (*)
	`ÿÎoc
(1, 
wÜk¥aû_size
);

801 
gGlob®BufãrCouÁ”
 +ğ
wÜk¥aû_size
;

802 
	`oÿÎ_´št
("MemÜy u§gš MB = ", ()
gGlob®BufãrCouÁ”
/(1024*1024));

803 
	`oÿÎ_´št
("\n",-1.0);

805 
	}
}

807 
	$«s_cbc_TA
(* 
xüy±
, * 
g¿d›Á
, 
Üg_Ën
, 
mode
)

809 
»suÉ
 = 0;

811 
ušt8_t
 *
by‹
;

813 
ušt8_t
 *
¬¿y
 = (ušt8_ˆ*)
	`ÿÎoc
(
Üg_Ën
*4, (uint8_t));

814 
z
 = 0; z < 
Üg_Ën
; z++){

815 
by‹
 = (
ušt8_t
*)(&
g¿d›Á
[
z
]);

816 
y
 = 0; y < 4; y++){

817 
¬¿y
[
z
*4 + 
y
] = 
by‹
[y];

821 if(
mode
 == 0)

824 
’c_Ën
 = ()(
Üg_Ën
/4);

825 
AES_ùx
 
ùx
;

826 
ušt8_t
 
iv
[] = { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f };

827 
ušt8_t
 
key
[16] = { (uint8_t)0x2b, (uint8_t)0x7e, (uint8_t)0x15, (uint8_t)0x16, (uint8_t)0x28, (uint8_t)0xae, (uint8_t)0xd2, (uint8_t)0xa6, (uint8_t)0xab, (uint8_t)0xf7, (uint8_t)0x15, (uint8_t)0x88, (uint8_t)0x09, (uint8_t)0xcf, (uint8_t)0x4f, (uint8_t)0x3c };

830 
	`AES_š™_ùx_iv
(&
ùx
, 
key
, 
iv
);

831 
i
 = 0; i < 
’c_Ën
; ++i)

833 if(
	`¡ºcmp
(
xüy±
, "encrypt", 2) == 0){

834 
	`AES_CBC_’üy±_bufãr
(&
ùx
, 
¬¿y
 + (
i
 * 16), 16);

835 }if(
	`¡ºcmp
(
xüy±
, "decrypt", 2) == 0){

836 
	`AES_CBC_deüy±_bufãr
(&
ùx
, 
¬¿y
 + (
i
 * 16), 16);

842 
»suÉ
 = 
	`«s_gcm_’Œy
(
xüy±
, 
¬¿y
, 
_g_bufãr
, 
Üg_Ën
*4);

843 if(
»suÉ
 != 0)

845 if(
	`¡ºcmp
(
xüy±
, "encrypt", 2) == 0){

846 
	`oÿÎ_´št
("Enüy±iÚ faed\n",()
»suÉ
);

849 
	`oÿÎ_´št
("Deüy±iÚ faed\n",()
»suÉ
);

855 
z
 = 0; z < 
Üg_Ën
; z++){

856 
g¿d›Á
[
z
] = *(*)(&
¬¿y
[z*4]);

859 
	`ä“
(
¬¿y
);

860  
»suÉ
;

861 
	}
}

863 
	$«s_cbc_TA_tok’
(* 
xüy±
, * 
UID
, 
Ën
)

865 
»suÉ
 = 
	`«s_gcm_’Œy
(
xüy±
, (
ušt8_t
 *)
UID
, 
_g_bufãr
, 
Ën
);

866 if(
»suÉ
 != 0)

868 if(
	`¡ºcmp
(
xüy±
, "encrypt", 2) == 0){

869 
	`oÿÎ_´št
("Enüy±iÚ faed\n",()
»suÉ
);

872 
	`oÿÎ_´št
("Deüy±iÚ faed\n",()
»suÉ
);

876  
»suÉ
;

877 
	}
}

879 
	$Œª¥o£_m©rix_TA
(*
a
, 
rows
, 
cŞs
)

881 *
Œª¥o£
 = (*)
	`ÿÎoc
(
rows
*
cŞs
, ());

882 
x
, 
y
;

883 
x
 = 0; x < 
rows
; ++x){

884 
y
 = 0; y < 
cŞs
; ++y){

885 
Œª¥o£
[
y
*
rows
 + 
x
] = 
a
[x*
cŞs
 + y];

888 
	`memıy
(
a
, 
Œª¥o£
, 
rows
*
cŞs
*());

889 
	`ä“
(
Œª¥o£
);

890 
	}
}

892 
	$eÿÎ_Œªsãr_weights
(*
vec
, 
Ëngth
, 
Ïy”_i
, 
ty³
, 
add™iÚ®
)

894 
size
 = 
Ëngth
/();

896 *
‹mpvec
 = (*)
	`ÿÎoc
(1,
Ëngth
);

897 if(
‹mpvec
 =ğ
NULL
)

899 
	`oÿÎ_´št
("Unableo‡llocate memory",-1.0);

902 
	`cİy_ıu_TA
(
size
, 
vec
, 1, 
‹mpvec
, 1);

905 
Ïy”_TA
 
l
 = 
Ã‰a
.
Ïy”s
[
Ïy”_i
 - 
_¡¬t_šdex
];

907 if(
ty³
 == 'b'){

908 
	`cİy_ıu_TA
(
size
, 
‹mpvec
, 1, 
l
.
bŸ£s
, 1);

910 if(
ty³
 == 'w'){

911 
	`cİy_ıu_TA
(
size
, 
‹mpvec
, 1, 
l
.
weights
, 1);

913 if(
ty³
 == 's'){

914 
	`cİy_ıu_TA
(
size
, 
‹mpvec
, 1, 
l
.
sÿËs
, 1);

916 if(
ty³
 == 'm'){

917 
	`cİy_ıu_TA
(
size
, 
‹mpvec
, 1, 
l
.
rŞlšg_m—n
, 1);

919 if(
ty³
 == 'v'){

920 
	`cİy_ıu_TA
(
size
, 
‹mpvec
, 1, 
l
.
rŞlšg_v¬Ÿnû
, 1);

924 if(
l
.
ty³
 =ğ
CONVOLUTIONAL_TA
 ||†.ty³ =ğ
DECONVOLUTIONAL_TA
){

925 if(
l
.
æ³d
 && 
ty³
 == 'w'){

926 
	`Œª¥o£_m©rix_TA
(
l
.
weights
,†.
c
*l.
size
*l.size,†.
n
);

929 if(
l
.
ty³
 =ğ
CONNECTED_TA
){

930 if(
add™iÚ®
 && 
ty³
 == 'w'){

931 
	`Œª¥o£_m©rix_TA
(
l
.
weights
,†.
šputs
,†.
ouuts
);

935 
	`ä“
(
‹mpvec
);

937 
	}
}

939 
	$eÿÎ_Ãt_ouut_»tuº
(*
Ãt_ouut
, 
Ëngth
, 
ušt8_t
 *
g_bufãr
, 
g_Ëngth
)

945 
size
 = 
Ëngth
 / ();

958 
	`mem£t
(
_g_bufãr
, 0, 
g_Ëngth
);

959 
	`oÿÎ_´št
("\n Encrypthe…artial„esults\n",0.0);

961 
»suÉ
 = 
	`«s_cbc_TA
((*)"’üy±", 
_Ãt_ouut
, 
size
, 1);

962 
	`oÿÎ_´št
("\n Done...\n",0.0);

964 if(
»suÉ
 == 0)

966 
z
=0; z<
size
; z++){

967 
Ãt_ouut
[
z
] = 
_Ãt_ouut
[z];

970 
z
=0; z<
g_Ëngth
; z++){

971 
g_bufãr
[
z
] = 
_g_bufãr
[z];

975 
	`ä“
(
_Ãt_ouut
);

976 
	`ä“
(
_g_bufãr
);

977  
»suÉ
;

978 
	}
}

980 
	$ÿlc_ÃtwÜk_co¡_’şave
()

982 
i
;

983 
sum
 = 0;

984 
couÁ
 = 0;

985 
i
 = 0; i < 
Ã‰a
.
n
; ++i){

986 if(
Ã‰a
.
Ïy”s
[
i
].
co¡
){

987 
sum
 +ğ
Ã‰a
.
Ïy”s
[
i
].
co¡
[0];

988 ++
couÁ
;

991 *
Ã‰a
.
co¡
 = 
sum
/
couÁ
;

992 
”r_sum
 +ğ*
Ã‰a
.
co¡
;

993 
	}
}

995 
	$eÿÎ_fÜw¬d_ÃtwÜk
(*
Ãt_šput
, 
l_šputs
, 
ušt8_t
 *
g_bufãr
, 
l_g
, 
Ãt_Œaš
)

997 
Ã‰a
.
šput
 = 
Ãt_šput
;

998 
Ã‰a
.
Œaš
 = 
Ãt_Œaš
;

1002 
_g_bufãr
 = (
ušt8_t
 *)
	`ÿÎoc
(1, 
l_g
);

1003 
	`memıy
(
_g_bufãr
, 
g_bufãr
, 
l_g
);

1004 
	`oÿÎ_´št
("\n Decrypthe…artial„esults\n",0.0);

1005 
»suÉ
 = 
	`«s_cbc_TA
((*)"deüy±", 
Ãt_šput
, (
l_šputs
/()), 1);

1006 
	`oÿÎ_´št
("\n Done...\n",0.0);

1017 
roundnum
++;

1018 
i
;

1019 
i
 = 0; (˜< 
Ã‰a
.
n
è&& (
»suÉ
 == 0); ++i){

1020 
Ã‰a
.
šdex
 = 
i
;

1021 
Ïy”_TA
 
l
 = 
Ã‰a
.
Ïy”s
[
i
];

1023 if(
l
.
d–
){

1024 
	`fl_ıu_TA
(
l
.
ouuts
 *†.
b©ch
, 0,†.
d–
, 1);

1027 
l
.
	`fÜw¬d_TA
Ö, 
Ã‰a
);

1029 
Ã‰a
.
šput
 = 
l
.
ouut
;

1031 if(
l
.
Œuth
) {

1032 
Ã‰a
.
Œuth
 = 
l
.
ouut
;

1036 if(
i
 =ğ
Ã‰a
.
n
 - 1){

1037 
_Ãt_ouut
 = (*)
	`m®loc
(()*
l
.
ouuts
*1);

1039 
gGlob®BufãrCouÁ”
 +ğ()*
l
.
ouuts
;

1040 
	`oÿÎ_´št
("MemÜy u§gš MB = ", ()
gGlob®BufãrCouÁ”
/(1024*1024));

1041 
	`oÿÎ_´št
("\n",-1.0);

1042 
z
=0; z<
l
.
ouuts
*1; z++){

1043 
_Ãt_ouut
[
z
] = 
l
.
ouut
[z];

1049  
»suÉ
;

1050 
	}
}

1052 
	$g‘DecSŒ
(* 
¡r
, 
ušt8_t
 
Ën
, ušt8_ˆ
tÙ®_couÁ
, 
ušt32_t
 
v®
)

1054 
ušt8_t
 
i
;

1055 
i
 = 1; i <ğ
Ën
; i++)

1057 
¡r
[
Ën
-
i
] = ()((
v®
 % 10UL) + '0');

1058 
v®
/=10;

1061 ; 
i
 <ğ
tÙ®_couÁ
; i++)

1063 
¡r
[
i
] = '0';

1066 
	}
}

1068 
	$¡r_cÚÿt
(* 
¡r1
, * 
¡r2
, 
ušt8_t
 
Ën
)

1070 
i
 = 0; i < 
Ën
; i++)

1072 
¡r1
[
i
] = 
¡r2
[i];

1074 
	}
}

1076 
	$num_of_dig™s_št
(
a
)

1078 
x
;

1079 
x
 = 1; 
a
 >= 10; x++)

1081 
a
 =‡ / 10;

1083  
x
;

1084 
	}
}

1086 
	$eÿÎ_©‹¡_£ssiÚ_tok’
(
£ssiÚ_tok’
, *
©‹¡©iÚ_bufãr
, 
©‹¡_size
, 
ušt8_t
 *
g_bufãr
, 
l_g
)

1088 
tÙ®_couÁ
 = 10;

1089 
size_uuid
 = 36;

1090 *
¡r
 = &
UID
[
size_uuid
];

1091 
num_of_dig™s
 = 
	`num_of_dig™s_št
(
£ssiÚ_tok’
);

1095 
	`oÿÎ_´št
("\nSessiÚok’: ",
£ssiÚ_tok’
);

1097 
	`g‘DecSŒ
(
¡r
, 
num_of_dig™s
, 
tÙ®_couÁ
, 
£ssiÚ_tok’
);

1101 
	`oÿÎ_´št
("\nSessionoken + UUID\n",-1);

1102 
	`oÿÎ_´št
(
UID
,-555.0);

1105 
_g_bufãr
 = (
ušt8_t
 *)
	`ÿÎoc
(1, 
l_g
);

1106 
	`oÿÎ_´št
("\n Encrypt‡nd hashhe sessionoken + uuid \n",0.0);

1107 
»suÉ
 = 
	`«s_cbc_TA_tok’
((*)"’üy±", 
UID
, (UID));

1108 
	`oÿÎ_´št
("\n Done...\n",0.0);

1110 if(
»suÉ
 == 0)

1112 
	`memıy
(
©‹¡©iÚ_bufãr
, 
UID
, (UID));

1113 
z
=0; z<
l_g
; z++){

1114 
g_bufãr
[
z
] = 
_g_bufãr
[z];

1119 
	`oÿÎ_´št
("\n Encryption failed \n",0.0);

1120 
»suÉ
 = -1;

1123 
	`ä“
(
_g_bufãr
);

1124  
»suÉ
;

1125 
	}
}

1127 
	$eÿÎ_deüy±
(
ušt32_t
 *
’üy±_šput
, ušt32_ˆ
šput_Ëngth
, ušt32_ˆ*
¶aš‹xt_ouut
, ušt32_ˆ
ouut_Ëngth
, 
ušt8_t
 *
key
, ušt32_ˆ
key_size
)

1129 
sgx_¡©us_t
 
¡©us
 = 
	`deüy±_d©a
((
ušt8_t
 *)
’üy±_šput
, 
šput_Ëngth
, (ušt8_ˆ*)
¶aš‹xt_ouut
, 
ouut_Ëngth
);

1130 if(
¡©us
 !ğ
SGX_SUCCESS
)

1132 
	`oÿÎ_´št
("Decryption failed...!!!",1.0);

1136 
	}
}

1138 
	$eÿÎ_’üy±
(
ušt32_t
 *
¶aš‹xt_šput
, ušt32_ˆ
šput_Ëngth
, ušt32_ˆ*
’üy±ed_ouut
, ušt32_ˆ
ouut_Ëngth
, 
ušt8_t
 *
key
, ušt32_ˆ
key_size
)

1141 
	}
}

	@Enclave/Enclave.h

1 #iâdeà
ENCLAVE_TA


2 
	#ENCLAVE_TA


	)

3 
	~<¡dlib.h
>

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

6 
	~<as£¹.h
>

8 
bš¬ize_ıu_TA
(*
šput
, 
n
, *
bš¬y
);

9 
bš¬ize_weights_TA
(*
weights
, 
n
, 
size
, *
bš¬y
);

10 
sw­_bš¬y_TA
(
Ïy”_TA
 *
l
);

11 
add_bŸs_TA
(*
ouut
, *
bŸ£s
, 
b©ch
, 
n
, 
size
);

12 
sÿË_bŸs_TA
(*
ouut
, *
sÿËs
, 
b©ch
, 
n
, 
size
);

13 
fÜw¬d_b©chnÜm_Ïy”_’şave
(
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
);

14 
fÜw¬d_cÚÃùed_Ïy”_’şave
(
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
);

15 
fÜw¬d_soámax_Ïy”_’şave
(cÚ¡ 
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
);

16 
COST_TYPE_TA
 
g‘_co¡_ty³_TA
(*
s
);

17 
fÜw¬d_co¡_Ïy”_’şave
(
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
);

18 
fÜw¬d_maxpoŞ_Ïy”_’şave
(cÚ¡ 
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
);

19 
fÜw¬d_drİout_Ïy”_’şave
(
Ïy”_TA
 
l
, 
ÃtwÜk_TA
 
Ãt
);

20 
«s_cbc_TA
(* 
xüy±
, * 
g¿d›Á
, 
Üg_Ën
);

21 
Œª¥o£_m©rix_TA
(*
a
, 
rows
, 
cŞs
);

22 
ÿlc_ÃtwÜk_co¡_’şave
();

	@Enclave/Enclave_t.c

1 
	~"Enşave_t.h
"

3 
	~"sgx_Œts.h
"

4 
	~"sgx_lãnû.h
"

6 
	~<”ºo.h
>

7 
	~<mbu§ãüt.h
>

8 
	~<¡dlib.h
>

10 
	#CHECK_REF_POINTER
(
±r
, 
siz
) do { \

11 ià(!(
±r
è|| ! 
	`sgx_is_outside_’şave
(ÕŒ), (
siz
))) \

12  
SGX_ERROR_INVALID_PARAMETER
;\

13 } 0)

	)

15 
	#CHECK_UNIQUE_POINTER
(
±r
, 
siz
) do { \

16 ià((
±r
è&& ! 
	`sgx_is_outside_’şave
(ÕŒ), (
siz
))) \

17  
SGX_ERROR_INVALID_PARAMETER
;\

18 } 0)

	)

20 
	#CHECK_ENCLAVE_POINTER
(
±r
, 
siz
) do { \

21 ià((
±r
è&& ! 
	`sgx_is_w™hš_’şave
(ÕŒ), (
siz
))) \

22  
SGX_ERROR_INVALID_PARAMETER
;\

23 } 0)

	)

25 
	#ADD_ASSIGN_OVERFLOW
(
a
, 
b
) ( \

26 ((
a
è+ğ(
b
)) < (b) \

27 )

	)

30 
	sms_eÿÎ_make_ÃtwÜk_t
 {

31 
	mms_»tv®
;

32 
	mms_n
;

33 
	mms_Ë¬nšg_¿‹
;

34 
	mms_mom’tum
;

35 
	mms_deÿy
;

36 
	mms_time_¡•s
;

37 
	mms_nÙruth
;

38 
	mms_b©ch
;

39 
	mms_subdivisiÚs
;

40 
	mms_¿ndom
;

41 
	mms_adam
;

42 
	mms_B1
;

43 
	mms_B2
;

44 
	mms_•s
;

45 
	mms_h
;

46 
	mms_w
;

47 
	mms_c
;

48 
	mms_šputs
;

49 
	mms_max_üİ
;

50 
	mms_mš_üİ
;

51 
	mms_max_¿tio
;

52 
	mms_mš_¿tio
;

53 
	mms_ûÁ”
;

54 
	mms_ş
;

55 
	mms_ªgË
;

56 
	mms_a¥eù
;

57 
	mms_§tu¿tiÚ
;

58 
	mms_exposu»
;

59 
	mms_hue
;

60 
	mms_buº_š
;

61 
	mms_pow”
;

62 
	mms_max_b©ches
;

63 
	mms_¡¬t_šdex
;

64 } 
	tms_eÿÎ_make_ÃtwÜk_t
;

66 
	sms_eÿÎ_make_cÚvŞutiÚ®_Ïy”_t
 {

67 
	mms_»tv®
;

68 
	mms_b©ch
;

69 
	mms_h
;

70 
	mms_w
;

71 
	mms_c
;

72 
	mms_n
;

73 
	mms_groups
;

74 
	mms_size
;

75 
	mms_¡ride
;

76 
	mms_·ddšg
;

77 * 
	mms_aùiv©iÚ_s
;

78 
	mms_aùi_Ëngth
;

79 
	mms_b©ch_nÜm®ize
;

80 
	mms_bš¬y
;

81 
	mms_xnÜ
;

82 
	mms_adam
;

83 
	mms_æ³d
;

84 
	mms_dÙ
;

85 } 
	tms_eÿÎ_make_cÚvŞutiÚ®_Ïy”_t
;

87 
	sms_eÿÎ_make_cÚÃùed_Ïy”_t
 {

88 
	mms_»tv®
;

89 
	mms_b©ch
;

90 
	mms_šputs
;

91 
	mms_ouuts
;

92 * 
	mms_aùiv©iÚ_s
;

93 
	mms_aùi_Ëngth
;

94 
	mms_b©ch_nÜm®ize
;

95 
	mms_adam
;

96 } 
	tms_eÿÎ_make_cÚÃùed_Ïy”_t
;

98 
	sms_eÿÎ_make_soámax_Ïy”_t
 {

99 
	mms_»tv®
;

100 
	mms_b©ch
;

101 
	mms_šputs
;

102 
	mms_groups
;

103 
	mms_‹m³¿tu»
;

104 
	mms_w
;

105 
	mms_h
;

106 
	mms_c
;

107 
	mms_¥©Ÿl
;

108 
	mms_nŞoss
;

109 } 
	tms_eÿÎ_make_soámax_Ïy”_t
;

111 
	sms_eÿÎ_make_co¡_Ïy”_t
 {

112 
	mms_»tv®
;

113 
	mms_b©ch
;

114 
	mms_šputs
;

115 * 
	mms_co¡_ty³
;

116 
	mms_co¡_size
;

117 
	mms_sÿË
;

118 
	mms_¿tio
;

119 
	mms_noobjeù_sÿË
;

120 
	mms_th»sh
;

121 } 
	tms_eÿÎ_make_co¡_Ïy”_t
;

123 
	sms_eÿÎ_make_maxpoŞ_Ïy”_t
 {

124 
	mms_»tv®
;

125 
	mms_b©ch
;

126 
	mms_h
;

127 
	mms_w
;

128 
	mms_c
;

129 
	mms_size
;

130 
	mms_¡ride
;

131 
	mms_·ddšg
;

132 } 
	tms_eÿÎ_make_maxpoŞ_Ïy”_t
;

134 
	sms_eÿÎ_make_drİout_Ïy”_t
 {

135 
	mms_»tv®
;

136 
	mms_b©ch
;

137 
	mms_šputs
;

138 
	mms_´obab™y
;

139 
	mms_w
;

140 
	mms_h
;

141 
	mms_c
;

142 * 
	mms_Ãt_´ev_ouut
;

143 
	mms_´ev_size
;

144 * 
	mms_Ãt_´ev_d–
;

145 
	mms_d–_size
;

146 } 
	tms_eÿÎ_make_drİout_Ïy”_t
;

148 
	sms_eÿÎ_make_avgpoŞ_Ïy”_t
 {

149 
	mms_»tv®
;

150 
	mms_b©ch
;

151 
	mms_w
;

152 
	mms_h
;

153 
	mms_c
;

154 } 
	tms_eÿÎ_make_avgpoŞ_Ïy”_t
;

156 
	sms_eÿÎ_®loÿ‹_wÜk¥aû_t
 {

157 
	mms_»tv®
;

158 
	mms_wÜk¥aû_size
;

159 } 
	tms_eÿÎ_®loÿ‹_wÜk¥aû_t
;

161 
	sms_eÿÎ_Œªsãr_weights_t
 {

162 
	mms_»tv®
;

163 * 
	mms_vec
;

164 
	mms_Ëngth
;

165 
	mms_Ïy”_i
;

166 
	mms_ty³
;

167 
	mms_add™iÚ®
;

168 } 
	tms_eÿÎ_Œªsãr_weights_t
;

170 
	sms_eÿÎ_Ãt_ouut_»tuº_t
 {

171 
	mms_»tv®
;

172 * 
	mms_Ãt_ouut
;

173 
	mms_Ëngth
;

174 
ušt8_t
* 
	mms_g_bufãr
;

175 
	mms_g_Ëngth
;

176 } 
	tms_eÿÎ_Ãt_ouut_»tuº_t
;

178 
	sms_eÿÎ_fÜw¬d_ÃtwÜk_t
 {

179 
	mms_»tv®
;

180 * 
	mms_Ãt_šput
;

181 
	mms_l_šputs
;

182 
ušt8_t
* 
	mms_g_bufãr
;

183 
	mms_l_g
;

184 
	mms_Ãt_Œaš
;

185 } 
	tms_eÿÎ_fÜw¬d_ÃtwÜk_t
;

187 
	sms_eÿÎ_©‹¡_£ssiÚ_tok’_t
 {

188 
	mms_»tv®
;

189 
	mms_£ssiÚ_tok’
;

190 * 
	mms_©‹¡©iÚ_bufãr
;

191 
	mms_©‹¡_size
;

192 
ušt8_t
* 
	mms_g_bufãr
;

193 
	mms_l_g
;

194 } 
	tms_eÿÎ_©‹¡_£ssiÚ_tok’_t
;

196 
	sms_eÿÎ_deüy±_t
 {

197 
	mms_»tv®
;

198 
ušt32_t
* 
	mms_’üy±_šput
;

199 
ušt32_t
 
	mms_šput_Ëngth
;

200 
ušt32_t
* 
	mms_¶aš‹xt_ouut
;

201 
ušt32_t
 
	mms_ouut_Ëngth
;

202 
ušt8_t
* 
	mms_key
;

203 
ušt32_t
 
	mms_key_size
;

204 } 
	tms_eÿÎ_deüy±_t
;

206 
	sms_eÿÎ_’üy±_t
 {

207 
	mms_»tv®
;

208 
ušt32_t
* 
	mms_¶aš‹xt_šput
;

209 
ušt32_t
 
	mms_šput_Ëngth
;

210 
ušt32_t
* 
	mms_’üy±ed_ouut
;

211 
ušt32_t
 
	mms_ouut_Ëngth
;

212 
ušt8_t
* 
	mms_key
;

213 
ušt32_t
 
	mms_key_size
;

214 } 
	tms_eÿÎ_’üy±_t
;

216 
	sms_oÿÎ_´št_t
 {

217 cÚ¡ * 
	mms_¡r
;

218 
	mms_v®ue
;

219 } 
	tms_oÿÎ_´št_t
;

221 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_make_ÃtwÜk
(* 
pms
)

223 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_make_ÃtwÜk_t
));

227 
	`sgx_lãnû
();

228 
ms_eÿÎ_make_ÃtwÜk_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_make_ÃtwÜk_t*, 
pms
);

229 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

233 
ms
->
ms_»tv®
 = 
	`eÿÎ_make_ÃtwÜk
(ms->
ms_n
, ms->
ms_Ë¬nšg_¿‹
, ms->
ms_mom’tum
, ms->
ms_deÿy
, ms->
ms_time_¡•s
, ms->
ms_nÙruth
, ms->
ms_b©ch
, ms->
ms_subdivisiÚs
, ms->
ms_¿ndom
, ms->
ms_adam
, ms->
ms_B1
, ms->
ms_B2
, ms->
ms_•s
, ms->
ms_h
, ms->
ms_w
, ms->
ms_c
, ms->
ms_šputs
, ms->
ms_max_üİ
, ms->
ms_mš_üİ
, ms->
ms_max_¿tio
, ms->
ms_mš_¿tio
, ms->
ms_ûÁ”
, ms->
ms_ş
, ms->
ms_ªgË
, ms->
ms_a¥eù
, ms->
ms_§tu¿tiÚ
, ms->
ms_exposu»
, ms->
ms_hue
, ms->
ms_buº_š
, ms->
ms_pow”
, ms->
ms_max_b©ches
, ms->
ms_¡¬t_šdex
);

236  
¡©us
;

237 
	}
}

239 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_make_cÚvŞutiÚ®_Ïy”
(* 
pms
)

241 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_make_cÚvŞutiÚ®_Ïy”_t
));

245 
	`sgx_lãnû
();

246 
ms_eÿÎ_make_cÚvŞutiÚ®_Ïy”_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_make_cÚvŞutiÚ®_Ïy”_t*, 
pms
);

247 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

248 * 
_tmp_aùiv©iÚ_s
 = 
ms
->
ms_aùiv©iÚ_s
;

249 
_tmp_aùi_Ëngth
 = 
ms
->
ms_aùi_Ëngth
;

250 
size_t
 
_Ën_aùiv©iÚ_s
 = 
_tmp_aùi_Ëngth
;

251 * 
_š_aùiv©iÚ_s
 = 
NULL
;

253 
	`CHECK_UNIQUE_POINTER
(
_tmp_aùiv©iÚ_s
, 
_Ën_aùiv©iÚ_s
);

258 
	`sgx_lãnû
();

260 ià(
_tmp_aùiv©iÚ_s
 !ğ
NULL
 && 
_Ën_aùiv©iÚ_s
 != 0) {

261 iàĞ
_Ën_aùiv©iÚ_s
 % (*
_tmp_aùiv©iÚ_s
) != 0)

263 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

264 
”r
;

266 
_š_aùiv©iÚ_s
 = (*)
	`m®loc
(
_Ën_aùiv©iÚ_s
);

267 ià(
_š_aùiv©iÚ_s
 =ğ
NULL
) {

268 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

269 
”r
;

272 ià(
	`memıy_s
(
_š_aùiv©iÚ_s
, 
_Ën_aùiv©iÚ_s
, 
_tmp_aùiv©iÚ_s
, _len_activation_s)) {

273 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

274 
”r
;

279 
ms
->
ms_»tv®
 = 
	`eÿÎ_make_cÚvŞutiÚ®_Ïy”
(ms->
ms_b©ch
, ms->
ms_h
, ms->
ms_w
, ms->
ms_c
, ms->
ms_n
, ms->
ms_groups
, ms->
ms_size
, ms->
ms_¡ride
, ms->
ms_·ddšg
, 
_š_aùiv©iÚ_s
, 
_tmp_aùi_Ëngth
, ms->
ms_b©ch_nÜm®ize
, ms->
ms_bš¬y
, ms->
ms_xnÜ
, ms->
ms_adam
, ms->
ms_æ³d
, ms->
ms_dÙ
);

281 
”r
:

282 ià(
_š_aùiv©iÚ_s
è
	`ä“
(_in_activation_s);

283  
¡©us
;

284 
	}
}

286 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_make_cÚÃùed_Ïy”
(* 
pms
)

288 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_make_cÚÃùed_Ïy”_t
));

292 
	`sgx_lãnû
();

293 
ms_eÿÎ_make_cÚÃùed_Ïy”_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_make_cÚÃùed_Ïy”_t*, 
pms
);

294 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

295 * 
_tmp_aùiv©iÚ_s
 = 
ms
->
ms_aùiv©iÚ_s
;

296 
_tmp_aùi_Ëngth
 = 
ms
->
ms_aùi_Ëngth
;

297 
size_t
 
_Ën_aùiv©iÚ_s
 = 
_tmp_aùi_Ëngth
;

298 * 
_š_aùiv©iÚ_s
 = 
NULL
;

300 
	`CHECK_UNIQUE_POINTER
(
_tmp_aùiv©iÚ_s
, 
_Ën_aùiv©iÚ_s
);

305 
	`sgx_lãnû
();

307 ià(
_tmp_aùiv©iÚ_s
 !ğ
NULL
 && 
_Ën_aùiv©iÚ_s
 != 0) {

308 iàĞ
_Ën_aùiv©iÚ_s
 % (*
_tmp_aùiv©iÚ_s
) != 0)

310 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

311 
”r
;

313 
_š_aùiv©iÚ_s
 = (*)
	`m®loc
(
_Ën_aùiv©iÚ_s
);

314 ià(
_š_aùiv©iÚ_s
 =ğ
NULL
) {

315 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

316 
”r
;

319 ià(
	`memıy_s
(
_š_aùiv©iÚ_s
, 
_Ën_aùiv©iÚ_s
, 
_tmp_aùiv©iÚ_s
, _len_activation_s)) {

320 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

321 
”r
;

326 
ms
->
ms_»tv®
 = 
	`eÿÎ_make_cÚÃùed_Ïy”
(ms->
ms_b©ch
, ms->
ms_šputs
, ms->
ms_ouuts
, 
_š_aùiv©iÚ_s
, 
_tmp_aùi_Ëngth
, ms->
ms_b©ch_nÜm®ize
, ms->
ms_adam
);

328 
”r
:

329 ià(
_š_aùiv©iÚ_s
è
	`ä“
(_in_activation_s);

330  
¡©us
;

331 
	}
}

333 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_make_soámax_Ïy”
(* 
pms
)

335 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_make_soámax_Ïy”_t
));

339 
	`sgx_lãnû
();

340 
ms_eÿÎ_make_soámax_Ïy”_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_make_soámax_Ïy”_t*, 
pms
);

341 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

345 
ms
->
ms_»tv®
 = 
	`eÿÎ_make_soámax_Ïy”
(ms->
ms_b©ch
, ms->
ms_šputs
, ms->
ms_groups
, ms->
ms_‹m³¿tu»
, ms->
ms_w
, ms->
ms_h
, ms->
ms_c
, ms->
ms_¥©Ÿl
, ms->
ms_nŞoss
);

348  
¡©us
;

349 
	}
}

351 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_make_co¡_Ïy”
(* 
pms
)

353 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_make_co¡_Ïy”_t
));

357 
	`sgx_lãnû
();

358 
ms_eÿÎ_make_co¡_Ïy”_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_make_co¡_Ïy”_t*, 
pms
);

359 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

360 * 
_tmp_co¡_ty³
 = 
ms
->
ms_co¡_ty³
;

361 
_tmp_co¡_size
 = 
ms
->
ms_co¡_size
;

362 
size_t
 
_Ën_co¡_ty³
 = 
_tmp_co¡_size
;

363 * 
_š_co¡_ty³
 = 
NULL
;

365 
	`CHECK_UNIQUE_POINTER
(
_tmp_co¡_ty³
, 
_Ën_co¡_ty³
);

370 
	`sgx_lãnû
();

372 ià(
_tmp_co¡_ty³
 !ğ
NULL
 && 
_Ën_co¡_ty³
 != 0) {

373 iàĞ
_Ën_co¡_ty³
 % (*
_tmp_co¡_ty³
) != 0)

375 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

376 
”r
;

378 
_š_co¡_ty³
 = (*)
	`m®loc
(
_Ën_co¡_ty³
);

379 ià(
_š_co¡_ty³
 =ğ
NULL
) {

380 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

381 
”r
;

384 ià(
	`memıy_s
(
_š_co¡_ty³
, 
_Ën_co¡_ty³
, 
_tmp_co¡_ty³
, _len_cost_type)) {

385 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

386 
”r
;

391 
ms
->
ms_»tv®
 = 
	`eÿÎ_make_co¡_Ïy”
(ms->
ms_b©ch
, ms->
ms_šputs
, 
_š_co¡_ty³
, 
_tmp_co¡_size
, ms->
ms_sÿË
, ms->
ms_¿tio
, ms->
ms_noobjeù_sÿË
, ms->
ms_th»sh
);

393 
”r
:

394 ià(
_š_co¡_ty³
è
	`ä“
(_in_cost_type);

395  
¡©us
;

396 
	}
}

398 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_make_maxpoŞ_Ïy”
(* 
pms
)

400 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_make_maxpoŞ_Ïy”_t
));

404 
	`sgx_lãnû
();

405 
ms_eÿÎ_make_maxpoŞ_Ïy”_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_make_maxpoŞ_Ïy”_t*, 
pms
);

406 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

410 
ms
->
ms_»tv®
 = 
	`eÿÎ_make_maxpoŞ_Ïy”
(ms->
ms_b©ch
, ms->
ms_h
, ms->
ms_w
, ms->
ms_c
, ms->
ms_size
, ms->
ms_¡ride
, ms->
ms_·ddšg
);

413  
¡©us
;

414 
	}
}

416 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_make_drİout_Ïy”
(* 
pms
)

418 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_make_drİout_Ïy”_t
));

422 
	`sgx_lãnû
();

423 
ms_eÿÎ_make_drİout_Ïy”_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_make_drİout_Ïy”_t*, 
pms
);

424 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

425 * 
_tmp_Ãt_´ev_ouut
 = 
ms
->
ms_Ãt_´ev_ouut
;

426 
_tmp_´ev_size
 = 
ms
->
ms_´ev_size
;

427 
size_t
 
_Ën_Ãt_´ev_ouut
 = 
_tmp_´ev_size
;

428 * 
_š_Ãt_´ev_ouut
 = 
NULL
;

429 * 
_tmp_Ãt_´ev_d–
 = 
ms
->
ms_Ãt_´ev_d–
;

430 
_tmp_d–_size
 = 
ms
->
ms_d–_size
;

431 
size_t
 
_Ën_Ãt_´ev_d–
 = 
_tmp_d–_size
;

432 * 
_š_Ãt_´ev_d–
 = 
NULL
;

434 
	`CHECK_UNIQUE_POINTER
(
_tmp_Ãt_´ev_ouut
, 
_Ën_Ãt_´ev_ouut
);

435 
	`CHECK_UNIQUE_POINTER
(
_tmp_Ãt_´ev_d–
, 
_Ën_Ãt_´ev_d–
);

440 
	`sgx_lãnû
();

442 ià(
_tmp_Ãt_´ev_ouut
 !ğ
NULL
 && 
_Ën_Ãt_´ev_ouut
 != 0) {

443 iàĞ
_Ën_Ãt_´ev_ouut
 % (*
_tmp_Ãt_´ev_ouut
) != 0)

445 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

446 
”r
;

448 
_š_Ãt_´ev_ouut
 = (*)
	`m®loc
(
_Ën_Ãt_´ev_ouut
);

449 ià(
_š_Ãt_´ev_ouut
 =ğ
NULL
) {

450 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

451 
”r
;

454 ià(
	`memıy_s
(
_š_Ãt_´ev_ouut
, 
_Ën_Ãt_´ev_ouut
, 
_tmp_Ãt_´ev_ouut
, _len_net_prev_output)) {

455 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

456 
”r
;

460 ià(
_tmp_Ãt_´ev_d–
 !ğ
NULL
 && 
_Ën_Ãt_´ev_d–
 != 0) {

461 iàĞ
_Ën_Ãt_´ev_d–
 % (*
_tmp_Ãt_´ev_d–
) != 0)

463 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

464 
”r
;

466 
_š_Ãt_´ev_d–
 = (*)
	`m®loc
(
_Ën_Ãt_´ev_d–
);

467 ià(
_š_Ãt_´ev_d–
 =ğ
NULL
) {

468 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

469 
”r
;

472 ià(
	`memıy_s
(
_š_Ãt_´ev_d–
, 
_Ën_Ãt_´ev_d–
, 
_tmp_Ãt_´ev_d–
, _len_net_prev_delta)) {

473 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

474 
”r
;

479 
ms
->
ms_»tv®
 = 
	`eÿÎ_make_drİout_Ïy”
(ms->
ms_b©ch
, ms->
ms_šputs
, ms->
ms_´obab™y
, ms->
ms_w
, ms->
ms_h
, ms->
ms_c
, 
_š_Ãt_´ev_ouut
, 
_tmp_´ev_size
, 
_š_Ãt_´ev_d–
, 
_tmp_d–_size
);

481 
”r
:

482 ià(
_š_Ãt_´ev_ouut
è
	`ä“
(_in_net_prev_output);

483 ià(
_š_Ãt_´ev_d–
è
	`ä“
(_in_net_prev_delta);

484  
¡©us
;

485 
	}
}

487 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_make_avgpoŞ_Ïy”
(* 
pms
)

489 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_make_avgpoŞ_Ïy”_t
));

493 
	`sgx_lãnû
();

494 
ms_eÿÎ_make_avgpoŞ_Ïy”_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_make_avgpoŞ_Ïy”_t*, 
pms
);

495 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

499 
ms
->
ms_»tv®
 = 
	`eÿÎ_make_avgpoŞ_Ïy”
(ms->
ms_b©ch
, ms->
ms_w
, ms->
ms_h
, ms->
ms_c
);

502  
¡©us
;

503 
	}
}

505 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_®loÿ‹_wÜk¥aû
(* 
pms
)

507 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_®loÿ‹_wÜk¥aû_t
));

511 
	`sgx_lãnû
();

512 
ms_eÿÎ_®loÿ‹_wÜk¥aû_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_®loÿ‹_wÜk¥aû_t*, 
pms
);

513 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

517 
ms
->
ms_»tv®
 = 
	`eÿÎ_®loÿ‹_wÜk¥aû
(ms->
ms_wÜk¥aû_size
);

520  
¡©us
;

521 
	}
}

523 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_Œªsãr_weights
(* 
pms
)

525 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_Œªsãr_weights_t
));

529 
	`sgx_lãnû
();

530 
ms_eÿÎ_Œªsãr_weights_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_Œªsãr_weights_t*, 
pms
);

531 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

532 * 
_tmp_vec
 = 
ms
->
ms_vec
;

533 
_tmp_Ëngth
 = 
ms
->
ms_Ëngth
;

534 
size_t
 
_Ën_vec
 = 
_tmp_Ëngth
;

535 * 
_š_vec
 = 
NULL
;

537 
	`CHECK_UNIQUE_POINTER
(
_tmp_vec
, 
_Ën_vec
);

542 
	`sgx_lãnû
();

544 ià(
_tmp_vec
 !ğ
NULL
 && 
_Ën_vec
 != 0) {

545 iàĞ
_Ën_vec
 % (*
_tmp_vec
) != 0)

547 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

548 
”r
;

550 
_š_vec
 = (*)
	`m®loc
(
_Ën_vec
);

551 ià(
_š_vec
 =ğ
NULL
) {

552 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

553 
”r
;

556 ià(
	`memıy_s
(
_š_vec
, 
_Ën_vec
, 
_tmp_vec
, _len_vec)) {

557 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

558 
”r
;

563 
ms
->
ms_»tv®
 = 
	`eÿÎ_Œªsãr_weights
(
_š_vec
, 
_tmp_Ëngth
, ms->
ms_Ïy”_i
, ms->
ms_ty³
, ms->
ms_add™iÚ®
);

565 
”r
:

566 ià(
_š_vec
è
	`ä“
(_in_vec);

567  
¡©us
;

568 
	}
}

570 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_Ãt_ouut_»tuº
(* 
pms
)

572 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_Ãt_ouut_»tuº_t
));

576 
	`sgx_lãnû
();

577 
ms_eÿÎ_Ãt_ouut_»tuº_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_Ãt_ouut_»tuº_t*, 
pms
);

578 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

579 * 
_tmp_Ãt_ouut
 = 
ms
->
ms_Ãt_ouut
;

580 
_tmp_Ëngth
 = 
ms
->
ms_Ëngth
;

581 
size_t
 
_Ën_Ãt_ouut
 = 
_tmp_Ëngth
;

582 * 
_š_Ãt_ouut
 = 
NULL
;

583 
ušt8_t
* 
_tmp_g_bufãr
 = 
ms
->
ms_g_bufãr
;

584 
_tmp_g_Ëngth
 = 
ms
->
ms_g_Ëngth
;

585 
size_t
 
_Ën_g_bufãr
 = 
_tmp_g_Ëngth
;

586 
ušt8_t
* 
_š_g_bufãr
 = 
NULL
;

588 
	`CHECK_UNIQUE_POINTER
(
_tmp_Ãt_ouut
, 
_Ën_Ãt_ouut
);

589 
	`CHECK_UNIQUE_POINTER
(
_tmp_g_bufãr
, 
_Ën_g_bufãr
);

594 
	`sgx_lãnû
();

596 ià(
_tmp_Ãt_ouut
 !ğ
NULL
 && 
_Ën_Ãt_ouut
 != 0) {

597 iàĞ
_Ën_Ãt_ouut
 % (*
_tmp_Ãt_ouut
) != 0)

599 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

600 
”r
;

602 
_š_Ãt_ouut
 = (*)
	`m®loc
(
_Ën_Ãt_ouut
);

603 ià(
_š_Ãt_ouut
 =ğ
NULL
) {

604 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

605 
”r
;

608 ià(
	`memıy_s
(
_š_Ãt_ouut
, 
_Ën_Ãt_ouut
, 
_tmp_Ãt_ouut
, _len_net_output)) {

609 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

610 
”r
;

614 ià(
_tmp_g_bufãr
 !ğ
NULL
 && 
_Ën_g_bufãr
 != 0) {

615 iàĞ
_Ën_g_bufãr
 % (*
_tmp_g_bufãr
) != 0)

617 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

618 
”r
;

620 
_š_g_bufãr
 = (
ušt8_t
*)
	`m®loc
(
_Ën_g_bufãr
);

621 ià(
_š_g_bufãr
 =ğ
NULL
) {

622 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

623 
”r
;

626 ià(
	`memıy_s
(
_š_g_bufãr
, 
_Ën_g_bufãr
, 
_tmp_g_bufãr
, _len_tag_buffer)) {

627 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

628 
”r
;

633 
ms
->
ms_»tv®
 = 
	`eÿÎ_Ãt_ouut_»tuº
(
_š_Ãt_ouut
, 
_tmp_Ëngth
, 
_š_g_bufãr
, 
_tmp_g_Ëngth
);

634 ià(
_š_Ãt_ouut
) {

635 ià(
	`memıy_s
(
_tmp_Ãt_ouut
, 
_Ën_Ãt_ouut
, 
_š_Ãt_ouut
, _len_net_output)) {

636 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

637 
”r
;

640 ià(
_š_g_bufãr
) {

641 ià(
	`memıy_s
(
_tmp_g_bufãr
, 
_Ën_g_bufãr
, 
_š_g_bufãr
, _len_tag_buffer)) {

642 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

643 
”r
;

647 
”r
:

648 ià(
_š_Ãt_ouut
è
	`ä“
(_in_net_output);

649 ià(
_š_g_bufãr
è
	`ä“
(_in_tag_buffer);

650  
¡©us
;

651 
	}
}

653 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_fÜw¬d_ÃtwÜk
(* 
pms
)

655 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_fÜw¬d_ÃtwÜk_t
));

659 
	`sgx_lãnû
();

660 
ms_eÿÎ_fÜw¬d_ÃtwÜk_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_fÜw¬d_ÃtwÜk_t*, 
pms
);

661 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

662 * 
_tmp_Ãt_šput
 = 
ms
->
ms_Ãt_šput
;

663 
_tmp_l_šputs
 = 
ms
->
ms_l_šputs
;

664 
size_t
 
_Ën_Ãt_šput
 = 
_tmp_l_šputs
;

665 * 
_š_Ãt_šput
 = 
NULL
;

666 
ušt8_t
* 
_tmp_g_bufãr
 = 
ms
->
ms_g_bufãr
;

667 
_tmp_l_g
 = 
ms
->
ms_l_g
;

668 
size_t
 
_Ën_g_bufãr
 = 
_tmp_l_g
;

669 
ušt8_t
* 
_š_g_bufãr
 = 
NULL
;

671 
	`CHECK_UNIQUE_POINTER
(
_tmp_Ãt_šput
, 
_Ën_Ãt_šput
);

672 
	`CHECK_UNIQUE_POINTER
(
_tmp_g_bufãr
, 
_Ën_g_bufãr
);

677 
	`sgx_lãnû
();

679 ià(
_tmp_Ãt_šput
 !ğ
NULL
 && 
_Ën_Ãt_šput
 != 0) {

680 iàĞ
_Ën_Ãt_šput
 % (*
_tmp_Ãt_šput
) != 0)

682 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

683 
”r
;

685 
_š_Ãt_šput
 = (*)
	`m®loc
(
_Ën_Ãt_šput
);

686 ià(
_š_Ãt_šput
 =ğ
NULL
) {

687 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

688 
”r
;

691 ià(
	`memıy_s
(
_š_Ãt_šput
, 
_Ën_Ãt_šput
, 
_tmp_Ãt_šput
, _len_net_input)) {

692 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

693 
”r
;

697 ià(
_tmp_g_bufãr
 !ğ
NULL
 && 
_Ën_g_bufãr
 != 0) {

698 iàĞ
_Ën_g_bufãr
 % (*
_tmp_g_bufãr
) != 0)

700 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

701 
”r
;

703 
_š_g_bufãr
 = (
ušt8_t
*)
	`m®loc
(
_Ën_g_bufãr
);

704 ià(
_š_g_bufãr
 =ğ
NULL
) {

705 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

706 
”r
;

709 ià(
	`memıy_s
(
_š_g_bufãr
, 
_Ën_g_bufãr
, 
_tmp_g_bufãr
, _len_tag_buffer)) {

710 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

711 
”r
;

716 
ms
->
ms_»tv®
 = 
	`eÿÎ_fÜw¬d_ÃtwÜk
(
_š_Ãt_šput
, 
_tmp_l_šputs
, 
_š_g_bufãr
, 
_tmp_l_g
, ms->
ms_Ãt_Œaš
);

718 
”r
:

719 ià(
_š_Ãt_šput
è
	`ä“
(_in_net_input);

720 ià(
_š_g_bufãr
è
	`ä“
(_in_tag_buffer);

721  
¡©us
;

722 
	}
}

724 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_©‹¡_£ssiÚ_tok’
(* 
pms
)

726 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_©‹¡_£ssiÚ_tok’_t
));

730 
	`sgx_lãnû
();

731 
ms_eÿÎ_©‹¡_£ssiÚ_tok’_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_©‹¡_£ssiÚ_tok’_t*, 
pms
);

732 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

733 * 
_tmp_©‹¡©iÚ_bufãr
 = 
ms
->
ms_©‹¡©iÚ_bufãr
;

734 
_tmp_©‹¡_size
 = 
ms
->
ms_©‹¡_size
;

735 
size_t
 
_Ën_©‹¡©iÚ_bufãr
 = 
_tmp_©‹¡_size
;

736 * 
_š_©‹¡©iÚ_bufãr
 = 
NULL
;

737 
ušt8_t
* 
_tmp_g_bufãr
 = 
ms
->
ms_g_bufãr
;

738 
_tmp_l_g
 = 
ms
->
ms_l_g
;

739 
size_t
 
_Ën_g_bufãr
 = 
_tmp_l_g
;

740 
ušt8_t
* 
_š_g_bufãr
 = 
NULL
;

742 
	`CHECK_UNIQUE_POINTER
(
_tmp_©‹¡©iÚ_bufãr
, 
_Ën_©‹¡©iÚ_bufãr
);

743 
	`CHECK_UNIQUE_POINTER
(
_tmp_g_bufãr
, 
_Ën_g_bufãr
);

748 
	`sgx_lãnû
();

750 ià(
_tmp_©‹¡©iÚ_bufãr
 !ğ
NULL
 && 
_Ën_©‹¡©iÚ_bufãr
 != 0) {

751 iàĞ
_Ën_©‹¡©iÚ_bufãr
 % (*
_tmp_©‹¡©iÚ_bufãr
) != 0)

753 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

754 
”r
;

756 
_š_©‹¡©iÚ_bufãr
 = (*)
	`m®loc
(
_Ën_©‹¡©iÚ_bufãr
);

757 ià(
_š_©‹¡©iÚ_bufãr
 =ğ
NULL
) {

758 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

759 
”r
;

762 ià(
	`memıy_s
(
_š_©‹¡©iÚ_bufãr
, 
_Ën_©‹¡©iÚ_bufãr
, 
_tmp_©‹¡©iÚ_bufãr
, _len_attestation_buffer)) {

763 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

764 
”r
;

768 ià(
_tmp_g_bufãr
 !ğ
NULL
 && 
_Ën_g_bufãr
 != 0) {

769 iàĞ
_Ën_g_bufãr
 % (*
_tmp_g_bufãr
) != 0)

771 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

772 
”r
;

774 
_š_g_bufãr
 = (
ušt8_t
*)
	`m®loc
(
_Ën_g_bufãr
);

775 ià(
_š_g_bufãr
 =ğ
NULL
) {

776 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

777 
”r
;

780 ià(
	`memıy_s
(
_š_g_bufãr
, 
_Ën_g_bufãr
, 
_tmp_g_bufãr
, _len_tag_buffer)) {

781 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

782 
”r
;

787 
ms
->
ms_»tv®
 = 
	`eÿÎ_©‹¡_£ssiÚ_tok’
(ms->
ms_£ssiÚ_tok’
, 
_š_©‹¡©iÚ_bufãr
, 
_tmp_©‹¡_size
, 
_š_g_bufãr
, 
_tmp_l_g
);

788 ià(
_š_©‹¡©iÚ_bufãr
) {

789 ià(
	`memıy_s
(
_tmp_©‹¡©iÚ_bufãr
, 
_Ën_©‹¡©iÚ_bufãr
, 
_š_©‹¡©iÚ_bufãr
, _len_attestation_buffer)) {

790 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

791 
”r
;

794 ià(
_š_g_bufãr
) {

795 ià(
	`memıy_s
(
_tmp_g_bufãr
, 
_Ën_g_bufãr
, 
_š_g_bufãr
, _len_tag_buffer)) {

796 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

797 
”r
;

801 
”r
:

802 ià(
_š_©‹¡©iÚ_bufãr
è
	`ä“
(_in_attestation_buffer);

803 ià(
_š_g_bufãr
è
	`ä“
(_in_tag_buffer);

804  
¡©us
;

805 
	}
}

807 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_deüy±
(* 
pms
)

809 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_deüy±_t
));

813 
	`sgx_lãnû
();

814 
ms_eÿÎ_deüy±_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_deüy±_t*, 
pms
);

815 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

816 
ušt32_t
* 
_tmp_’üy±_šput
 = 
ms
->
ms_’üy±_šput
;

817 
ušt32_t
 
_tmp_šput_Ëngth
 = 
ms
->
ms_šput_Ëngth
;

818 
size_t
 
_Ën_’üy±_šput
 = 
_tmp_šput_Ëngth
;

819 
ušt32_t
* 
_š_’üy±_šput
 = 
NULL
;

820 
ušt32_t
* 
_tmp_¶aš‹xt_ouut
 = 
ms
->
ms_¶aš‹xt_ouut
;

821 
ušt32_t
 
_tmp_ouut_Ëngth
 = 
ms
->
ms_ouut_Ëngth
;

822 
size_t
 
_Ën_¶aš‹xt_ouut
 = 
_tmp_ouut_Ëngth
;

823 
ušt32_t
* 
_š_¶aš‹xt_ouut
 = 
NULL
;

824 
ušt8_t
* 
_tmp_key
 = 
ms
->
ms_key
;

825 
ušt32_t
 
_tmp_key_size
 = 
ms
->
ms_key_size
;

826 
size_t
 
_Ën_key
 = 
_tmp_key_size
;

827 
ušt8_t
* 
_š_key
 = 
NULL
;

829 
	`CHECK_UNIQUE_POINTER
(
_tmp_’üy±_šput
, 
_Ën_’üy±_šput
);

830 
	`CHECK_UNIQUE_POINTER
(
_tmp_¶aš‹xt_ouut
, 
_Ën_¶aš‹xt_ouut
);

831 
	`CHECK_UNIQUE_POINTER
(
_tmp_key
, 
_Ën_key
);

836 
	`sgx_lãnû
();

838 ià(
_tmp_’üy±_šput
 !ğ
NULL
 && 
_Ën_’üy±_šput
 != 0) {

839 iàĞ
_Ën_’üy±_šput
 % (*
_tmp_’üy±_šput
) != 0)

841 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

842 
”r
;

844 
_š_’üy±_šput
 = (
ušt32_t
*)
	`m®loc
(
_Ën_’üy±_šput
);

845 ià(
_š_’üy±_šput
 =ğ
NULL
) {

846 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

847 
”r
;

850 ià(
	`memıy_s
(
_š_’üy±_šput
, 
_Ën_’üy±_šput
, 
_tmp_’üy±_šput
, _len_encrypt_input)) {

851 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

852 
”r
;

856 ià(
_tmp_¶aš‹xt_ouut
 !ğ
NULL
 && 
_Ën_¶aš‹xt_ouut
 != 0) {

857 iàĞ
_Ën_¶aš‹xt_ouut
 % (*
_tmp_¶aš‹xt_ouut
) != 0)

859 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

860 
”r
;

862 ià((
_š_¶aš‹xt_ouut
 = (
ušt32_t
*)
	`m®loc
(
_Ën_¶aš‹xt_ouut
)è=ğ
NULL
) {

863 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

864 
”r
;

867 
	`mem£t
((*)
_š_¶aš‹xt_ouut
, 0, 
_Ën_¶aš‹xt_ouut
);

869 ià(
_tmp_key
 !ğ
NULL
 && 
_Ën_key
 != 0) {

870 iàĞ
_Ën_key
 % (*
_tmp_key
) != 0)

872 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

873 
”r
;

875 
_š_key
 = (
ušt8_t
*)
	`m®loc
(
_Ën_key
);

876 ià(
_š_key
 =ğ
NULL
) {

877 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

878 
”r
;

881 ià(
	`memıy_s
(
_š_key
, 
_Ën_key
, 
_tmp_key
, _len_key)) {

882 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

883 
”r
;

888 
ms
->
ms_»tv®
 = 
	`eÿÎ_deüy±
(
_š_’üy±_šput
, 
_tmp_šput_Ëngth
, 
_š_¶aš‹xt_ouut
, 
_tmp_ouut_Ëngth
, 
_š_key
, 
_tmp_key_size
);

889 ià(
_š_¶aš‹xt_ouut
) {

890 ià(
	`memıy_s
(
_tmp_¶aš‹xt_ouut
, 
_Ën_¶aš‹xt_ouut
, 
_š_¶aš‹xt_ouut
, _len_plaintext_output)) {

891 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

892 
”r
;

895 ià(
_š_key
) {

896 ià(
	`memıy_s
(
_tmp_key
, 
_Ën_key
, 
_š_key
, _len_key)) {

897 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

898 
”r
;

902 
”r
:

903 ià(
_š_’üy±_šput
è
	`ä“
(_in_encrypt_input);

904 ià(
_š_¶aš‹xt_ouut
è
	`ä“
(_in_plaintext_output);

905 ià(
_š_key
è
	`ä“
(_in_key);

906  
¡©us
;

907 
	}
}

909 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_’üy±
(* 
pms
)

911 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_’üy±_t
));

915 
	`sgx_lãnû
();

916 
ms_eÿÎ_’üy±_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_’üy±_t*, 
pms
);

917 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

918 
ušt32_t
* 
_tmp_¶aš‹xt_šput
 = 
ms
->
ms_¶aš‹xt_šput
;

919 
ušt32_t
 
_tmp_šput_Ëngth
 = 
ms
->
ms_šput_Ëngth
;

920 
size_t
 
_Ën_¶aš‹xt_šput
 = 
_tmp_šput_Ëngth
;

921 
ušt32_t
* 
_š_¶aš‹xt_šput
 = 
NULL
;

922 
ušt32_t
* 
_tmp_’üy±ed_ouut
 = 
ms
->
ms_’üy±ed_ouut
;

923 
ušt32_t
 
_tmp_ouut_Ëngth
 = 
ms
->
ms_ouut_Ëngth
;

924 
size_t
 
_Ën_’üy±ed_ouut
 = 
_tmp_ouut_Ëngth
;

925 
ušt32_t
* 
_š_’üy±ed_ouut
 = 
NULL
;

926 
ušt8_t
* 
_tmp_key
 = 
ms
->
ms_key
;

927 
ušt32_t
 
_tmp_key_size
 = 
ms
->
ms_key_size
;

928 
size_t
 
_Ën_key
 = 
_tmp_key_size
;

929 
ušt8_t
* 
_š_key
 = 
NULL
;

931 
	`CHECK_UNIQUE_POINTER
(
_tmp_¶aš‹xt_šput
, 
_Ën_¶aš‹xt_šput
);

932 
	`CHECK_UNIQUE_POINTER
(
_tmp_’üy±ed_ouut
, 
_Ën_’üy±ed_ouut
);

933 
	`CHECK_UNIQUE_POINTER
(
_tmp_key
, 
_Ën_key
);

938 
	`sgx_lãnû
();

940 ià(
_tmp_¶aš‹xt_šput
 !ğ
NULL
 && 
_Ën_¶aš‹xt_šput
 != 0) {

941 iàĞ
_Ën_¶aš‹xt_šput
 % (*
_tmp_¶aš‹xt_šput
) != 0)

943 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

944 
”r
;

946 
_š_¶aš‹xt_šput
 = (
ušt32_t
*)
	`m®loc
(
_Ën_¶aš‹xt_šput
);

947 ià(
_š_¶aš‹xt_šput
 =ğ
NULL
) {

948 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

949 
”r
;

952 ià(
	`memıy_s
(
_š_¶aš‹xt_šput
, 
_Ën_¶aš‹xt_šput
, 
_tmp_¶aš‹xt_šput
, _len_plaintext_input)) {

953 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

954 
”r
;

958 ià(
_tmp_’üy±ed_ouut
 !ğ
NULL
 && 
_Ën_’üy±ed_ouut
 != 0) {

959 iàĞ
_Ën_’üy±ed_ouut
 % (*
_tmp_’üy±ed_ouut
) != 0)

961 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

962 
”r
;

964 ià((
_š_’üy±ed_ouut
 = (
ušt32_t
*)
	`m®loc
(
_Ën_’üy±ed_ouut
)è=ğ
NULL
) {

965 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

966 
”r
;

969 
	`mem£t
((*)
_š_’üy±ed_ouut
, 0, 
_Ën_’üy±ed_ouut
);

971 ià(
_tmp_key
 !ğ
NULL
 && 
_Ën_key
 != 0) {

972 iàĞ
_Ën_key
 % (*
_tmp_key
) != 0)

974 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

975 
”r
;

977 
_š_key
 = (
ušt8_t
*)
	`m®loc
(
_Ën_key
);

978 ià(
_š_key
 =ğ
NULL
) {

979 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

980 
”r
;

983 ià(
	`memıy_s
(
_š_key
, 
_Ën_key
, 
_tmp_key
, _len_key)) {

984 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

985 
”r
;

990 
ms
->
ms_»tv®
 = 
	`eÿÎ_’üy±
(
_š_¶aš‹xt_šput
, 
_tmp_šput_Ëngth
, 
_š_’üy±ed_ouut
, 
_tmp_ouut_Ëngth
, 
_š_key
, 
_tmp_key_size
);

991 ià(
_š_’üy±ed_ouut
) {

992 ià(
	`memıy_s
(
_tmp_’üy±ed_ouut
, 
_Ën_’üy±ed_ouut
, 
_š_’üy±ed_ouut
, _len_encrypted_output)) {

993 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

994 
”r
;

997 ià(
_š_key
) {

998 ià(
	`memıy_s
(
_tmp_key
, 
_Ën_key
, 
_š_key
, _len_key)) {

999 
¡©us
 = 
SGX_ERROR_UNEXPECTED
;

1000 
”r
;

1004 
”r
:

1005 ià(
_š_¶aš‹xt_šput
è
	`ä“
(_in_plaintext_input);

1006 ià(
_š_’üy±ed_ouut
è
	`ä“
(_in_encrypted_output);

1007 ià(
_š_key
è
	`ä“
(_in_key);

1008  
¡©us
;

1009 
	}
}

1011 
SGX_EXTERNC
 const struct {

1012 
size_t
 
	mÄ_eÿÎ
;

1013 ¡ruù {* 
	meÿÎ_addr
; 
ušt8_t
 
	mis_´iv
; ušt8_ˆ
	mis_sw™chËss
;} 
	meÿÎ_bË
[15];

1014 } 
	gg_eÿÎ_bË
 = {

1017 {(*)(
ušŒ_t
)
sgx_eÿÎ_make_ÃtwÜk
, 0, 0},

1018 {(*)(
ušŒ_t
)
sgx_eÿÎ_make_cÚvŞutiÚ®_Ïy”
, 0, 0},

1019 {(*)(
ušŒ_t
)
sgx_eÿÎ_make_cÚÃùed_Ïy”
, 0, 0},

1020 {(*)(
ušŒ_t
)
sgx_eÿÎ_make_soámax_Ïy”
, 0, 0},

1021 {(*)(
ušŒ_t
)
sgx_eÿÎ_make_co¡_Ïy”
, 0, 0},

1022 {(*)(
ušŒ_t
)
sgx_eÿÎ_make_maxpoŞ_Ïy”
, 0, 0},

1023 {(*)(
ušŒ_t
)
sgx_eÿÎ_make_drİout_Ïy”
, 0, 0},

1024 {(*)(
ušŒ_t
)
sgx_eÿÎ_make_avgpoŞ_Ïy”
, 0, 0},

1025 {(*)(
ušŒ_t
)
sgx_eÿÎ_®loÿ‹_wÜk¥aû
, 0, 0},

1026 {(*)(
ušŒ_t
)
sgx_eÿÎ_Œªsãr_weights
, 0, 0},

1027 {(*)(
ušŒ_t
)
sgx_eÿÎ_Ãt_ouut_»tuº
, 0, 0},

1028 {(*)(
ušŒ_t
)
sgx_eÿÎ_fÜw¬d_ÃtwÜk
, 0, 0},

1029 {(*)(
ušŒ_t
)
sgx_eÿÎ_©‹¡_£ssiÚ_tok’
, 0, 0},

1030 {(*)(
ušŒ_t
)
sgx_eÿÎ_deüy±
, 0, 0},

1031 {(*)(
ušŒ_t
)
sgx_eÿÎ_’üy±
, 0, 0},

1035 
SGX_EXTERNC
 const struct {

1036 
size_t
 
	mÄ_oÿÎ
;

1037 
ušt8_t
 
	m’Œy_bË
[1][15];

1038 } 
	gg_dyn_’Œy_bË
 = {

1046 
sgx_¡©us_t
 
SGX_CDECL
 
	$oÿÎ_´št
(cÚ¡ * 
¡r
, 
v®ue
)

1048 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

1049 
size_t
 
_Ën_¡r
 = 
¡r
 ? 
	`¡¾’
(str) + 1 : 0;

1051 
ms_oÿÎ_´št_t
* 
ms
 = 
NULL
;

1052 
size_t
 
oÿÎoc_size
 = (
ms_oÿÎ_´št_t
);

1053 *
__tmp
 = 
NULL
;

1056 
	`CHECK_ENCLAVE_POINTER
(
¡r
, 
_Ën_¡r
);

1058 ià(
	`ADD_ASSIGN_OVERFLOW
(
oÿÎoc_size
, (
¡r
 !ğ
NULL
è? 
_Ën_¡r
 : 0))

1059  
SGX_ERROR_INVALID_PARAMETER
;

1061 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

1062 ià(
__tmp
 =ğ
NULL
) {

1063 
	`sgx_ocä“
();

1064  
SGX_ERROR_UNEXPECTED
;

1066 
ms
 = (
ms_oÿÎ_´št_t
*)
__tmp
;

1067 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_oÿÎ_´št_t
));

1068 
oÿÎoc_size
 -ğ(
ms_oÿÎ_´št_t
);

1070 ià(
¡r
 !ğ
NULL
) {

1071 
ms
->
ms_¡r
 = (cÚ¡ *)
__tmp
;

1072 ià(
_Ën_¡r
 % (*
¡r
) != 0) {

1073 
	`sgx_ocä“
();

1074  
SGX_ERROR_INVALID_PARAMETER
;

1076 ià(
	`memıy_s
(
__tmp
, 
oÿÎoc_size
, 
¡r
, 
_Ën_¡r
)) {

1077 
	`sgx_ocä“
();

1078  
SGX_ERROR_UNEXPECTED
;

1080 
__tmp
 = (*)((
size_t
)__tm°+ 
_Ën_¡r
);

1081 
oÿÎoc_size
 -ğ
_Ën_¡r
;

1083 
ms
->
ms_¡r
 = 
NULL
;

1086 
ms
->
ms_v®ue
 = 
v®ue
;

1087 
¡©us
 = 
	`sgx_oÿÎ
(0, 
ms
);

1089 ià(
¡©us
 =ğ
SGX_SUCCESS
) {

1091 
	`sgx_ocä“
();

1092  
¡©us
;

1093 
	}
}

	@Enclave/Enclave_t.h

1 #iâdeà
ENCLAVE_T_H__


2 
	#ENCLAVE_T_H__


	)

4 
	~<¡dšt.h
>

5 
	~<wch¬.h
>

6 
	~<¡ddef.h
>

7 
	~"sgx_edg”8r.h
"

10 
	~<¡dlib.h
>

12 
	#SGX_CAST
(
ty³
, 
™em
è(Ñy³)(™em))

	)

14 #ifdeà
__ılu¥lus


18 
eÿÎ_make_ÃtwÜk
(
n
, 
Ë¬nšg_¿‹
, 
mom’tum
, 
deÿy
, 
time_¡•s
, 
nÙruth
, 
b©ch
, 
subdivisiÚs
, 
¿ndom
, 
adam
, 
B1
, 
B2
, 
•s
, 
h
, 
w
, 
c
, 
šputs
, 
max_üİ
, 
mš_üİ
, 
max_¿tio
, 
mš_¿tio
, 
ûÁ”
, 
ş
, 
ªgË
, 
a¥eù
, 
§tu¿tiÚ
, 
exposu»
, 
hue
, 
buº_š
, 
pow”
, 
max_b©ches
, 
¡¬t_šdex
);

19 
eÿÎ_make_cÚvŞutiÚ®_Ïy”
(
b©ch
, 
h
, 
w
, 
c
, 
n
, 
groups
, 
size
, 
¡ride
, 
·ddšg
, * 
aùiv©iÚ_s
, 
aùi_Ëngth
, 
b©ch_nÜm®ize
, 
bš¬y
, 
xnÜ
, 
adam
, 
æ³d
, 
dÙ
);

20 
eÿÎ_make_cÚÃùed_Ïy”
(
b©ch
, 
šputs
, 
ouuts
, * 
aùiv©iÚ_s
, 
aùi_Ëngth
, 
b©ch_nÜm®ize
, 
adam
);

21 
eÿÎ_make_soámax_Ïy”
(
b©ch
, 
šputs
, 
groups
, 
‹m³¿tu»
, 
w
, 
h
, 
c
, 
¥©Ÿl
, 
nŞoss
);

22 
eÿÎ_make_co¡_Ïy”
(
b©ch
, 
šputs
, * 
co¡_ty³
, 
co¡_size
, 
sÿË
, 
¿tio
, 
noobjeù_sÿË
, 
th»sh
);

23 
eÿÎ_make_maxpoŞ_Ïy”
(
b©ch
, 
h
, 
w
, 
c
, 
size
, 
¡ride
, 
·ddšg
);

24 
eÿÎ_make_drİout_Ïy”
(
b©ch
, 
šputs
, 
´obab™y
, 
w
, 
h
, 
c
, * 
Ãt_´ev_ouut
, 
´ev_size
, * 
Ãt_´ev_d–
, 
d–_size
);

25 
eÿÎ_make_avgpoŞ_Ïy”
(
b©ch
, 
w
, 
h
, 
c
);

26 
eÿÎ_®loÿ‹_wÜk¥aû
(
wÜk¥aû_size
);

27 
eÿÎ_Œªsãr_weights
(* 
vec
, 
Ëngth
, 
Ïy”_i
, 
ty³
, 
add™iÚ®
);

28 
eÿÎ_Ãt_ouut_»tuº
(* 
Ãt_ouut
, 
Ëngth
, 
ušt8_t
* 
g_bufãr
, 
g_Ëngth
);

29 
eÿÎ_fÜw¬d_ÃtwÜk
(* 
Ãt_šput
, 
l_šputs
, 
ušt8_t
* 
g_bufãr
, 
l_g
, 
Ãt_Œaš
);

30 
eÿÎ_©‹¡_£ssiÚ_tok’
(
£ssiÚ_tok’
, * 
©‹¡©iÚ_bufãr
, 
©‹¡_size
, 
ušt8_t
* 
g_bufãr
, 
l_g
);

31 
eÿÎ_deüy±
(
ušt32_t
* 
’üy±_šput
, ušt32_ˆ
šput_Ëngth
, ušt32_t* 
¶aš‹xt_ouut
, ušt32_ˆ
ouut_Ëngth
, 
ušt8_t
* 
key
, ušt32_ˆ
key_size
);

32 
eÿÎ_’üy±
(
ušt32_t
* 
¶aš‹xt_šput
, ušt32_ˆ
šput_Ëngth
, ušt32_t* 
’üy±ed_ouut
, ušt32_ˆ
ouut_Ëngth
, 
ušt8_t
* 
key
, ušt32_ˆ
key_size
);

34 
sgx_¡©us_t
 
SGX_CDECL
 
oÿÎ_´št
(cÚ¡ * 
¡r
, 
v®ue
);

36 #ifdeà
__ılu¥lus


	@Enclave/activations_TA.cpp

1 
	~"aùiv©iÚs_TA.h
"

3 
	~<¡dio.h
>

4 
	~<¡dlib.h
>

5 
	~<¡ršg.h
>

7 *
	$g‘_aùiv©iÚ_¡ršg_TA
(
ACTIVATION_TA
 
a
)

9 
a
){

10 
LOGISTIC_TA
:

12 
LOGGY_TA
:

14 
RELU_TA
:

16 
ELU_TA
:

18 
SELU_TA
:

20 
RELIE_TA
:

22 
RAMP_TA
:

24 
LINEAR_TA
:

26 
TANH_TA
:

28 
PLSE_TA
:

30 
LEAKY_TA
:

32 
STAIR_TA
:

34 
HARDTAN_TA
:

36 
LHTAN_TA
:

42 
	}
}

44 
ACTIVATION_TA
 
	$g‘_aùiv©iÚ_TA
(*
s
)

46 ià(
	`¡rcmp
(
s
, "logi¡ic")==0è 
LOGISTIC_TA
;

47 ià(
	`¡rcmp
(
s
, "loggy")==0è 
LOGGY_TA
;

48 ià(
	`¡rcmp
(
s
, "»lu")==0è 
RELU_TA
;

49 ià(
	`¡rcmp
(
s
, "–u")==0è 
ELU_TA
;

50 ià(
	`¡rcmp
(
s
, "£lu")==0è 
SELU_TA
;

51 ià(
	`¡rcmp
(
s
, "»l›")==0è 
RELIE_TA
;

52 ià(
	`¡rcmp
(
s
, "¶£")==0è 
PLSE_TA
;

53 ià(
	`¡rcmp
(
s
, "h¬dn")==0è 
HARDTAN_TA
;

54 ià(
	`¡rcmp
(
s
, "lhn")==0è 
LHTAN_TA
;

55 ià(
	`¡rcmp
(
s
, "lš—r")==0è 
LINEAR_TA
;

56 ià(
	`¡rcmp
(
s
, "¿mp")==0è 
RAMP_TA
;

57 ià(
	`¡rcmp
(
s
, "Ëaky")==0è 
LEAKY_TA
;

58 ià(
	`¡rcmp
(
s
, "nh")==0è 
TANH_TA
;

59 ià(
	`¡rcmp
(
s
, "¡aœ")==0è 
STAIR_TA
;

61  
RELU_TA
;

62 
	}
}

66 
	$aùiv©e_TA
(
x
, 
ACTIVATION_TA
 
a
)

68 
a
){

69 
LINEAR_TA
:

70  
	`lš—r_aùiv©e_TA
(
x
);

71 
LOGISTIC_TA
:

72  
	`logi¡ic_aùiv©e_TA
(
x
);

73 
LOGGY_TA
:

74  
	`loggy_aùiv©e_TA
(
x
);

75 
RELU_TA
:

76  
	`»lu_aùiv©e_TA
(
x
);

77 
ELU_TA
:

78  
	`–u_aùiv©e_TA
(
x
);

79 
SELU_TA
:

80  
	`£lu_aùiv©e_TA
(
x
);

81 
RELIE_TA
:

82  
	`»l›_aùiv©e_TA
(
x
);

83 
RAMP_TA
:

84  
	`¿mp_aùiv©e_TA
(
x
);

85 
LEAKY_TA
:

86  
	`Ëaky_aùiv©e_TA
(
x
);

87 
TANH_TA
:

88  
	`nh_aùiv©e_TA
(
x
);

89 
PLSE_TA
:

90  
	`¶£_aùiv©e_TA
(
x
);

91 
STAIR_TA
:

92  
	`¡aœ_aùiv©e_TA
(
x
);

93 
HARDTAN_TA
:

94  
	`h¬dn_aùiv©e_TA
(
x
);

95 
LHTAN_TA
:

96  
	`lhn_aùiv©e_TA
(
x
);

99 
	}
}

101 * 
	$aùiv©e_¬¿y_TA
(*
x
, cÚ¡ 
n
, cÚ¡ 
ACTIVATION_TA
 
a
)

103 
i
;

104 #´agm¨
omp
 
·¿Î–
 

105 
i
 = 0; i < 
n
; ++i){

106 
x
[
i
] = 
	`aùiv©e_TA
(x[i], 
a
);

108  
x
;

109 
	}
}

112 
	$g¿d›Á_TA
(
x
, 
ACTIVATION_TA
 
a
)

114 
a
){

115 
LINEAR_TA
:

116  
	`lš—r_g¿d›Á_TA
(
x
);

117 
LOGISTIC_TA
:

118  
	`logi¡ic_g¿d›Á_TA
(
x
);

119 
LOGGY_TA
:

120  
	`loggy_g¿d›Á_TA
(
x
);

121 
RELU_TA
:

122  
	`»lu_g¿d›Á_TA
(
x
);

123 
ELU_TA
:

124  
	`–u_g¿d›Á_TA
(
x
);

125 
SELU_TA
:

126  
	`£lu_g¿d›Á_TA
(
x
);

127 
RELIE_TA
:

128  
	`»l›_g¿d›Á_TA
(
x
);

129 
RAMP_TA
:

130  
	`¿mp_g¿d›Á_TA
(
x
);

131 
LEAKY_TA
:

132  
	`Ëaky_g¿d›Á_TA
(
x
);

133 
TANH_TA
:

134  
	`nh_g¿d›Á_TA
(
x
);

135 
PLSE_TA
:

136  
	`¶£_g¿d›Á_TA
(
x
);

137 
STAIR_TA
:

138  
	`¡aœ_g¿d›Á_TA
(
x
);

139 
HARDTAN_TA
:

140  
	`h¬dn_g¿d›Á_TA
(
x
);

141 
LHTAN_TA
:

142  
	`lhn_g¿d›Á_TA
(
x
);

145 
	}
}

147 * 
	$g¿d›Á_¬¿y_TA
(cÚ¡ *
x
, cÚ¡ 
n
, cÚ¡ 
ACTIVATION_TA
 
a
, *
d–
)

149 
i
;

150 
i
 = 0; i < 
n
; ++i){

151 
d–
[
i
] *ğ
	`g¿d›Á_TA
(
x
[i], 
a
);

153  
d–
;

154 
	}
}

	@Enclave/activations_TA.h

1 #iâdeà
ACTIVATIONS_TA_H


2 
	#ACTIVATIONS_TA_H


	)

3 
	~"d¬kÃt_TA.h
"

4 
	~"m©h_TA.h
"

5 
	~<¡dio.h
>

7 *
g‘_aùiv©iÚ_¡ršg_TA
(
ACTIVATION_TA
 
a
);

9 
ACTIVATION_TA
 
g‘_aùiv©iÚ_TA
(*
s
);

11 
aùiv©e_TA
(
x
, 
ACTIVATION_TA
 
a
);

13 * 
aùiv©e_¬¿y_TA
(*
x
, cÚ¡ 
n
, cÚ¡ 
ACTIVATION_TA
 
a
);

15 
g¿d›Á_TA
(
x
, 
ACTIVATION_TA
 
a
);

17 * 
g¿d›Á_¬¿y_TA
(cÚ¡ *
x
, cÚ¡ 
n
, cÚ¡ 
ACTIVATION_TA
 
a
, *
d–
);

20 
šlše
 
	$¡aœ_aùiv©e_TA
(
x
)

22 
n
 = 
	`_æoÜ
(
x
);

23 ià(
n
%2 =ğ0è 
	`_æoÜ
(
x
/2.);

24  (
x
 - 
n
è+ 
	`_æoÜ
(x/2.);

25 
	}
}

26 
šlše
 
	$h¬dn_aùiv©e_TA
(
x
)

28 ià(
x
 < -1)  -1;

29 ià(
x
 > 1)  1;

30  
x
;

31 
	}
}

32 
šlše
 
	$lš—r_aùiv©e_TA
(
x
){ x;
	}
}

33 
šlše
 
	$logi¡ic_aùiv©e_TA
(
x
){ 1./(1. + 
	`_exp
(-x));
	}
}

34 
šlše
 
	$loggy_aùiv©e_TA
(
x
){ 2./(1. + 
	`_exp
(-x)è- 1;
	}
}

35 
šlše
 
	$»lu_aùiv©e_TA
(
x
){ x*(x>0);
	}
}

36 
šlše
 
	$–u_aùiv©e_TA
(
x
){ (x >ğ0)*x + (x < 0)*(
	`_exp
(x)-1);
	}
}

37 
šlše
 
	$£lu_aùiv©e_TA
(
x
){ (x >ğ0)*1.0507*x + (x < 0)*1.0507*1.6732*(
	`_exp
(x)-1);
	}
}

38 
šlše
 
	$»l›_aùiv©e_TA
(
x
){ (x>0è? x : .01*x;
	}
}

39 
šlše
 
	$¿mp_aùiv©e_TA
(
x
){ x*(x>0)+.1*x;
	}
}

40 
šlše
 
	$Ëaky_aùiv©e_TA
(
x
){ (x>0è? x : .1*x;
	}
}

41 
šlše
 
	$nh_aùiv©e_TA
(
x
){ (
	`_exp
(2*x)-1)/Ña_exp(2*x)+1);
	}
}

42 
šlše
 
	$¶£_aùiv©e_TA
(
x
)

44 if(
x
 < -4)  .01 * (x + 4);

45 if(
x
 > 4)  .01 * (x - 4) + 1;

46  .125*
x
 + .5;

47 
	}
}

49 
šlše
 
	$lhn_aùiv©e_TA
(
x
)

51 if(
x
 < 0)  .001*x;

52 if(
x
 > 1)  .001*(x-1) + 1;

53  
x
;

54 
	}
}

57 
šlše
 
	$lhn_g¿d›Á_TA
(
x
)

59 if(
x
 > 0 && x < 1)  1;

61 
	}
}

63 
šlše
 
	$h¬dn_g¿d›Á_TA
(
x
)

65 ià(
x
 > -1 && x < 1)  1;

67 
	}
}

68 
šlše
 
	$lš—r_g¿d›Á_TA
(
x
){ 1;
	}
}

69 
šlše
 
	$logi¡ic_g¿d›Á_TA
(
x
){ (1-x)*x;
	}
}

70 
šlše
 
	$loggy_g¿d›Á_TA
(
x
)

72 
y
 = (
x
+1.)/2.;

73  2*(1-
y
)*y;

74 
	}
}

75 
šlše
 
	$¡aœ_g¿d›Á_TA
(
x
)

77 ià(
	`_æoÜ
(
x
) == x)  0;

79 
	}
}

80 
šlše
 
	$»lu_g¿d›Á_TA
(
x
){ (x>0);
	}
}

81 
šlše
 
	$–u_g¿d›Á_TA
(
x
){ (x >ğ0è+ (x < 0)*(x + 1);
	}
}

82 
šlše
 
	$£lu_g¿d›Á_TA
(
x
){ (x >ğ0)*1.0507 + (x < 0)*(x + 1.0507*1.6732);
	}
}

83 
šlše
 
	$»l›_g¿d›Á_TA
(
x
){ (x>0è? 1 : .01;
	}
}

84 
šlše
 
	$¿mp_g¿d›Á_TA
(
x
){ (x>0)+.1;
	}
}

85 
šlše
 
	$Ëaky_g¿d›Á_TA
(
x
){ (x>0è? 1 : .1;
	}
}

86 
šlše
 
	$nh_g¿d›Á_TA
(
x
){ 1-x*x;
	}
}

87 
šlše
 
	$¶£_g¿d›Á_TA
(
x
){ (x < 0 || x > 1è? .01 : .125;
	}
}

	@Enclave/aes-common.h

13 #iâdeà
AES_COMMON_H


14 
	#AES_COMMON_H


	)

16 
	~<ùy³.h
>

17 
	~<¡dlib.h
>

18 
	~<¡dio.h
>

19 
	~<¡d¬g.h
>

20 
	~<¡ršg.h
>

25 
	t«s_uch¬
;

26 
	t«s_ushÜt
;

27 
	t«s_ušt
;

28 
	t«s_ulÚg
;

29 sigÃd 
	t«s_ch¬
;

30 sigÃd 
	t«s_shÜt
;

31 sigÃd 
	t«s_št
;

32 sigÃd 
	t«s_lÚg
;

43 #ià
defšed
(
__F»eBSD__
è|| defšed(
__N‘BSD__
) || \

44 
defšed
(
__D¿gÚFly__
è|| 
	$defšed
(
__O³nBSD__
)

45 
	~<sys/ty³s.h
>

46 
	~<sys/’dŸn.h
>

47 
	#__BYTE_ORDER
 
_BYTE_ORDER


	)

48 
	#__LITTLE_ENDIAN
 
_LITTLE_ENDIAN


	)

49 
	#__BIG_ENDIAN
 
_BIG_ENDIAN


	)

51 * 
	`defšed
(
__D¿gÚFly__
è|| defšed(
__O³nBSD__
) */

53 #ifdeà
sun


54 
	~<sys/i§_defs.h
>

55 
	#__LITTLE_ENDIAN
 1234

	)

56 
	#__BIG_ENDIAN
 4321

	)

57 #ifdeà
_LITTLE_ENDIAN


58 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

60 
	#__BYTE_ORDER
 
__BIG_ENDIAN


	)

64 #ifdeà
_MSC_VER


65 
	#šlše
 
__šlše


	)

66 
	#__LITTLE_ENDIAN
 1234

	)

67 
	#__BIG_ENDIAN
 4321

	)

68 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

71 #ifdeà
__APPLE__


72 
	~<sys/ty³s.h
>

73 
	~<machše/’dŸn.h
>

74 
	#__BYTE_ORDER
 
BYTE_ORDER


	)

75 
	#__LITTLE_ENDIAN
 
LITTLE_ENDIAN


	)

76 
	#__BIG_ENDIAN
 
BIG_ENDIAN


	)

82 #iâdeà
bsw­_16


83 
	#bsw­_16
(
a
è((((
«s_ushÜt
) (a) & 0xff00) >> 8) | \

84 (((
«s_ushÜt
è(
a
è& 0x00ffè<< 8))

	)

87 #iâdeà
bsw­_32


88 #ià
defšed
 
__GNUC__


89 
	#bsw­_32
(
a
è
	`__butš_bsw­32
×)

	)

91 
	#bsw­_32
(
a
è((((
«s_ušt
) (a) & 0xff000000) >> 24) | \

92 (((
«s_ušt
è(
a
) & 0x00ff0000) >> 8) | \

93 (((
«s_ušt
è(
a
) & 0x0000ff00) << 8) | \

94 (((
«s_ušt
è(
a
è& 0x000000ffè<< 24))

	)

98 #iâdeà
bsw­_64


99 #ià
defšed
 
__GNUC__


100 
	#bsw­_64
(
a
è
	`__butš_bsw­64
×)

	)

102 
	#bsw­_64
(
a
è((((
«s_ulÚg
) (a) & 0xff00000000000000ull) >> 56) | \

103 (((
«s_ulÚg
è(
a
) & 0x00ff000000000000ull) >> 40) | \

104 (((
«s_ulÚg
è(
a
) & 0x0000ff0000000000ull) >> 24) | \

105 (((
«s_ulÚg
è(
a
) & 0x000000ff00000000ull) >> 8) | \

106 (((
«s_ulÚg
è(
a
) & 0x00000000ff000000ull) << 8) | \

107 (((
«s_ulÚg
è(
a
) & 0x0000000000ff0000ull) << 24) | \

108 (((
«s_ulÚg
è(
a
) & 0x000000000000ff00ull) << 40) | \

109 (((
«s_ulÚg
è(
a
è& 0x00000000000000ffuÎè<< 56))

	)

148 
šlše
 
«s_ushÜt
 
	$AES_GET_BE16
(cÚ¡ 
«s_uch¬
 *
a
)

150  (
a
[0] << 8) |‡[1];

151 
	}
}

153 
šlše
 
	$AES_PUT_BE16
(
«s_uch¬
 *
a
, 
«s_ushÜt
 
v®
)

155 
a
[0] = 
v®
 >> 8;

156 
a
[1] = 
v®
 & 0xff;

157 
	}
}

159 
šlše
 
«s_ushÜt
 
	$AES_GET_LE16
(cÚ¡ 
«s_uch¬
 *
a
)

161  (
a
[1] << 8) |‡[0];

162 
	}
}

164 
šlše
 
	$AES_PUT_LE16
(
«s_uch¬
 *
a
, 
«s_ushÜt
 
v®
)

166 
a
[1] = 
v®
 >> 8;

167 
a
[0] = 
v®
 & 0xff;

168 
	}
}

170 
šlše
 
«s_ušt
 
	$AES_GET_BE24
(cÚ¡ 
«s_uch¬
 *
a
)

172  (
a
[0] << 16) | (a[1] << 8) |‡[2];

173 
	}
}

175 
šlše
 
	$AES_PUT_BE24
(
«s_uch¬
 *
a
, 
«s_ušt
 
v®
)

177 
a
[0] = (
v®
 >> 16) & 0xff;

178 
a
[1] = (
v®
 >> 8) & 0xff;

179 
a
[2] = 
v®
 & 0xff;

180 
	}
}

182 
šlše
 
«s_ušt
 
	$AES_GET_BE32
(cÚ¡ 
«s_uch¬
 *
a
)

184  (
a
[0] << 24) | (a[1] << 16) | (a[2] << 8) |‡[3];

185 
	}
}

187 
šlše
 
	$AES_PUT_BE32
(
«s_uch¬
 *
a
, 
«s_ušt
 
v®
)

189 
a
[0] = (
v®
 >> 24) & 0xff;

190 
a
[1] = (
v®
 >> 16) & 0xff;

191 
a
[2] = (
v®
 >> 8) & 0xff;

192 
a
[3] = 
v®
 & 0xff;

193 
	}
}

195 
šlše
 
«s_ušt
 
	$AES_GET_LE32
(cÚ¡ 
«s_uch¬
 *
a
)

197  (
a
[3] << 24) | (a[2] << 16) | (a[1] << 8) |‡[0];

198 
	}
}

200 
šlše
 
	$AES_PUT_LE32
(
«s_uch¬
 *
a
, 
«s_ušt
 
v®
)

202 
a
[3] = (
v®
 >> 24) & 0xff;

203 
a
[2] = (
v®
 >> 16) & 0xff;

204 
a
[1] = (
v®
 >> 8) & 0xff;

205 
a
[0] = 
v®
 & 0xff;

206 
	}
}

208 
šlše
 
«s_ulÚg
 
	$AES_GET_BE64
(cÚ¡ 
«s_uch¬
 *
a
)

210  (((
«s_ulÚg
è
a
[0]) << 56) | (((aes_ulong)‡[1]) << 48) |

211 (((
«s_ulÚg
è
a
[2]) << 40) | (((aes_ulong)‡[3]) << 32) |

212 (((
«s_ulÚg
è
a
[4]) << 24) | (((aes_ulong)‡[5]) << 16) |

213 (((
«s_ulÚg
è
a
[6]) << 8) | ((aes_ulong)‡[7]);

214 
	}
}

216 
šlše
 
	$AES_PUT_BE64
(
«s_uch¬
 *
a
, 
«s_ulÚg
 
v®
)

218 
a
[0] = 
v®
 >> 56;

219 
a
[1] = 
v®
 >> 48;

220 
a
[2] = 
v®
 >> 40;

221 
a
[3] = 
v®
 >> 32;

222 
a
[4] = 
v®
 >> 24;

223 
a
[5] = 
v®
 >> 16;

224 
a
[6] = 
v®
 >> 8;

225 
a
[7] = 
v®
 & 0xff;

226 
	}
}

228 
šlše
 
«s_ulÚg
 
	$AES_GET_LE64
(cÚ¡ 
«s_uch¬
 *
a
)

230  (((
«s_ulÚg
è
a
[7]) << 56) | (((aes_ulong)‡[6]) << 48) |

231 (((
«s_ulÚg
è
a
[5]) << 40) | (((aes_ulong)‡[4]) << 32) |

232 (((
«s_ulÚg
è
a
[3]) << 24) | (((aes_ulong)‡[2]) << 16) |

233 (((
«s_ulÚg
è
a
[1]) << 8) | ((aes_ulong)‡[0]);

234 
	}
}

236 
šlše
 
	$AES_PUT_LE64
(
«s_uch¬
 *
a
, 
«s_ulÚg
 
v®
)

238 
a
[7] = 
v®
 >> 56;

239 
a
[6] = 
v®
 >> 48;

240 
a
[5] = 
v®
 >> 40;

241 
a
[4] = 
v®
 >> 32;

242 
a
[3] = 
v®
 >> 24;

243 
a
[2] = 
v®
 >> 16;

244 
a
[1] = 
v®
 >> 8;

245 
a
[0] = 
v®
 & 0xff;

246 
	}
}

251 #iâdeà
AES_WARN_UNUSED_RESULT


252 #ià
defšed
 
__GNUC__


253 
	#AES_WARN_UNUSED_RESULT
 
	`__©Œibu‹__
((
__w¬n_unu£d_»suÉ__
))

	)

255 
	#AES_WARN_UNUSED_RESULT


	)

	@Enclave/aes-gcm-entry.cpp

5 
	#AES_DEBUG


	)

7 
	~"«s.h
"

9 cÚ¡ 
	gt3_key
[] = {

12 cÚ¡ 
	gt3_iv
[] = {

15 cÚ¡ 
	gt3_¯d
[] = {};

24 cÚ¡ 
	gt3_g
[] = {

29 
	$«s_gcm_’Œy
(*
xüy±
, 
ušt8_t
 *
g¿d›Á
, ušt8_ˆ*
g_bufãr
, 
size
)

31 
»suÉ
;

35 
size
 = siz* (
ušt8_t
);

36 *
t3_¶aš
 = (*)
g¿d›Á
;

38 * 
g_buf
 = (*)
g_bufãr
;

40 if(
	`¡ºcmp
(
xüy±
, "encrypt", 2) == 0)

42 * 
üy±_buf
 = (*)
	`ÿÎoc
(1,
size
);

43 
»suÉ
 = 
	`«s_gcm_«
(
t3_key
, (t3_key),

44 
t3_iv
, (t3_iv),

45 
t3_¶aš
, 
size
,

46 
t3_¯d
, (t3_aad),

47 
üy±_buf
, 
g_buf
);

48 
	`memıy
(
g¿d›Á
, (
ušt8_t
 *)
üy±_buf
, 
size
);

49 
	`ä“
(
üy±_buf
);

51 if(
	`¡ºcmp
(
xüy±
, "decrypt", 2) == 0)

53 * 
¶aš_buf
 = (*)
	`ÿÎoc
(1,
size
);

54 
»suÉ
 = 
	`«s_gcm_ad
(
t3_key
, (t3_key),

55 
t3_iv
, (t3_iv),

56 
t3_¶aš
, 
size
,

57 
t3_¯d
, (t3_aad),

58 
g_buf
, 
¶aš_buf
);

59 
	`memıy
(
g¿d›Á
, (
ušt8_t
 *)
¶aš_buf
, 
size
);

60 
	`ä“
(
¶aš_buf
);

64 
	`oÿÎ_´št
("\n Incorrect‡rgument for AES_GCM\n",-1.0);

65 
»suÉ
 = -1;

68  
»suÉ
;

69 
	}
}

	@Enclave/aes-gcm.cpp

10 
	~"«s.h
"

12 
	$šc32
(
«s_uch¬
 *
block
)

14 
«s_ušt
 
v®
;

15 
v®
 = 
	`AES_GET_BE32
(
block
 + 
AES_BLOCK_SIZE
 - 4);

16 
v®
++;

17 
	`AES_PUT_BE32
(
block
 + 
AES_BLOCK_SIZE
 - 4, 
v®
);

18 
	}
}

21 
	$xÜ_block
(
«s_uch¬
 *
d¡
, cÚ¡‡es_uch¬ *
¤c
)

23 
«s_ušt
 *
d
 = («s_ušˆ*è
d¡
;

24 
«s_ušt
 *
s
 = («s_ušˆ*è
¤c
;

25 *
d
++ ^ğ*
s
++;

26 *
d
++ ^ğ*
s
++;

27 *
d
++ ^ğ*
s
++;

28 *
d
++ ^ğ*
s
++;

29 
	}
}

32 
	$shiá_right_block
(
«s_uch¬
 *
v
)

34 
«s_ušt
 
v®
;

36 
v®
 = 
	`AES_GET_BE32
(
v
 + 12);

37 
v®
 >>= 1;

38 ià(
v
[11] & 0x01)

39 
v®
 |= 0x80000000;

40 
	`AES_PUT_BE32
(
v
 + 12, 
v®
);

42 
v®
 = 
	`AES_GET_BE32
(
v
 + 8);

43 
v®
 >>= 1;

44 ià(
v
[7] & 0x01)

45 
v®
 |= 0x80000000;

46 
	`AES_PUT_BE32
(
v
 + 8, 
v®
);

48 
v®
 = 
	`AES_GET_BE32
(
v
 + 4);

49 
v®
 >>= 1;

50 ià(
v
[3] & 0x01)

51 
v®
 |= 0x80000000;

52 
	`AES_PUT_BE32
(
v
 + 4, 
v®
);

54 
v®
 = 
	`AES_GET_BE32
(
v
);

55 
v®
 >>= 1;

56 
	`AES_PUT_BE32
(
v
, 
v®
);

57 
	}
}

61 
	$gf_muÉ
(cÚ¡ 
«s_uch¬
 *
x
, cÚ¡‡es_uch¬ *
y
,‡es_uch¬ *
z
)

63 
«s_uch¬
 
v
[16];

64 
i
, 
j
;

66 
	`mem£t
(
z
, 0, 16);

67 
	`memıy
(
v
, 
y
, 16);

69 
i
 = 0; i < 16; i++) {

70 
j
 = 0; j < 8; j++) {

71 ià(
x
[
i
] & 1 << (7 - 
j
)) {

73 
	`xÜ_block
(
z
, 
v
);

78 ià(
v
[15] & 0x01) {

80 
	`shiá_right_block
(
v
);

82 
v
[0] ^= 0xe1;

85 
	`shiá_right_block
(
v
);

89 
	}
}

92 
	$ghash_¡¬t
(
«s_uch¬
 *
y
)

95 
	`mem£t
(
y
, 0, 16);

96 
	}
}

99 
	$ghash
(cÚ¡ 
«s_uch¬
 *
h
, cÚ¡‡es_uch¬ *
x
, 
size_t
 
xËn
,‡es_uch¬ *
y
)

101 
size_t
 
m
, 
i
;

102 cÚ¡ 
«s_uch¬
 *
xpos
 = 
x
;

103 
«s_uch¬
 
tmp
[16];

105 
m
 = 
xËn
 / 16;

107 
i
 = 0; i < 
m
; i++) {

109 
	`xÜ_block
(
y
, 
xpos
);

110 
xpos
 += 16;

115 
	`gf_muÉ
(
y
, 
h
, 
tmp
);

116 
	`memıy
(
y
, 
tmp
, 16);

119 ià(
x
 + 
xËn
 > 
xpos
) {

121 
size_t
 
Ï¡
 = 
x
 + 
xËn
 - 
xpos
;

122 
	`memıy
(
tmp
, 
xpos
, 
Ï¡
);

123 
	`mem£t
(
tmp
 + 
Ï¡
, 0, (tmp) -†ast);

126 
	`xÜ_block
(
y
, 
tmp
);

131 
	`gf_muÉ
(
y
, 
h
, 
tmp
);

132 
	`memıy
(
y
, 
tmp
, 16);

136 
	}
}

139 
	$«s_gùr
(*
«s
, cÚ¡ 
«s_uch¬
 *
icb
, cÚ¡‡es_uch¬ *
x
, 
size_t
 
xËn
,‡es_uch¬ *
y
)

141 
size_t
 
i
, 
n
, 
Ï¡
;

142 
«s_uch¬
 
cb
[
AES_BLOCK_SIZE
], 
tmp
[AES_BLOCK_SIZE];

143 cÚ¡ 
«s_uch¬
 *
xpos
 = 
x
;

144 
«s_uch¬
 *
ypos
 = 
y
;

146 ià(
xËn
 == 0)

149 
n
 = 
xËn
 / 16;

151 
	`memıy
(
cb
, 
icb
, 
AES_BLOCK_SIZE
);

153 
i
 = 0; i < 
n
; i++) {

154 
	`«s_’üy±
(
«s
, 
cb
, 
ypos
);

155 
	`xÜ_block
(
ypos
, 
xpos
);

156 
xpos
 +ğ
AES_BLOCK_SIZE
;

157 
ypos
 +ğ
AES_BLOCK_SIZE
;

158 
	`šc32
(
cb
);

161 
Ï¡
 = 
x
 + 
xËn
 - 
xpos
;

162 ià(
Ï¡
) {

164 
	`«s_’üy±
(
«s
, 
cb
, 
tmp
);

165 
i
 = 0; i < 
Ï¡
; i++)

166 *
ypos
++ = *
xpos
++ ^ 
tmp
[
i
];

168 
	}
}

171 * 
	$«s_gcm_š™_hash_subkey
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
key_Ën
,‡es_uch¬ *
H
)

173 *
«s
;

175 
«s
 = 
	`«s_’üy±_š™
(
key
, 
key_Ën
);

176 ià(
«s
 =ğ
NULL
)

177  
NULL
;

180 
	`mem£t
(
H
, 0, 
AES_BLOCK_SIZE
);

181 
	`«s_’üy±
(
«s
, 
H
, H);

183  
«s
;

184 
	}
}

187 
	$«s_gcm_´•¬e_j0
(cÚ¡ 
«s_uch¬
 *
iv
, 
size_t
 
iv_Ën
, cÚ¡‡es_uch¬ *
H
,‡es_uch¬ *
J0
)

189 
«s_uch¬
 
Ën_buf
[16];

191 ià(
iv_Ën
 == 12) {

193 
	`memıy
(
J0
, 
iv
, 
iv_Ën
);

194 
	`mem£t
(
J0
 + 
iv_Ën
, 0, 
AES_BLOCK_SIZE
 - iv_len);

195 
J0
[
AES_BLOCK_SIZE
 - 1] = 0x01;

201 
	`ghash_¡¬t
(
J0
);

202 
	`ghash
(
H
, 
iv
, 
iv_Ën
, 
J0
);

203 
	`AES_PUT_BE64
(
Ën_buf
, 0);

204 
	`AES_PUT_BE64
(
Ën_buf
 + 8, 
iv_Ën
 * 8);

205 
	`ghash
(
H
, 
Ën_buf
, Ö’_buf), 
J0
);

207 
	}
}

210 
	$«s_gcm_gùr
(*
«s
, cÚ¡ 
«s_uch¬
 *
J0
, cÚ¡‡es_uch¬ *
š
, 
size_t
 
Ën
,

211 
«s_uch¬
 *
out
)

213 
«s_uch¬
 
J0šc
[
AES_BLOCK_SIZE
];

215 ià(
Ën
 == 0)

218 
	`memıy
(
J0šc
, 
J0
, 
AES_BLOCK_SIZE
);

219 
	`šc32
(
J0šc
);

220 
	`«s_gùr
(
«s
, 
J0šc
, 
š
, 
Ën
, 
out
);

221 
	}
}

224 
	$«s_gcm_ghash
(cÚ¡ 
«s_uch¬
 *
H
, cÚ¡‡es_uch¬ *
¯d
, 
size_t
 
¯d_Ën
,

225 cÚ¡ 
«s_uch¬
 *
üy±
, 
size_t
 
üy±_Ën
,‡es_uch¬ *
S
)

227 
«s_uch¬
 
Ën_buf
[16];

235 
	`ghash_¡¬t
(
S
);

236 
	`ghash
(
H
, 
¯d
, 
¯d_Ën
, 
S
);

237 
	`ghash
(
H
, 
üy±
, 
üy±_Ën
, 
S
);

238 
	`AES_PUT_BE64
(
Ën_buf
, 
¯d_Ën
 * 8);

239 
	`AES_PUT_BE64
(
Ën_buf
 + 8, 
üy±_Ën
 * 8);

240 
	`ghash
(
H
, 
Ën_buf
, Ö’_buf), 
S
);

243 
	}
}

249 
	$«s_gcm_«
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
key_Ën
, cÚ¡‡es_uch¬ *
iv
, size_ˆ
iv_Ën
,

250 cÚ¡ 
«s_uch¬
 *
¶aš
, 
size_t
 
¶aš_Ën
,

251 cÚ¡ 
«s_uch¬
 *
¯d
, 
size_t
 
¯d_Ën
,‡es_uch¬ *
üy±
,‡es_uch¬ *
g
)

253 
«s_uch¬
 
H
[
AES_BLOCK_SIZE
];

254 
«s_uch¬
 
J0
[
AES_BLOCK_SIZE
];

255 
«s_uch¬
 
S
[16];

256 *
«s
;

258 
«s
 = 
	`«s_gcm_š™_hash_subkey
(
key
, 
key_Ën
, 
H
);

259 ià(
«s
 =ğ
NULL
)

262 
	`«s_gcm_´•¬e_j0
(
iv
, 
iv_Ën
, 
H
, 
J0
);

265 
	`«s_gcm_gùr
(
«s
, 
J0
, 
¶aš
, 
¶aš_Ën
, 
üy±
);

267 
	`«s_gcm_ghash
(
H
, 
¯d
, 
¯d_Ën
, 
üy±
, 
¶aš_Ën
, 
S
);

270 
	`«s_gùr
(
«s
, 
J0
, 
S
, (S), 
g
);

274 
	`«s_’üy±_deš™
(
«s
);

277 
	}
}

283 
	$«s_gcm_ad
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
key_Ën
, cÚ¡‡es_uch¬ *
iv
, size_ˆ
iv_Ën
,

284 cÚ¡ 
«s_uch¬
 *
üy±
, 
size_t
 
üy±_Ën
,

285 cÚ¡ 
«s_uch¬
 *
¯d
, 
size_t
 
¯d_Ën
, cÚ¡‡es_uch¬ *
g
,‡es_uch¬ *
¶aš
)

287 
«s_uch¬
 
H
[
AES_BLOCK_SIZE
];

288 
«s_uch¬
 
J0
[
AES_BLOCK_SIZE
];

289 
«s_uch¬
 
S
[16], 
T
[16];

290 *
«s
;

292 
«s
 = 
	`«s_gcm_š™_hash_subkey
(
key
, 
key_Ën
, 
H
);

293 ià(
«s
 =ğ
NULL
)

296 
	`«s_gcm_´•¬e_j0
(
iv
, 
iv_Ën
, 
H
, 
J0
);

299 
	`«s_gcm_gùr
(
«s
, 
J0
, 
üy±
, 
üy±_Ën
, 
¶aš
);

301 
	`«s_gcm_ghash
(
H
, 
¯d
, 
¯d_Ën
, 
üy±
, 
üy±_Ën
, 
S
);

304 
	`«s_gùr
(
«s
, 
J0
, 
S
, (S), 
T
);

306 
	`«s_’üy±_deš™
(
«s
);

308 ià(
	`memcmp
(
g
, 
T
, 16) != 0) {

310 
	`oÿÎ_´št
("\nGCM: Tag mismatch...",-1.0);

315 
	}
}

318 
	$«s_gmac
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
key_Ën
, cÚ¡‡es_uch¬ *
iv
, size_ˆ
iv_Ën
,

319 cÚ¡ 
«s_uch¬
 *
¯d
, 
size_t
 
¯d_Ën
,‡es_uch¬ *
g
)

321  
	`«s_gcm_«
(
key
, 
key_Ën
, 
iv
, 
iv_Ën
, 
NULL
, 0, 
¯d
, 
¯d_Ën
, NULL, 
g
);

322 
	}
}

	@Enclave/aes-internal-enc.cpp

17 
	~"«s.h
"

18 
	~"«s-š‹º®.h
"

25 
	$«s_rijnd«l_key_£tup_’c
(
«s_ušt
 
rk
[], cÚ¡ 
«s_uch¬
 
ch”Key
[], 
size_t
 
keyB™s
)

27 
i
;

28 
«s_ušt
 
‹mp
;

30 
rk
[0] = 
	`GETU32
(
ch”Key
 );

31 
rk
[1] = 
	`GETU32
(
ch”Key
 + 4);

32 
rk
[2] = 
	`GETU32
(
ch”Key
 + 8);

33 
rk
[3] = 
	`GETU32
(
ch”Key
 + 12);

35 ià(
keyB™s
 == 128) {

36 
i
 = 0; i < 10; i++) {

37 
‹mp
 = 
rk
[3];

38 
rk
[4] =„k[0] ^ 
	`TE421
(
‹mp
è^ 
	`TE432
(temp) ^

39 
	`TE443
(
‹mp
è^ 
	`TE414
Ñempè^ 
	`RCON
(
i
);

40 
rk
[5] =„k[1] ^„k[4];

41 
rk
[6] =„k[2] ^„k[5];

42 
rk
[7] =„k[3] ^„k[6];

43 
rk
 += 4;

48 
rk
[4] = 
	`GETU32
(
ch”Key
 + 16);

49 
rk
[5] = 
	`GETU32
(
ch”Key
 + 20);

51 ià(
keyB™s
 == 192) {

52 
i
 = 0; i < 8; i++) {

53 
‹mp
 = 
rk
[5];

54 
rk
[6] =„k[0] ^ 
	`TE421
(
‹mp
è^ 
	`TE432
(temp) ^

55 
	`TE443
(
‹mp
è^ 
	`TE414
Ñempè^ 
	`RCON
(
i
);

56 
rk
[7] =„k[1] ^„k[6];

57 
rk
[8] =„k[2] ^„k[7];

58 
rk
[9] =„k[3] ^„k[8];

59 ià(
i
 == 7)

61 
rk
[10] =„k[4] ^„k[9];

62 
rk
[11] =„k[5] ^„k[10];

63 
rk
 += 6;

67 
rk
[6] = 
	`GETU32
(
ch”Key
 + 24);

68 
rk
[7] = 
	`GETU32
(
ch”Key
 + 28);

70 ià(
keyB™s
 == 256) {

71 
i
 = 0; i < 7; i++) {

72 
‹mp
 = 
rk
[7];

73 
rk
[8] =„k[0] ^ 
	`TE421
(
‹mp
è^ 
	`TE432
(temp) ^

74 
	`TE443
(
‹mp
è^ 
	`TE414
Ñempè^ 
	`RCON
(
i
);

75 
rk
[9] =„k[1] ^„k[8];

76 
rk
[10] =„k[2] ^„k[9];

77 
rk
[11] =„k[3] ^„k[10];

78 ià(
i
 == 6)

80 
‹mp
 = 
rk
[11];

81 
rk
[12] =„k[4] ^ 
	`TE411
(
‹mp
è^ 
	`TE422
(temp) ^

82 
	`TE433
(
‹mp
è^ 
	`TE444
(temp);

83 
rk
[13] =„k[5] ^„k[12];

84 
rk
[14] =„k[6] ^„k[13];

85 
rk
[15] =„k[7] ^„k[14];

86 
rk
 += 8;

91 
	}
}

93 
	$«s_rijnd«l_’üy±
(cÚ¡ 
«s_ušt
 
rk
[], 
Nr
, cÚ¡ 
«s_uch¬
 
±
[16],‡es_uch¬ 
ù
[16])

95 
«s_ušt
 
s0
, 
s1
, 
s2
, 
s3
, 
t0
, 
t1
, 
t2
, 
t3
;

96 #iâdeà
AES_FULL_UNROLL


97 
r
;

104 
s0
 = 
	`GETU32
(
±
 ) ^ 
rk
[0];

105 
s1
 = 
	`GETU32
(
±
 + 4è^ 
rk
[1];

106 
s2
 = 
	`GETU32
(
±
 + 8è^ 
rk
[2];

107 
s3
 = 
	`GETU32
(
±
 + 12è^ 
rk
[3];

109 
	#ROUND
(
i
,
d
,
s
) \

110 
d
##0 = 
	`TE0
(
s
##0è^ 
	`TE1
(s##1è^ 
	`TE2
(s##2è^ 
	`TE3
(s##3è^ 
rk
[4 * 
i
]; \

111 
d
##1 = 
	`TE0
(
s
##1è^ 
	`TE1
(s##2è^ 
	`TE2
(s##3è^ 
	`TE3
(s##0è^ 
rk
[4 * 
i
 + 1]; \

112 
d
##2 = 
	`TE0
(
s
##2è^ 
	`TE1
(s##3è^ 
	`TE2
(s##0è^ 
	`TE3
(s##1è^ 
rk
[4 * 
i
 + 2]; \

113 
d
##3 = 
	`TE0
(
s
##3è^ 
	`TE1
(s##0è^ 
	`TE2
(s##1è^ 
	`TE3
(s##2è^ 
rk
[4 * 
i
 + 3]

	)

115 #ifdeà
AES_FULL_UNROLL


117 
	`ROUND
(1,
t
,
s
);

118 
	`ROUND
(2,
s
,
t
);

119 
	`ROUND
(3,
t
,
s
);

120 
	`ROUND
(4,
s
,
t
);

121 
	`ROUND
(5,
t
,
s
);

122 
	`ROUND
(6,
s
,
t
);

123 
	`ROUND
(7,
t
,
s
);

124 
	`ROUND
(8,
s
,
t
);

125 
	`ROUND
(9,
t
,
s
);

126 ià(
Nr
 > 10) {

127 
	`ROUND
(10,
s
,
t
);

128 
	`ROUND
(11,
t
,
s
);

129 ià(
Nr
 > 12) {

130 
	`ROUND
(12,
s
,
t
);

131 
	`ROUND
(13,
t
,
s
);

135 
rk
 +ğ
Nr
 << 2;

140 
r
 = 
Nr
 >> 1;

142 
	`ROUND
(1,
t
,
s
);

143 
rk
 += 8;

144 ià(--
r
 == 0)

146 
	`ROUND
(0,
s
,
t
);

151 #undeà
ROUND


157 
s0
 = 
	`TE41
(
t0
è^ 
	`TE42
(
t1
è^ 
	`TE43
(
t2
è^ 
	`TE44
(
t3
è^ 
rk
[0];

158 
	`PUTU32
(
ù
 , 
s0
);

159 
s1
 = 
	`TE41
(
t1
è^ 
	`TE42
(
t2
è^ 
	`TE43
(
t3
è^ 
	`TE44
(
t0
è^ 
rk
[1];

160 
	`PUTU32
(
ù
 + 4, 
s1
);

161 
s2
 = 
	`TE41
(
t2
è^ 
	`TE42
(
t3
è^ 
	`TE43
(
t0
è^ 
	`TE44
(
t1
è^ 
rk
[2];

162 
	`PUTU32
(
ù
 + 8, 
s2
);

163 
s3
 = 
	`TE41
(
t3
è^ 
	`TE42
(
t0
è^ 
	`TE43
(
t1
è^ 
	`TE44
(
t2
è^ 
rk
[3];

164 
	`PUTU32
(
ù
 + 12, 
s3
);

165 
	}
}

170 * 
	$«s_’üy±_š™
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
Ën
)

172 
«s_ušt
 *
rk
;

173 
»s
;

174 
rk
 = (
«s_ušt
 *)
	`m®loc
(
AES_PRIV_SIZE
);

175 ià(
rk
 =ğ
NULL
)

176  
NULL
;

177 
»s
 = 
	`«s_rijnd«l_key_£tup_’c
(
rk
, 
key
, 
Ën
 * 8);

178 ià(
»s
 < 0) {

179 
	`ä“
(
rk
);

180  
NULL
;

182 
rk
[
AES_PRIV_NR_POS
] = 
»s
;

183  
rk
;

184 
	}
}

187 
	$«s_’üy±
(*
ùx
, cÚ¡ 
«s_uch¬
 *
¶aš
,‡es_uch¬ *
üy±
)

189 
«s_ušt
 *
rk
 = («s_ušˆ*)
ùx
;

190 
	`«s_rijnd«l_’üy±
((
«s_ušt
 *)
ùx
, 
rk
[
AES_PRIV_NR_POS
], 
¶aš
, 
üy±
);

191 
	}
}

194 
	$«s_’üy±_deš™
(*
ùx
)

196 
	`mem£t
(
ùx
, 0, 
AES_PRIV_SIZE
);

197 
	`ä“
(
ùx
);

198 
	}
}

	@Enclave/aes-internal.cpp

17 
	~"«s.h
"

18 
	~"«s-š‹º®.h
"

61 cÚ¡ 
«s_ušt
 
	gTe0
[256] = {

127 #iâdeà
AES_SMALL_TABLES


128 cÚ¡ 
«s_ušt
 
	gTe1
[256] = {

194 cÚ¡ 
«s_ušt
 
	gTe2
[256] = {

260 cÚ¡ 
«s_ušt
 
	gTe3
[256] = {

326 cÚ¡ 
«s_ušt
 
	gTe4
[256] = {

393 cÚ¡ 
«s_ušt
 
	gTd0
[256] = {

459 #iâdeà
AES_SMALL_TABLES


460 cÚ¡ 
«s_ušt
 
	gTd1
[256] = {

526 cÚ¡ 
«s_ušt
 
	gTd2
[256] = {

592 cÚ¡ 
«s_ušt
 
	gTd3
[256] = {

658 cÚ¡ 
«s_ušt
 
	gTd4
[256] = {

724 cÚ¡ 
«s_ušt
 
	grcÚ
[] = {

730 cÚ¡ 
«s_uch¬
 
	gTd4s
[256] = {

764 cÚ¡ 
«s_uch¬
 
	grcÚs
[] = {

	@Enclave/aes-internal.h

9 #iâdeà
AES_INTERNAL_H


10 
	#AES_INTERNAL_H


	)

12 cÚ¡ 
«s_ušt
 
Te0
[256];

13 cÚ¡ 
«s_ušt
 
Te1
[256];

14 cÚ¡ 
«s_ušt
 
Te2
[256];

15 cÚ¡ 
«s_ušt
 
Te3
[256];

16 cÚ¡ 
«s_ušt
 
Te4
[256];

17 cÚ¡ 
«s_ušt
 
Td0
[256];

18 cÚ¡ 
«s_ušt
 
Td1
[256];

19 cÚ¡ 
«s_ušt
 
Td2
[256];

20 cÚ¡ 
«s_ušt
 
Td3
[256];

21 cÚ¡ 
«s_ušt
 
Td4
[256];

22 cÚ¡ 
«s_ušt
 
rcÚ
[10];

23 cÚ¡ 
«s_uch¬
 
Td4s
[256];

24 cÚ¡ 
«s_uch¬
 
rcÚs
[10];

26 #iâdeà
AES_SMALL_TABLES


28 
	#RCON
(
i
è
rcÚ
[(i)]

	)

30 
	#TE0
(
i
è
Te0
[((iè>> 24è& 0xff]

	)

31 
	#TE1
(
i
è
Te1
[((iè>> 16è& 0xff]

	)

32 
	#TE2
(
i
è
Te2
[((iè>> 8è& 0xff]

	)

33 
	#TE3
(
i
è
Te3
[(iè& 0xff]

	)

34 
	#TE41
(
i
è(
Te4
[((iè>> 24è& 0xff] & 0xff000000)

	)

35 
	#TE42
(
i
è(
Te4
[((iè>> 16è& 0xff] & 0x00ff0000)

	)

36 
	#TE43
(
i
è(
Te4
[((iè>> 8è& 0xff] & 0x0000ff00)

	)

37 
	#TE44
(
i
è(
Te4
[(iè& 0xff] & 0x000000ff)

	)

38 
	#TE421
(
i
è(
Te4
[((iè>> 16è& 0xff] & 0xff000000)

	)

39 
	#TE432
(
i
è(
Te4
[((iè>> 8è& 0xff] & 0x00ff0000)

	)

40 
	#TE443
(
i
è(
Te4
[(iè& 0xff] & 0x0000ff00)

	)

41 
	#TE414
(
i
è(
Te4
[((iè>> 24è& 0xff] & 0x000000ff)

	)

42 
	#TE411
(
i
è(
Te4
[((iè>> 24è& 0xff] & 0xff000000)

	)

43 
	#TE422
(
i
è(
Te4
[((iè>> 16è& 0xff] & 0x00ff0000)

	)

44 
	#TE433
(
i
è(
Te4
[((iè>> 8è& 0xff] & 0x0000ff00)

	)

45 
	#TE444
(
i
è(
Te4
[(iè& 0xff] & 0x000000ff)

	)

46 
	#TE4
(
i
è(
Te4
[(i)] & 0x000000ff)

	)

48 
	#TD0
(
i
è
Td0
[((iè>> 24è& 0xff]

	)

49 
	#TD1
(
i
è
Td1
[((iè>> 16è& 0xff]

	)

50 
	#TD2
(
i
è
Td2
[((iè>> 8è& 0xff]

	)

51 
	#TD3
(
i
è
Td3
[(iè& 0xff]

	)

52 
	#TD41
(
i
è(
Td4
[((iè>> 24è& 0xff] & 0xff000000)

	)

53 
	#TD42
(
i
è(
Td4
[((iè>> 16è& 0xff] & 0x00ff0000)

	)

54 
	#TD43
(
i
è(
Td4
[((iè>> 8è& 0xff] & 0x0000ff00)

	)

55 
	#TD44
(
i
è(
Td4
[(iè& 0xff] & 0x000000ff)

	)

56 
	#TD0_
(
i
è
Td0
[(iè& 0xff]

	)

57 
	#TD1_
(
i
è
Td1
[(iè& 0xff]

	)

58 
	#TD2_
(
i
è
Td2
[(iè& 0xff]

	)

59 
	#TD3_
(
i
è
Td3
[(iè& 0xff]

	)

63 
	#RCON
(
i
è(
rcÚs
[(i)] << 24)

	)

65 
šlše
 
«s_ušt
 
	$rÙr
(
«s_ušt
 
v®
, 
b™s
)

67  (
v®
 >> 
b™s
) | (val << (32 - bits));

68 
	}
}

70 
	#TE0
(
i
è
Te0
[((iè>> 24è& 0xff]

	)

71 
	#TE1
(
i
è
	`rÙr
(
Te0
[((iè>> 16è& 0xff], 8)

	)

72 
	#TE2
(
i
è
	`rÙr
(
Te0
[((iè>> 8è& 0xff], 16)

	)

73 
	#TE3
(
i
è
	`rÙr
(
Te0
[(iè& 0xff], 24)

	)

74 
	#TE41
(
i
è((
Te0
[((iè>> 24è& 0xff] << 8è& 0xff000000)

	)

75 
	#TE42
(
i
è(
Te0
[((iè>> 16è& 0xff] & 0x00ff0000)

	)

76 
	#TE43
(
i
è(
Te0
[((iè>> 8è& 0xff] & 0x0000ff00)

	)

77 
	#TE44
(
i
è((
Te0
[(iè& 0xff] >> 8è& 0x000000ff)

	)

78 
	#TE421
(
i
è((
Te0
[((iè>> 16è& 0xff] << 8è& 0xff000000)

	)

79 
	#TE432
(
i
è(
Te0
[((iè>> 8è& 0xff] & 0x00ff0000)

	)

80 
	#TE443
(
i
è(
Te0
[(iè& 0xff] & 0x0000ff00)

	)

81 
	#TE414
(
i
è((
Te0
[((iè>> 24è& 0xff] >> 8è& 0x000000ff)

	)

82 
	#TE411
(
i
è((
Te0
[((iè>> 24è& 0xff] << 8è& 0xff000000)

	)

83 
	#TE422
(
i
è(
Te0
[((iè>> 16è& 0xff] & 0x00ff0000)

	)

84 
	#TE433
(
i
è(
Te0
[((iè>> 8è& 0xff] & 0x0000ff00)

	)

85 
	#TE444
(
i
è((
Te0
[(iè& 0xff] >> 8è& 0x000000ff)

	)

86 
	#TE4
(
i
è((
Te0
[(i)] >> 8è& 0x000000ff)

	)

88 
	#TD0
(
i
è
Td0
[((iè>> 24è& 0xff]

	)

89 
	#TD1
(
i
è
	`rÙr
(
Td0
[((iè>> 16è& 0xff], 8)

	)

90 
	#TD2
(
i
è
	`rÙr
(
Td0
[((iè>> 8è& 0xff], 16)

	)

91 
	#TD3
(
i
è
	`rÙr
(
Td0
[(iè& 0xff], 24)

	)

92 
	#TD41
(
i
è(
Td4s
[((iè>> 24è& 0xff] << 24)

	)

93 
	#TD42
(
i
è(
Td4s
[((iè>> 16è& 0xff] << 16)

	)

94 
	#TD43
(
i
è(
Td4s
[((iè>> 8è& 0xff] << 8)

	)

95 
	#TD44
(
i
è(
Td4s
[(iè& 0xff])

	)

96 
	#TD0_
(
i
è
Td0
[(iè& 0xff]

	)

97 
	#TD1_
(
i
è
	`rÙr
(
Td0
[(iè& 0xff], 8)

	)

98 
	#TD2_
(
i
è
	`rÙr
(
Td0
[(iè& 0xff], 16)

	)

99 
	#TD3_
(
i
è
	`rÙr
(
Td0
[(iè& 0xff], 24)

	)

103 
	#GETU32
(
±
è(((
«s_ušt
)(pt)[0] << 24) ^ \

104 ((
«s_ušt
)(
±
)[1] << 16) ^ \

105 ((
«s_ušt
)(
±
)[2] << 8) ^ \

106 ((
«s_ušt
)(
±
)[3]))

	)

107 
	#PUTU32
(
ù
, 
¡
) { \

108 (
ù
)[0] = (
«s_uch¬
)((
¡
) >> 24); \

109 (
ù
)[1] = (
«s_uch¬
)((
¡
) >> 16); \

110 (
ù
)[2] = (
«s_uch¬
)((
¡
) >> 8); \

111 (
ù
)[3] = (
«s_uch¬
)(
¡
); }

	)

113 
	#AES_PRIV_SIZE
 (4 * 4 * 15 + 4)

	)

114 
	#AES_PRIV_NR_POS
 (4 * 15)

	)

116 
«s_rijnd«l_’üy±
(cÚ¡ 
«s_ušt
 
rk
[], 
Nr
, cÚ¡ 
«s_uch¬
 
±
[16],‡es_uch¬ 
ù
[16]);

117 
«s_rijnd«l_deüy±
(cÚ¡ 
«s_ušt
 
rk
[], 
Nr
, cÚ¡ 
«s_uch¬
 
ù
[16],‡es_uch¬ 
±
[16]);

118 
«s_rijnd«l_key_£tup_dec
(
«s_ušt
 
rk
[], cÚ¡ 
«s_uch¬
 
ch”Key
[], 
size_t
 
keyB™s
);

119 
«s_rijnd«l_key_£tup_’c
(
«s_ušt
 
rk
[], cÚ¡ 
«s_uch¬
 
ch”Key
[], 
size_t
 
keyB™s
);

	@Enclave/aes.h

9 #iâdeà
AES_H


10 
	#AES_H


	)

12 #ifdeà
__ılu¥lus


16 
	#AES_FULL_UNROLL


	)

17 
	#AES_SMALL_TABLES


	)

18 
	#AES_BLOCK_SIZE
 16

	)

20 
	~"Enşave_t.h
"

21 
	~"«s-commÚ.h
"

22 
	~"«s-š‹º®.h
"

24 
«s_gcm_’Œy
(*
xüy±
, 
ušt8_t
 *
g¿d›Á
, ušt8_ˆ*
g_bufãr
, 
size
);

25 * 
«s_’üy±_š™
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
Ën
);

26 
«s_’üy±
(*
ùx
, cÚ¡ 
«s_uch¬
 *
¶aš
,‡es_uch¬ *
üy±
);

27 
«s_’üy±_deš™
(*
ùx
);

28 * 
«s_deüy±_š™
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
Ën
);

29 
«s_deüy±
(*
ùx
, cÚ¡ 
«s_uch¬
 *
üy±
,‡es_uch¬ *
¶aš
);

30 
«s_deüy±_deš™
(*
ùx
);

32 
AES_WARN_UNUSED_RESULT
 
«s_w¿p
(cÚ¡ 
«s_uch¬
 *
kek
, 
n
, cÚ¡‡es_uch¬ *
¶aš
,‡es_uch¬ *
ch”
);

33 
AES_WARN_UNUSED_RESULT
 
«s_unw¿p
(cÚ¡ 
«s_uch¬
 *
kek
, 
n
, cÚ¡‡es_uch¬ *
ch”
,‡es_uch¬ *
¶aš
);

34 
AES_WARN_UNUSED_RESULT
 
omac1_«s_128_veùÜ
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
num_–em
,

35 cÚ¡ 
«s_uch¬
 *
addr
[], cÚ¡ 
size_t
 *
Ën
,

36 
«s_uch¬
 *
mac
);

37 
AES_WARN_UNUSED_RESULT
 
omac1_«s_128
(cÚ¡ 
«s_uch¬
 *
key
, cÚ¡‡es_uch¬ *
d©a
, 
size_t
 
d©a_Ën
,

38 
«s_uch¬
 *
mac
);

39 
AES_WARN_UNUSED_RESULT
 
«s_128_’üy±_block
(cÚ¡ 
«s_uch¬
 *
key
, cÚ¡‡es_uch¬ *
š
,‡es_uch¬ *
out
);

40 
AES_WARN_UNUSED_RESULT
 
«s_128_ùr_’üy±
(cÚ¡ 
«s_uch¬
 *
key
, cÚ¡‡es_uch¬ *
nÚû
,

41 
«s_uch¬
 *
d©a
, 
size_t
 
d©a_Ën
);

42 
AES_WARN_UNUSED_RESULT
 
«s_128_—x_’üy±
(cÚ¡ 
«s_uch¬
 *
key
,

43 cÚ¡ 
«s_uch¬
 *
nÚû
, 
size_t
 
nÚû_Ën
,

44 cÚ¡ 
«s_uch¬
 *
hdr
, 
size_t
 
hdr_Ën
,

45 
«s_uch¬
 *
d©a
, 
size_t
 
d©a_Ën
,‡es_uch¬ *
g
);

46 
AES_WARN_UNUSED_RESULT
 
«s_128_—x_deüy±
(cÚ¡ 
«s_uch¬
 *
key
,

47 cÚ¡ 
«s_uch¬
 *
nÚû
, 
size_t
 
nÚû_Ën
,

48 cÚ¡ 
«s_uch¬
 *
hdr
, 
size_t
 
hdr_Ën
,

49 
«s_uch¬
 *
d©a
, 
size_t
 
d©a_Ën
, cÚ¡‡es_uch¬ *
g
);

50 
AES_WARN_UNUSED_RESULT
 
«s_128_cbc_’üy±
(cÚ¡ 
«s_uch¬
 *
key
, cÚ¡‡es_uch¬ *
iv
,‡es_uch¬ *
d©a
,

51 
size_t
 
d©a_Ën
);

52 
AES_WARN_UNUSED_RESULT
 
«s_128_cbc_deüy±
(cÚ¡ 
«s_uch¬
 *
key
, cÚ¡‡es_uch¬ *
iv
,‡es_uch¬ *
d©a
,

53 
size_t
 
d©a_Ën
);

54 
AES_WARN_UNUSED_RESULT
 
«s_gcm_«
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
key_Ën
,

55 cÚ¡ 
«s_uch¬
 *
iv
, 
size_t
 
iv_Ën
,

56 cÚ¡ 
«s_uch¬
 *
¶aš
, 
size_t
 
¶aš_Ën
,

57 cÚ¡ 
«s_uch¬
 *
¯d
, 
size_t
 
¯d_Ën
,

58 
«s_uch¬
 *
üy±
,‡es_uch¬ *
g
);

59 
AES_WARN_UNUSED_RESULT
 
«s_gcm_ad
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
key_Ën
,

60 cÚ¡ 
«s_uch¬
 *
iv
, 
size_t
 
iv_Ën
,

61 cÚ¡ 
«s_uch¬
 *
üy±
, 
size_t
 
üy±_Ën
,

62 cÚ¡ 
«s_uch¬
 *
¯d
, 
size_t
 
¯d_Ën
, cÚ¡‡es_uch¬ *
g
,

63 
«s_uch¬
 *
¶aš
);

64 
AES_WARN_UNUSED_RESULT
 
«s_gmac
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
key_Ën
,

65 cÚ¡ 
«s_uch¬
 *
iv
, 
size_t
 
iv_Ën
,

66 cÚ¡ 
«s_uch¬
 *
¯d
, 
size_t
 
¯d_Ën
,‡es_uch¬ *
g
);

67 
AES_WARN_UNUSED_RESULT
 
«s_ccm_«
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
key_Ën
, cÚ¡‡es_uch¬ *
nÚû
,

68 
size_t
 
M
, cÚ¡ 
«s_uch¬
 *
¶aš
, size_ˆ
¶aš_Ën
,

69 cÚ¡ 
«s_uch¬
 *
¯d
, 
size_t
 
¯d_Ën
,‡es_uch¬ *
üy±
,‡es_uch¬ *
auth
);

70 
AES_WARN_UNUSED_RESULT
 
«s_ccm_ad
(cÚ¡ 
«s_uch¬
 *
key
, 
size_t
 
key_Ën
, cÚ¡‡es_uch¬ *
nÚû
,

71 
size_t
 
M
, cÚ¡ 
«s_uch¬
 *
üy±
, size_ˆ
üy±_Ën
,

72 cÚ¡ 
«s_uch¬
 *
¯d
, 
size_t
 
¯d_Ën
, cÚ¡‡es_uch¬ *
auth
,

73 
«s_uch¬
 *
¶aš
);

75 #ifdeà
__ılu¥lus


	@Enclave/aes_TA.cpp

38 
	~<¡dšt.h
>

39 
	~<¡ršg.h
>

40 
	~"«s_TA.h
"

46 
	#Nb
 4

	)

48 #ià
defšed
(
AES256
) && (AES256 == 1)

49 
	#Nk
 8

	)

50 
	#Nr
 14

	)

51 #–ià
defšed
(
AES192
) && (AES192 == 1)

52 
	#Nk
 6

	)

53 
	#Nr
 12

	)

55 
	#Nk
 4

56 
	#Nr
 10

58 

	)

62 #iâdeà
MULTIPLY_AS_A_FUNCTION


63 
	#MULTIPLY_AS_A_FUNCTION
 0

	)

73 
ušt8_t
 
	t¡©e_t
[4][4];

80 cÚ¡ 
ušt8_t
 
	gsbox
[256] = {

99 cÚ¡ 
ušt8_t
 
	grsbox
[256] = {

119 cÚ¡ 
ušt8_t
 
	gRcÚ
[11] = {

142 
	#g‘SBoxV®ue
(
num
è(
sbox
[Òum)])

	)

149 
	#g‘SBoxInv”t
(
num
è(
rsbox
[Òum)])

	)

152 
	$KeyEx·nsiÚ
(
ušt8_t
* 
RoundKey
, cÚ¡ ušt8_t* 
Key
)

154 
i
, 
j
, 
k
;

155 
ušt8_t
 
‹m·
[4];

158 
i
 = 0; i < 
Nk
; ++i)

160 
RoundKey
[(
i
 * 4è+ 0] = 
Key
[(i * 4) + 0];

161 
RoundKey
[(
i
 * 4è+ 1] = 
Key
[(i * 4) + 1];

162 
RoundKey
[(
i
 * 4è+ 2] = 
Key
[(i * 4) + 2];

163 
RoundKey
[(
i
 * 4è+ 3] = 
Key
[(i * 4) + 3];

167 
i
 = 
Nk
; i < 
Nb
 * (
Nr
 + 1); ++i)

170 
k
 = (
i
 - 1) * 4;

171 
‹m·
[0]=
RoundKey
[
k
 + 0];

172 
‹m·
[1]=
RoundKey
[
k
 + 1];

173 
‹m·
[2]=
RoundKey
[
k
 + 2];

174 
‹m·
[3]=
RoundKey
[
k
 + 3];

178 ià(
i
 % 
Nk
 == 0)

185 cÚ¡ 
ušt8_t
 
u8tmp
 = 
‹m·
[0];

186 
‹m·
[0] =empa[1];

187 
‹m·
[1] =empa[2];

188 
‹m·
[2] =empa[3];

189 
‹m·
[3] = 
u8tmp
;

197 
‹m·
[0] = 
	`g‘SBoxV®ue
(tempa[0]);

198 
‹m·
[1] = 
	`g‘SBoxV®ue
(tempa[1]);

199 
‹m·
[2] = 
	`g‘SBoxV®ue
(tempa[2]);

200 
‹m·
[3] = 
	`g‘SBoxV®ue
(tempa[3]);

203 
‹m·
[0] =em·[0] ^ 
RcÚ
[
i
/
Nk
];

205 #ià
	`defšed
(
AES256
) && (AES256 == 1)

206 ià(
i
 % 
Nk
 == 4)

210 
‹m·
[0] = 
	`g‘SBoxV®ue
(tempa[0]);

211 
‹m·
[1] = 
	`g‘SBoxV®ue
(tempa[1]);

212 
‹m·
[2] = 
	`g‘SBoxV®ue
(tempa[2]);

213 
‹m·
[3] = 
	`g‘SBoxV®ue
(tempa[3]);

217 
j
 = 
i
 * 4; 
k
=(˜- 
Nk
) * 4;

218 
RoundKey
[
j
 + 0] = RoundKey[
k
 + 0] ^ 
‹m·
[0];

219 
RoundKey
[
j
 + 1] = RoundKey[
k
 + 1] ^ 
‹m·
[1];

220 
RoundKey
[
j
 + 2] = RoundKey[
k
 + 2] ^ 
‹m·
[2];

221 
RoundKey
[
j
 + 3] = RoundKey[
k
 + 3] ^ 
‹m·
[3];

223 
	}
}

225 
	$AES_š™_ùx
(
AES_ùx
* 
ùx
, cÚ¡ 
ušt8_t
* 
key
)

227 
	`KeyEx·nsiÚ
(
ùx
->
RoundKey
, 
key
);

228 
	}
}

229 #ià(
defšed
(
CBC
è&& (CBC =ğ1)è|| (defšed(
CTR
) && (CTR == 1))

230 
	$AES_š™_ùx_iv
(
AES_ùx
* 
ùx
, cÚ¡ 
ušt8_t
* 
key
, cÚ¡ ušt8_t* 
iv
)

232 
	`KeyEx·nsiÚ
(
ùx
->
RoundKey
, 
key
);

233 
	`memıy
 (
ùx
->
Iv
, 
iv
, 
AES_BLOCKLEN
);

234 
	}
}

235 
	$AES_ùx_£t_iv
(
AES_ùx
* 
ùx
, cÚ¡ 
ušt8_t
* 
iv
)

237 
	`memıy
 (
ùx
->
Iv
, 
iv
, 
AES_BLOCKLEN
);

238 
	}
}

243 
	$AddRoundKey
(
ušt8_t
 
round
, 
¡©e_t
* 
¡©e
, cÚ¡ ušt8_t* 
RoundKey
)

245 
ušt8_t
 
i
,
j
;

246 
i
 = 0; i < 4; ++i)

248 
j
 = 0; j < 4; ++j)

250 (*
¡©e
)[
i
][
j
] ^ğ
RoundKey
[(
round
 * 
Nb
 * 4) + (i * Nb) + j];

253 
	}
}

257 
	$SubBy‹s
(
¡©e_t
* 
¡©e
)

259 
ušt8_t
 
i
, 
j
;

260 
i
 = 0; i < 4; ++i)

262 
j
 = 0; j < 4; ++j)

264 (*
¡©e
)[
j
][
i
] = 
	`g‘SBoxV®ue
((*state)[j][i]);

267 
	}
}

272 
	$ShiáRows
(
¡©e_t
* 
¡©e
)

274 
ušt8_t
 
‹mp
;

277 
‹mp
 = (*
¡©e
)[0][1];

278 (*
¡©e
)[0][1] = (*state)[1][1];

279 (*
¡©e
)[1][1] = (*state)[2][1];

280 (*
¡©e
)[2][1] = (*state)[3][1];

281 (*
¡©e
)[3][1] = 
‹mp
;

284 
‹mp
 = (*
¡©e
)[0][2];

285 (*
¡©e
)[0][2] = (*state)[2][2];

286 (*
¡©e
)[2][2] = 
‹mp
;

288 
‹mp
 = (*
¡©e
)[1][2];

289 (*
¡©e
)[1][2] = (*state)[3][2];

290 (*
¡©e
)[3][2] = 
‹mp
;

293 
‹mp
 = (*
¡©e
)[0][3];

294 (*
¡©e
)[0][3] = (*state)[3][3];

295 (*
¡©e
)[3][3] = (*state)[2][3];

296 (*
¡©e
)[2][3] = (*state)[1][3];

297 (*
¡©e
)[1][3] = 
‹mp
;

298 
	}
}

300 
ušt8_t
 
	$xtime
(
ušt8_t
 
x
)

302  ((
x
<<1) ^ (((x>>7) & 1) * 0x1b));

303 
	}
}

306 
	$MixCŞumns
(
¡©e_t
* 
¡©e
)

308 
ušt8_t
 
i
;

309 
ušt8_t
 
Tmp
, 
Tm
, 
t
;

310 
i
 = 0; i < 4; ++i)

312 
t
 = (*
¡©e
)[
i
][0];

313 
Tmp
 = (*
¡©e
)[
i
][0] ^ (*state)[i][1] ^ (*state)[i][2] ^ (*state)[i][3] ;

314 
Tm
 = (*
¡©e
)[
i
][0] ^ (*¡©e)[i][1] ; Tm = 
	`xtime
(Tm); (*¡©e)[i][0] ^ğTm ^ 
Tmp
 ;

315 
Tm
 = (*
¡©e
)[
i
][1] ^ (*¡©e)[i][2] ; Tm = 
	`xtime
(Tm); (*¡©e)[i][1] ^ğTm ^ 
Tmp
 ;

316 
Tm
 = (*
¡©e
)[
i
][2] ^ (*¡©e)[i][3] ; Tm = 
	`xtime
(Tm); (*¡©e)[i][2] ^ğTm ^ 
Tmp
 ;

317 
Tm
 = (*
¡©e
)[
i
][3] ^ 
t
 ; Tm = 
	`xtime
(Tm); (*¡©e)[i][3] ^ğTm ^ 
Tmp
 ;

319 
	}
}

325 #ià
MULTIPLY_AS_A_FUNCTION


326 
ušt8_t
 
	$MuÉly
(
ušt8_t
 
x
, ušt8_ˆ
y
)

328  (((
y
 & 1è* 
x
) ^

329 ((
y
>>1 & 1è* 
	`xtime
(
x
)) ^

330 ((
y
>>2 & 1è* 
	`xtime
(xtime(
x
))) ^

331 ((
y
>>3 & 1è* 
	`xtime
(xtime(xtime(
x
)))) ^

332 ((
y
>>4 & 1è* 
	`xtime
(xtime(xtime(xtime(
x
))))));

333 
	}
}

335 
	#MuÉly
(
x
, 
y
) \

336 Ğ((
y
 & 1è* 
x
) ^ \

337 ((
y
>>1 & 1è* 
	`xtime
(
x
)) ^ \

338 ((
y
>>2 & 1è* 
	`xtime
(xtime(
x
))) ^ \

339 ((
y
>>3 & 1è* 
	`xtime
(xtime(xtime(
x
)))) ^ \

340 ((
y
>>4 & 1è* 
	`xtime
(xtime(xtime(xtime(
x
)))))) \

341 

	)

344 #ià(
defšed
(
CBC
è&& CBC =ğ1è|| (defšed(
ECB
) && ECB == 1)

348 
	$InvMixCŞumns
(
¡©e_t
* 
¡©e
)

350 
i
;

351 
ušt8_t
 
a
, 
b
, 
c
, 
d
;

352 
i
 = 0; i < 4; ++i)

354 
a
 = (*
¡©e
)[
i
][0];

355 
b
 = (*
¡©e
)[
i
][1];

356 
c
 = (*
¡©e
)[
i
][2];

357 
d
 = (*
¡©e
)[
i
][3];

359 (*
¡©e
)[
i
][0] = 
	`MuÉly
(
a
, 0x0eè^ MuÉly(
b
, 0x0bè^ MuÉly(
c
, 0x0dè^ MuÉly(
d
, 0x09);

360 (*
¡©e
)[
i
][1] = 
	`MuÉly
(
a
, 0x09è^ MuÉly(
b
, 0x0eè^ MuÉly(
c
, 0x0bè^ MuÉly(
d
, 0x0d);

361 (*
¡©e
)[
i
][2] = 
	`MuÉly
(
a
, 0x0dè^ MuÉly(
b
, 0x09è^ MuÉly(
c
, 0x0eè^ MuÉly(
d
, 0x0b);

362 (*
¡©e
)[
i
][3] = 
	`MuÉly
(
a
, 0x0bè^ MuÉly(
b
, 0x0dè^ MuÉly(
c
, 0x09è^ MuÉly(
d
, 0x0e);

364 
	}
}

369 
	$InvSubBy‹s
(
¡©e_t
* 
¡©e
)

371 
ušt8_t
 
i
, 
j
;

372 
i
 = 0; i < 4; ++i)

374 
j
 = 0; j < 4; ++j)

376 (*
¡©e
)[
j
][
i
] = 
	`g‘SBoxInv”t
((*state)[j][i]);

379 
	}
}

381 
	$InvShiáRows
(
¡©e_t
* 
¡©e
)

383 
ušt8_t
 
‹mp
;

386 
‹mp
 = (*
¡©e
)[3][1];

387 (*
¡©e
)[3][1] = (*state)[2][1];

388 (*
¡©e
)[2][1] = (*state)[1][1];

389 (*
¡©e
)[1][1] = (*state)[0][1];

390 (*
¡©e
)[0][1] = 
‹mp
;

393 
‹mp
 = (*
¡©e
)[0][2];

394 (*
¡©e
)[0][2] = (*state)[2][2];

395 (*
¡©e
)[2][2] = 
‹mp
;

397 
‹mp
 = (*
¡©e
)[1][2];

398 (*
¡©e
)[1][2] = (*state)[3][2];

399 (*
¡©e
)[3][2] = 
‹mp
;

402 
‹mp
 = (*
¡©e
)[0][3];

403 (*
¡©e
)[0][3] = (*state)[1][3];

404 (*
¡©e
)[1][3] = (*state)[2][3];

405 (*
¡©e
)[2][3] = (*state)[3][3];

406 (*
¡©e
)[3][3] = 
‹mp
;

407 
	}
}

411 
	$Ch”
(
¡©e_t
* 
¡©e
, cÚ¡ 
ušt8_t
* 
RoundKey
)

413 
ušt8_t
 
round
 = 0;

416 
	`AddRoundKey
(0, 
¡©e
, 
RoundKey
);

421 
round
 = 1;„ound < 
Nr
; ++round)

423 
	`SubBy‹s
(
¡©e
);

424 
	`ShiáRows
(
¡©e
);

425 
	`MixCŞumns
(
¡©e
);

426 
	`AddRoundKey
(
round
, 
¡©e
, 
RoundKey
);

431 
	`SubBy‹s
(
¡©e
);

432 
	`ShiáRows
(
¡©e
);

433 
	`AddRoundKey
(
Nr
, 
¡©e
, 
RoundKey
);

434 
	}
}

436 #ià(
defšed
(
CBC
è&& CBC =ğ1è|| (defšed(
ECB
) && ECB == 1)

437 
	$InvCh”
(
¡©e_t
* 
¡©e
, cÚ¡ 
ušt8_t
* 
RoundKey
)

439 
ušt8_t
 
round
 = 0;

442 
	`AddRoundKey
(
Nr
, 
¡©e
, 
RoundKey
);

447 
round
 = (
Nr
 - 1);„ound > 0; --round)

449 
	`InvShiáRows
(
¡©e
);

450 
	`InvSubBy‹s
(
¡©e
);

451 
	`AddRoundKey
(
round
, 
¡©e
, 
RoundKey
);

452 
	`InvMixCŞumns
(
¡©e
);

457 
	`InvShiáRows
(
¡©e
);

458 
	`InvSubBy‹s
(
¡©e
);

459 
	`AddRoundKey
(0, 
¡©e
, 
RoundKey
);

460 
	}
}

466 #ià
defšed
(
ECB
) && (ECB == 1)

469 
	$AES_ECB_’üy±
(cÚ¡ 
AES_ùx
* 
ùx
, 
ušt8_t
* 
buf
)

472 
	`Ch”
((
¡©e_t
*)
buf
, 
ùx
->
RoundKey
);

473 
	}
}

475 
	$AES_ECB_deüy±
(cÚ¡ 
AES_ùx
* 
ùx
, 
ušt8_t
* 
buf
)

478 
	`InvCh”
((
¡©e_t
*)
buf
, 
ùx
->
RoundKey
);

479 
	}
}

488 #ià
defšed
(
CBC
) && (CBC == 1)

491 
	$XÜW™hIv
(
ušt8_t
* 
buf
, cÚ¡ ušt8_t* 
Iv
)

493 
ušt8_t
 
i
;

494 
i
 = 0; i < 
AES_BLOCKLEN
; ++i)

496 
buf
[
i
] ^ğ
Iv
[i];

498 
	}
}

500 
	$AES_CBC_’üy±_bufãr
(
AES_ùx
 *
ùx
, 
ušt8_t
* 
buf
, 
ušt32_t
 
Ëngth
)

502 
ušŒ_t
 
i
;

503 
ušt8_t
 *
Iv
 = 
ùx
->Iv;

504 
i
 = 0; i < 
Ëngth
; i +ğ
AES_BLOCKLEN
)

506 
	`XÜW™hIv
(
buf
, 
Iv
);

507 
	`Ch”
((
¡©e_t
*)
buf
, 
ùx
->
RoundKey
);

508 
Iv
 = 
buf
;

509 
buf
 +ğ
AES_BLOCKLEN
;

513 
	`memıy
(
ùx
->
Iv
, Iv, 
AES_BLOCKLEN
);

514 
	}
}

516 
	$AES_CBC_deüy±_bufãr
(
AES_ùx
* 
ùx
, 
ušt8_t
* 
buf
, 
ušt32_t
 
Ëngth
)

518 
ušŒ_t
 
i
;

519 
ušt8_t
 
¡ÜeNextIv
[
AES_BLOCKLEN
];

520 
i
 = 0; i < 
Ëngth
; i +ğ
AES_BLOCKLEN
)

522 
	`memıy
(
¡ÜeNextIv
, 
buf
, 
AES_BLOCKLEN
);

523 
	`InvCh”
((
¡©e_t
*)
buf
, 
ùx
->
RoundKey
);

524 
	`XÜW™hIv
(
buf
, 
ùx
->
Iv
);

525 
	`memıy
(
ùx
->
Iv
, 
¡ÜeNextIv
, 
AES_BLOCKLEN
);

526 
buf
 +ğ
AES_BLOCKLEN
;

529 
	}
}

535 #ià
defšed
(
CTR
) && (CTR == 1)

538 
	$AES_CTR_xüy±_bufãr
(
AES_ùx
* 
ùx
, 
ušt8_t
* 
buf
, 
ušt32_t
 
Ëngth
)

540 
ušt8_t
 
bufãr
[
AES_BLOCKLEN
];

542 
i
;

543 
bi
;

544 
i
 = 0, 
bi
 = 
AES_BLOCKLEN
; i < 
Ëngth
; ++i, ++bi)

546 ià(
bi
 =ğ
AES_BLOCKLEN
)

549 
	`memıy
(
bufãr
, 
ùx
->
Iv
, 
AES_BLOCKLEN
);

550 
	`Ch”
((
¡©e_t
*)
bufãr
,
ùx
->
RoundKey
);

553 
bi
 = (
AES_BLOCKLEN
 - 1); bi >= 0; --bi)

556 ià(
ùx
->
Iv
[
bi
] == 255)

558 
ùx
->
Iv
[
bi
] = 0;

561 
ùx
->
Iv
[
bi
] += 1;

564 
bi
 = 0;

567 
buf
[
i
] = (buf[i] ^ 
bufãr
[
bi
]);

569 
	}
}

	@Enclave/aes_TA.h

1 #iâdeà
_AES_H_


2 
	#_AES_H_


	)

4 
	~<¡dšt.h
>

13 #iâdeà
CBC


14 
	#CBC
 1

	)

17 #iâdeà
ECB


18 
	#ECB
 1

	)

21 #iâdeà
CTR


22 
	#CTR
 1

	)

26 
	#AES128
 1

	)

30 
	#AES_BLOCKLEN
 16

31 

	)

32 #ià
defšed
(
AES256
) && (AES256 == 1)

33 
	#AES_KEYLEN
 32

	)

34 
	#AES_keyExpSize
 240

	)

35 #–ià
defšed
(
AES192
) && (AES192 == 1)

36 
	#AES_KEYLEN
 24

	)

37 
	#AES_keyExpSize
 208

	)

39 
	#AES_KEYLEN
 16

40 
	#AES_keyExpSize
 176

	)

43 
	sAES_ùx


45 
ušt8_t
 
	mRoundKey
[
AES_keyExpSize
];

46 #ià(
defšed
(
CBC
è&& (CBC =ğ1)è|| (defšed(
CTR
) && (CTR == 1))

47 
ušt8_t
 
	mIv
[
AES_BLOCKLEN
];

51 
AES_š™_ùx
(
AES_ùx
* 
ùx
, cÚ¡ 
ušt8_t
* 
key
);

52 #ià(
defšed
(
CBC
è&& (CBC =ğ1)è|| (defšed(
CTR
) && (CTR == 1))

53 
AES_š™_ùx_iv
(
AES_ùx
* 
ùx
, cÚ¡ 
ušt8_t
* 
key
, cÚ¡ ušt8_t* 
iv
);

54 
AES_ùx_£t_iv
(
AES_ùx
* 
ùx
, cÚ¡ 
ušt8_t
* 
iv
);

57 #ià
defšed
(
ECB
) && (ECB == 1)

61 
AES_ECB_’üy±
(cÚ¡ 
AES_ùx
* 
ùx
, 
ušt8_t
* 
buf
);

62 
AES_ECB_deüy±
(cÚ¡ 
AES_ùx
* 
ùx
, 
ušt8_t
* 
buf
);

67 #ià
defšed
(
CBC
) && (CBC == 1)

72 
AES_CBC_’üy±_bufãr
(
AES_ùx
* 
ùx
, 
ušt8_t
* 
buf
, 
ušt32_t
 
Ëngth
);

73 
AES_CBC_deüy±_bufãr
(
AES_ùx
* 
ùx
, 
ušt8_t
* 
buf
, 
ušt32_t
 
Ëngth
);

78 #ià
defšed
(
CTR
) && (CTR == 1)

85 
AES_CTR_xüy±_bufãr
(
AES_ùx
* 
ùx
, 
ušt8_t
* 
buf
, 
ušt32_t
 
Ëngth
);

	@Enclave/blas_TA.cpp

1 
	~"bÏs_TA.h
"

2 
	~"m©h_TA.h
"

3 
	~"Enşave_t.h
"

5 
	~<as£¹.h
>

6 
	~<¡dio.h
>

7 
	~<¡dlib.h
>

8 
	~<¡ršg.h
>

9 
	~<m©h.h
>

10 
	~<æßt.h
>

12 
	$fl_ıu_TA
(
N
, 
ALPHA
, *
X
, 
INCX
)

14 
i
;

15 #´agm¨
omp
 
·¿Î–
 

16 
i
 = 0; i < 
N
; ++iè
X
[i*
INCX
] = 
ALPHA
;

17 
	}
}

19 
	$cİy_ıu_TA
(
N
, *
X
, 
INCX
, *
Y
, 
INCY
)

21 
i
;

22 #´agm¨
omp
 
·¿Î–
 

23 
i
 = 0; i < 
N
; ++i) {

24 
Y
[
i
*
INCY
] = 
X
[i*
INCX
];

26 
	}
}

28 
	$m—n_ıu_TA
(*
x
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
, *
m—n
)

30 
sÿË
 = 1./(
b©ch
 * 
¥©Ÿl
);

31 
i
,
j
,
k
;

32 
i
 = 0; i < 
f‹rs
; ++i){

33 
m—n
[
i
] = 0;

34 
j
 = 0; j < 
b©ch
; ++j){

35 
k
 = 0; k < 
¥©Ÿl
; ++k){

36 
šdex
 = 
j
*
f‹rs
*
¥©Ÿl
 + 
i
*¥©ŸÈ+ 
k
;

37 
m—n
[
i
] +ğ
x
[
šdex
];

40 
m—n
[
i
] *ğ
sÿË
;

42 
	}
}

44 
	$v¬Ÿnû_ıu_TA
(*
x
, *
m—n
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
, *
v¬Ÿnû
)

46 
sÿË
 = 1./(
b©ch
 * 
¥©Ÿl
 - 1);

47 
i
,
j
,
k
;

48 
i
 = 0; i < 
f‹rs
; ++i){

49 
v¬Ÿnû
[
i
] = 0;

50 
j
 = 0; j < 
b©ch
; ++j){

51 
k
 = 0; k < 
¥©Ÿl
; ++k){

52 
šdex
 = 
j
*
f‹rs
*
¥©Ÿl
 + 
i
*¥©ŸÈ+ 
k
;

53 
v¬Ÿnû
[
i
] +ğ
	`_pow
((
x
[
šdex
] - 
m—n
[i]), 2);

56 
v¬Ÿnû
[
i
] *ğ
sÿË
;

58 
	}
}

60 
	$sÿl_ıu_TA
(
N
, 
ALPHA
, *
X
, 
INCX
)

62 
i
;

63 
i
 = 0; i < 
N
; ++iè
X
[i*
INCX
] *ğ
ALPHA
;

64 
	}
}

66 
	$axpy_ıu_TA
(
N
, 
ALPHA
, *
X
, 
INCX
, *
Y
, 
INCY
)

68 
i
;

69 
i
 = 0; i < 
N
; ++iè
Y
[i*
INCY
] +ğ
ALPHA
*
X
[i*
INCX
];

70 
	}
}

73 
	$nÜm®ize_ıu_TA
(*
x
, *
m—n
, *
v¬Ÿnû
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
)

75 
b
, 
f
, 
i
;

76 
b
 = 0; b < 
b©ch
; ++b){

77 
b_v®
 = 
b
*
f‹rs
*
¥©Ÿl
;

78 
f
 = 0; f < 
f‹rs
; ++f){

79 
f_v®
 = 
f
*
¥©Ÿl
;

80 
i
 = 0; i < 
¥©Ÿl
; ++i){

82 
šdex
 = 
b_v®
 + 
f_v®
 + 
i
;

83 
x
[
šdex
] = (x[šdex] - 
m—n
[
f
])/(
	`_sq¹
(
v¬Ÿnû
[f]) + .000001f);

87 
	}
}

90 
	$soámax_TA
(*
šput
, 
n
, 
‹mp
, 
¡ride
, *
ouut
)

92 
i
;

93 
sum
 = 0;

94 
Ïrge¡
 = -
fœ¡_aim_mÚey
;

95 
i
 = 0; i < 
n
; ++i){

96 if(
šput
[
i
*
¡ride
] > 
Ïrge¡
)†argest = input[i*stride];

99 
i
 = 0; i < 
n
; ++i){

101 
e_
 = 
	`exp
(
šput
[
i
*
¡ride
]/
‹mp
 - 
Ïrge¡
/temp);

102 
sum
 +ğ
e_
;

103 
ouut
[
i
*
¡ride
] = 
e_
;

106 
i
 = 0; i < 
n
; ++i){

107 
ouut
[
i
*
¡ride
] /ğ
sum
;

110 
	}
}

113 
	$soámax_ıu_TA
(*
šput
, 
n
, 
b©ch
, 
b©ch_off£t
, 
groups
, 
group_off£t
, 
¡ride
, 
‹mp
, *
ouut
)

115 
g
, 
b
;

116 
b
 = 0; b < 
b©ch
; ++b){

117 
g
 = 0; g < 
groups
; ++g){

118 
	`soámax_TA
(
šput
 + 
b
*
b©ch_off£t
 + 
g
*
group_off£t
, 
n
, 
‹mp
, 
¡ride
, 
ouut
 + b*batch_offset + g*group_offset);

121 
	}
}

125 
	$soámax_x_’t_ıu_TA
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
)

127 
i
;

128 
i
 = 0; i < 
n
; ++i){

129 
t
 = 
Œuth
[
i
];

130 
p
 = 
´ed
[
i
];

131 
”rÜ
[
i
] = (
t
è? -
	`_Ê
(
p
) : 0;

132 
d–
[
i
] = 
t
-
p
;

135 
	}
}

139 
	$smoÙh_l1_ıu_TA
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
)

141 
i
;

142 
i
 = 0; i < 
n
; ++i){

143 
diff
 = 
Œuth
[
i
] - 
´ed
[i];

144 
abs_v®
 = 
	`çbs
(
diff
);

145 if(
abs_v®
 < 1) {

146 
”rÜ
[
i
] = 
diff
 * diff;

147 
d–
[
i
] = 
diff
;

150 
”rÜ
[
i
] = 2*
abs_v®
 - 1;

151 
d–
[
i
] = (
diff
 < 0) ? 1 : -1;

155 
	}
}

158 
	$l1_ıu_TA
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
)

160 
i
;

161 
i
 = 0; i < 
n
; ++i){

162 
diff
 = 
Œuth
[
i
] - 
´ed
[i];

163 
”rÜ
[
i
] = 
	`çbs
(
diff
);

164 
d–
[
i
] = 
diff
 > 0 ? 1 : -1;

167 
	}
}

169 
	$l2_ıu_TA
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
)

171 
i
;

172 
i
 = 0; i < 
n
; ++i){

173 
diff
 = 
Œuth
[
i
] - 
´ed
[i];

174 
”rÜ
[
i
] = 
diff
 * diff;

175 
d–
[
i
] = 
diff
;

178 
	}
}

	@Enclave/blas_TA.h

1 #iâdeà
BLAS_TA_H


2 
	#BLAS_TA_H


	)

3 
	~"d¬kÃt_TA.h
"

5 
fl_ıu_TA
(
N
, 
ALPHA
, *
X
, 
INCX
);

7 
cİy_ıu_TA
(
N
, *
X
, 
INCX
, *
Y
, 
INCY
);

9 
m—n_ıu_TA
(*
x
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
, *
m—n
);

11 
v¬Ÿnû_ıu_TA
(*
x
, *
m—n
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
, *
v¬Ÿnû
);

13 
sÿl_ıu_TA
(
N
, 
ALPHA
, *
X
, 
INCX
);

15 
axpy_ıu_TA
(
N
, 
ALPHA
, *
X
, 
INCX
, *
Y
, 
INCY
);

17 
nÜm®ize_ıu_TA
(*
x
, *
m—n
, *
v¬Ÿnû
, 
b©ch
, 
f‹rs
, 
¥©Ÿl
);

19 
soámax_TA
(*
šput
, 
n
, 
‹mp
, 
¡ride
, *
ouut
);

21 
soámax_ıu_TA
(*
šput
, 
n
, 
b©ch
, 
b©ch_off£t
, 
groups
, 
group_off£t
, 
¡ride
, 
‹mp
, *
ouut
);

23 
soámax_x_’t_ıu_TA
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
);

25 
smoÙh_l1_ıu_TA
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
);

27 
l1_ıu_TA
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
);

29 
l2_ıu_TA
(
n
, *
´ed
, *
Œuth
, *
d–
, *
”rÜ
);

	@Enclave/darknet_TA.h

1 #iâdeà
DARKNET_API_TA


2 
	#DARKNET_API_TA


	)

3 
	~<¡dlib.h
>

4 
	~<¡dio.h
>

5 
	~<¡ršg.h
>

8 
	#SECRET_NUM_TA
 -1234

	)

10 
	#TA_THRESHOLD_LIMIT
 (6*1024*1024)

	)

13 *
	mËaf
;

14 
	mn
;

15 *
	m·»Á
;

16 *
	mchd
;

17 *
	mgroup
;

18 **
	mÇme
;

20 
	mgroups
;

21 *
	mgroup_size
;

22 *
	mgroup_off£t
;

23 } 
	tŒ“_TA
;

26 
	mLOGISTIC_TA
, 
	mRELU_TA
, 
	mRELIE_TA
, 
	mLINEAR_TA
, 
	mRAMP_TA
, 
	mTANH_TA
, 
	mPLSE_TA
, 
	mLEAKY_TA
, 
	mELU_TA
, 
	mLOGGY_TA
, 
	mSTAIR_TA
, 
	mHARDTAN_TA
, 
	mLHTAN_TA
, 
	mSELU_TA


27 } 
	tACTIVATION_TA
;

30 
	mCONVOLUTIONAL_TA
,

31 
	mDECONVOLUTIONAL_TA
,

32 
	mCONNECTED_TA
,

33 
	mMAXPOOL_TA
,

34 
	mSOFTMAX_TA
,

35 
	mDETECTION_TA
,

36 
	mDROPOUT_TA
,

37 
	mCROP_TA
,

38 
	mROUTE_TA
,

39 
	mCOST_TA
,

40 
	mNORMALIZATION_TA
,

41 
	mAVGPOOL_TA
,

42 
	mLOCAL_TA
,

43 
	mSHORTCUT_TA
,

44 
	mACTIVE_TA
,

45 
	mRNN_TA
,

46 
	mGRU_TA
,

47 
	mLSTM_TA
,

48 
	mCRNN_TA
,

49 
	mBATCHNORM_TA
,

50 
	mNETWORK_TA
,

51 
	mXNOR_TA
,

52 
	mREGION_TA
,

53 
	mYOLO_TA
,

54 
	mISEG_TA
,

55 
	mREORG_TA
,

56 
	mUPSAMPLE_TA
,

57 
	mLOGXENT_TA
,

58 
	mL2NORM_TA
,

59 
	mBLANK_TA


60 } 
	tLAYER_TYPE_TA
;

63 
	mSSE_TA
, 
	mMASKED_TA
, 
	mL1_TA
, 
	mSEG_TA
, 
	mSMOOTH_TA
, 
	mWGAN_TA


64 } 
	tCOST_TYPE_TA
;

67 
	mb©ch
;

68 
	mË¬nšg_¿‹
;

69 
	mmom’tum
;

70 
	mdeÿy
;

71 
	madam
;

72 
	mB1
;

73 
	mB2
;

74 
	m•s
;

75 
	mt
;

76 } 
	tupd©e_¬gs_TA
;

78 
	gÃtwÜk_TA
;

79 
ÃtwÜk_TA
 
	tÃtwÜk_TA
;

81 
	gÏy”_TA
;

82 
Ïy”_TA
 
	tÏy”_TA
;

84 
	sÏy”_TA
{

85 
LAYER_TYPE_TA
 
	mty³
;

86 
ACTIVATION_TA
 
	maùiv©iÚ
;

87 
COST_TYPE_TA
 
	mco¡_ty³
;

88 (*
	mfÜw¬d_TA
è(
	mÏy”_TA
, 
	mÃtwÜk_TA
);

89 (*
	mbackw¬d_TA
è(
	mÏy”_TA
, 
	mÃtwÜk_TA
);

90 (*
	mupd©e_TA
è(
	mÏy”_TA
, 
	mupd©e_¬gs_TA
);

92 
	mÃŠum
;

94 
	mb©ch_nÜm®ize
;

95 
	mshÜtcut
;

96 
	mb©ch
;

97 
	mfÜûd
;

98 
	mæ³d
;

99 
	mšputs
;

100 
	mouuts
;

101 
	mnweights
;

102 
	mnbŸ£s
;

103 
	mexŒa
;

104 
	mŒuths
;

105 
	mh
,
	mw
,
	mc
;

106 
	mout_h
, 
	mout_w
, 
	mout_c
;

107 
	mn
;

108 
	mmax_boxes
;

109 
	mgroups
;

110 
	msize
;

111 
	mside
;

112 
	m¡ride
;

113 
	m»v”£
;

114 
	mæ©‹n
;

115 
	m¥©Ÿl
;

116 
	m·d
;

117 
	msq¹
;

118 
	mæ
;

119 
	mšdex
;

120 
	mbš¬y
;

121 
	mxnÜ
;

122 
	m¡•s
;

123 
	mhidd’
;

124 
	mŒuth
;

125 
	msmoÙh
;

126 
	mdÙ
;

127 
	mªgË
;

128 
	mj™‹r
;

129 
	m§tu¿tiÚ
;

130 
	mexposu»
;

131 
	mshiá
;

132 
	m¿tio
;

133 
	mË¬nšg_¿‹_sÿË
;

134 
	mş
;

135 
	mnŞoss
;

136 
	msoámax
;

137 
	mşas£s
;

138 
	mcoÜds
;

139 
	mbackground
;

140 
	m»scÜe
;

141 
	mobjeùÃss
;

142 
	mjošt
;

143 
	mnßdju¡
;

144 
	m»Üg
;

145 
	mlog
;

146 
	mnh
;

147 *
	mmask
;

148 
	mtÙ®
;

150 
	m®pha
;

151 
	mb‘a
;

152 
	mk­·
;

154 
	mcoÜd_sÿË
;

155 
	mobjeù_sÿË
;

156 
	mnoobjeù_sÿË
;

157 
	mmask_sÿË
;

158 
	mşass_sÿË
;

159 
	mbŸs_m©ch
;

160 
	m¿ndom
;

161 
	mignÜe_th»sh
;

162 
	mŒuth_th»sh
;

163 
	mth»sh
;

164 
	mfocus
;

165 
	mşassfix
;

166 
	mabsŞu‹
;

168 
	mÚlyfÜw¬d
;

169 
	m¡İbackw¬d
;

170 
	mdÚßd
;

171 
	mdÚt§ve
;

172 
	mdÚßdsÿËs
;

173 
	mnumlßd
;

175 
	m‹m³¿tu»
;

176 
	m´obab™y
;

177 
	msÿË
;

179 * 
	mcweights
;

180 * 
	mšdexes
;

181 * 
	mšput_Ïy”s
;

182 * 
	mšput_sizes
;

183 * 
	mm­
;

184 * 
	mcouÁs
;

185 ** 
	msums
;

186 * 
	m¿nd
;

187 * 
	mco¡
;

188 * 
	m¡©e
;

189 * 
	m´ev_¡©e
;

190 * 
	mfÜgÙ_¡©e
;

191 * 
	mfÜgÙ_d–
;

192 * 
	m¡©e_d–
;

193 * 
	mcombše_ıu
;

194 * 
	mcombše_d–_ıu
;

196 * 
	mcÚÿt
;

197 * 
	mcÚÿt_d–
;

199 * 
	mbš¬y_weights
;

201 * 
	mbŸ£s
;

202 * 
	mbŸs_upd©es
;

204 * 
	msÿËs
;

205 * 
	msÿË_upd©es
;

207 * 
	mweights
;

208 * 
	mweight_upd©es
;

210 * 
	md–
;

211 * 
	mouut
;

212 * 
	mloss
;

213 * 
	msqu¬ed
;

214 * 
	mnÜms
;

216 * 
	m¥©Ÿl_m—n
;

217 * 
	mm—n
;

218 * 
	mv¬Ÿnû
;

220 * 
	mm—n_d–
;

221 * 
	mv¬Ÿnû_d–
;

223 * 
	mrŞlšg_m—n
;

224 * 
	mrŞlšg_v¬Ÿnû
;

226 * 
	mx
;

227 * 
	mx_nÜm
;

229 * 
	mm
;

230 * 
	mv
;

232 * 
	mbŸs_m
;

233 * 
	mbŸs_v
;

234 * 
	msÿË_m
;

235 * 
	msÿË_v
;

238 *
	mz_ıu
;

239 *
	mr_ıu
;

240 *
	mh_ıu
;

241 * 
	m´ev_¡©e_ıu
;

243 *
	m‹mp_ıu
;

244 *
	m‹mp2_ıu
;

245 *
	m‹mp3_ıu
;

247 *
	mdh_ıu
;

248 *
	mhh_ıu
;

249 *
	m´ev_ûÎ_ıu
;

250 *
	mûÎ_ıu
;

251 *
	mf_ıu
;

252 *
	mi_ıu
;

253 *
	mg_ıu
;

254 *
	mo_ıu
;

255 *
	mc_ıu
;

256 *
	mdc_ıu
;

258 * 
	mbš¬y_šput
;

260 
Ïy”_TA
 *
	mšput_Ïy”
;

261 
Ïy”_TA
 *
	m£lf_Ïy”
;

262 
Ïy”_TA
 *
	mouut_Ïy”
;

264 
Ïy”_TA
 *
	m»£t_Ïy”
;

265 
Ïy”_TA
 *
	mupd©e_Ïy”
;

266 
Ïy”_TA
 *
	m¡©e_Ïy”
;

268 
Ïy”_TA
 *
	mšput_g©e_Ïy”
;

269 
Ïy”_TA
 *
	m¡©e_g©e_Ïy”
;

270 
Ïy”_TA
 *
	mšput_§ve_Ïy”
;

271 
Ïy”_TA
 *
	m¡©e_§ve_Ïy”
;

272 
Ïy”_TA
 *
	mšput_¡©e_Ïy”
;

273 
Ïy”_TA
 *
	m¡©e_¡©e_Ïy”
;

275 
Ïy”_TA
 *
	mšput_z_Ïy”
;

276 
Ïy”_TA
 *
	m¡©e_z_Ïy”
;

278 
Ïy”_TA
 *
	mšput_r_Ïy”
;

279 
Ïy”_TA
 *
	m¡©e_r_Ïy”
;

281 
Ïy”_TA
 *
	mšput_h_Ïy”
;

282 
Ïy”_TA
 *
	m¡©e_h_Ïy”
;

284 
Ïy”_TA
 *
	mwz
;

285 
Ïy”_TA
 *
	muz
;

286 
Ïy”_TA
 *
	mwr
;

287 
Ïy”_TA
 *
	mur
;

288 
Ïy”_TA
 *
	mwh
;

289 
Ïy”_TA
 *
	muh
;

290 
Ïy”_TA
 *
	muo
;

291 
Ïy”_TA
 *
	mwo
;

292 
Ïy”_TA
 *
	muf
;

293 
Ïy”_TA
 *
	mwf
;

294 
Ïy”_TA
 *
	mui
;

295 
Ïy”_TA
 *
	mwi
;

296 
Ïy”_TA
 *
	mug
;

297 
Ïy”_TA
 *
	mwg
;

299 
Œ“_TA
 *
	msoámax_Œ“
;

301 
size_t
 
	mwÜk¥aû_size
;

304 
ä“_Ïy”_TA
(
Ïy”_TA
);

307 
	mCONSTANT_TA
, 
	mSTEP_TA
, 
	mEXP_TA
, 
	mPOLY_TA
, 
	mSTEPS_TA
, 
	mSIG_TA
, 
	mRANDOM_TA


308 } 
	tË¬nšg_¿‹_pŞicy_TA
;

310 
	sÃtwÜk_TA
{

311 
	mn
;

312 
	mb©ch
;

313 
size_t
 *
	m£’
;

314 *
	mt
;

315 
	m•och
;

316 
	msubdivisiÚs
;

317 
Ïy”_TA
 *
	mÏy”s
;

318 *
	mouut
;

319 
Ë¬nšg_¿‹_pŞicy_TA
 
	mpŞicy
;

321 
	mË¬nšg_¿‹
;

322 
	mmom’tum
;

323 
	mdeÿy
;

324 
	mgamma
;

325 
	msÿË
;

326 
	mpow”
;

327 
	mtime_¡•s
;

328 
	m¡•
;

329 
	mmax_b©ches
;

330 *
	msÿËs
;

331 *
	m¡•s
;

332 
	mnum_¡•s
;

333 
	mbuº_š
;

335 
	madam
;

336 
	mB1
;

337 
	mB2
;

338 
	m•s
;

340 
	mšputs
;

341 
	mouuts
;

342 
	mŒuths
;

343 
	mnÙruth
;

344 
	mh
, 
	mw
, 
	mc
;

345 
	mmax_üİ
;

346 
	mmš_üİ
;

347 
	mmax_¿tio
;

348 
	mmš_¿tio
;

349 
	mûÁ”
;

350 
	mªgË
;

351 
	ma¥eù
;

352 
	mexposu»
;

353 
	m§tu¿tiÚ
;

354 
	mhue
;

355 
	m¿ndom
;

357 
	mgpu_šdex
;

358 
Œ“_TA
 *
	mh›¿rchy
;

360 *
	mšput
;

361 *
	mŒuth
;

362 *
	md–
;

363 *
	mwÜk¥aû
;

364 
	mŒaš
;

365 
	mšdex
;

366 *
	mco¡
;

367 
	mş
;

369 } 
	tÃtwÜk_TA
;

	@Enclave/darknetp_ta.h

1 #iâdeà
TA_DARKNETP_H


2 
	#TA_DARKNETP_H


	)

4 
	~"d¬kÃt_TA.h
"

7 *
Ã‰a_Œuth
;

13 
	#TA_DARKNETP_UUID
 \

15 { 0x80, 0xaf, 0xb4, 0x—, 0xb2, 0xf1, 0x99, 0x8d} }

	)

18 
	#MAKE_NETWORK_CMD
 1

	)

19 
	#WORKSPACE_NETWORK_CMD
 2

	)

20 
	#MAKE_CONV_CMD
 3

	)

21 
	#MAKE_MAX_CMD
 4

	)

22 
	#MAKE_DROP_CMD
 5

	)

23 
	#MAKE_CONNECTED_CMD
 6

	)

24 
	#MAKE_SOFTMAX_CMD
 7

	)

25 
	#MAKE_COST_CMD
 8

	)

26 
	#FORWARD_CMD
 9

	)

27 
	#BACKWARD_CMD
 10

	)

28 
	#BACKWARD_ADD_CMD
 11

	)

29 
	#UPDATE_CMD
 12

	)

30 
	#NET_TRUTH_CMD
 13

	)

31 
	#CALC_LOSS_CMD
 14

	)

32 
	#TRANS_WEI_CMD
 15

	)

33 
	#OUTPUT_RETURN_CMD
 16

	)

34 
	#SAVE_WEI_CMD
 17

	)

	@Enclave/gemm_TA.cpp

1 
	~"gemm_TA.h
"

2 
	~"uts_TA.h
"

4 
	~"m©h_TA.h
"

5 
	~"d¬kÃt_TA.h
"

6 
	~"Enşave_t.h
"

8 
	~<¡dlib.h
>

9 
	~<¡dio.h
>

11 
	$gemm_TA
(
TA
, 
TB
, 
M
, 
N
, 
K
, 
ALPHA
,

12 *
A
, 
lda
,

13 *
B
, 
ldb
,

14 
BETA
,

15 *
C
, 
ldc
)

17 
	`gemm_ıu_TA
Ğ
TA
, 
TB
, 
M
, 
N
, 
K
, 
ALPHA
,
A
,
lda
, 
B
, 
ldb
,
BETA
,
C
,
ldc
);

18 
	}
}

20 
	$gemm_Â_TA
(
M
, 
N
, 
K
, 
ALPHA
,

21 *
A
, 
lda
,

22 *
B
, 
ldb
,

23 *
C
, 
ldc
)

25 
i
,
j
,
k
;

26 #´agm¨
omp
 
·¿Î–
 

27 
i
 = 0; i < 
M
; ++i){

28 
i_v®
 = 
i
*
ldc
;

29 
k
 = 0; k < 
K
; ++k){

30 
A_PART
 = 
ALPHA
*
A
[
i
*
lda
+
k
];

31 
k_v®
 = 
k
*
ldb
;

32 
j
 = 0; j < 
N
; ++j){

34 
C
[
i_v®
+
j
] +ğ(
A_PART
*
B
[
k_v®
+j]);

49 
	}
}

51 
	$gemm_Á_TA
(
M
, 
N
, 
K
, 
ALPHA
,

52 *
A
, 
lda
,

53 *
B
, 
ldb
,

54 *
C
, 
ldc
)

64 
i
,
j
,
k
;

65 
i
 = 0; i < 
M
; ++i){

66 
j
 = 0; j < 
N
; ++j){

67 
sum
 = 0;

70 
k
 = 0; k < 
K
; ++k){

75 
sum
 +ğ
ALPHA
*
A
[
i
*
lda
+
k
]*
B
[
j
*
ldb
 + k];

81 
C
[
i
*
ldc
+
j
] +ğ
sum
;

84 
	}
}

86 
	$gemm_Š_TA
(
M
, 
N
, 
K
, 
ALPHA
,

87 *
A
, 
lda
,

88 *
B
, 
ldb
,

89 *
C
, 
ldc
)

91 
i
,
j
,
k
;

92 
i
 = 0; i < 
M
; ++i){

93 
k
 = 0; k < 
K
; ++k){

94 
A_PART
 = 
ALPHA
*
A
[
k
*
lda
+
i
];

95 
j
 = 0; j < 
N
; ++j){

97 
C
[
i
*
ldc
+
j
] +ğ
A_PART
*
B
[
k
*
ldb
+j];

101 
	}
}

103 
	$gemm_‰_TA
(
M
, 
N
, 
K
, 
ALPHA
,

104 *
A
, 
lda
,

105 *
B
, 
ldb
,

106 *
C
, 
ldc
)

108 
i
,
j
,
k
;

109 
i
 = 0; i < 
M
; ++i){

110 
j
 = 0; j < 
N
; ++j){

111 
sum
 = 0;

112 
k
 = 0; k < 
K
; ++k){

113 
sum
 +ğ
ALPHA
*
A
[
i
+
k
*
lda
]*
B
[k+
j
*
ldb
];

115 
C
[
i
*
ldc
+
j
] +ğ
sum
;

118 
	}
}

121 
	$gemm_ıu_TA
(
TA
, 
TB
, 
M
, 
N
, 
K
, 
ALPHA
,

122 *
A
, 
lda
,

123 *
B
, 
ldb
,

124 
BETA
,

125 *
C
, 
ldc
)

128 
i
, 
j
;

129 
i
 = 0; i < 
M
; ++i){

130 
j
 = 0; j < 
N
; ++j){

131 
C
[
i
*
ldc
 + 
j
] *ğ
BETA
;

135 if(!
TA
 && !
TB
)

136 
	`gemm_Â_TA
(
M
, 
N
, 
K
, 
ALPHA
,
A
,
lda
, 
B
, 
ldb
,
C
,
ldc
);

137 if(
TA
 && !
TB
)

138 
	`gemm_Š_TA
(
M
, 
N
, 
K
, 
ALPHA
,
A
,
lda
, 
B
, 
ldb
,
C
,
ldc
);

139 if(!
TA
 && 
TB
)

140 
	`gemm_Á_TA
(
M
, 
N
, 
K
, 
ALPHA
,
A
,
lda
, 
B
, 
ldb
,
C
,
ldc
);

142 
	`gemm_‰_TA
(
M
, 
N
, 
K
, 
ALPHA
,
A
,
lda
, 
B
, 
ldb
,
C
,
ldc
);

143 
	}
}

	@Enclave/gemm_TA.h

1 #iâdeà
GEMM_TA_H


2 
	#GEMM_TA_H


	)

4 
gemm_TA
(
TA
, 
TB
, 
M
, 
N
, 
K
, 
ALPHA
,

5 *
A
, 
lda
,

6 *
B
, 
ldb
,

7 
BETA
,

8 *
C
, 
ldc
);

10 
gemm_ıu_TA
(
TA
, 
TB
, 
M
, 
N
, 
K
, 
ALPHA
,

11 *
A
, 
lda
,

12 *
B
, 
ldb
,

13 
BETA
,

14 *
C
, 
ldc
);

	@Enclave/im2col_TA.cpp

1 
	~"im2cŞ_TA.h
"

2 
	~<¡dio.h
>

3 
	~"Enşave_t.h
"

5 
	$im2cŞ_g‘_pix–_TA
(*
im
, 
height
, 
width
, 
chªÃls
,

6 
row
, 
cŞ
, 
chªÃl
, 
·d
)

8 
row
 -ğ
·d
;

9 
cŞ
 -ğ
·d
;

11 ià(
row
 < 0 || 
cŞ
 < 0 ||

12 
row
 >ğ
height
 || 
cŞ
 >ğ
width
)  0;

13  
im
[
cŞ
 + 
width
*(
row
 + 
height
*
chªÃl
)];

14 
	}
}

18 
	$im2cŞ_ıu_TA
(* 
d©a_im
,

19 
chªÃls
, 
height
, 
width
,

20 
ksize
, 
¡ride
, 
·d
, * 
d©a_cŞ
)

22 
c
,
h
,
w
;

23 
height_cŞ
 = (
height
 + 2*
·d
 - 
ksize
è/ 
¡ride
 + 1;

24 
width_cŞ
 = (
width
 + 2*
·d
 - 
ksize
è/ 
¡ride
 + 1;

26 
chªÃls_cŞ
 = 
chªÃls
 * 
ksize
 * ksize;

27 
c
 = 0; c < 
chªÃls_cŞ
; ++c) {

28 
w_off£t
 = 
c
 % 
ksize
;

29 
h_off£t
 = (
c
 / 
ksize
) % ksize;

30 
c_im
 = 
c
 / 
ksize
 / ksize;

31 
h
 = 0; h < 
height_cŞ
; ++h) {

32 
w
 = 0; w < 
width_cŞ
; ++w) {

33 
im_row
 = 
h_off£t
 + 
h
 * 
¡ride
;

34 
im_cŞ
 = 
w_off£t
 + 
w
 * 
¡ride
;

35 
cŞ_šdex
 = (
c
 * 
height_cŞ
 + 
h
è* 
width_cŞ
 + 
w
;

36 
d©a_cŞ
[
cŞ_šdex
] = 
	`im2cŞ_g‘_pix–_TA
(
d©a_im
, 
height
, 
width
, 
chªÃls
,

37 
im_row
, 
im_cŞ
, 
c_im
, 
·d
);

42 
	}
}

	@Enclave/im2col_TA.h

1 #iâdeà
IM2COL_TA_H


2 
	#IM2COL_TA_H


	)

4 
	~"d¬kÃt_TA.h
"

6 
im2cŞ_ıu_TA
(* 
d©a_im
,

7 
chªÃls
, 
height
, 
width
,

8 
ksize
, 
¡ride
, 
·d
, * 
d©a_cŞ
);

	@Enclave/math_TA.cpp

1 
	~"m©h_TA.h
"

3 
	~<¡d¬g.h
>

4 
	~<¡dio.h
>

5 
	~<¡dlib.h
>

6 
	~<¡dšt.h
>

7 
	~<¡ršg.h
>

8 
	~<m©h.h
>

10 
	$¿nd
(
¡¬t_¿nge
, 
’d_¿nge
)

12 
¿nd_TA
 = 0xACE1;

15 if(
¡¬t_¿nge
 =ğ
’d_¿nge
) {

16  
¡¬t_¿nge
;

20 
¿nd_TA
 += 0x3AD;

21 
¿nd_TA
 %ğ
’d_¿nge
;

24 
¿nd_TA
 < 
¡¬t_¿nge
){

25 
¿nd_TA
 =„ªd_TA + 
’d_¿nge
 - 
¡¬t_¿nge
;

28  
¿nd_TA
;

29 
	}
}

31 
	$_max
(
a
, 
b
)

33 
m
;

34 
m
 = 0;

35 if(
a
 > 
b
){

36 
m
 = 
a
;

39 
m
 = 
b
;

41  
m
;

42 
	}
}

45 
	$_pow
(
a
, 
n
)

47 if(
n
<0è 1/
	`_pow
(
a
,-n);

48 
»s
 = 1.0;

49 
n
)

51 if(
n
&1è
»s
 *ğ
a
;

52 
a
 *=‡;

53 
n
 >>= 1;

55  
»s
;

56 
	}
}

59 
	$_“e
(
x
)

61 if(
x
>1e-3)

63 
“
 = 
	`_“e
(
x
/2);

64  
“
*ee;

67  1 + 
x
 + x*x/2 + 
	`_pow
(x,3)/6 +a_pow(x,4)/24 +a_pow(x,5)/120;

68 
	}
}

71 
	$_exp
(
x
)

73 if(
x
<0è 1/
	`_exp
(-x);

74 
n
 = ()
x
;

75 
x
 -ğ
n
;

76 
e1
 = 
	`_pow
(
e
,
n
);

77 
e2
 = 
	`_“e
(
x
);

78  
e1
*
e2
;

79 
	}
}

82 
	$_¿nd
()

84 
dige¡
[20];

85 
sum¿nd
 = 0;

86 
i
;

88 
i
 =0; i < 20; i++)

90 
dige¡
[
i
] = 
	`¿nd
(0, 
UINT16_MAX
);

92 
i
=0; i<20; i++){

93 
dige¡_št
 = 
dige¡
[
i
];

94 
sum¿nd
 +ğ
dige¡_št
;

96 
¿nd_num
 = (è(
sum¿nd
 % 10000) / 10000;

102  
¿nd_num
;

103 
	}
}

118 
	$_æoÜ
(
x
)

120  (è
x
 - (x< 0);

121 
	}
}

123 
	$_sq¹
(
x
)

125 if(
x
>100è 10.0*
	`_sq¹
(x/100);

126 
t
 = 
x
/8 + 0.5 + 2*x/(4+x);

127 
c
 = 10;

128 
c
--)

130 
t
 = (t+
x
/t)/2;

132  
t
;

133 
	}
}

136 
	$F1
(
x
)

138  1/
x
;

139 
	}
}

141 
	$F2
(
x
)

143  1/
	`_sq¹
(1-
x
*x);

144 
	}
}

146 
	$simpsÚ
(
a
, 
b
,
æag
)

148 
c
 = 
a
 + (
b
-a)/2;

149 if(
æag
==1)

150  (
	`F1
(
a
)+4*F1(
c
)+F1(
b
))*(b-a)/6;

151 if(
æag
==2)

152  (
	`F2
(
a
)+4*F2(
c
)+F2(
b
))*(b-a)/6;

153 
	}
}

155 
	$a¤
(
a
, 
b
, 
•s
, 
A
,
æag
)

157 
c
 = 
a
 + (
b
-a)/2;

158 
L
 = 
	`simpsÚ
(
a
, 
c
,
æag
), 
R
 = simpsÚ(c, 
b
,flag);

159 if(
	`çbs
(
L
+
R
-
A
è<ğ15*
•s
)  L+R+(L+R-A)/15.0;

160  
	`a¤
(
a
, 
c
, 
•s
/2, 
L
,
æag
è+‡¤(c, 
b
,ƒps/2, 
R
,flag);

161 
	}
}

163 
	$a¤0
(
a
, 
b
, 
•s
,
æag
)

165  
	`a¤
(
a
, 
b
, 
•s
, 
	`simpsÚ
×, b,
æag
),flag);

166 
	}
}

168 
	$_Ê
(
x
)

170  
	`a¤0
(1,
x
,1e-8,1);

171 
	}
}

173 
	$_log
(
a
,
N
)

175  
	`_Ê
(
N
)/_Ê(
a
);

176 
	}
}

178 
	$_sš
(
x
)

180 
æ
 = 1;

181 if(
x
>2*
PI
 || x<-2*PI) x -= ()(x/(2*PI))*2*PI;

182 if(
x
>
PI
) x -= 2*PI;

183 if(
x
<-
PI
) x += 2*PI;

184 if(
x
>
PI
/2)

186 
x
 -ğ
PI
;

187 
æ
 *= -1;

189 if(
x
<-
PI
/2)

191 
x
 +ğ
PI
;

192 
æ
 *= -1;

194 if(
x
>
PI
/4è 
	`_cos
(PI/2-x);

195  
æ
*(
x
 - 
	`_pow
(x,3)/6 +a_pow(x,5)/120 -a_pow(x,7)/5040 +a_pow(x,9)/362880);

196 
	}
}

198 
	$_cos
(
x
)

200 
æ
 = 1;

201 if(
x
>2*
PI
 || x<-2*PI) x -= ()(x/(2*PI))*2*PI;

202 if(
x
>
PI
) x -= 2*PI;

203 if(
x
<-
PI
) x += 2*PI;

204 if(
x
>
PI
/2)

206 
x
 -ğ
PI
;

207 
æ
 *= -1;

209 if(
x
<-
PI
/2)

211 
x
 +ğ
PI
;

212 
æ
 *= -1;

214 if(
x
>
PI
/4è 
	`_sš
(PI/2-x);

215  
æ
*(1 - 
	`_pow
(
x
,2)/2 +a_pow(x,4)/24 -a_pow(x,6)/720 +a_pow(x,8)/40320);

216 
	}
}

218 
	$_n
(
x
)

220  
	`_sš
(
x
)/
	`_cos
(x);

221 
	}
}

224 
	$»v”£
(*
¡r
, 
Ën
)

226 
i
=0, 
j
=
Ën
-1, 
‹mp
;

227 
i
<
j
)

229 
‹mp
 = 
¡r
[
i
];

230 
¡r
[
i
] = sŒ[
j
];

231 
¡r
[
j
] = 
‹mp
;

232 
i
++; 
j
--;

234 
	}
}

239 
	$štToSŒ
(
x
, 
¡r
[], 
d
)

241 
i
 = 0;

242 
x
)

244 
¡r
[
i
++] = (
x
%10) + '0';

245 
x
 = x/10;

250 
i
 < 
d
)

251 
¡r
[
i
++] = '0';

253 
	`»v”£
(
¡r
, 
i
);

254 
¡r
[
i
] = '\0';

255  
i
;

256 
	}
}

286 
	$bubbË_sÜt_tİ
(*
¬r
, 
Ën
) {

287 
i
, 
j
;

288 
‹mp
;

291 
i
 = 0; i < 
Ën
 - 1; i++){

292 
j
 = 0; j < 
Ën
 - 1 - 
i
; j++){

293 ià(
¬r
[
j
] <‡rr[j + 1]) {

294 
‹mp
 = 
¬r
[
j
];

295 
¬r
[
j
] =‡rr[j + 1];

296 
¬r
[
j
 + 1] = 
‹mp
;

300 
	}
}

	@Enclave/math_TA.h

1 #iâdeà
TA_MY_TEST_H_MATH


2 
	#TA_MY_TEST_H_MATH


	)

5 
	#PI
 3.14159265358979323846

	)

6 
	#e
 2.7182818284590452354

	)

7 
	#Ê_2
 0.69314718055994530942

	)

8 
	#Ê_10
 2.30258509299404568402

	)

9 
	#fœ¡_aim_mÚey
 1000000000.0f

	)

13 
_max
(
a
, 
b
);

14 
_pow
(
a
,
n
);

15 
_“e
(
x
);

16 
_exp
(
x
);

17 
_¿nd
();

18 
_æoÜ
(
x
);

19 
_sq¹
(
x
);

20 
_Ê
(
x
);

21 
_log
(
a
,
N
);

22 
_sš
(
x
);

23 
_cos
(
x
);

24 
_n
(
x
);

26 
»v”£
(*
¡r
, 
Ën
);

27 
štToSŒ
(
x
, 
¡r
[], 
d
);

29 
bubbË_sÜt_tİ
(*
¬r
, 
Ën
);

31 
¿nd
(
¡¬t_¿nge
, 
’d_¿nge
);

	@Enclave/utils_TA.cpp

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

5 
	~"uts_TA.h
"

6 
	~"m©h_TA.h
"

8 
	$sum_¬¿y_TA
(*
a
, 
n
)

10 
i
;

11 
sum
 = 0;

12 
i
 = 0; i < 
n
; ++iè
sum
 +ğ
a
[i];

14  
sum
;

15 
	}
}

17 
	$¿nd_unifÜm_TA
(
mš
, 
max
)

19 if(
max
 < 
mš
){

20 
sw­
 = 
mš
;

21 
mš
 = 
max
;

22 
max
 = 
sw­
;

24  (()
	`_¿nd
(è* (
max
 - 
mš
)) + min;

25 
	}
}

28 
	$¿nd_nÜm®_TA
(
mu
, 
sigma
){

29 
U1
, 
U2
, 
W
, 
muÉ
;

30 
X1
, 
X2
;

31 
ÿÎ
 = 0;

33 ià(
ÿÎ
 == 1)

35 
ÿÎ
 = !call;

36  (
mu
 + 
sigma
 * (è
X2
);

41 
U1
 = -1 + (è
	`_¿nd
 () * 2;

42 
U2
 = -1 + (è
	`_¿nd
 () * 2;

43 
W
 = 
	`_pow
 (
U1
, 2è+a_pow (
U2
, 2);

45 
W
 >= 1 || W == 0);

47 
muÉ
 = 
	`_sq¹
 ((-2 * 
	`_Ê
 (
W
)) / W);

48 
X1
 = 
U1
 * 
muÉ
;

49 
X2
 = 
U2
 * 
muÉ
;

51 
ÿÎ
 = !call;

53  (
mu
 + 
sigma
 * (è
X1
);

54 
	}
}

	@Enclave/utils_TA.h

1 #iâdeà
UTILS_H_TA


2 
	#UTILS_H_TA


	)

3 
	~<¡dio.h
>

4 
	~"d¬kÃt_TA.h
"

6 
sum_¬¿y_TA
(*
a
, 
n
);

7 
¿nd_unifÜm_TA
(
mš
, 
max
);

8 
¿nd_nÜm®_TA
(
mu
, 
sigma
);

	@/usr/include/arpa/inet.h

18 #iâdeà
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<Ãtš‘/š.h
>

25 #iâdeà
__sockËn_t_defšed


26 
__sockËn_t
 
	tsockËn_t
;

27 
	#__sockËn_t_defšed


	)

30 
__BEGIN_DECLS


34 
š_addr_t
 
	$š‘_addr
 (cÚ¡ *
__ı
è
__THROW
;

37 
š_addr_t
 
	$š‘_Êaof
 (
š_addr
 
__š
è
__THROW
;

41 
š_addr
 
	$š‘_mak—ddr
 (
š_addr_t
 
__Ãt
, in_addr_ˆ
__ho¡
)

42 
__THROW
;

45 
š_addr_t
 
	$š‘_Ãtof
 (
š_addr
 
__š
è
__THROW
;

49 
š_addr_t
 
	$š‘_ÃtwÜk
 (cÚ¡ *
__ı
è
__THROW
;

53 *
	$š‘_Áß
 (
š_addr
 
__š
è
__THROW
;

58 
	$š‘_±Ú
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

59 *
__»¡riù
 
__buf
è
__THROW
;

64 cÚ¡ *
	$š‘_Áİ
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

65 *
__»¡riù
 
__buf
, 
sockËn_t
 
__Ën
)

66 
__THROW
;

70 #ifdeà
__USE_MISC


73 
	$š‘_©Ú
 (cÚ¡ *
__ı
, 
š_addr
 *
__šp
è
__THROW
;

77 *
	$š‘_Ã
 (
š_addr_t
 
__Ãt
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

82 *
	$š‘_Ãt_Áİ
 (
__af
, cÚ¡ *
__ı
, 
__b™s
,

83 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

88 
	$š‘_Ãt_±Ú
 (
__af
, cÚ¡ *
__ı
,

89 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

94 
	$š‘_n§p_addr
 (cÚ¡ *
__ı
,

95 *
__buf
, 
__Ën
è
__THROW
;

99 *
	$š‘_n§p_Áß
 (
__Ën
, cÚ¡ *
__ı
,

100 *
__buf
è
__THROW
;

103 
__END_DECLS


	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


91 #ià
defšed
 
__ılu¥lus


92 
	#as£¹
(
ex´
) \

93 (
¡©ic_ÿ¡
 <
boŞ
> (
ex´
) \

95 : 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

96 #–ià!
defšed
 
__GNUC__
 || defšed 
__STRICT_ANSI__


97 
	#as£¹
(
ex´
) \

98 ((
ex´
) \

99 ? 
	`__ASSERT_VOID_CAST
 (0) \

100 : 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

107 
	#as£¹
(
ex´
) \

108 ((è ((
ex´
è? 1 : 0), 
	`__ex‹nsiÚ__
 ({ \

109 ià(
ex´
) \

112 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
); \

113 
	}
}))

	)

116 #ifdef 
__USE_GNU


117 
	#as£¹_³¼Ü
(
”ºum
) \

118 (!(
”ºum
) \

119 ? 
	`__ASSERT_VOID_CAST
 (0) \

120 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

128 #ià
defšed
 
__ılu¥lus
 ? 
__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

129 
	#__ASSERT_FUNCTION
 
__ex‹nsiÚ__
 
__PRETTY_FUNCTION__


	)

131 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

132 
	#__ASSERT_FUNCTION
 
__func__


	)

134 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

141 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


142 #undeà
¡©ic_as£¹


143 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

108 
__exùy³
 (
i§Êum
);

109 
__exùy³
 (
i§Íha
);

110 
__exùy³
 (
isúŒl
);

111 
__exùy³
 (
isdig™
);

112 
__exùy³
 (
i¦ow”
);

113 
__exùy³
 (
isg¿ph
);

114 
__exùy³
 (
i¥ršt
);

115 
__exùy³
 (
i¥unù
);

116 
__exùy³
 (
is¥aû
);

117 
__exùy³
 (
isuµ”
);

118 
__exùy³
 (
isxdig™
);

122 
	$tŞow”
 (
__c
è
__THROW
;

125 
	$touµ”
 (
__c
è
__THROW
;

129 #ifdef 
__USE_ISOC99


130 
	`__exùy³
 (
isbÏnk
);

133 #ifdeà
__USE_GNU


135 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

138 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


142 
	$i§scii
 (
__c
è
__THROW
;

146 
	$tßscii
 (
__c
è
__THROW
;

150 
	`__exùy³
 (
_touµ”
);

151 
	`__exùy³
 (
_tŞow”
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

156 (
__ex‹nsiÚ__
 \

157 ({ 
__»s
; \

158 ià( (
c
) > 1) \

160 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

166 
__»s
 = 
f
 
¬gs
; \

169 
__»s
 = (
a
)[(è(
c
)]; \

170 
__»s
; 
	}
}))

	)

172 #ià!
defšed
 
__NO_CTYPE


173 #ifdeà
__isùy³_f


174 
	$__isùy³_f
 (
®num
)

175 
	$__isùy³_f
 (
®pha
)

176 
	$__isùy³_f
 (
úŒl
)

177 
	$__isùy³_f
 (
dig™
)

178 
	$__isùy³_f
 (
low”
)

179 
	$__isùy³_f
 (
g¿ph
)

180 
	$__isùy³_f
 (
´št
)

181 
	$__isùy³_f
 (
punù
)

182 
	$__isùy³_f
 (
¥aû
)

183 
	$__isùy³_f
 (
uµ”
)

184 
	$__isùy³_f
 (
xdig™
)

185 #ifdeà
__USE_ISOC99


186 
	$__isùy³_f
 (
bÏnk
)

188 #–ià
defšed
 
__isùy³


189 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

190 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

191 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

192 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

193 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

194 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

195 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

196 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

197 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

198 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

199 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

200 #ifdeà
__USE_ISOC99


201 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

205 #ifdeà
__USE_EXTERN_INLINES


206 
__ex‹º_šlše
 

207 
	`__NTH
 (
	$tŞow”
 (
__c
))

209  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

210 
	}
}

212 
__ex‹º_šlše
 

213 
__NTH
 (
	$touµ”
 (
__c
))

215  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

216 
	}
}

219 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


220 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

221 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

224 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


225 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

226 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

228 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

229 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

235 #ifdeà
__USE_XOPEN2K8


237 
	~<b™s/ty³s/loÿË_t.h
>

241 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

242 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

244 
	#__exùy³_l
(
Çme
) \

245 
	`Çme
 (, 
loÿË_t
è
__THROW


	)

251 
__exùy³_l
 (
i§Êum_l
);

252 
__exùy³_l
 (
i§Íha_l
);

253 
__exùy³_l
 (
isúŒl_l
);

254 
__exùy³_l
 (
isdig™_l
);

255 
__exùy³_l
 (
i¦ow”_l
);

256 
__exùy³_l
 (
isg¿ph_l
);

257 
__exùy³_l
 (
i¥ršt_l
);

258 
__exùy³_l
 (
i¥unù_l
);

259 
__exùy³_l
 (
is¥aû_l
);

260 
__exùy³_l
 (
isuµ”_l
);

261 
__exùy³_l
 (
isxdig™_l
);

263 
__exùy³_l
 (
isbÏnk_l
);

267 
	$__tŞow”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

268 
	$tŞow”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

271 
	$__touµ”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

272 
	$touµ”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

274 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


275 
	#__tŞow”_l
(
c
, 
loÿË
) \

276 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

277 
	#__touµ”_l
(
c
, 
loÿË
) \

278 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

279 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

280 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

284 #iâdeà
__NO_CTYPE


285 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

286 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

287 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

288 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

289 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

290 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

291 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

292 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

293 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

294 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

295 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

297 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

299 #ifdeà
__USE_MISC


300 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

301 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

304 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

305 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

306 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

307 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

308 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

309 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

310 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

311 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

312 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

313 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

314 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

316 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

318 #ifdeà
__USE_MISC


319 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

320 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

327 
__END_DECLS


	@/usr/include/err.h

19 #iâdef 
_ERR_H


20 
	#_ERR_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	#__Ãed___va_li¡


	)

25 
	~<¡d¬g.h
>

26 #iâdef 
__GNUC_VA_LIST


27 
	#__gnuc_va_li¡
 *

	)

30 
__BEGIN_DECLS


34 
	$w¬n
 (cÚ¡ *
__fÜm©
, ...)

35 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 1, 2)));

36 
	$vw¬n
 (cÚ¡ *
__fÜm©
, 
__gnuc_va_li¡
)

37 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 1, 0)));

40 
	$w¬nx
 (cÚ¡ *
__fÜm©
, ...)

41 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 1, 2)));

42 
	$vw¬nx
 (cÚ¡ *
__fÜm©
, 
__gnuc_va_li¡
)

43 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 1, 0)));

46 
	$”r
 (
__¡©us
, cÚ¡ *
__fÜm©
, ...)

47 
	`__©Œibu‹__
 ((
__nÜ‘uº__
, 
	`__fÜm©__
 (
__´štf__
, 2, 3)));

48 
	$v”r
 (
__¡©us
, cÚ¡ *
__fÜm©
, 
__gnuc_va_li¡
)

49 
	`__©Œibu‹__
 ((
__nÜ‘uº__
, 
	`__fÜm©__
 (
__´štf__
, 2, 0)));

50 
	$”rx
 (
__¡©us
, cÚ¡ *
__fÜm©
, ...)

51 
	`__©Œibu‹__
 ((
__nÜ‘uº__
, 
	`__fÜm©__
 (
__´štf__
, 2, 3)));

52 
	$v”rx
 (
__¡©us
, cÚ¡ *, 
__gnuc_va_li¡
)

53 
	`__©Œibu‹__
 ((
__nÜ‘uº__
, 
	`__fÜm©__
 (
__´štf__
, 2, 0)));

55 
__END_DECLS


	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


23 
	#_ERRNO_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/”ºo.h
>

32 #iâdeà
__ASSEMBLER__


34 
__BEGIN_DECLS


37 *
	$__”ºo_loÿtiÚ
 (è
__THROW
 
__©Œibu‹_cÚ¡__
;

38 
	#”ºo
 (*
	`__”ºo_loÿtiÚ
 ())

	)

40 #ifdeà
__USE_GNU


45 *
´og¿m_švoÿtiÚ_Çme
;

46 *
´og¿m_švoÿtiÚ_shÜt_Çme
;

50 #iâdeà
__”rÜ_t_defšed


51 
	#__”rÜ_t_defšed
 1

	)

52 
	t”rÜ_t
;

57 
__END_DECLS


	@/usr/include/limits.h

22 #iâdeà
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

32 
	#MB_LEN_MAX
 16

	)

37 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

42 #iâdeà
_LIMITS_H


43 
	#_LIMITS_H
 1

	)

45 
	~<b™s/wÜdsize.h
>

54 
	#CHAR_BIT
 8

	)

57 
	#SCHAR_MIN
 (-128)

	)

58 
	#SCHAR_MAX
 127

	)

61 
	#UCHAR_MAX
 255

	)

64 #ifdeà
__CHAR_UNSIGNED__


65 
	#CHAR_MIN
 0

	)

66 
	#CHAR_MAX
 
UCHAR_MAX


	)

68 
	#CHAR_MIN
 
SCHAR_MIN


	)

69 
	#CHAR_MAX
 
SCHAR_MAX


	)

73 
	#SHRT_MIN
 (-32768)

	)

74 
	#SHRT_MAX
 32767

	)

77 
	#USHRT_MAX
 65535

	)

80 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

81 
	#INT_MAX
 2147483647

	)

84 
	#UINT_MAX
 4294967295U

	)

87 #ià
__WORDSIZE
 == 64

88 
	#LONG_MAX
 9223372036854775807L

	)

90 
	#LONG_MAX
 2147483647L

	)

92 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

95 #ià
__WORDSIZE
 == 64

96 
	#ULONG_MAX
 18446744073709551615UL

	)

98 
	#ULONG_MAX
 4294967295UL

	)

101 #ifdeà
__USE_ISOC99


104 
	#LLONG_MAX
 9223372036854775807LL

	)

105 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

108 
	#ULLONG_MAX
 18446744073709551615ULL

	)

122 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


124 #šşude_Ãxˆ<
lim™s
.
h
>

130 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


131 #iâdeà
LLONG_MIN


132 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

134 #iâdeà
LLONG_MAX


135 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

137 #iâdeà
ULLONG_MAX


138 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

145 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

146 #iâdeà
CHAR_WIDTH


147 
	#CHAR_WIDTH
 8

	)

149 #iâdeà
SCHAR_WIDTH


150 
	#SCHAR_WIDTH
 8

	)

152 #iâdeà
UCHAR_WIDTH


153 
	#UCHAR_WIDTH
 8

	)

155 #iâdeà
SHRT_WIDTH


156 
	#SHRT_WIDTH
 16

	)

158 #iâdeà
USHRT_WIDTH


159 
	#USHRT_WIDTH
 16

	)

161 #iâdeà
INT_WIDTH


162 
	#INT_WIDTH
 32

	)

164 #iâdeà
UINT_WIDTH


165 
	#UINT_WIDTH
 32

	)

167 #iâdeà
LONG_WIDTH


168 
	#LONG_WIDTH
 
__WORDSIZE


	)

170 #iâdeà
ULONG_WIDTH


171 
	#ULONG_WIDTH
 
__WORDSIZE


	)

173 #iâdeà
LLONG_WIDTH


174 
	#LLONG_WIDTH
 64

	)

176 #iâdeà
ULLONG_WIDTH


177 
	#ULLONG_WIDTH
 64

	)

181 #ifdef 
__USE_POSIX


183 
	~<b™s/posix1_lim.h
>

186 #ifdef 
__USE_POSIX2


187 
	~<b™s/posix2_lim.h
>

190 #ifdef 
__USE_XOPEN


191 
	~<b™s/xİ’_lim.h
>

	@/usr/include/math.h

23 #iâdef 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

29 #ià
defšed
 
log
 && defšed 
__GNUC__


30 #w¬nšg 
A
 
maüo
 
ÿÎed
 
log
 
was
 
®»ady
 
defšed
 
wh’
 <
m©h
.
h
> wa 
šşuded
.

31 #w¬nšg 
This
 
wl
 
ÿu£
 
comp©iÚ
 
´obËms
.

34 
	g__BEGIN_DECLS


37 
	~<b™s/ty³s.h
>

40 
	~<b™s/m©h-veùÜ.h
>

43 
	~<b™s/æßŠ.h
>

47 #ià
__GNUC_PREREQ
 (3, 3)

48 
	#HUGE_VAL
 (
	`__butš_huge_v®
 ())

	)

55 
	#HUGE_VAL
 1e10000

	)

57 #ifdeà
__USE_ISOC99


58 #ià
__GNUC_PREREQ
 (3, 3)

59 
	#HUGE_VALF
 (
	`__butš_huge_v®f
 ())

	)

60 
	#HUGE_VALL
 (
	`__butš_huge_v®l
 ())

	)

62 
	#HUGE_VALF
 1e10000f

	)

63 
	#HUGE_VALL
 1e10000L

	)

66 #ià
__HAVE_FLOAT16
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

67 
	#HUGE_VAL_F16
 (
	`__butš_huge_v®f16
 ())

	)

69 #ià
__HAVE_FLOAT32
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

70 
	#HUGE_VAL_F32
 (
	`__butš_huge_v®f32
 ())

	)

72 #ià
__HAVE_FLOAT64
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

73 
	#HUGE_VAL_F64
 (
	`__butš_huge_v®f64
 ())

	)

75 #ià
__HAVE_FLOAT128
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

76 
	#HUGE_VAL_F128
 (
	`__butš_huge_v®f128
 ())

	)

78 #ià
__HAVE_FLOAT32X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

79 
	#HUGE_VAL_F32X
 (
	`__butš_huge_v®f32x
 ())

	)

81 #ià
__HAVE_FLOAT64X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

82 
	#HUGE_VAL_F64X
 (
	`__butš_huge_v®f64x
 ())

	)

84 #ià
__HAVE_FLOAT128X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

85 
	#HUGE_VAL_F128X
 (
	`__butš_huge_v®f128x
 ())

	)

88 #ifdeà
__USE_ISOC99


90 #ià
__GNUC_PREREQ
 (3, 3)

91 
	#INFINITY
 (
	`__butš_šff
 ())

	)

93 
	#INFINITY
 
HUGE_VALF


	)

97 #ià
__GNUC_PREREQ
 (3, 3)

98 
	#NAN
 (
	`__butš_Çnf
 (""))

	)

103 
	#NAN
 (0.0à/ 0.0f)

	)

107 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

109 #ià
__GNUC_PREREQ
 (3, 3)

110 
	#SNANF
 (
	`__butš_Çnsf
 (""))

	)

111 
	#SNAN
 (
	`__butš_Çns
 (""))

	)

112 
	#SNANL
 (
	`__butš_Çn¦
 (""))

	)

115 #ià
__HAVE_FLOAT16
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

116 
	#SNANF16
 (
	`__butš_Çnsf16
 (""))

	)

118 #ià
__HAVE_FLOAT32
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

119 
	#SNANF32
 (
	`__butš_Çnsf32
 (""))

	)

121 #ià
__HAVE_FLOAT64
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

122 
	#SNANF64
 (
	`__butš_Çnsf64
 (""))

	)

124 #ià
__HAVE_FLOAT128
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

125 
	#SNANF128
 (
	`__butš_Çnsf128
 (""))

	)

127 #ià
__HAVE_FLOAT32X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

128 
	#SNANF32X
 (
	`__butš_Çnsf32x
 (""))

	)

130 #ià
__HAVE_FLOAT64X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

131 
	#SNANF64X
 (
	`__butš_Çnsf64x
 (""))

	)

133 #ià
__HAVE_FLOAT128X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
	#SNANF128X
 (
	`__butš_Çnsf128x
 (""))

	)

138 
	~<b™s/æt-ev®-m‘hod.h
>

140 #ifdeà
__USE_ISOC99


148 #ià
__GLIBC_FLT_EVAL_METHOD
 == 0 || __GLIBC_FLT_EVAL_METHOD == 16

149 
	tæßt_t
;

150 
	tdoubË_t
;

151 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 1

152 
	tæßt_t
;

153 
	tdoubË_t
;

154 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 2

155 
	tæßt_t
;

156 
	tdoubË_t
;

157 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 32

158 
_Flßt32
 
	tæßt_t
;

159 
	tdoubË_t
;

160 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 33

161 
_Flßt32x
 
	tæßt_t
;

162 
_Flßt32x
 
	tdoubË_t
;

163 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 64

164 
_Flßt64
 
	tæßt_t
;

165 
_Flßt64
 
	tdoubË_t
;

166 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 65

167 
_Flßt64x
 
	tæßt_t
;

168 
_Flßt64x
 
	tdoubË_t
;

169 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 128

170 
_Flßt128
 
	tæßt_t
;

171 
_Flßt128
 
	tdoubË_t
;

172 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 129

173 
_Flßt128x
 
	tæßt_t
;

174 
_Flßt128x
 
	tdoubË_t
;

190 
	~<b™s/å-logb.h
>

191 #ifdeà
__USE_ISOC99


192 #ià
__FP_LOGB0_IS_MIN


193 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

195 
	#FP_ILOGB0
 (-2147483647)

	)

197 #ià
__FP_LOGBNAN_IS_MIN


198 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

200 
	#FP_ILOGBNAN
 2147483647

	)

203 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

204 #ià
__WORDSIZE
 == 32

205 
	#__FP_LONG_MAX
 0x7fffffffL

	)

207 
	#__FP_LONG_MAX
 0x7fffffffffffffffL

	)

209 #ià
__FP_LOGB0_IS_MIN


210 
	#FP_LLOGB0
 (-
__FP_LONG_MAX
 - 1)

	)

212 
	#FP_LLOGB0
 (-
__FP_LONG_MAX
)

	)

214 #ià
__FP_LOGBNAN_IS_MIN


215 
	#FP_LLOGBNAN
 (-
__FP_LONG_MAX
 - 1)

	)

217 
	#FP_LLOGBNAN
 
__FP_LONG_MAX


	)

233 
	~<b™s/å-ç¡.h
>

235 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

239 
	mFP_INT_UPWARD
 =

240 
	#FP_INT_UPWARD
 0

	)

241 
FP_INT_UPWARD
,

242 
	mFP_INT_DOWNWARD
 =

243 
	#FP_INT_DOWNWARD
 1

	)

244 
FP_INT_DOWNWARD
,

245 
	mFP_INT_TOWARDZERO
 =

246 
	#FP_INT_TOWARDZERO
 2

	)

247 
FP_INT_TOWARDZERO
,

248 
	mFP_INT_TONEARESTFROMZERO
 =

249 
	#FP_INT_TONEARESTFROMZERO
 3

	)

250 
FP_INT_TONEARESTFROMZERO
,

251 
	mFP_INT_TONEAREST
 =

252 
	#FP_INT_TONEAREST
 4

	)

253 
FP_INT_TONEAREST
,

262 
	#__SIMD_DECL
(
funùiÚ
è
	`__CONCAT
 (
__DECL_SIMD_
, funùiÚ)

	)

264 
	#__MATHCALL_VEC
(
funùiÚ
, 
suffix
, 
¬gs
) \

265 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
funùiÚ
, 
suffix
)) \

266 
	`__MATHCALL
 (
funùiÚ
, 
suffix
, 
¬gs
)

	)

268 
	#__MATHDECL_VEC
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

269 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
funùiÚ
, 
suffix
)) \

270 
	`__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
)

	)

272 
	#__MATHCALL
(
funùiÚ
,
suffix
, 
¬gs
) \

273 
	`__MATHDECL
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
)

	)

274 
	#__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

275 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
); \

276 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
)

	)

277 
	#__MATHCALLX
(
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

278 
	`__MATHDECLX
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
)

	)

279 
	#__MATHDECLX
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

280 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
); \

281 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
)

	)

282 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

283 
ty³
 
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
è
¬gs
 
__THROW


	)

285 
	#_MdoubË_
 

	)

286 
	#__MATH_PRECNAME
(
Çme
,
r
è
	`__CONCAT
Òame,r)

	)

287 
	#__MATH_DECLARING_DOUBLE
 1

	)

288 
	#__MATH_DECLARING_FLOATN
 0

	)

289 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

290 
	~<b™s/m©hÿÎs.h
>

291 #undeà
_MdoubË_


292 #undeà
__MATH_PRECNAME


293 #undeà
__MATH_DECLARING_DOUBLE


294 #undeà
__MATH_DECLARING_FLOATN


296 #ifdeà
__USE_ISOC99


302 
	#_MdoubË_
 

	)

303 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f
##
	)
r

304 
	#__MATH_DECLARING_DOUBLE
 0

	)

305 
	#__MATH_DECLARING_FLOATN
 0

	)

306 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

307 
	~<b™s/m©hÿÎs.h
>

308 #undeà
_MdoubË_


309 #undeà
__MATH_PRECNAME


310 #undeà
__MATH_DECLARING_DOUBLE


311 #undeà
__MATH_DECLARING_FLOATN


313 #ià!(
defšed
 
__NO_LONG_DOUBLE_MATH
 && defšed 
_LIBC
) \

314 || 
defšed
 
__LDBL_COMPAT
 \

315 || 
defšed
 
_LIBC_TEST


316 #ifdeà
__LDBL_COMPAT


318 #ifdeà
__USE_ISOC99


319 
	$__Ædbl_Ãx‰ow¬df
 (
__x
, 
__y
)

320 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

321 #ifdeà
__REDIRECT_NTH


322 
	`__REDIRECT_NTH
 (
Ãx‰ow¬df
, (
__x
, 
__y
),

323 
__Ædbl_Ãx‰ow¬df
)

324 
	`__©Œibu‹__
 ((
__cÚ¡__
));

325 
	`__REDIRECT_NTH
 (
Ãx‰ow¬d
, (
__x
, 
__y
),

326 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

327 
	`__REDIRECT_NTH
 (
Ãx‰ow¬dl
,

328 (
__x
, 
__y
),

329 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

333 #undeà
__MATHDECL_1


334 
	#__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
®Ÿs
) \

335 
ty³
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
), \

336 
¬gs
, 
®Ÿs
)

	)

337 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

338 
	`__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
	`__CONCAT
(funùiÚ,suffix))

	)

344 
	#_MdoubË_
 

	)

345 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
l
##
	)
r

346 
	#__MATH_DECLARING_DOUBLE
 0

	)

347 
	#__MATH_DECLARING_FLOATN
 0

	)

348 
	#__MATH_DECLARE_LDOUBLE
 1

	)

349 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

350 
	~<b™s/m©hÿÎs.h
>

351 #undeà
_MdoubË_


352 #undeà
__MATH_PRECNAME


353 #undeà
__MATH_DECLARING_DOUBLE


354 #undeà
__MATH_DECLARING_FLOATN


363 #ià
__HAVE_DISTINCT_FLOAT16
 || (
__HAVE_FLOAT16
 && !
defšed
 
_LIBC
)

364 
	#_MdoubË_
 
_Flßt16


	)

365 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f16
##
	)
r

366 
	#__MATH_DECLARING_DOUBLE
 0

	)

367 
	#__MATH_DECLARING_FLOATN
 1

	)

368 #ià
__HAVE_DISTINCT_FLOAT16


369 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

371 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

372 
	~<b™s/m©hÿÎs.h
>

374 #undeà
_MdoubË_


375 #undeà
__MATH_PRECNAME


376 #undeà
__MATH_DECLARING_DOUBLE


377 #undeà
__MATH_DECLARING_FLOATN


380 #ià
__HAVE_DISTINCT_FLOAT32
 || (
__HAVE_FLOAT32
 && !
defšed
 
_LIBC
)

381 
	#_MdoubË_
 
_Flßt32


	)

382 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f32
##
	)
r

383 
	#__MATH_DECLARING_DOUBLE
 0

	)

384 
	#__MATH_DECLARING_FLOATN
 1

	)

385 #ià
__HAVE_DISTINCT_FLOAT32


386 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

388 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

389 
	~<b™s/m©hÿÎs.h
>

391 #undeà
_MdoubË_


392 #undeà
__MATH_PRECNAME


393 #undeà
__MATH_DECLARING_DOUBLE


394 #undeà
__MATH_DECLARING_FLOATN


397 #ià
__HAVE_DISTINCT_FLOAT64
 || (
__HAVE_FLOAT64
 && !
defšed
 
_LIBC
)

398 
	#_MdoubË_
 
_Flßt64


	)

399 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f64
##
	)
r

400 
	#__MATH_DECLARING_DOUBLE
 0

	)

401 
	#__MATH_DECLARING_FLOATN
 1

	)

402 #ià
__HAVE_DISTINCT_FLOAT64


403 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

405 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

406 
	~<b™s/m©hÿÎs.h
>

408 #undeà
_MdoubË_


409 #undeà
__MATH_PRECNAME


410 #undeà
__MATH_DECLARING_DOUBLE


411 #undeà
__MATH_DECLARING_FLOATN


414 #ià
__HAVE_DISTINCT_FLOAT128
 || (
__HAVE_FLOAT128
 && !
defšed
 
_LIBC
)

415 
	#_MdoubË_
 
_Flßt128


	)

416 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f128
##
	)
r

417 
	#__MATH_DECLARING_DOUBLE
 0

	)

418 
	#__MATH_DECLARING_FLOATN
 1

	)

419 #ià
__HAVE_DISTINCT_FLOAT128


420 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

422 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

423 
	~<b™s/m©hÿÎs.h
>

425 #undeà
_MdoubË_


426 #undeà
__MATH_PRECNAME


427 #undeà
__MATH_DECLARING_DOUBLE


428 #undeà
__MATH_DECLARING_FLOATN


431 #ià
__HAVE_DISTINCT_FLOAT32X
 || (
__HAVE_FLOAT32X
 && !
defšed
 
_LIBC
)

432 
	#_MdoubË_
 
_Flßt32x


	)

433 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f32x
##
	)
r

434 
	#__MATH_DECLARING_DOUBLE
 0

	)

435 
	#__MATH_DECLARING_FLOATN
 1

	)

436 #ià
__HAVE_DISTINCT_FLOAT32X


437 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

439 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

440 
	~<b™s/m©hÿÎs.h
>

442 #undeà
_MdoubË_


443 #undeà
__MATH_PRECNAME


444 #undeà
__MATH_DECLARING_DOUBLE


445 #undeà
__MATH_DECLARING_FLOATN


448 #ià
__HAVE_DISTINCT_FLOAT64X
 || (
__HAVE_FLOAT64X
 && !
defšed
 
_LIBC
)

449 
	#_MdoubË_
 
_Flßt64x


	)

450 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f64x
##
	)
r

451 
	#__MATH_DECLARING_DOUBLE
 0

	)

452 
	#__MATH_DECLARING_FLOATN
 1

	)

453 #ià
__HAVE_DISTINCT_FLOAT64X


454 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

456 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

457 
	~<b™s/m©hÿÎs.h
>

459 #undeà
_MdoubË_


460 #undeà
__MATH_PRECNAME


461 #undeà
__MATH_DECLARING_DOUBLE


462 #undeà
__MATH_DECLARING_FLOATN


465 #ià
__HAVE_DISTINCT_FLOAT128X
 || (
__HAVE_FLOAT128X
 && !
defšed
 
_LIBC
)

466 
	#_MdoubË_
 
_Flßt128x


	)

467 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f128x
##
	)
r

468 
	#__MATH_DECLARING_DOUBLE
 0

	)

469 
	#__MATH_DECLARING_FLOATN
 1

	)

470 #ià
__HAVE_DISTINCT_FLOAT128X


471 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

473 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

474 
	~<b™s/m©hÿÎs.h
>

476 #undeà
_MdoubË_


477 #undeà
__MATH_PRECNAME


478 #undeà
__MATH_DECLARING_DOUBLE


479 #undeà
__MATH_DECLARING_FLOATN


482 #undeà
__MATHDECL_1


483 #undeà
__MATHDECL


484 #undeà
__MATHCALL


487 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


489 
signgam
;

492 #ià(
__HAVE_DISTINCT_FLOAT16
 \

493 || 
__HAVE_DISTINCT_FLOAT32
 \

494 || 
__HAVE_DISTINCT_FLOAT64
 \

495 || 
__HAVE_DISTINCT_FLOAT32X
 \

496 || 
__HAVE_DISTINCT_FLOAT64X
 \

497 || 
__HAVE_DISTINCT_FLOAT128X
)

510 #ifdeà
__NO_LONG_DOUBLE_MATH


511 #ià
__HAVE_DISTINCT_FLOAT128


514 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

515 ( (
TG_ARG
è=ğ (è? 
FUNC
 ## 
f
 
ARGS
 : FUNC ARGS)

	)

516 #–ià
__HAVE_DISTINCT_FLOAT128


517 #ià
__HAVE_GENERIC_SELECTION


518 #ià
__HAVE_FLOATN_NOT_TYPEDEF
 && 
__HAVE_FLOAT32


519 
	#__MATH_TG_F32
(
FUNC
, 
ARGS
è
_Flßt32
: FUNC ## 
f
 ARGS,

	)

521 
	#__MATH_TG_F32
(
FUNC
, 
ARGS
)

	)

523 #ià
__HAVE_FLOATN_NOT_TYPEDEF
 && 
__HAVE_FLOAT64X


524 #ià
__HAVE_FLOAT64X_LONG_DOUBLE


525 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
è
_Flßt64x
: FUNC ## 
l
 ARGS,

	)

527 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
è
_Flßt64x
: FUNC ## 
f128
 ARGS,

	)

530 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
)

	)

532 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

533 
	`_G’”ic
 ((
TG_ARG
), \

534 : 
FUNC
 ## 
f
 
ARGS
, \

535 
	`__MATH_TG_F32
 (
FUNC
, 
ARGS
) \

536 : 
FUNC
 
ARGS
, \

537 : 
FUNC
 ## 
l
 
ARGS
, \

538 
	`__MATH_TG_F64X
 (
FUNC
, 
ARGS
) \

539 
_Flßt128
: 
FUNC
 ## 
f128
 
ARGS
)

	)

541 #ià
__HAVE_FLOATN_NOT_TYPEDEF


544 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

545 
__butš_choo£_ex´
 \

546 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

547 
FUNC
 ## 
f
 
ARGS
, \

548 
__butš_choo£_ex´
 \

549 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

550 
FUNC
 
ARGS
, \

551 
__butš_choo£_ex´
 \

552 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

553 
FUNC
 ## 
l
 
ARGS
, \

554 
FUNC
 ## 
f128
 
ARGS
)))

	)

557 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

558 ( (
TG_ARG
) ==  () \

559 ? 
FUNC
 ## 
f
 
ARGS
 \

560 :  (
TG_ARG
) ==  () \

561 ? 
FUNC
 
ARGS
 \

562 : 
FUNC
 ## 
l
 
ARGS
)

	)

566 #ifdeà
__USE_ISOC99


571 
FP_NAN
 =

572 
	#FP_NAN
 0

	)

573 
FP_NAN
,

574 
FP_INFINITE
 =

575 
	#FP_INFINITE
 1

	)

576 
FP_INFINITE
,

577 
FP_ZERO
 =

578 
	#FP_ZERO
 2

	)

579 
FP_ZERO
,

580 
FP_SUBNORMAL
 =

581 
	#FP_SUBNORMAL
 3

	)

582 
FP_SUBNORMAL
,

583 
FP_NORMAL
 =

584 
	#FP_NORMAL
 4

	)

585 
FP_NORMAL


593 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__
 \

594 && (!
defšed
 
__OPTIMIZE_SIZE__
 || defšed 
__ılu¥lus
)

601 
	#åşassify
(
x
è
	`__butš_åşassify
 (
FP_NAN
, 
FP_INFINITE
, \

602 
FP_NORMAL
, 
FP_SUBNORMAL
, 
FP_ZERO
, 
x
)

	)

604 
	#åşassify
(
x
è
	`__MATH_TG
 ((x), 
__åşassify
, (x))

	)

608 #ià
	`__GNUC_PREREQ
 (6,0)

609 
	#signb™
(
x
è
	`__butš_signb™
 (x)

	)

610 #–ià
defšed
 
__ılu¥lus


618 
	#signb™
(
x
è
	`__butš_signb™l
 (x)

	)

619 #–ià
	`__GNUC_PREREQ
 (4,0)

620 
	#signb™
(
x
è
	`__MATH_TG
 ((x), 
__butš_signb™
, (x))

	)

622 
	#signb™
(
x
è
	`__MATH_TG
 ((x), 
__signb™
, (x))

	)

626 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


627 
	#isfš™e
(
x
è
	`__butš_isfš™e
 (x)

	)

629 
	#isfš™e
(
x
è
	`__MATH_TG
 ((x), 
__fš™e
, (x))

	)

633 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


634 
	#i¢Üm®
(
x
è
	`__butš_i¢Üm®
 (x)

	)

636 
	#i¢Üm®
(
x
è(
	`åşassify
 (xè=ğ
FP_NORMAL
)

	)

641 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


642 
	#i¢ª
(
x
è
	`__butš_i¢ª
 (x)

	)

644 
	#i¢ª
(
x
è
	`__MATH_TG
 ((x), 
__i¢ª
, (x))

	)

648 #ià
__HAVE_DISTINCT_FLOAT128
 && !
	`__GNUC_PREREQ
 (7,0) \

649 && !
defšed
 
__SUPPORT_SNAN__
 && !defšed 
__ılu¥lus


655 
	#isšf
(
x
) \

656 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
x
), 
_Flßt128
) \

657 ? 
	`__isšff128
 (
x
è: 
	`__butš_isšf_sign
 (x))

	)

658 #–ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


659 
	#isšf
(
x
è
	`__butš_isšf_sign
 (x)

	)

661 
	#isšf
(
x
è
	`__MATH_TG
 ((x), 
__isšf
, (x))

	)

665 
	#MATH_ERRNO
 1

	)

666 
	#MATH_ERREXCEPT
 2

	)

673 #ifdeà
__FAST_MATH__


674 
	#m©h_”rhªdlšg
 0

	)

675 #–ià
defšed
 
__NO_MATH_ERRNO__


676 
	#m©h_”rhªdlšg
 (
MATH_ERREXCEPT
)

	)

678 
	#m©h_”rhªdlšg
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

683 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

684 
	~<b™s/isÿnÚiÿl.h
>

687 #iâdeà
__ılu¥lus


688 
	#issigÇlšg
(
x
è
	`__MATH_TG
 ((x), 
__issigÇlšg
, (x))

	)

697 
šlše
 
	`issigÇlšg
 (
__v®
è{  
	`__issigÇlšgf
 (__val); }

698 
šlše
 
	`issigÇlšg
 (
__v®
è{  
	`__issigÇlšg
 (__val); }

699 
šlše
 

700 
	`issigÇlšg
 (
__v®
)

702 #ifdeà
__NO_LONG_DOUBLE_MATH


703  
	`__issigÇlšg
 (
__v®
);

705  
	`__issigÇlšgl
 (
__v®
);

708 #ià
__HAVE_DISTINCT_FLOAT128


709 
šlše
 
	`issigÇlšg
 (
_Flßt128
 
__v®
è{  
	`__issigÇlšgf128
 (__val); }

711 
	}
}

715 
	#issubnÜm®
(
x
è(
	`åşassify
 (xè=ğ
FP_SUBNORMAL
)

	)

718 #iâdeà
__ılu¥lus


719 #ifdeà
__SUPPORT_SNAN__


720 
	#isz”o
(
x
è(
	`åşassify
 (xè=ğ
FP_ZERO
)

	)

722 
	#isz”o
(
x
è(((
	`__ty³of
 (x)è(x)è=ğ0)

	)

726 #ifdeà
__SUPPORT_SNAN__


727 
šlše
 

728 
isz”o
 (
__v®
)

730  
__åşassifyf
 (
__v®
è=ğ
FP_ZERO
;

732 
šlše
 

733 
isz”o
 (
__v®
)

735  
__åşassify
 (
__v®
è=ğ
FP_ZERO
;

737 
šlše
 

738 
isz”o
 (
__v®
)

740 #ifdeà
__NO_LONG_DOUBLE_MATH


741  
__åşassify
 (
__v®
è=ğ
FP_ZERO
;

743  
__åşassifyl
 (
__v®
è=ğ
FP_ZERO
;

746 #ià
__HAVE_DISTINCT_FLOAT128


747 
šlše
 

748 
isz”o
 (
_Flßt128
 
__v®
)

750  
__åşassifyf128
 (
__v®
è=ğ
FP_ZERO
;

754 
‹m¶©e
 <
şass
 
__T
> 
šlše
 
boŞ


755 
isz”o
 (
__T
 
__v®
)

757  
__v®
 == 0;

764 #ifdeà
__USE_XOPEN


766 
	#MAXFLOAT
 3.40282347e+38F

	)

771 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


772 
	#M_E
 2.7182818284590452354

	)

773 
	#M_LOG2E
 1.4426950408889634074

	)

774 
	#M_LOG10E
 0.43429448190325182765

	)

775 
	#M_LN2
 0.69314718055994530942

	)

776 
	#M_LN10
 2.30258509299404568402

	)

777 
	#M_PI
 3.14159265358979323846

	)

778 
	#M_PI_2
 1.57079632679489661923

	)

779 
	#M_PI_4
 0.78539816339744830962

	)

780 
	#M_1_PI
 0.31830988618379067154

	)

781 
	#M_2_PI
 0.63661977236758134308

	)

782 
	#M_2_SQRTPI
 1.12837916709551257390

	)

783 
	#M_SQRT2
 1.41421356237309504880

	)

784 
	#M_SQRT1_2
 0.70710678118654752440

	)

790 #ifdeà
__USE_GNU


791 
	#M_El
 2.718281828459045235360287471352662498L

	)

792 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

793 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

794 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

795 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

796 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

797 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

798 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

799 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

800 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

801 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

802 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

803 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

806 #ià
__HAVE_FLOAT16
 && 
defšed
 
__USE_GNU


807 
	#M_Ef16
 
	`__f16
 (2.718281828459045235360287471352662498è

	)

808 
	#M_LOG2Ef16
 
	`__f16
 (1.442695040888963407359924681001892137è

	)

809 
	#M_LOG10Ef16
 
	`__f16
 (0.434294481903251827651128918916605082è

	)

810 
	#M_LN2f16
 
	`__f16
 (0.693147180559945309417232121458176568è

	)

811 
	#M_LN10f16
 
	`__f16
 (2.302585092994045684017991454684364208è

	)

812 
	#M_PIf16
 
	`__f16
 (3.141592653589793238462643383279502884è

	)

813 
	#M_PI_2f16
 
	`__f16
 (1.570796326794896619231321691639751442è

	)

814 
	#M_PI_4f16
 
	`__f16
 (0.785398163397448309615660845819875721è

	)

815 
	#M_1_PIf16
 
	`__f16
 (0.318309886183790671537767526745028724è

	)

816 
	#M_2_PIf16
 
	`__f16
 (0.636619772367581343075535053490057448è

	)

817 
	#M_2_SQRTPIf16
 
	`__f16
 (1.128379167095512573896158903121545172è

	)

818 
	#M_SQRT2f16
 
	`__f16
 (1.414213562373095048801688724209698079è

	)

819 
	#M_SQRT1_2f16
 
	`__f16
 (0.707106781186547524400844362104849039è

	)

822 #ià
__HAVE_FLOAT32
 && 
defšed
 
__USE_GNU


823 
	#M_Ef32
 
	`__f32
 (2.718281828459045235360287471352662498è

	)

824 
	#M_LOG2Ef32
 
	`__f32
 (1.442695040888963407359924681001892137è

	)

825 
	#M_LOG10Ef32
 
	`__f32
 (0.434294481903251827651128918916605082è

	)

826 
	#M_LN2f32
 
	`__f32
 (0.693147180559945309417232121458176568è

	)

827 
	#M_LN10f32
 
	`__f32
 (2.302585092994045684017991454684364208è

	)

828 
	#M_PIf32
 
	`__f32
 (3.141592653589793238462643383279502884è

	)

829 
	#M_PI_2f32
 
	`__f32
 (1.570796326794896619231321691639751442è

	)

830 
	#M_PI_4f32
 
	`__f32
 (0.785398163397448309615660845819875721è

	)

831 
	#M_1_PIf32
 
	`__f32
 (0.318309886183790671537767526745028724è

	)

832 
	#M_2_PIf32
 
	`__f32
 (0.636619772367581343075535053490057448è

	)

833 
	#M_2_SQRTPIf32
 
	`__f32
 (1.128379167095512573896158903121545172è

	)

834 
	#M_SQRT2f32
 
	`__f32
 (1.414213562373095048801688724209698079è

	)

835 
	#M_SQRT1_2f32
 
	`__f32
 (0.707106781186547524400844362104849039è

	)

838 #ià
__HAVE_FLOAT64
 && 
defšed
 
__USE_GNU


839 
	#M_Ef64
 
	`__f64
 (2.718281828459045235360287471352662498è

	)

840 
	#M_LOG2Ef64
 
	`__f64
 (1.442695040888963407359924681001892137è

	)

841 
	#M_LOG10Ef64
 
	`__f64
 (0.434294481903251827651128918916605082è

	)

842 
	#M_LN2f64
 
	`__f64
 (0.693147180559945309417232121458176568è

	)

843 
	#M_LN10f64
 
	`__f64
 (2.302585092994045684017991454684364208è

	)

844 
	#M_PIf64
 
	`__f64
 (3.141592653589793238462643383279502884è

	)

845 
	#M_PI_2f64
 
	`__f64
 (1.570796326794896619231321691639751442è

	)

846 
	#M_PI_4f64
 
	`__f64
 (0.785398163397448309615660845819875721è

	)

847 
	#M_1_PIf64
 
	`__f64
 (0.318309886183790671537767526745028724è

	)

848 
	#M_2_PIf64
 
	`__f64
 (0.636619772367581343075535053490057448è

	)

849 
	#M_2_SQRTPIf64
 
	`__f64
 (1.128379167095512573896158903121545172è

	)

850 
	#M_SQRT2f64
 
	`__f64
 (1.414213562373095048801688724209698079è

	)

851 
	#M_SQRT1_2f64
 
	`__f64
 (0.707106781186547524400844362104849039è

	)

854 #ià
__HAVE_FLOAT128
 && 
defšed
 
__USE_GNU


855 
	#M_Ef128
 
	`__f128
 (2.718281828459045235360287471352662498è

	)

856 
	#M_LOG2Ef128
 
	`__f128
 (1.442695040888963407359924681001892137è

	)

857 
	#M_LOG10Ef128
 
	`__f128
 (0.434294481903251827651128918916605082è

	)

858 
	#M_LN2f128
 
	`__f128
 (0.693147180559945309417232121458176568è

	)

859 
	#M_LN10f128
 
	`__f128
 (2.302585092994045684017991454684364208è

	)

860 
	#M_PIf128
 
	`__f128
 (3.141592653589793238462643383279502884è

	)

861 
	#M_PI_2f128
 
	`__f128
 (1.570796326794896619231321691639751442è

	)

862 
	#M_PI_4f128
 
	`__f128
 (0.785398163397448309615660845819875721è

	)

863 
	#M_1_PIf128
 
	`__f128
 (0.318309886183790671537767526745028724è

	)

864 
	#M_2_PIf128
 
	`__f128
 (0.636619772367581343075535053490057448è

	)

865 
	#M_2_SQRTPIf128
 
	`__f128
 (1.128379167095512573896158903121545172è

	)

866 
	#M_SQRT2f128
 
	`__f128
 (1.414213562373095048801688724209698079è

	)

867 
	#M_SQRT1_2f128
 
	`__f128
 (0.707106781186547524400844362104849039è

	)

870 #ià
__HAVE_FLOAT32X
 && 
defšed
 
__USE_GNU


871 
	#M_Ef32x
 
	`__f32x
 (2.718281828459045235360287471352662498è

	)

872 
	#M_LOG2Ef32x
 
	`__f32x
 (1.442695040888963407359924681001892137è

	)

873 
	#M_LOG10Ef32x
 
	`__f32x
 (0.434294481903251827651128918916605082è

	)

874 
	#M_LN2f32x
 
	`__f32x
 (0.693147180559945309417232121458176568è

	)

875 
	#M_LN10f32x
 
	`__f32x
 (2.302585092994045684017991454684364208è

	)

876 
	#M_PIf32x
 
	`__f32x
 (3.141592653589793238462643383279502884è

	)

877 
	#M_PI_2f32x
 
	`__f32x
 (1.570796326794896619231321691639751442è

	)

878 
	#M_PI_4f32x
 
	`__f32x
 (0.785398163397448309615660845819875721è

	)

879 
	#M_1_PIf32x
 
	`__f32x
 (0.318309886183790671537767526745028724è

	)

880 
	#M_2_PIf32x
 
	`__f32x
 (0.636619772367581343075535053490057448è

	)

881 
	#M_2_SQRTPIf32x
 
	`__f32x
 (1.128379167095512573896158903121545172è

	)

882 
	#M_SQRT2f32x
 
	`__f32x
 (1.414213562373095048801688724209698079è

	)

883 
	#M_SQRT1_2f32x
 
	`__f32x
 (0.707106781186547524400844362104849039è

	)

886 #ià
__HAVE_FLOAT64X
 && 
defšed
 
__USE_GNU


887 
	#M_Ef64x
 
	`__f64x
 (2.718281828459045235360287471352662498è

	)

888 
	#M_LOG2Ef64x
 
	`__f64x
 (1.442695040888963407359924681001892137è

	)

889 
	#M_LOG10Ef64x
 
	`__f64x
 (0.434294481903251827651128918916605082è

	)

890 
	#M_LN2f64x
 
	`__f64x
 (0.693147180559945309417232121458176568è

	)

891 
	#M_LN10f64x
 
	`__f64x
 (2.302585092994045684017991454684364208è

	)

892 
	#M_PIf64x
 
	`__f64x
 (3.141592653589793238462643383279502884è

	)

893 
	#M_PI_2f64x
 
	`__f64x
 (1.570796326794896619231321691639751442è

	)

894 
	#M_PI_4f64x
 
	`__f64x
 (0.785398163397448309615660845819875721è

	)

895 
	#M_1_PIf64x
 
	`__f64x
 (0.318309886183790671537767526745028724è

	)

896 
	#M_2_PIf64x
 
	`__f64x
 (0.636619772367581343075535053490057448è

	)

897 
	#M_2_SQRTPIf64x
 
	`__f64x
 (1.128379167095512573896158903121545172è

	)

898 
	#M_SQRT2f64x
 
	`__f64x
 (1.414213562373095048801688724209698079è

	)

899 
	#M_SQRT1_2f64x
 
	`__f64x
 (0.707106781186547524400844362104849039è

	)

902 #ià
__HAVE_FLOAT128X
 && 
defšed
 
__USE_GNU


909 #ià
defšed
 
__STRICT_ANSI__
 && !defšed 
__NO_MATH_INLINES


910 
	#__NO_MATH_INLINES
 1

	)

913 #ifdeà
__USE_ISOC99


914 #ià
__GNUC_PREREQ
 (3, 1)

921 
	#isg»©”
(
x
, 
y
è
	`__butš_isg»©”
(x, y)

	)

922 
	#isg»©”equ®
(
x
, 
y
è
	`__butš_isg»©”equ®
(x, y)

	)

923 
	#i¦ess
(
x
, 
y
è
	`__butš_i¦ess
(x, y)

	)

924 
	#i¦es£qu®
(
x
, 
y
è
	`__butš_i¦es£qu®
(x, y)

	)

925 
	#i¦essg»©”
(
x
, 
y
è
	`__butš_i¦essg»©”
(x, y)

	)

926 
	#isunÜd”ed
(
x
, 
y
è
	`__butš_isunÜd”ed
(x, y)

	)

928 
	#isg»©”
(
x
, 
y
) \

929 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

930 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x > __y; }))

	)

931 
	#isg»©”equ®
(
x
, 
y
) \

932 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

933 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x >ğ__y; }))

	)

934 
	#i¦ess
(
x
, 
y
) \

935 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

936 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x < __y; }))

	)

937 
	#i¦es£qu®
(
x
, 
y
) \

938 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

939 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x <ğ__y; }))

	)

940 
	#i¦essg»©”
(
x
, 
y
) \

941 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

942 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x !ğ__y; }))

	)

944 
	#isunÜd”ed
(
x
, 
y
) \

945 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__u
 = (x); __ty³of__ (
y
è
__v
 = (y); \

946 
__u
 !ğ
__v
 && (__u !ğ__u || __v !ğ__v); }))

	)

951 #ifdeà
__USE_EXTERN_INLINES


952 
	~<b™s/m©hšlše.h
>

957 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

960 
	#_MdoubË_
 

	)

961 
	#__MATH_DECLARING_DOUBLE
 1

	)

962 
	#__MATH_DECLARING_FLOATN
 0

	)

963 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

964 
funùiÚ
 ## 
»’Œªt


	)

965 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

966 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

967 
	~<b™s/m©h-fš™e.h
>

968 #undeà
_MdoubË_


969 #undeà
__MATH_DECLARING_DOUBLE


970 #undeà
__MATH_DECLARING_FLOATN


971 #undeà
__REDIRFROM_X


972 #undeà
__REDIRTO_X


976 #ifdeà
__USE_ISOC99


979 
	#_MdoubË_
 

	)

980 
	#__MATH_DECLARING_DOUBLE
 0

	)

981 
	#__MATH_DECLARING_FLOATN
 0

	)

982 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

983 
funùiÚ
 ## 
f
 ## 
»’Œªt


	)

984 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

985 
__
 ## 
funùiÚ
 ## 
f
 ## 
»’Œªt
 ## 
_fš™e


	)

986 
	~<b™s/m©h-fš™e.h
>

987 #undeà
_MdoubË_


988 #undeà
__MATH_DECLARING_DOUBLE


989 #undeà
__MATH_DECLARING_FLOATN


990 #undeà
__REDIRFROM_X


991 #undeà
__REDIRTO_X


994 #ifdeà
__MATH_DECLARE_LDOUBLE


995 
	#_MdoubË_
 

	)

996 
	#__MATH_DECLARING_DOUBLE
 0

	)

997 
	#__MATH_DECLARING_FLOATN
 0

	)

998 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

999 
funùiÚ
 ## 
l
 ## 
»’Œªt


	)

1000 #ifdeà
__NO_LONG_DOUBLE_MATH


1001 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1002 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1004 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1005 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1007 
	~<b™s/m©h-fš™e.h
>

1008 #undeà
_MdoubË_


1009 #undeà
__MATH_DECLARING_DOUBLE


1010 #undeà
__MATH_DECLARING_FLOATN


1011 #undeà
__REDIRFROM_X


1012 #undeà
__REDIRTO_X


1019 #ià(
__HAVE_DISTINCT_FLOAT16
 || (
__HAVE_FLOAT16
 && !
defšed
 
_LIBC
)) \

1020 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1021 
	#_MdoubË_
 
_Flßt16


	)

1022 
	#__MATH_DECLARING_DOUBLE
 0

	)

1023 
	#__MATH_DECLARING_FLOATN
 1

	)

1024 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1025 
funùiÚ
 ## 
f16
 ## 
»’Œªt


	)

1026 #ià
__HAVE_DISTINCT_FLOAT16


1027 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1028 
__
 ## 
funùiÚ
 ## 
f16
 ## 
»’Œªt
 ## 
_fš™e


	)

1032 
	~<b™s/m©h-fš™e.h
>

1033 #undeà
_MdoubË_


1034 #undeà
__MATH_DECLARING_DOUBLE


1035 #undeà
__MATH_DECLARING_FLOATN


1036 #undeà
__REDIRFROM_X


1037 #undeà
__REDIRTO_X


1040 #ià(
__HAVE_DISTINCT_FLOAT32
 || (
__HAVE_FLOAT32
 && !
defšed
 
_LIBC
)) \

1041 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1042 
	#_MdoubË_
 
_Flßt32


	)

1043 
	#__MATH_DECLARING_DOUBLE
 0

	)

1044 
	#__MATH_DECLARING_FLOATN
 1

	)

1045 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1046 
funùiÚ
 ## 
f32
 ## 
»’Œªt


	)

1047 #ià
__HAVE_DISTINCT_FLOAT32


1048 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1049 
__
 ## 
funùiÚ
 ## 
f32
 ## 
»’Œªt
 ## 
_fš™e


	)

1051 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1052 
__
 ## 
funùiÚ
 ## 
f
 ## 
»’Œªt
 ## 
_fš™e


	)

1054 
	~<b™s/m©h-fš™e.h
>

1055 #undeà
_MdoubË_


1056 #undeà
__MATH_DECLARING_DOUBLE


1057 #undeà
__MATH_DECLARING_FLOATN


1058 #undeà
__REDIRFROM_X


1059 #undeà
__REDIRTO_X


1062 #ià(
__HAVE_DISTINCT_FLOAT64
 || (
__HAVE_FLOAT64
 && !
defšed
 
_LIBC
)) \

1063 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1064 
	#_MdoubË_
 
_Flßt64


	)

1065 
	#__MATH_DECLARING_DOUBLE
 0

	)

1066 
	#__MATH_DECLARING_FLOATN
 1

	)

1067 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1068 
funùiÚ
 ## 
f64
 ## 
»’Œªt


	)

1069 #ià
__HAVE_DISTINCT_FLOAT64


1070 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1071 
__
 ## 
funùiÚ
 ## 
f64
 ## 
»’Œªt
 ## 
_fš™e


	)

1073 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1074 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1076 
	~<b™s/m©h-fš™e.h
>

1077 #undeà
_MdoubË_


1078 #undeà
__MATH_DECLARING_DOUBLE


1079 #undeà
__MATH_DECLARING_FLOATN


1080 #undeà
__REDIRFROM_X


1081 #undeà
__REDIRTO_X


1084 #ià(
__HAVE_DISTINCT_FLOAT128
 || (
__HAVE_FLOAT128
 && !
defšed
 
_LIBC
)) \

1085 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1086 
	#_MdoubË_
 
_Flßt128


	)

1087 
	#__MATH_DECLARING_DOUBLE
 0

	)

1088 
	#__MATH_DECLARING_FLOATN
 1

	)

1089 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1090 
funùiÚ
 ## 
f128
 ## 
»’Œªt


	)

1091 #ià
__HAVE_DISTINCT_FLOAT128


1092 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1093 
__
 ## 
funùiÚ
 ## 
f128
 ## 
»’Œªt
 ## 
_fš™e


	)

1095 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1096 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1098 
	~<b™s/m©h-fš™e.h
>

1099 #undeà
_MdoubË_


1100 #undeà
__MATH_DECLARING_DOUBLE


1101 #undeà
__MATH_DECLARING_FLOATN


1102 #undeà
__REDIRFROM_X


1103 #undeà
__REDIRTO_X


1106 #ià(
__HAVE_DISTINCT_FLOAT32X
 || (
__HAVE_FLOAT32X
 && !
defšed
 
_LIBC
)) \

1107 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1108 
	#_MdoubË_
 
_Flßt32x


	)

1109 
	#__MATH_DECLARING_DOUBLE
 0

	)

1110 
	#__MATH_DECLARING_FLOATN
 1

	)

1111 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1112 
funùiÚ
 ## 
f32x
 ## 
»’Œªt


	)

1113 #ià
__HAVE_DISTINCT_FLOAT32X


1114 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1115 
__
 ## 
funùiÚ
 ## 
f32x
 ## 
»’Œªt
 ## 
_fš™e


	)

1117 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1118 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1120 
	~<b™s/m©h-fš™e.h
>

1121 #undeà
_MdoubË_


1122 #undeà
__MATH_DECLARING_DOUBLE


1123 #undeà
__MATH_DECLARING_FLOATN


1124 #undeà
__REDIRFROM_X


1125 #undeà
__REDIRTO_X


1128 #ià(
__HAVE_DISTINCT_FLOAT64X
 || (
__HAVE_FLOAT64X
 && !
defšed
 
_LIBC
)) \

1129 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1130 
	#_MdoubË_
 
_Flßt64x


	)

1131 
	#__MATH_DECLARING_DOUBLE
 0

	)

1132 
	#__MATH_DECLARING_FLOATN
 1

	)

1133 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1134 
funùiÚ
 ## 
f64x
 ## 
»’Œªt


	)

1135 #ià
__HAVE_DISTINCT_FLOAT64X


1136 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1137 
__
 ## 
funùiÚ
 ## 
f64x
 ## 
»’Œªt
 ## 
_fš™e


	)

1138 #–ià
__HAVE_FLOAT64X_LONG_DOUBLE


1139 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1140 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1142 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1143 
__
 ## 
funùiÚ
 ## 
f128
 ## 
»’Œªt
 ## 
_fš™e


	)

1145 
	~<b™s/m©h-fš™e.h
>

1146 #undeà
_MdoubË_


1147 #undeà
__MATH_DECLARING_DOUBLE


1148 #undeà
__MATH_DECLARING_FLOATN


1149 #undeà
__REDIRFROM_X


1150 #undeà
__REDIRTO_X


1153 #ià(
__HAVE_DISTINCT_FLOAT128X
 || (
__HAVE_FLOAT128X
 && !
defšed
 
_LIBC
)) \

1154 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1155 
	#_MdoubË_
 
_Flßt128x


	)

1156 
	#__MATH_DECLARING_DOUBLE
 0

	)

1157 
	#__MATH_DECLARING_FLOATN
 1

	)

1158 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1159 
funùiÚ
 ## 
f128x
 ## 
»’Œªt


	)

1160 #ià
__HAVE_DISTINCT_FLOAT128X


1161 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1162 
__
 ## 
funùiÚ
 ## 
f128x
 ## 
»’Œªt
 ## 
_fš™e


	)

1166 
	~<b™s/m©h-fš™e.h
>

1167 #undeà
_MdoubË_


1168 #undeà
__MATH_DECLARING_DOUBLE


1169 #undeà
__MATH_DECLARING_FLOATN


1170 #undeà
__REDIRFROM_X


1171 #undeà
__REDIRTO_X


1176 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

1179 #ià
__FLT_EVAL_METHOD__
 == 2 || __FLT_EVAL_METHOD__ > 64

1180 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0L)

	)

1181 #–ià
__FLT_EVAL_METHOD__
 == 1 || __FLT_EVAL_METHOD__ > 32

1182 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0)

	)

1183 #–ià
__FLT_EVAL_METHOD__
 == 0 || __FLT_EVAL_METHOD__ == 32

1184 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0f)

	)

1186 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (y))

	)

1191 #ià!
defšed
 
__ılu¥lus
 || (__ılu¥lu < 201103L && !defšed 
__GNUC__
)

1192 
	#i£qsig
(
x
, 
y
) \

1193 
	`__MATH_TG
 (
	`__MATH_EVAL_FMT2
 (
x
, 
y
), 
__i£qsig
, ((x), (y)))

	)

1206 
‹m¶©e
<
ty³Çme
> 
__i£qsig_ty³
;

1208 
‹m¶©e
<> 
__i£qsig_ty³
<>

1210 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1212  
	`__i£qsigf
 (
__x
, 
__y
);

1216 
‹m¶©e
<> 
__i£qsig_ty³
<>

1218 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1220  
	`__i£qsig
 (
__x
, 
__y
);

1224 
‹m¶©e
<> 
__i£qsig_ty³
<>

1226 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1228 #iâdeà
__NO_LONG_DOUBLE_MATH


1229  
	`__i£qsigl
 (
__x
, 
__y
);

1231  
	`__i£qsig
 (
__x
, 
__y
);

1236 #ià
__HAVE_DISTINCT_FLOAT128


1237 
‹m¶©e
<> 
__i£qsig_ty³
<
_Flßt128
>

1239 
	`__ÿÎ
 (
_Flßt128
 
__x
, _Flßt128 
__y
è
	`throw
 ()

1241  
	`__i£qsigf128
 (
__x
, 
__y
);

1246 
‹m¶©e
<
ty³Çme
 
_T1
,y³Çm
_T2
>

1247 
šlše
 

1248 
	`i£qsig
 (
_T1
 
__x
, 
_T2
 
__y
è
	`throw
 ()

1250 #ià
__ılu¥lus
 >= 201103L

1251 
	`deşty³
 (
	t__MATH_EVAL_FMT2
 (
	t__x
, 
	t__y
)è
	t_T3
;

1253 
	`__ty³of
 (
	t__MATH_EVAL_FMT2
 (
	t__x
, 
	t__y
)è
	t_T3
;

1255  
__i£qsig_ty³
<
_T3
>::
	`__ÿÎ
 (
__x
, 
__y
);

1258 
	}
}

1263 
__END_DECLS


	@/usr/include/pthread.h

18 #iâdeà
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<’dŸn.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<b™s/±h»adty³s.h
>

27 
	~<b™s/£tjmp.h
>

28 
	~<b™s/wÜdsize.h
>

29 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

35 
	mPTHREAD_CREATE_JOINABLE
,

36 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

37 
	mPTHREAD_CREATE_DETACHED


38 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

45 
	mPTHREAD_MUTEX_TIMED_NP
,

46 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

47 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

48 
	mPTHREAD_MUTEX_ADAPTIVE_NP


49 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


51 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

52 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

53 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

54 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


56 #ifdeà
__USE_GNU


58 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


63 #ifdeà
__USE_XOPEN2K


67 
	mPTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

69 
	mPTHREAD_MUTEX_ROBUST
,

70 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


75 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


79 
	mPTHREAD_PRIO_NONE
,

80 
	mPTHREAD_PRIO_INHERIT
,

81 
	mPTHREAD_PRIO_PROTECT


86 #ià
__PTHREAD_MUTEX_HAVE_PREV


87 
	#PTHREAD_MUTEX_INITIALIZER
 \

88 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

89 #ifdeà
__USE_GNU


90 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

91 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

92 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

93 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

94 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

95 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

99 
	#PTHREAD_MUTEX_INITIALIZER
 \

100 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

101 #ifdeà
__USE_GNU


102 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

103 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

104 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

105 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

106 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

107 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

114 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


117 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

118 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

119 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

120 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


126 #iâdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


127 #ià
__WORDSIZE
 == 64

128 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

133 
	#PTHREAD_RWLOCK_INITIALIZER
 \

134 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

135 #ifdeà
__USE_GNU


136 #ifdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


137 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

138 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, \

139 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

141 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


142 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

143 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

144 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

146 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

147 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

148 0 } }

	)

158 
	mPTHREAD_INHERIT_SCHED
,

159 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

160 
	mPTHREAD_EXPLICIT_SCHED


161 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

168 
	mPTHREAD_SCOPE_SYSTEM
,

169 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

170 
	mPTHREAD_SCOPE_PROCESS


171 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

178 
	mPTHREAD_PROCESS_PRIVATE
,

179 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

180 
	mPTHREAD_PROCESS_SHARED


181 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

187 
	#PTHREAD_COND_INITIALIZER
 { { {0}, {0}, {0, 0}, {0, 0}, 0, 0, {0, 0} } }

	)

191 
	s_±h»ad_ş—nup_bufãr


193 (*
	m__routše
) (*);

194 *
	m__¬g
;

195 
	m__ÿnûÉy³
;

196 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

202 
	mPTHREAD_CANCEL_ENABLE
,

203 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

204 
	mPTHREAD_CANCEL_DISABLE


205 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

209 
	mPTHREAD_CANCEL_DEFERRED
,

210 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

211 
	mPTHREAD_CANCEL_ASYNCHRONOUS


212 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

214 
	#PTHREAD_CANCELED
 ((*è-1)

	)

218 
	#PTHREAD_ONCE_INIT
 0

	)

221 #ifdeà
__USE_XOPEN2K


225 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

229 
__BEGIN_DECLS


234 
	$±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

235 cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

236 *(*
__¡¬t_routše
) (*),

237 *
__»¡riù
 
__¬g
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 3));

243 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

251 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

253 #ifdeà
__USE_GNU


256 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

264 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

265 cÚ¡ 
time¥ec
 *
__ab¡ime
);

272 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

276 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

279 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
)

280 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

288 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

291 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

292 
__THROW
 
	`__nÚnuÎ
 ((1));

295 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

296 *
__d‘ach¡©e
)

297 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

300 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

301 
__d‘ach¡©e
)

302 
__THROW
 
	`__nÚnuÎ
 ((1));

306 
	$±h»ad_©Œ_g‘gu¬dsize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

307 
size_t
 *
__gu¬dsize
)

308 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

311 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

312 
size_t
 
__gu¬dsize
)

313 
__THROW
 
	`__nÚnuÎ
 ((1));

317 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

318 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

319 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

322 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

323 cÚ¡ 
sched_·¿m
 *
__»¡riù


324 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

327 
	$±h»ad_©Œ_g‘schedpŞicy
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


328 
__©Œ
, *
__»¡riù
 
__pŞicy
)

329 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

332 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

333 
__THROW
 
	`__nÚnuÎ
 ((1));

336 
	$±h»ad_©Œ_g‘šh”™sched
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


337 
__©Œ
, *
__»¡riù
 
__šh”™
)

338 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

341 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

342 
__šh”™
)

343 
__THROW
 
	`__nÚnuÎ
 ((1));

347 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

348 *
__»¡riù
 
__scİe
)

349 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

352 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

353 
__THROW
 
	`__nÚnuÎ
 ((1));

356 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


357 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

358 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

364 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

365 *
__¡ackaddr
)

366 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

369 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


370 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

371 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

376 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

377 
size_t
 
__¡acksize
)

378 
__THROW
 
	`__nÚnuÎ
 ((1));

380 #ifdeà
__USE_XOPEN2K


382 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

383 **
__»¡riù
 
__¡ackaddr
,

384 
size_t
 *
__»¡riù
 
__¡acksize
)

385 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

390 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

391 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

394 #ifdeà
__USE_GNU


397 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

398 
size_t
 
__ıu£tsize
,

399 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

400 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

404 
	$±h»ad_©Œ_g‘affš™y_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

405 
size_t
 
__ıu£tsize
,

406 
ıu_£t_t
 *
__ıu£t
)

407 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

410 
	$±h»ad_g‘©Œ_deçuÉ_Å
 (
±h»ad_©Œ_t
 *
__©Œ
)

411 
__THROW
 
	`__nÚnuÎ
 ((1));

415 
	$±h»ad_£‰r_deçuÉ_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
)

416 
__THROW
 
	`__nÚnuÎ
 ((1));

421 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

422 
__THROW
 
	`__nÚnuÎ
 ((2));

430 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

431 cÚ¡ 
sched_·¿m
 *
__·¿m
)

432 
__THROW
 
	`__nÚnuÎ
 ((3));

435 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

436 *
__»¡riù
 
__pŞicy
,

437 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

438 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

441 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

442 
__THROW
;

445 #ifdeà
__USE_GNU


447 
	$±h»ad_g‘Çme_Å
 (
±h»ad_t
 
__rg‘_th»ad
, *
__buf
,

448 
size_t
 
__buæ’
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

452 
	$±h»ad_£Šame_Å
 (
±h»ad_t
 
__rg‘_th»ad
, cÚ¡ *
__Çme
)

453 
__THROW
 
	`__nÚnuÎ
 ((2));

457 #ifdeà
__USE_UNIX98


459 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

462 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

465 #ifdeà
__USE_GNU


470 
	$±h»ad_y›ld
 (è
__THROW
;

475 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

476 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

477 
__THROW
 
	`__nÚnuÎ
 ((3));

480 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

481 
ıu_£t_t
 *
__ıu£t
)

482 
__THROW
 
	`__nÚnuÎ
 ((3));

495 
	$±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

496 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

507 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

511 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

514 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

519 
	`±h»ad_‹¡ÿnûl
 ();

528 
__jmp_buf
 
__ÿnûl_jmp_buf
;

529 
__mask_was_§ved
;

530 } 
__ÿnûl_jmp_buf
[1];

531 *
__·d
[4];

532 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

535 #iâdeà
__ş—nup_fù_©Œibu‹


536 
	#__ş—nup_fù_©Œibu‹


	)

541 
	s__±h»ad_ş—nup_äame


543 (*
__ÿnûl_routše
) (*);

544 *
__ÿnûl_¬g
;

545 
__do_™
;

546 
__ÿnûl_ty³
;

549 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


550 #ifdeà
__ılu¥lus


552 şas 
	c__±h»ad_ş—nup_şass


554 (*
__ÿnûl_routše
) (*);

555 *
__ÿnûl_¬g
;

556 
__do_™
;

557 
__ÿnûl_ty³
;

559 
public
:

560 
	$__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

561 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

562 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

563 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

564 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

565 &
__ÿnûl_ty³
); 
	}
}

566 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

576 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

578 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

582 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

583 
__şäame
.
	`__£tdo™
 (
execu‹
); \

584 } 0)

	)

586 #ifdeà
__USE_GNU


590 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

592 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

593 
__şäame
.
	`__deãr
 ()

	)

598 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

599 
__şäame
.
	`__»¡Üe
 (); \

600 
__şäame
.
	`__£tdo™
 (
execu‹
); \

601 } 0)

	)

608 
__ex‹º_šlše
 

609 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

611 ià(
__äame
->
__do_™
)

612 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

613 
	}
}

622 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

624 
__±h»ad_ş—nup_äame
 
__şäame
 \

625 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

626 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

627 .
__do_™
 = 1 };

	)

631 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

632 
__şäame
.
__do_™
 = (
execu‹
); \

633 } 0)

	)

635 #ifdeà
__USE_GNU


639 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

641 
__±h»ad_ş—nup_äame
 
__şäame
 \

642 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

643 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

644 .
__do_™
 = 1 }; \

645 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

646 &
__şäame
.
__ÿnûl_ty³
)

	)

651 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

652 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

653 
__şäame
.
__do_™
 = (
execu‹
); \

654 } 0)

	)

665 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

667 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

668 (*
__ÿnûl_routše
è(*èğ(
routše
); \

669 *
__ÿnûl_¬g
 = (
¬g
); \

670 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

671 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

672 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

674 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

675 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

679 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

680 dØ{

	)

681 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

682 
__ş—nup_fù_©Œibu‹
;

686 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

689 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

690 ià(
execu‹
) \

691 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

692 } 0)

	)

693 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

694 
__ş—nup_fù_©Œibu‹
;

696 #ifdeà
__USE_GNU


700 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

702 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

703 (*
__ÿnûl_routše
è(*èğ(
routše
); \

704 *
__ÿnûl_¬g
 = (
¬g
); \

705 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

706 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

707 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

709 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

710 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

714 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

715 dØ{

	)

716 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

717 
__ş—nup_fù_©Œibu‹
;

722 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

725 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

726 ià(
execu‹
) \

727 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

728 
	}
} 0)

	)

729 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

730 
__ş—nup_fù_©Œibu‹
;

734 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

735 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

736 #iâdeà
SHARED


737 
	`__©Œibu‹__
 ((
__w—k__
))

743 
__jmp_buf_g
;

744 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROWNL
;

750 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

751 cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

752 
__THROW
 
	`__nÚnuÎ
 ((1));

755 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

756 
__THROW
 
	`__nÚnuÎ
 ((1));

759 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

760 
__THROWNL
 
	`__nÚnuÎ
 ((1));

763 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

764 
__THROWNL
 
	`__nÚnuÎ
 ((1));

766 #ifdeà
__USE_XOPEN2K


768 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

769 cÚ¡ 
time¥ec
 *
__»¡riù


770 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

774 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

775 
__THROWNL
 
	`__nÚnuÎ
 ((1));

779 
	$±h»ad_mu‹x_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x_t
 *

780 
__»¡riù
 
__mu‹x
,

781 *
__»¡riù
 
__´ioûšg
)

782 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

786 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

787 
__´ioûšg
,

788 *
__»¡riù
 
__Şd_ûšg
)

789 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

792 #ifdeà
__USE_XOPEN2K8


794 
	$±h»ad_mu‹x_cÚsi¡’t
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

795 
__THROW
 
	`__nÚnuÎ
 ((1));

796 #ifdeà
__USE_GNU


797 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

798 
__THROW
 
	`__nÚnuÎ
 ((1));

807 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

808 
__THROW
 
	`__nÚnuÎ
 ((1));

811 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

812 
__THROW
 
	`__nÚnuÎ
 ((1));

815 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

816 
__»¡riù
 
__©Œ
,

817 *
__»¡riù
 
__psh¬ed
)

818 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

821 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

822 
__psh¬ed
)

823 
__THROW
 
	`__nÚnuÎ
 ((1));

825 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


827 
	$±h»ad_mu‹x©Œ_g‘ty³
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


828 
__©Œ
, *
__»¡riù
 
__kšd
)

829 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

834 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

835 
__THROW
 
	`__nÚnuÎ
 ((1));

839 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

840 
__»¡riù
 
__©Œ
,

841 *
__»¡riù
 
__´ÙocŞ
)

842 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

846 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

847 
__´ÙocŞ
)

848 
__THROW
 
	`__nÚnuÎ
 ((1));

851 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

852 
__»¡riù
 
__©Œ
,

853 *
__»¡riù
 
__´ioûšg
)

854 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

857 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

858 
__´ioûšg
)

859 
__THROW
 
	`__nÚnuÎ
 ((1));

861 #ifdeà
__USE_XOPEN2K


863 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

864 *
__robu¡Ãss
)

865 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

866 #ifdeà
__USE_GNU


867 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

868 *
__robu¡Ãss
)

869 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

873 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

874 
__robu¡Ãss
)

875 
__THROW
 
	`__nÚnuÎ
 ((1));

876 #ifdeà
__USE_GNU


877 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

878 
__robu¡Ãss
)

879 
__THROW
 
	`__nÚnuÎ
 ((1));

884 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


889 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

890 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
__»¡riù


891 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

894 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

895 
__THROW
 
	`__nÚnuÎ
 ((1));

898 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

899 
__THROWNL
 
	`__nÚnuÎ
 ((1));

902 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

903 
__THROWNL
 
	`__nÚnuÎ
 ((1));

905 #ifdeà
__USE_XOPEN2K


907 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

908 cÚ¡ 
time¥ec
 *
__»¡riù


909 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

913 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

914 
__THROWNL
 
	`__nÚnuÎ
 ((1));

917 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

918 
__THROWNL
 
	`__nÚnuÎ
 ((1));

920 #ifdeà
__USE_XOPEN2K


922 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

923 cÚ¡ 
time¥ec
 *
__»¡riù


924 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

928 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

929 
__THROWNL
 
	`__nÚnuÎ
 ((1));

935 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

936 
__THROW
 
	`__nÚnuÎ
 ((1));

939 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

940 
__THROW
 
	`__nÚnuÎ
 ((1));

943 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

944 
__»¡riù
 
__©Œ
,

945 *
__»¡riù
 
__psh¬ed
)

946 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

949 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

950 
__psh¬ed
)

951 
__THROW
 
	`__nÚnuÎ
 ((1));

954 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

955 
__»¡riù
 
__©Œ
,

956 *
__»¡riù
 
__´ef
)

957 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

960 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

961 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

969 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

970 cÚ¡ 
±h»ad_cÚd©Œ_t
 *
__»¡riù
 
__cÚd_©Œ
)

971 
__THROW
 
	`__nÚnuÎ
 ((1));

974 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

975 
__THROW
 
	`__nÚnuÎ
 ((1));

978 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

979 
__THROWNL
 
	`__nÚnuÎ
 ((1));

982 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

983 
__THROWNL
 
	`__nÚnuÎ
 ((1));

990 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

991 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

992 
	`__nÚnuÎ
 ((1, 2));

1001 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1002 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

1003 cÚ¡ 
time¥ec
 *
__»¡riù
 
__ab¡ime
)

1004 
	`__nÚnuÎ
 ((1, 2, 3));

1009 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1010 
__THROW
 
	`__nÚnuÎ
 ((1));

1013 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1014 
__THROW
 
	`__nÚnuÎ
 ((1));

1017 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1018 
__»¡riù
 
__©Œ
,

1019 *
__»¡riù
 
__psh¬ed
)

1020 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1023 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1024 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1026 #ifdeà
__USE_XOPEN2K


1028 
	$±h»ad_cÚd©Œ_g‘şock
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1029 
__»¡riù
 
__©Œ
,

1030 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1031 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1034 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1035 
__şockid_t
 
__şock_id
)

1036 
__THROW
 
	`__nÚnuÎ
 ((1));

1040 #ifdeà
__USE_XOPEN2K


1045 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1046 
__THROW
 
	`__nÚnuÎ
 ((1));

1049 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1050 
__THROW
 
	`__nÚnuÎ
 ((1));

1053 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1054 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1057 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1058 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1061 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1062 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1069 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1070 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1071 
__©Œ
, 
__couÁ
)

1072 
__THROW
 
	`__nÚnuÎ
 ((1));

1075 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1076 
__THROW
 
	`__nÚnuÎ
 ((1));

1079 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1080 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1084 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1085 
__THROW
 
	`__nÚnuÎ
 ((1));

1088 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1089 
__THROW
 
	`__nÚnuÎ
 ((1));

1092 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *

1093 
__»¡riù
 
__©Œ
,

1094 *
__»¡riù
 
__psh¬ed
)

1095 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1098 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1099 
__psh¬ed
)

1100 
__THROW
 
	`__nÚnuÎ
 ((1));

1112 
	$±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1113 (*
__de¡r_funùiÚ
) (*))

1114 
__THROW
 
	`__nÚnuÎ
 ((1));

1117 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1120 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1123 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1124 cÚ¡ *
__poš‹r
è
__THROW
 ;

1127 #ifdeà
__USE_XOPEN2K


1129 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1130 
__şockid_t
 *
__şock_id
)

1131 
__THROW
 
	`__nÚnuÎ
 ((2));

1146 
	$±h»ad_©fÜk
 ((*
__´•¬e
) (),

1147 (*
__·»Á
) (),

1148 (*
__chd
è()è
__THROW
;

1151 #ifdeà
__USE_EXTERN_INLINES


1153 
__ex‹º_šlše
 

1154 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1156  
__th»ad1
 =ğ
__th»ad2
;

1157 
	}
}

1160 
	g__END_DECLS


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

27 
	~<b™s/ty³s.h
>

28 
	~<b™s/wch¬.h
>

29 
	~<b™s/wÜdsize.h
>

34 
	~<b™s/¡dšt-šŠ.h
>

37 
	~<b™s/¡dšt-ušŠ.h
>

43 sigÃd 
	tšt_Ëa¡8_t
;

44 
	tšt_Ëa¡16_t
;

45 
	tšt_Ëa¡32_t
;

46 #ià
__WORDSIZE
 == 64

47 
	tšt_Ëa¡64_t
;

49 
__ex‹nsiÚ__


50 
	tšt_Ëa¡64_t
;

54 
	tušt_Ëa¡8_t
;

55 
	tušt_Ëa¡16_t
;

56 
	tušt_Ëa¡32_t
;

57 #ià
__WORDSIZE
 == 64

58 
	tušt_Ëa¡64_t
;

60 
__ex‹nsiÚ__


61 
	tušt_Ëa¡64_t
;

68 sigÃd 
	tšt_ç¡8_t
;

69 #ià
__WORDSIZE
 == 64

70 
	tšt_ç¡16_t
;

71 
	tšt_ç¡32_t
;

72 
	tšt_ç¡64_t
;

74 
	tšt_ç¡16_t
;

75 
	tšt_ç¡32_t
;

76 
__ex‹nsiÚ__


77 
	tšt_ç¡64_t
;

81 
	tušt_ç¡8_t
;

82 #ià
__WORDSIZE
 == 64

83 
	tušt_ç¡16_t
;

84 
	tušt_ç¡32_t
;

85 
	tušt_ç¡64_t
;

87 
	tušt_ç¡16_t
;

88 
	tušt_ç¡32_t
;

89 
__ex‹nsiÚ__


90 
	tušt_ç¡64_t
;

95 #ià
__WORDSIZE
 == 64

96 #iâdeà
__šŒ_t_defšed


97 
	tšŒ_t
;

98 
	#__šŒ_t_defšed


	)

100 
	tušŒ_t
;

102 #iâdeà
__šŒ_t_defšed


103 
	tšŒ_t
;

104 
	#__šŒ_t_defšed


	)

106 
	tušŒ_t
;

111 
__štmax_t
 
	tštmax_t
;

112 
__uštmax_t
 
	tuštmax_t
;

115 #ià
__WORDSIZE
 == 64

116 
	#__INT64_C
(
c
èø## 
L


	)

117 
	#__UINT64_C
(
c
èø## 
UL


	)

119 
	#__INT64_C
(
c
èø## 
LL


	)

120 
	#__UINT64_C
(
c
èø## 
ULL


	)

126 
	#INT8_MIN
 (-128)

	)

127 
	#INT16_MIN
 (-32767-1)

	)

128 
	#INT32_MIN
 (-2147483647-1)

	)

129 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

131 
	#INT8_MAX
 (127)

	)

132 
	#INT16_MAX
 (32767)

	)

133 
	#INT32_MAX
 (2147483647)

	)

134 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

137 
	#UINT8_MAX
 (255)

	)

138 
	#UINT16_MAX
 (65535)

	)

139 
	#UINT32_MAX
 (4294967295U)

	)

140 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

144 
	#INT_LEAST8_MIN
 (-128)

	)

145 
	#INT_LEAST16_MIN
 (-32767-1)

	)

146 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

147 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

149 
	#INT_LEAST8_MAX
 (127)

	)

150 
	#INT_LEAST16_MAX
 (32767)

	)

151 
	#INT_LEAST32_MAX
 (2147483647)

	)

152 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

155 
	#UINT_LEAST8_MAX
 (255)

	)

156 
	#UINT_LEAST16_MAX
 (65535)

	)

157 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

158 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

162 
	#INT_FAST8_MIN
 (-128)

	)

163 #ià
__WORDSIZE
 == 64

164 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

165 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

167 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

168 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

170 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

172 
	#INT_FAST8_MAX
 (127)

	)

173 #ià
__WORDSIZE
 == 64

174 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

175 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

177 
	#INT_FAST16_MAX
 (2147483647)

	)

178 
	#INT_FAST32_MAX
 (2147483647)

	)

180 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

183 
	#UINT_FAST8_MAX
 (255)

	)

184 #ià
__WORDSIZE
 == 64

185 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

186 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

188 
	#UINT_FAST16_MAX
 (4294967295U)

	)

189 
	#UINT_FAST32_MAX
 (4294967295U)

	)

191 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

195 #ià
__WORDSIZE
 == 64

196 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

197 
	#INTPTR_MAX
 (9223372036854775807L)

	)

198 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

200 
	#INTPTR_MIN
 (-2147483647-1)

	)

201 
	#INTPTR_MAX
 (2147483647)

	)

202 
	#UINTPTR_MAX
 (4294967295U)

	)

207 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

209 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

218 #ià
__WORDSIZE
 == 64

219 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

220 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

222 #ià
__WORDSIZE32_PTRDIFF_LONG


223 
	#PTRDIFF_MIN
 (-2147483647L-1)

	)

224 
	#PTRDIFF_MAX
 (2147483647L)

	)

226 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

227 
	#PTRDIFF_MAX
 (2147483647)

	)

232 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

233 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

236 #ià
__WORDSIZE
 == 64

237 
	#SIZE_MAX
 (18446744073709551615UL)

	)

239 #ià
__WORDSIZE32_SIZE_ULONG


240 
	#SIZE_MAX
 (4294967295UL)

	)

242 
	#SIZE_MAX
 (4294967295U)

	)

247 #iâdeà
WCHAR_MIN


249 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

250 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

254 
	#WINT_MIN
 (0u)

	)

255 
	#WINT_MAX
 (4294967295u)

	)

258 
	#INT8_C
(
c
è
	)
c

259 
	#INT16_C
(
c
è
	)
c

260 
	#INT32_C
(
c
è
	)
c

261 #ià
__WORDSIZE
 == 64

262 
	#INT64_C
(
c
èø## 
L


	)

264 
	#INT64_C
(
c
èø## 
LL


	)

268 
	#UINT8_C
(
c
è
	)
c

269 
	#UINT16_C
(
c
è
	)
c

270 
	#UINT32_C
(
c
èø## 
U


	)

271 #ià
__WORDSIZE
 == 64

272 
	#UINT64_C
(
c
èø## 
UL


	)

274 
	#UINT64_C
(
c
èø## 
ULL


	)

278 #ià
__WORDSIZE
 == 64

279 
	#INTMAX_C
(
c
èø## 
L


	)

280 
	#UINTMAX_C
(
c
èø## 
UL


	)

282 
	#INTMAX_C
(
c
èø## 
LL


	)

283 
	#UINTMAX_C
(
c
èø## 
ULL


	)

286 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

288 
	#INT8_WIDTH
 8

	)

289 
	#UINT8_WIDTH
 8

	)

290 
	#INT16_WIDTH
 16

	)

291 
	#UINT16_WIDTH
 16

	)

292 
	#INT32_WIDTH
 32

	)

293 
	#UINT32_WIDTH
 32

	)

294 
	#INT64_WIDTH
 64

	)

295 
	#UINT64_WIDTH
 64

	)

297 
	#INT_LEAST8_WIDTH
 8

	)

298 
	#UINT_LEAST8_WIDTH
 8

	)

299 
	#INT_LEAST16_WIDTH
 16

	)

300 
	#UINT_LEAST16_WIDTH
 16

	)

301 
	#INT_LEAST32_WIDTH
 32

	)

302 
	#UINT_LEAST32_WIDTH
 32

	)

303 
	#INT_LEAST64_WIDTH
 64

	)

304 
	#UINT_LEAST64_WIDTH
 64

	)

306 
	#INT_FAST8_WIDTH
 8

	)

307 
	#UINT_FAST8_WIDTH
 8

	)

308 
	#INT_FAST16_WIDTH
 
__WORDSIZE


	)

309 
	#UINT_FAST16_WIDTH
 
__WORDSIZE


	)

310 
	#INT_FAST32_WIDTH
 
__WORDSIZE


	)

311 
	#UINT_FAST32_WIDTH
 
__WORDSIZE


	)

312 
	#INT_FAST64_WIDTH
 64

	)

313 
	#UINT_FAST64_WIDTH
 64

	)

315 
	#INTPTR_WIDTH
 
__WORDSIZE


	)

316 
	#UINTPTR_WIDTH
 
__WORDSIZE


	)

318 
	#INTMAX_WIDTH
 64

	)

319 
	#UINTMAX_WIDTH
 64

	)

321 
	#PTRDIFF_WIDTH
 
__WORDSIZE


	)

322 
	#SIG_ATOMIC_WIDTH
 32

	)

323 
	#SIZE_WIDTH
 
__WORDSIZE


	)

324 
	#WCHAR_WIDTH
 32

	)

325 
	#WINT_WIDTH
 32

	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


24 
	#_STDIO_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	~<b™s/ty³s/__FILE.h
>

37 
	~<b™s/ty³s/FILE.h
>

39 
	#_STDIO_USES_IOSTREAM


	)

41 
	~<b™s/libio.h
>

43 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


44 #ifdeà
__GNUC__


45 #iâdeà
_VA_LIST_DEFINED


46 
_G_va_li¡
 
	tva_li¡
;

47 
	#_VA_LIST_DEFINED


	)

50 
	~<¡d¬g.h
>

54 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


55 #iâdeà
__off_t_defšed


56 #iâdeà
__USE_FILE_OFFSET64


57 
__off_t
 
	toff_t
;

59 
__off64_t
 
	toff_t
;

61 
	#__off_t_defšed


	)

63 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_defšed


	)

69 #ifdeà
__USE_XOPEN2K8


70 #iâdeà
__ssize_t_defšed


71 
__ssize_t
 
	tssize_t
;

72 
	#__ssize_t_defšed


	)

77 #iâdeà
__USE_FILE_OFFSET64


78 
_G_åos_t
 
	tåos_t
;

80 
_G_åos64_t
 
	tåos_t
;

82 #ifdeà
__USE_LARGEFILE64


83 
_G_åos64_t
 
	tåos64_t
;

87 
	#_IOFBF
 0

	)

88 
	#_IOLBF
 1

	)

89 
	#_IONBF
 2

	)

93 #iâdeà
BUFSIZ


94 
	#BUFSIZ
 
_IO_BUFSIZ


	)

100 #iâdeà
EOF


101 
	#EOF
 (-1)

	)

107 
	#SEEK_SET
 0

	)

108 
	#SEEK_CUR
 1

	)

109 
	#SEEK_END
 2

	)

110 #ifdeà
__USE_GNU


111 
	#SEEK_DATA
 3

	)

112 
	#SEEK_HOLE
 4

	)

116 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


118 
	#P_tmpdœ
 "/tmp"

	)

131 
	~<b™s/¡dio_lim.h
>

135 
_IO_FILE
 *
¡dš
;

136 
_IO_FILE
 *
¡dout
;

137 
_IO_FILE
 *
¡d”r
;

139 
	#¡dš
 
¡dš


	)

140 
	#¡dout
 
¡dout


	)

141 
	#¡d”r
 
¡d”r


	)

144 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

146 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

148 #ifdeà
__USE_ATFILE


150 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

151 cÚ¡ *
__Ãw
è
__THROW
;

158 #iâdeà
__USE_FILE_OFFSET64


159 
FILE
 *
	$tmpfe
 (è
__wur
;

161 #ifdeà
__REDIRECT


162 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

164 
	#tmpfe
 
tmpfe64


	)

168 #ifdeà
__USE_LARGEFILE64


169 
FILE
 *
	$tmpfe64
 (è
__wur
;

173 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

175 #ifdeà
__USE_MISC


178 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

182 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


190 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

191 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

199 
	`fşo£
 (
FILE
 *
__¡»am
);

204 
	`fæush
 (
FILE
 *
__¡»am
);

206 #ifdeà
__USE_MISC


213 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

216 #ifdeà
__USE_GNU


223 
	`fşo£®l
 ();

227 #iâdeà
__USE_FILE_OFFSET64


232 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

233 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

238 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

239 cÚ¡ *
__»¡riù
 
__modes
,

240 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

242 #ifdeà
__REDIRECT


243 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

244 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

245 
__wur
;

246 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

247 cÚ¡ *
__»¡riù
 
__modes
,

248 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

249 
__wur
;

251 
	#fİ’
 
fİ’64


	)

252 
	#äeİ’
 
äeİ’64


	)

255 #ifdeà
__USE_LARGEFILE64


256 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

257 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

258 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

259 cÚ¡ *
__»¡riù
 
__modes
,

260 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

263 #ifdef 
__USE_POSIX


265 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

268 #ifdef 
__USE_GNU


271 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

272 cÚ¡ *
__»¡riù
 
__modes
,

273 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

276 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

278 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

279 
__THROW
 
__wur
;

284 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

290 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

294 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

295 
__modes
, 
size_t
 
__n
è
__THROW
;

297 #ifdef 
__USE_MISC


300 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

301 
size_t
 
__size
è
__THROW
;

304 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

312 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

313 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

318 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

320 
	$¥rštf
 (*
__»¡riù
 
__s
,

321 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

327 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

328 
_G_va_li¡
 
__¬g
);

333 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

335 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

336 
_G_va_li¡
 
__¬g
è
__THROWNL
;

338 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


340 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

341 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

342 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

344 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

345 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

346 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

349 #ià
	`__GLIBC_USE
 (
LIB_EXT2
)

352 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

353 
_G_va_li¡
 
__¬g
)

354 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

355 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

356 cÚ¡ *
__»¡riù
 
__fmt
, ...)

357 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

358 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

359 cÚ¡ *
__»¡riù
 
__fmt
, ...)

360 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

363 #ifdeà
__USE_XOPEN2K8


365 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

366 
_G_va_li¡
 
__¬g
)

367 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

368 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

369 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

377 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

378 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

383 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

385 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

386 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

388 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

389 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

390 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

391 #ifdeà
__REDIRECT


395 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

396 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

397 
__isoc99_fsÿnf
è
__wur
;

398 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

399 
__isoc99_sÿnf
è
__wur
;

400 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

401 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

402 
__isoc99_ssÿnf
);

404 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

405 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

406 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

407 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

408 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

409 
	#fsÿnf
 
__isoc99_fsÿnf


	)

410 
	#sÿnf
 
__isoc99_sÿnf


	)

411 
	#ssÿnf
 
__isoc99_ssÿnf


	)

415 #ifdef 
__USE_ISOC99


420 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

421 
_G_va_li¡
 
__¬g
)

422 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

428 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

429 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

432 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

433 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

434 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

436 #ià!
defšed
 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
vfsÿnf
,

444 (
FILE
 *
__»¡riù
 
__s
,

445 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

446 
__isoc99_vfsÿnf
)

447 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

448 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

449 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

450 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

451 
	`__REDIRECT_NTH
 (
vssÿnf
,

452 (cÚ¡ *
__»¡riù
 
__s
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
,

454 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

455 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

457 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

458 cÚ¡ *
__»¡riù
 
__fÜm©
,

459 
_G_va_li¡
 
__¬g
è
__wur
;

460 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

461 
_G_va_li¡
 
__¬g
è
__wur
;

462 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

463 cÚ¡ *
__»¡riù
 
__fÜm©
,

464 
_G_va_li¡
 
__¬g
è
__THROW
;

465 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

466 
	#vsÿnf
 
__isoc99_vsÿnf


	)

467 
	#vssÿnf
 
__isoc99_vssÿnf


	)

477 
	`fg‘c
 (
FILE
 *
__¡»am
);

478 
	`g‘c
 (
FILE
 *
__¡»am
);

484 
	`g‘ch¬
 ();

488 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

490 #ifdeà
__USE_POSIX199506


495 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

496 
	`g‘ch¬_uÆocked
 ();

499 #ifdeà
__USE_MISC


506 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

517 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

518 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

524 
	`putch¬
 (
__c
);

528 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

530 #ifdeà
__USE_MISC


537 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

540 #ifdeà
__USE_POSIX199506


545 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

546 
	`putch¬_uÆocked
 (
__c
);

550 #ià
defšed
 
__USE_MISC
 \

551 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

553 
	`g‘w
 (
FILE
 *
__¡»am
);

556 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

564 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

565 
__wur
;

567 #ià
	`__GLIBC_USE
 (
DEPRECATED_GETS
)

577 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

580 #ifdeà
__USE_GNU


587 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

588 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

592 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

603 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

604 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

605 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

606 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

607 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

608 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

616 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

617 
size_t
 *
__»¡riù
 
__n
,

618 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

626 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

632 
	`puts
 (cÚ¡ *
__s
);

639 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

646 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

647 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

652 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

653 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

655 #ifdeà
__USE_GNU


662 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

663 
FILE
 *
__»¡riù
 
__¡»am
);

666 #ifdeà
__USE_MISC


673 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

674 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

675 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

676 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

684 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

689 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

694 
	`»wšd
 (
FILE
 *
__¡»am
);

701 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


702 #iâdeà
__USE_FILE_OFFSET64


707 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

712 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

714 #ifdeà
__REDIRECT


715 
	`__REDIRECT
 (
f£eko
,

716 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

717 
f£eko64
);

718 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

720 
	#f£eko
 
f£eko64


	)

721 
	#á–lo
 
á–lo64


	)

726 #iâdeà
__USE_FILE_OFFSET64


731 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

736 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

738 #ifdeà
__REDIRECT


739 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

740 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

741 
	`__REDIRECT
 (
f£os
,

742 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

744 
	#fg‘pos
 
fg‘pos64


	)

745 
	#f£os
 
f£os64


	)

749 #ifdeà
__USE_LARGEFILE64


750 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

751 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

752 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

753 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

757 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

759 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

761 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

763 #ifdeà
__USE_MISC


765 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

766 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

767 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

775 
	`³¼Ü
 (cÚ¡ *
__s
);

781 
	~<b™s/sys_”¾i¡.h
>

784 #ifdef 
__USE_POSIX


786 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

789 #ifdeà
__USE_MISC


791 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

795 #ifdeà
__USE_POSIX2


800 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

806 
	`pşo£
 (
FILE
 *
__¡»am
);

810 #ifdef 
__USE_POSIX


812 *
	$ù”mid
 (*
__s
è
__THROW
;

816 #ià(
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
è|| defšed 
__USE_GNU


818 *
	`cu£rid
 (*
__s
);

822 #ifdef 
__USE_GNU


823 
ob¡ack
;

826 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

827 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

828 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

829 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

830 cÚ¡ *
__»¡riù
 
__fÜm©
,

831 
_G_va_li¡
 
__¬gs
)

832 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

836 #ifdeà
__USE_POSIX199506


840 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

844 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

847 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

850 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


853 
	~<b™s/g‘İt_posix.h
>

858 #ifdeà
__USE_EXTERN_INLINES


859 
	~<b™s/¡dio.h
>

861 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


862 
	~<b™s/¡dio2.h
>

864 #ifdeà
__LDBL_COMPAT


865 
	~<b™s/¡dio-ldbl.h
>

868 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

25 
	~<b™s/libc-h—d”-¡¬t.h
>

28 
	#__Ãed_size_t


	)

29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

31 
	~<¡ddef.h
>

33 
	g__BEGIN_DECLS


35 
	#_STDLIB_H
 1

	)

37 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


39 
	~<b™s/wa™æags.h
>

40 
	~<b™s/wa™¡©us.h
>

43 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (¡©us)

	)

44 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (¡©us)

	)

45 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (¡©us)

	)

46 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (¡©us)

	)

47 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (¡©us)

	)

48 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (¡©us)

	)

49 #ifdeà
__WIFCONTINUED


50 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (¡©us)

	)

55 
	~<b™s/æßŠ.h
>

60 
	mquÙ
;

61 
	m»m
;

62 } 
	tdiv_t
;

65 #iâdeà
__ldiv_t_defšed


68 
	mquÙ
;

69 
	m»m
;

70 } 
	tldiv_t
;

71 
	#__ldiv_t_defšed
 1

	)

74 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


76 
__ex‹nsiÚ__
 struct

78 
	mquÙ
;

79 
	m»m
;

80 } 
	tÎdiv_t
;

81 
	#__Îdiv_t_defšed
 1

	)

86 
	#RAND_MAX
 2147483647

	)

91 
	#EXIT_FAILURE
 1

	)

92 
	#EXIT_SUCCESS
 0

	)

96 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

97 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

101 
	$©of
 (cÚ¡ *
__ÅŒ
)

102 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

104 
	$©oi
 (cÚ¡ *
__ÅŒ
)

105 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

107 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

108 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

110 #ifdeà
__USE_ISOC99


112 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

113 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

117 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

118 **
__»¡riù
 
__’d±r
)

119 
__THROW
 
	`__nÚnuÎ
 ((1));

121 #ifdef 
__USE_ISOC99


123 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

124 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

126 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

127 **
__»¡riù
 
__’d±r
)

128 
__THROW
 
	`__nÚnuÎ
 ((1));

133 #ià
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
_Flßt16
 
	$¡¹of16
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

135 **
__»¡riù
 
__’d±r
)

136 
__THROW
 
	`__nÚnuÎ
 ((1));

139 #ià
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

140 
_Flßt32
 
	$¡¹of32
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

141 **
__»¡riù
 
__’d±r
)

142 
__THROW
 
	`__nÚnuÎ
 ((1));

145 #ià
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

146 
_Flßt64
 
	$¡¹of64
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

147 **
__»¡riù
 
__’d±r
)

148 
__THROW
 
	`__nÚnuÎ
 ((1));

151 #ià
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

152 
_Flßt128
 
	$¡¹of128
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

153 **
__»¡riù
 
__’d±r
)

154 
__THROW
 
	`__nÚnuÎ
 ((1));

157 #ià
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

158 
_Flßt32x
 
	$¡¹of32x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

159 **
__»¡riù
 
__’d±r
)

160 
__THROW
 
	`__nÚnuÎ
 ((1));

163 #ià
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

164 
_Flßt64x
 
	$¡¹of64x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

169 #ià
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

170 
_Flßt128x
 
	$¡¹of128x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

171 **
__»¡riù
 
__’d±r
)

172 
__THROW
 
	`__nÚnuÎ
 ((1));

176 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

177 **
__»¡riù
 
__’d±r
, 
__ba£
)

178 
__THROW
 
	`__nÚnuÎ
 ((1));

180 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

181 **
__»¡riù
 
__’d±r
, 
__ba£
)

182 
__THROW
 
	`__nÚnuÎ
 ((1));

184 #ifdeà
__USE_MISC


186 
__ex‹nsiÚ__


187 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

191 
__ex‹nsiÚ__


192 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

193 **
__»¡riù
 
__’d±r
, 
__ba£
)

194 
__THROW
 
	`__nÚnuÎ
 ((1));

197 #ifdeà
__USE_ISOC99


199 
__ex‹nsiÚ__


200 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

204 
__ex‹nsiÚ__


205 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

206 **
__»¡riù
 
__’d±r
, 
__ba£
)

207 
__THROW
 
	`__nÚnuÎ
 ((1));

211 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

212 
	$¡räomd
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

213 
__f
)

214 
__THROW
 
	`__nÚnuÎ
 ((3));

216 
	$¡räomf
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

217 
__f
)

218 
__THROW
 
	`__nÚnuÎ
 ((3));

220 
	$¡räoml
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

221 
__f
)

222 
__THROW
 
	`__nÚnuÎ
 ((3));

225 #ià
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

226 
	$¡räomf16
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

227 
_Flßt16
 
__f
)

228 
__THROW
 
	`__nÚnuÎ
 ((3));

231 #ià
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

232 
	$¡räomf32
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

233 
_Flßt32
 
__f
)

234 
__THROW
 
	`__nÚnuÎ
 ((3));

237 #ià
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

238 
	$¡räomf64
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

239 
_Flßt64
 
__f
)

240 
__THROW
 
	`__nÚnuÎ
 ((3));

243 #ià
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

244 
	$¡räomf128
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

245 
_Flßt128
 
__f
)

246 
__THROW
 
	`__nÚnuÎ
 ((3));

249 #ià
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

250 
	$¡räomf32x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

251 
_Flßt32x
 
__f
)

252 
__THROW
 
	`__nÚnuÎ
 ((3));

255 #ià
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

256 
	$¡räomf64x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

257 
_Flßt64x
 
__f
)

258 
__THROW
 
	`__nÚnuÎ
 ((3));

261 #ià
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

262 
	$¡räomf128x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

263 
_Flßt128x
 
__f
)

264 
__THROW
 
	`__nÚnuÎ
 ((3));

268 #ifdeà
__USE_GNU


272 
	~<b™s/ty³s/loÿË_t.h
>

274 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

275 **
__»¡riù
 
__’d±r
, 
__ba£
,

276 
loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

278 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

279 **
__»¡riù
 
__’d±r
,

280 
__ba£
, 
loÿË_t
 
__loc
)

281 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

283 
__ex‹nsiÚ__


284 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

285 **
__»¡riù
 
__’d±r
, 
__ba£
,

286 
loÿË_t
 
__loc
)

287 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

289 
__ex‹nsiÚ__


290 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

291 **
__»¡riù
 
__’d±r
,

292 
__ba£
, 
loÿË_t
 
__loc
)

293 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

295 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

296 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

297 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

299 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

300 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

301 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

303 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

304 **
__»¡riù
 
__’d±r
,

305 
loÿË_t
 
__loc
)

306 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

308 #ià
__HAVE_FLOAT16


309 
_Flßt16
 
	$¡¹of16_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

310 **
__»¡riù
 
__’d±r
,

311 
loÿË_t
 
__loc
)

312 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

315 #ià
__HAVE_FLOAT32


316 
_Flßt32
 
	$¡¹of32_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

317 **
__»¡riù
 
__’d±r
,

318 
loÿË_t
 
__loc
)

319 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

322 #ià
__HAVE_FLOAT64


323 
_Flßt64
 
	$¡¹of64_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

324 **
__»¡riù
 
__’d±r
,

325 
loÿË_t
 
__loc
)

326 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

329 #ià
__HAVE_FLOAT128


330 
_Flßt128
 
	$¡¹of128_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 **
__»¡riù
 
__’d±r
,

332 
loÿË_t
 
__loc
)

333 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

336 #ià
__HAVE_FLOAT32X


337 
_Flßt32x
 
	$¡¹of32x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

338 **
__»¡riù
 
__’d±r
,

339 
loÿË_t
 
__loc
)

340 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

343 #ià
__HAVE_FLOAT64X


344 
_Flßt64x
 
	$¡¹of64x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

345 **
__»¡riù
 
__’d±r
,

346 
loÿË_t
 
__loc
)

347 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

350 #ià
__HAVE_FLOAT128X


351 
_Flßt128x
 
	$¡¹of128x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

352 **
__»¡riù
 
__’d±r
,

353 
loÿË_t
 
__loc
)

354 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

359 #ifdeà
__USE_EXTERN_INLINES


360 
__ex‹º_šlše
 

361 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

363  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

364 
	}
}

365 
__ex‹º_šlše
 

366 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

368  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

369 
	}
}

371 #ifdeà
__USE_ISOC99


372 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

373 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

375  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

376 
	}
}

381 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


385 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

388 
	$a64l
 (cÚ¡ *
__s
)

389 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

393 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


394 
	~<sys/ty³s.h
>

401 
	$¿ndom
 (è
__THROW
;

404 
	$¤ªdom
 (
__£ed
è
__THROW
;

410 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

411 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

415 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

418 #ifdeà
__USE_MISC


423 
	s¿ndom_d©a


425 
št32_t
 *
åŒ
;

426 
št32_t
 *
½Œ
;

427 
št32_t
 *
¡©e
;

428 
¿nd_ty³
;

429 
¿nd_deg
;

430 
¿nd_£p
;

431 
št32_t
 *
’d_±r
;

434 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

435 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

437 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

438 
__THROW
 
	`__nÚnuÎ
 ((2));

440 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

441 
size_t
 
__¡©–’
,

442 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

443 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

445 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

446 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

447 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

453 
	$¿nd
 (è
__THROW
;

455 
	$¤ªd
 (
__£ed
è
__THROW
;

457 #ifdeà
__USE_POSIX199506


459 
	$¿nd_r
 (*
__£ed
è
__THROW
;

463 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


467 
	$d¿nd48
 (è
__THROW
;

468 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

471 
	$Ìªd48
 (è
__THROW
;

472 
	$Äªd48
 (
__xsubi
[3])

473 
__THROW
 
	`__nÚnuÎ
 ((1));

476 
	$m¿nd48
 (è
__THROW
;

477 
	$j¿nd48
 (
__xsubi
[3])

478 
__THROW
 
	`__nÚnuÎ
 ((1));

481 
	$¤ªd48
 (
__£edv®
è
__THROW
;

482 *
	$£ed48
 (
__£ed16v
[3])

483 
__THROW
 
	`__nÚnuÎ
 ((1));

484 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

486 #ifdeà
__USE_MISC


490 
	sd¿nd48_d©a


492 
__x
[3];

493 
__Şd_x
[3];

494 
__c
;

495 
__š™
;

496 
__ex‹nsiÚ__
 
__a
;

501 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

502 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

503 
	$”ªd48_r
 (
__xsubi
[3],

504 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

505 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

508 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

509 *
__»¡riù
 
__»suÉ
)

510 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

511 
	$Äªd48_r
 (
__xsubi
[3],

512 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

513 *
__»¡riù
 
__»suÉ
)

514 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

517 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

518 *
__»¡riù
 
__»suÉ
)

519 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

520 
	$j¿nd48_r
 (
__xsubi
[3],

521 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

522 *
__»¡riù
 
__»suÉ
)

523 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

526 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

527 
__THROW
 
	`__nÚnuÎ
 ((2));

529 
	$£ed48_r
 (
__£ed16v
[3],

530 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

532 
	$lcÚg48_r
 (
__·¿m
[7],

533 
d¿nd48_d©a
 *
__bufãr
)

534 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

539 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

541 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

542 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

549 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

550 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

552 #ifdeà
__USE_GNU


558 *
	$»®loÿ¼ay
 (*
__±r
, 
size_t
 
__nmemb
, size_ˆ
__size
)

559 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

563 
	$ä“
 (*
__±r
è
__THROW
;

565 #ifdeà
__USE_MISC


566 
	~<®loÿ.h
>

569 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

570 || 
defšed
 
__USE_MISC


572 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

575 #ifdeà
__USE_XOPEN2K


577 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

578 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

581 #ifdeà
__USE_ISOC11


583 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

584 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

588 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

592 
	$©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

594 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


596 #ifdeà
__ılu¥lus


597 "C++" 
	$©_quick_ex™
 ((*
__func
) ())

598 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

600 
	$©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

604 #ifdef 
__USE_MISC


607 
	$Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

608 
__THROW
 
	`__nÚnuÎ
 ((1));

614 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

616 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


620 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

623 #ifdeà
__USE_ISOC99


626 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

631 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

633 #ifdeà
__USE_GNU


636 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

637 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

640 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


644 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

647 #ifdeà
__USE_XOPEN2K


650 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

651 
__THROW
 
	`__nÚnuÎ
 ((2));

654 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

657 #ifdef 
__USE_MISC


661 
	$ş—»nv
 (è
__THROW
;

665 #ià
defšed
 
__USE_MISC
 \

666 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

672 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

675 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


684 #iâdeà
__USE_FILE_OFFSET64


685 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

687 #ifdeà
__REDIRECT


688 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

689 
	`__nÚnuÎ
 ((1)è
__wur
;

691 
	#mk¡emp
 
mk¡emp64


	)

694 #ifdeà
__USE_LARGEFILE64


695 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

699 #ifdeà
__USE_MISC


706 #iâdeà
__USE_FILE_OFFSET64


707 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

709 #ifdeà
__REDIRECT


710 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

711 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

713 
	#mk¡emps
 
mk¡emps64


	)

716 #ifdeà
__USE_LARGEFILE64


717 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

718 
	`__nÚnuÎ
 ((1)è
__wur
;

722 #ifdeà
__USE_XOPEN2K8


728 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

731 #ifdeà
__USE_GNU


738 #iâdeà
__USE_FILE_OFFSET64


739 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

741 #ifdeà
__REDIRECT


742 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

743 
	`__nÚnuÎ
 ((1)è
__wur
;

745 
	#mko¡emp
 
mko¡emp64


	)

748 #ifdeà
__USE_LARGEFILE64


749 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

758 #iâdeà
__USE_FILE_OFFSET64


759 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

760 
	`__nÚnuÎ
 ((1)è
__wur
;

762 #ifdeà
__REDIRECT


763 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

764 
__æags
), 
mko¡emps64
)

765 
	`__nÚnuÎ
 ((1)è
__wur
;

767 
	#mko¡emps
 
mko¡emps64


	)

770 #ifdeà
__USE_LARGEFILE64


771 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

772 
	`__nÚnuÎ
 ((1)è
__wur
;

781 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

784 #ifdef 
__USE_GNU


787 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

788 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

791 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


797 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

798 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

803 #iâdeà
__COMPAR_FN_T


804 
	#__COMPAR_FN_T


	)

805 (*
	t__com·r_â_t
) (const *, const *);

807 #ifdef 
__USE_GNU


808 
__com·r_â_t
 
	tcom·risÚ_â_t
;

811 #ifdeà
__USE_GNU


812 (*
	t__com·r_d_â_t
) (const *, const *, *);

817 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

818 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

819 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

821 #ifdeà
__USE_EXTERN_INLINES


822 
	~<b™s/¡dlib-b£¬ch.h
>

827 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

828 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

829 #ifdeà
__USE_GNU


830 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

831 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

832 
	`__nÚnuÎ
 ((1, 4));

837 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

838 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

840 #ifdeà
__USE_ISOC99


841 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

842 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

849 
div_t
 
	$div
 (
__num”
, 
__d’om
)

850 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

851 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

852 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

854 #ifdeà
__USE_ISOC99


855 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

856 
__d’om
)

857 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

861 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

862 || 
defšed
 
__USE_MISC


869 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

870 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

875 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

876 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

881 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

882 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

885 #ifdeà
__USE_MISC


887 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

888 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

889 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

890 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

891 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

892 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

893 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

894 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

899 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

900 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

901 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

902 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

903 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

904 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

906 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

907 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

908 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

909 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

910 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

911 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

912 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

913 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

919 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

922 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

923 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

926 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

930 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

931 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

933 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

934 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

935 
__THROW
;

938 #ifdeà
__USE_MISC


943 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

947 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


954 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

955 *cÚ¡ *
__»¡riù
 
__tok’s
,

956 **
__»¡riù
 
__v®u•
)

957 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

961 #ifdeà
__USE_XOPEN


963 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

969 #ifdeà
__USE_XOPEN2KXSI


971 
	$posix_İ’±
 (
__oæag
è
__wur
;

974 #ifdeà
__USE_XOPEN_EXTENDED


979 
	$g¿Á±
 (
__fd
è
__THROW
;

983 
	$uÆock±
 (
__fd
è
__THROW
;

988 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

991 #ifdeà
__USE_GNU


995 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

996 
__THROW
 
	`__nÚnuÎ
 ((2));

999 
	`g‘±
 ();

1002 #ifdeà
__USE_MISC


1006 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

1007 
__THROW
 
	`__nÚnuÎ
 ((1));

1010 #ià
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K


1013 
	$‰y¦Ù
 (è
__THROW
;

1016 
	~<b™s/¡dlib-æßt.h
>

1019 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1020 
	~<b™s/¡dlib.h
>

1022 #ifdeà
__LDBL_COMPAT


1023 
	~<b™s/¡dlib-ldbl.h
>

1026 
__END_DECLS


	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

28 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

36 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

37 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

42 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

43 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

46 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

47 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

52 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


53 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

54 
__c
, 
size_t
 
__n
)

55 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

60 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

63 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

64 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

67 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


70 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

71 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

72 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

75 #ifdeà
__OPTIMIZE__


76 
__ex‹º_®ways_šlše
 *

77 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


79  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

82 
__ex‹º_®ways_šlše
 const *

83 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


85  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

88 
	}
}

90 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

91 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

94 #ifdeà
__USE_GNU


97 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


98 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

99 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

100 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

101 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

103 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

104 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

108 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


109 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

110 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

111 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

112 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

114 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

121 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

122 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

124 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

125 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

126 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

129 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

132 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

133 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

136 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

137 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

139 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

140 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

143 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

144 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

146 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

147 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

148 
__THROW
 
	`__nÚnuÎ
 ((2));

150 #ifdeà
__USE_XOPEN2K8


152 
	~<b™s/ty³s/loÿË_t.h
>

155 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
loÿË_t
 
__l
)

156 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

159 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

160 
loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

163 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8
 \

164 || 
	$__GLIBC_USE
 (
LIB_EXT2
))

166 *
	$¡rdup
 (cÚ¡ *
__s
)

167 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

173 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

174 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

175 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

178 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


180 
	#¡rdu·
(
s
) \

181 (
__ex‹nsiÚ__
 \

183 cÚ¡ *
__Şd
 = (
s
); \

184 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

185 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

186 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

187 
	}
}))

	)

190 
	#¡ºdu·
(
s
, 
n
) \

191 (
__ex‹nsiÚ__
 \

193 cÚ¡ *
__Şd
 = (
s
); \

194 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

195 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

196 
__Ãw
[
__Ën
] = '\0'; \

197 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

198 }))

	)

202 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


205 *
¡rchr
 (*
__s
, 
__c
)

206 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

207 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

208 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

210 #ifdeà
__OPTIMIZE__


211 
__ex‹º_®ways_šlše
 *

212 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


214  
__butš_¡rchr
 (
__s
, 
__c
);

217 
__ex‹º_®ways_šlše
 const *

218 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


220  
__butš_¡rchr
 (
__s
, 
__c
);

225 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

226 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

229 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


232 *
	`¡¼chr
 (*
__s
, 
__c
)

233 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

234 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

235 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

237 #ifdeà
__OPTIMIZE__


238 
__ex‹º_®ways_šlše
 *

239 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


241  
	`__butš_¡¼chr
 (
__s
, 
__c
);

244 
__ex‹º_®ways_šlše
 const *

245 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


247  
	`__butš_¡¼chr
 (
__s
, 
__c
);

250 
	}
}

252 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

253 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

256 #ifdeà
__USE_GNU


259 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


260 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

261 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

262 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

263 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

265 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

266 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

272 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

273 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

276 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

277 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

279 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


282 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

283 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

284 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

285 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

287 #ifdeà
__OPTIMIZE__


288 
__ex‹º_®ways_šlše
 *

289 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


291  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

294 
__ex‹º_®ways_šlše
 const *

295 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


297  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

300 
	}
}

302 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

303 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

306 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


309 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

310 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

311 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

312 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

314 #ifdeà
__OPTIMIZE__


315 
__ex‹º_®ways_šlše
 *

316 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


318  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

321 
__ex‹º_®ways_šlše
 const *

322 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


324  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

327 
	}
}

329 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

330 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

335 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

336 
__THROW
 
	`__nÚnuÎ
 ((2));

340 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

341 cÚ¡ *
__»¡riù
 
__d–im
,

342 **
__»¡riù
 
__§ve_±r
)

343 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

344 #ifdeà
__USE_POSIX


345 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

346 **
__»¡riù
 
__§ve_±r
)

347 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

350 #ifdeà
__USE_GNU


352 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


353 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

354 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

355 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

356 cÚ¡ *
__ÃedË
)

357 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

359 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

360 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

364 #ifdeà
__USE_GNU


368 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

369 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

370 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

374 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

375 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

376 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

377 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

378 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

379 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

384 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

385 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

387 #ifdef 
__USE_XOPEN2K8


390 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

391 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

396 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

397 #ifdeà
__USE_XOPEN2K


405 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


408 #ifdeà
__REDIRECT_NTH


409 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

410 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

411 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

413 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

414 
__THROW
 
	`__nÚnuÎ
 ((2));

415 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

420 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

421 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

425 #ifdeà
__USE_XOPEN2K8


427 *
	$¡»¼Ü_l
 (
__”ºum
, 
loÿË_t
 
__l
è
__THROW
;

430 #ifdeà
__USE_MISC


431 
	~<¡ršgs.h
>

435 
	$ex¶ic™_bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

439 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

440 cÚ¡ *
__»¡riù
 
__d–im
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

444 #ifdef 
__USE_XOPEN2K8


446 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

449 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

450 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

451 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

452 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

456 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

457 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

458 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

460 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

461 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

464 #ifdef 
__USE_GNU


466 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

467 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

470 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

473 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

475 #iâdeà
ba£Çme


480 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


481 "C++" *
	$ba£Çme
 (*
__f’ame
)

482 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

483 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

484 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

486 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

491 #ià
	`__GNUC_PREREQ
 (3,4)

492 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


494 
	~<b™s/¡ršg_fÜtif›d.h
>

498 
__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


23 
	#_TIME_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 
	#__Ãed_NULL


	)

29 
	~<¡ddef.h
>

33 
	~<b™s/time.h
>

37 
	~<b™s/ty³s/şock_t.h
>

38 
	~<b™s/ty³s/time_t.h
>

39 
	~<b™s/ty³s/¡ruù_tm.h
>

41 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_ISOC11


42 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

45 #ifdeà
__USE_POSIX199309


46 
	~<b™s/ty³s/şockid_t.h
>

47 
	~<b™s/ty³s/tim”_t.h
>

48 
	~<b™s/ty³s/¡ruù_™im”¥ec.h
>

49 
	gsigev’t
;

52 #ifdeà
__USE_XOPEN2K


53 #iâdeà
__pid_t_defšed


54 
__pid_t
 
	tpid_t
;

55 
	#__pid_t_defšed


	)

59 #ifdeà
__USE_XOPEN2K8


60 
	~<b™s/ty³s/loÿË_t.h
>

63 #ifdeà
__USE_ISOC11


65 
	#TIME_UTC
 1

	)

68 
__BEGIN_DECLS


72 
şock_t
 
	$şock
 (è
__THROW
;

75 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

78 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

79 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

82 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

88 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

89 cÚ¡ *
__»¡riù
 
__fÜm©
,

90 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

92 #ifdeà
__USE_XOPEN


95 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

96 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

97 
__THROW
;

100 #ifdeà
__USE_XOPEN2K8


104 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

105 cÚ¡ *
__»¡riù
 
__fÜm©
,

106 cÚ¡ 
tm
 *
__»¡riù
 
__
,

107 
loÿË_t
 
__loc
è
__THROW
;

110 #ifdeà
__USE_GNU


111 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

112 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

113 
loÿË_t
 
__loc
è
__THROW
;

119 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

123 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

125 #ifdeà
__USE_POSIX


128 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

129 
tm
 *
__»¡riù
 
__
è
__THROW
;

133 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

134 
tm
 *
__»¡riù
 
__
è
__THROW
;

139 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

142 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

144 #ifdeà
__USE_POSIX


149 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

150 *
__»¡riù
 
__buf
è
__THROW
;

153 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

154 *
__»¡riù
 
__buf
è
__THROW
;

159 *
__tzÇme
[2];

160 
__daylight
;

161 
__timezÚe
;

164 #ifdef 
__USE_POSIX


166 *
tzÇme
[2];

170 
	$tz£t
 (è
__THROW
;

173 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


174 
daylight
;

175 
timezÚe
;

178 #ifdeà
__USE_MISC


181 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

187 
	#__i¦—p
(
y—r
) \

188 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

191 #ifdeà
__USE_MISC


196 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

199 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

202 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

206 #ifdeà
__USE_POSIX199309


211 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

212 
time¥ec
 *
__»maššg
);

216 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

219 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

222 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

223 
__THROW
;

225 #ifdeà
__USE_XOPEN2K


230 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

231 cÚ¡ 
time¥ec
 *
__»q
,

232 
time¥ec
 *
__»m
);

235 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

240 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

241 
sigev’t
 *
__»¡riù
 
__evp
,

242 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

245 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

248 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

249 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

250 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

253 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

254 
__THROW
;

257 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

261 #ifdeà
__USE_ISOC11


263 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

264 
__THROW
 
	`__nÚnuÎ
 ((1));

268 #ifdeà
__USE_XOPEN_EXTENDED


280 
g‘d©e_”r
;

289 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

292 #ifdeà
__USE_GNU


303 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

304 
tm
 *
__»¡riù
 
__»sbuå
);

307 
__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

70 
	#_POSIX2_C_VERSION
 
__POSIX2_THIS_VERSION


	)

74 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

78 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

82 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

86 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

89 #ifdeà
__USE_XOPEN2K8


90 
	#_XOPEN_VERSION
 700

	)

91 #–ià
defšed
 
__USE_XOPEN2K


92 
	#_XOPEN_VERSION
 600

	)

93 #–ià
defšed
 
__USE_UNIX98


94 
	#_XOPEN_VERSION
 500

	)

96 
	#_XOPEN_VERSION
 4

	)

100 
	#_XOPEN_XCU_VERSION
 4

	)

103 
	#_XOPEN_XPG2
 1

	)

104 
	#_XOPEN_XPG3
 1

	)

105 
	#_XOPEN_XPG4
 1

	)

108 
	#_XOPEN_UNIX
 1

	)

111 
	#_XOPEN_CRYPT
 1

	)

115 
	#_XOPEN_ENH_I18N
 1

	)

118 
	#_XOPEN_LEGACY
 1

	)

205 
	~<b™s/posix_İt.h
>

208 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


209 
	~<b™s/’vœÚm’ts.h
>

213 
	#STDIN_FILENO
 0

	)

214 
	#STDOUT_FILENO
 1

	)

215 
	#STDERR_FILENO
 2

	)

220 
	~<b™s/ty³s.h
>

222 #iâdef 
__ssize_t_defšed


223 
__ssize_t
 
	tssize_t
;

224 
	#__ssize_t_defšed


	)

227 
	#__Ãed_size_t


	)

228 
	#__Ãed_NULL


	)

229 
	~<¡ddef.h
>

231 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


234 #iâdeà
__gid_t_defšed


235 
__gid_t
 
	tgid_t
;

236 
	#__gid_t_defšed


	)

239 #iâdeà
__uid_t_defšed


240 
__uid_t
 
	tuid_t
;

241 
	#__uid_t_defšed


	)

244 #iâdeà
__off_t_defšed


245 #iâdeà
__USE_FILE_OFFSET64


246 
__off_t
 
	toff_t
;

248 
__off64_t
 
	toff_t
;

250 
	#__off_t_defšed


	)

252 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


253 
__off64_t
 
	toff64_t
;

254 
	#__off64_t_defšed


	)

257 #iâdeà
__u£cÚds_t_defšed


258 
__u£cÚds_t
 
	tu£cÚds_t
;

259 
	#__u£cÚds_t_defšed


	)

262 #iâdeà
__pid_t_defšed


263 
__pid_t
 
	tpid_t
;

264 
	#__pid_t_defšed


	)

268 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


269 #iâdeà
__šŒ_t_defšed


270 
__šŒ_t
 
	tšŒ_t
;

271 
	#__šŒ_t_defšed


	)

275 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


276 #iâdeà
__sockËn_t_defšed


277 
__sockËn_t
 
	tsockËn_t
;

278 
	#__sockËn_t_defšed


	)

284 
	#R_OK
 4

	)

285 
	#W_OK
 2

	)

286 
	#X_OK
 1

	)

287 
	#F_OK
 0

	)

290 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

292 #ifdeà
__USE_GNU


295 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

296 
__THROW
 
	`__nÚnuÎ
 ((1));

299 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

300 
__THROW
 
	`__nÚnuÎ
 ((1));

303 #ifdeà
__USE_ATFILE


307 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

308 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

313 #iâdef 
_STDIO_H


314 
	#SEEK_SET
 0

	)

315 
	#SEEK_CUR
 1

	)

316 
	#SEEK_END
 2

	)

317 #ifdeà
__USE_GNU


318 
	#SEEK_DATA
 3

	)

319 
	#SEEK_HOLE
 4

	)

323 #ià
defšed
 
__USE_MISC
 && !defšed 
L_SET


325 
	#L_SET
 
SEEK_SET


	)

326 
	#L_INCR
 
SEEK_CUR


	)

327 
	#L_XTND
 
SEEK_END


	)

336 #iâdeà
__USE_FILE_OFFSET64


337 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

339 #ifdeà
__REDIRECT_NTH


340 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

341 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

342 
l£ek64
);

344 
	#l£ek
 
l£ek64


	)

347 #ifdeà
__USE_LARGEFILE64


348 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

349 
__THROW
;

356 
	`şo£
 (
__fd
);

363 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

369 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

371 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


372 #iâdeà
__USE_FILE_OFFSET64


379 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

380 
__off_t
 
__off£t
è
__wur
;

387 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

388 
__off_t
 
__off£t
è
__wur
;

390 #ifdeà
__REDIRECT


391 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

392 
__off64_t
 
__off£t
),

393 
´—d64
è
__wur
;

394 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

395 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

396 
pwr™e64
è
__wur
;

398 
	#´—d
 
´—d64


	)

399 
	#pwr™e
 
pwr™e64


	)

403 #ifdeà
__USE_LARGEFILE64


407 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

408 
__off64_t
 
__off£t
è
__wur
;

411 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

412 
__off64_t
 
__off£t
è
__wur
;

420 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

422 #ifdeà
__USE_GNU


425 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

435 
	$®¬m
 (
__£cÚds
è
__THROW
;

447 
	`¦“p
 (
__£cÚds
);

449 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

450 || 
defšed
 
__USE_MISC


455 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

456 
__THROW
;

463 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

472 
	`·u£
 ();

476 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

477 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

479 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


481 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

486 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

487 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

491 #ifdeà
__USE_ATFILE


494 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

495 
__gid_t
 
__group
, 
__æag
)

496 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

500 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

502 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


504 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

514 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

516 #ifdef 
__USE_GNU


520 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

523 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

524 || 
defšed
 
__USE_MISC


528 *
	$g‘wd
 (*
__buf
)

529 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

534 
	$dup
 (
__fd
è
__THROW
 
__wur
;

537 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

539 #ifdeà
__USE_GNU


542 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

546 **
__’vœÚ
;

547 #ifdeà
__USE_GNU


548 **
’vœÚ
;

554 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

555 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

557 #ifdeà
__USE_XOPEN2K8


560 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

561 
__THROW
 
	`__nÚnuÎ
 ((2));

566 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

567 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

571 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

572 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

576 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

577 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

581 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

582 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

588 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

590 #ifdeà
__USE_GNU


593 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

594 *cÚ¡ 
__’vp
[])

595 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

599 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


601 
	$niû
 (
__šc
è
__THROW
 
__wur
;

606 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

612 
	~<b™s/cÚâame.h
>

615 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

616 
__THROW
 
	`__nÚnuÎ
 ((1));

619 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

622 
	$syscÚf
 (
__Çme
è
__THROW
;

624 #ifdef 
__USE_POSIX2


626 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

631 
__pid_t
 
	$g‘pid
 (è
__THROW
;

634 
__pid_t
 
	$g‘µid
 (è
__THROW
;

637 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

640 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

641 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


642 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

649 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

651 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


663 
	$£g½
 (è
__THROW
;

670 
__pid_t
 
	$£tsid
 (è
__THROW
;

672 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


674 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

678 
__uid_t
 
	$g‘uid
 (è
__THROW
;

681 
__uid_t
 
	$g‘euid
 (è
__THROW
;

684 
__gid_t
 
	$g‘gid
 (è
__THROW
;

687 
__gid_t
 
	$g‘egid
 (è
__THROW
;

692 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

694 #ifdef 
__USE_GNU


696 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

703 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

705 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


708 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

711 #ifdeà
__USE_XOPEN2K


713 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

720 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

722 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


725 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

728 #ifdeà
__USE_XOPEN2K


730 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

733 #ifdeà
__USE_GNU


736 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

737 
__THROW
;

741 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

742 
__THROW
;

746 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

747 
__THROW
 
__wur
;

751 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

752 
__THROW
 
__wur
;

759 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

761 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

762 || 
defšed
 
__USE_MISC


767 
__pid_t
 
	$vfÜk
 (è
__THROW
;

773 *
	$‰yÇme
 (
__fd
è
__THROW
;

777 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

778 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

782 
	$i§‰y
 (
__fd
è
__THROW
;

784 #ifdeà
__USE_MISC


787 
	$‰y¦Ù
 (è
__THROW
;

792 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

793 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

795 #ifdeà
__USE_ATFILE


798 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

799 cÚ¡ *
__to
, 
__æags
)

800 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

803 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


805 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

806 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

811 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

812 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

813 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

816 #ifdeà
__USE_ATFILE


818 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

819 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

822 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

823 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

824 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

828 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

830 #ifdeà
__USE_ATFILE


832 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

833 
__THROW
 
	`__nÚnuÎ
 ((2));

837 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

841 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

844 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

851 *
	`g‘logš
 ();

852 #ifdeà
__USE_POSIX199506


859 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

862 #ifdef 
__USE_MISC


864 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

868 #ifdef 
__USE_POSIX2


872 
	~<b™s/g‘İt_posix.h
>

876 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


880 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

884 #ià
defšed
 
__USE_MISC


887 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

888 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

892 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

898 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

899 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

900 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

901 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

907 
	$vhªgup
 (è
__THROW
;

910 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

918 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

919 
size_t
 
__off£t
, 
__sÿË
)

920 
__THROW
 
	`__nÚnuÎ
 ((1));

926 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

930 *
	$g‘u£rsh–l
 (è
__THROW
;

931 
	$’du£rsh–l
 (è
__THROW
;

932 
	$£tu£rsh–l
 (è
__THROW
;

938 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

942 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

945 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

949 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

957 
	`fsync
 (
__fd
);

960 #ifdeà
__USE_GNU


963 
	$syncfs
 (
__fd
è
__THROW
;

967 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


970 
	`g‘ho¡id
 ();

973 
	$sync
 (è
__THROW
;

976 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K


979 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

984 
	$g‘dbËsize
 (è
__THROW
;

990 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


993 #iâdeà
__USE_FILE_OFFSET64


994 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

995 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

997 #ifdeà
__REDIRECT_NTH


998 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

999 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

1000 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1002 
	#Œunÿ‹
 
Œunÿ‹64


	)

1005 #ifdeà
__USE_LARGEFILE64


1006 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1007 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1012 #ià
defšed
 
__USE_POSIX199309
 \

1013 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1016 #iâdeà
__USE_FILE_OFFSET64


1017 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1019 #ifdeà
__REDIRECT_NTH


1020 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1021 
árunÿ‹64
è
__wur
;

1023 
	#árunÿ‹
 
árunÿ‹64


	)

1026 #ifdeà
__USE_LARGEFILE64


1027 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1033 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1034 || 
defšed
 
__USE_MISC


1038 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1044 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1048 #ifdeà
__USE_MISC


1059 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1064 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1076 
	#F_ULOCK
 0

	)

1077 
	#F_LOCK
 1

	)

1078 
	#F_TLOCK
 2

	)

1079 
	#F_TEST
 3

	)

1081 #iâdeà
__USE_FILE_OFFSET64


1082 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1084 #ifdeà
__REDIRECT


1085 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1086 
lockf64
è
__wur
;

1088 
	#lockf
 
lockf64


	)

1091 #ifdeà
__USE_LARGEFILE64


1092 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1097 #ifdeà
__USE_GNU


1102 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1103 (
__ex‹nsiÚ__
 \

1104 ({ 
__»suÉ
; \

1105 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1106 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1107 
__»suÉ
; 
	}
}))

	)

1110 
ssize_t
 
cİy_fe_¿nge
 (
__šfd
, 
__off64_t
 *
__pšoff
,

1111 
__outfd
, 
__off64_t
 *
__poutoff
,

1112 
size_t
 
__Ëngth
, 
__æags
);

1115 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1118 
fd©async
 (
__fdes
);

1124 #ifdef 
__USE_XOPEN


1126 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1127 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1131 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1132 
__THROW
 
	`__nÚnuÎ
 ((1));

1139 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1140 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1147 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1149 *
	$ù”mid
 (*
__s
è
__THROW
;

1152 *
	`cu£rid
 (*
__s
);

1158 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_XOPEN2K


1159 
	$±h»ad_©fÜk
 ((*
__´•¬e
) (),

1160 (*
__·»Á
) (),

1161 (*
__chd
è()è
__THROW
;

1164 #ifdeà
__USE_MISC


1167 
	$g‘’Œİy
 (*
__bufãr
, 
size_t
 
__Ëngth
è
__wur
;

1171 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1172 
	~<b™s/uni¡d.h
>

1175 
__END_DECLS


	@/usr/include/wchar.h

23 #iâdeà
_WCHAR_H


24 
	#_WCHAR_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

30 
	~<b™s/æßŠ.h
>

32 
	#__Ãed_size_t


	)

33 
	#__Ãed_wch¬_t


	)

34 
	#__Ãed_NULL


	)

35 
	~<¡ddef.h
>

37 
	#__Ãed___va_li¡


	)

38 
	~<¡d¬g.h
>

40 
	~<b™s/wch¬.h
>

41 
	~<b™s/ty³s/wšt_t.h
>

42 
	~<b™s/ty³s/mb¡©e_t.h
>

43 
	~<b™s/ty³s/__FILE.h
>

45 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


46 
	~<b™s/ty³s/FILE.h
>

48 #ifdeà
__USE_XOPEN2K8


49 
	~<b™s/ty³s/loÿË_t.h
>

53 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

54 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

57 #iâdeà
WCHAR_MIN


59 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

60 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

63 #iâdeà
WEOF


64 
	#WEOF
 (0xffffffffu)

	)

74 #ià(
defšed
 
__USE_XOPEN
 && !defšed 
__USE_GNU
 \

75 && !(
defšed
 
	g__USE_XOPEN2K
 && !defšed 
	g__USE_XOPEN2KXSI
))

76 
	~<b™s/wùy³-wch¬.h
>

79 
__BEGIN_DECLS


83 
	gtm
;

87 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

88 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
)

89 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

92 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

93 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

94 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

97 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

98 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
)

99 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

101 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

102 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

103 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

106 
	$wcscmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
)

107 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

109 
	$wc¢cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

110 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

112 #ifdeà
__USE_XOPEN2K8


114 
	$wcsÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

117 
	$wc¢ÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

118 
size_t
 
__n
è
__THROW
;

122 
	$wcsÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

123 
loÿË_t
 
__loc
è
__THROW
;

125 
	$wc¢ÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

126 
size_t
 
__n
, 
loÿË_t
 
__loc
è
__THROW
;

131 
	$wcscŞl
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

135 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

136 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

138 #ifdeà
__USE_XOPEN2K8


144 
	$wcscŞl_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

145 
loÿË_t
 
__loc
è
__THROW
;

150 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

151 
size_t
 
__n
, 
loÿË_t
 
__loc
è
__THROW
;

154 
wch¬_t
 *
	$wcsdup
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

158 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


159 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

160 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

161 "C++" cÚ¡ 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

162 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

164 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

165 
__THROW
 
__©Œibu‹_pu»__
;

168 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


169 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

170 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

171 "C++" cÚ¡ 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

172 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

174 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

175 
__THROW
 
__©Œibu‹_pu»__
;

178 #ifdeà
__USE_GNU


181 
wch¬_t
 *
	$wcschºul
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

182 
__THROW
 
__©Œibu‹_pu»__
;

187 
size_t
 
	$wcsc¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__»jeù
)

188 
__THROW
 
__©Œibu‹_pu»__
;

191 
size_t
 
	$wcs¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

192 
__THROW
 
__©Œibu‹_pu»__
;

194 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


195 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

196 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

197 "C++" cÚ¡ 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
,

198 cÚ¡ 
wch¬_t
 *
__acû±
)

199 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

201 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

202 
__THROW
 
__©Œibu‹_pu»__
;

205 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


206 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

207 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

208 "C++" cÚ¡ 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

209 cÚ¡ 
wch¬_t
 *
__ÃedË
)

210 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

212 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

213 
__THROW
 
__©Œibu‹_pu»__
;

217 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

218 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__d–im
,

219 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

222 
size_t
 
	$wc¦’
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

224 #ifdeà
__USE_XOPEN


226 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


227 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

228 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

229 "C++" cÚ¡ 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

230 cÚ¡ 
wch¬_t
 *
__ÃedË
)

231 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

233 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

234 
__THROW
 
__©Œibu‹_pu»__
;

238 #ifdeà
__USE_XOPEN2K8


240 
size_t
 
	$wc¢Ën
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

241 
__THROW
 
__©Œibu‹_pu»__
;

246 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


247 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

248 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

249 "C++" cÚ¡ 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

250 
size_t
 
__n
)

251 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

253 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

254 
__THROW
 
__©Œibu‹_pu»__
;

258 
	$wmemcmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

259 
__THROW
 
__©Œibu‹_pu»__
;

262 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

263 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

267 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

268 
__THROW
;

271 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

273 #ifdeà
__USE_GNU


276 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

277 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

278 
__THROW
;

284 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

288 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

292 
	$mbsš™
 (cÚ¡ 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

296 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

297 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

298 
mb¡©e_t
 *
__»¡riù
 
__p
è
__THROW
;

301 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

302 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

305 
size_t
 
	$__mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

306 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

307 
size_t
 
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

308 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

310 #ifdeà
__USE_EXTERN_INLINES


316 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

317 
__ex‹º_šlše
 
wšt_t


318 
	`__NTH
 (
	$btowc
 (
__c
))

319 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

320 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

322 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

323 
__ex‹º_šlše
 

324 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

325 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

326 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

328 
__ex‹º_šlše
 
size_t


329 
__NTH
 (
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

330 
mb¡©e_t
 *
__»¡riù
 
__ps
))

331 {  (
__ps
 !ğ
NULL


332 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

337 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

338 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

339 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

343 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

344 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

345 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

348 #ifdef 
__USE_XOPEN2K8


351 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

352 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

353 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

357 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

358 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

359 
size_t
 
__nwc
, size_ˆ
__Ën
,

360 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

365 #ifdeà
__USE_XOPEN


367 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

371 
	$wcswidth
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

377 
	$wc¡od
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

378 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

380 #ifdeà
__USE_ISOC99


382 
	$wc¡of
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

383 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

384 
	$wc¡Şd
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

385 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

390 #ià
__HAVE_FLOAT16
 && 
defšed
 
__USE_GNU


391 
_Flßt16
 
	$wc¡of16
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

392 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

395 #ià
__HAVE_FLOAT32
 && 
defšed
 
__USE_GNU


396 
_Flßt32
 
	$wc¡of32
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

397 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

400 #ià
__HAVE_FLOAT64
 && 
defšed
 
__USE_GNU


401 
_Flßt64
 
	$wc¡of64
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

402 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

405 #ià
__HAVE_FLOAT128
 && 
defšed
 
__USE_GNU


406 
_Flßt128
 
	$wc¡of128
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

407 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

410 #ià
__HAVE_FLOAT32X
 && 
defšed
 
__USE_GNU


411 
_Flßt32x
 
	$wc¡of32x
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

412 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

415 #ià
__HAVE_FLOAT64X
 && 
defšed
 
__USE_GNU


416 
_Flßt64x
 
	$wc¡of64x
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

417 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

420 #ià
__HAVE_FLOAT128X
 && 
defšed
 
__USE_GNU


421 
_Flßt128x
 
	$wc¡of128x
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

422 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

428 
	$wc¡Ş
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

429 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

433 
	$wc¡oul
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

434 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

435 
__THROW
;

437 #ifdeà
__USE_ISOC99


440 
__ex‹nsiÚ__


441 
	$wc¡Şl
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

442 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

443 
__THROW
;

447 
__ex‹nsiÚ__


448 
	$wc¡ouÎ
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

449 
wch¬_t
 **
__»¡riù
 
__’d±r
,

450 
__ba£
è
__THROW
;

453 #ifdeà
__USE_GNU


456 
__ex‹nsiÚ__


457 
	$wc¡oq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

458 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

459 
__THROW
;

463 
__ex‹nsiÚ__


464 
	$wc¡ouq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

465 
wch¬_t
 **
__»¡riù
 
__’d±r
,

466 
__ba£
è
__THROW
;

469 #ifdeà
__USE_GNU


473 
	$wc¡Ş_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

474 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

475 
loÿË_t
 
__loc
è
__THROW
;

477 
	$wc¡oul_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

478 
wch¬_t
 **
__»¡riù
 
__’d±r
,

479 
__ba£
, 
loÿË_t
 
__loc
è
__THROW
;

481 
__ex‹nsiÚ__


482 
	$wc¡Şl_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

483 
wch¬_t
 **
__»¡riù
 
__’d±r
,

484 
__ba£
, 
loÿË_t
 
__loc
è
__THROW
;

486 
__ex‹nsiÚ__


487 
	$wc¡ouÎ_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

488 
wch¬_t
 **
__»¡riù
 
__’d±r
,

489 
__ba£
, 
loÿË_t
 
__loc
)

490 
__THROW
;

492 
	$wc¡od_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

493 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

494 
__THROW
;

496 
	$wc¡of_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

497 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

498 
__THROW
;

500 
	$wc¡Şd_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

501 
wch¬_t
 **
__»¡riù
 
__’d±r
,

502 
loÿË_t
 
__loc
è
__THROW
;

504 #ià
__HAVE_FLOAT16


505 
_Flßt16
 
	$wc¡of16_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

506 
wch¬_t
 **
__»¡riù
 
__’d±r
,

507 
loÿË_t
 
__loc
è
__THROW
;

510 #ià
__HAVE_FLOAT32


511 
_Flßt32
 
	$wc¡of32_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

512 
wch¬_t
 **
__»¡riù
 
__’d±r
,

513 
loÿË_t
 
__loc
è
__THROW
;

516 #ià
__HAVE_FLOAT64


517 
_Flßt64
 
	$wc¡of64_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

518 
wch¬_t
 **
__»¡riù
 
__’d±r
,

519 
loÿË_t
 
__loc
è
__THROW
;

522 #ià
__HAVE_FLOAT128


523 
_Flßt128
 
	$wc¡of128_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

524 
wch¬_t
 **
__»¡riù
 
__’d±r
,

525 
loÿË_t
 
__loc
è
__THROW
;

528 #ià
__HAVE_FLOAT32X


529 
_Flßt32x
 
	$wc¡of32x_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

530 
wch¬_t
 **
__»¡riù
 
__’d±r
,

531 
loÿË_t
 
__loc
è
__THROW
;

534 #ià
__HAVE_FLOAT64X


535 
_Flßt64x
 
	$wc¡of64x_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

536 
wch¬_t
 **
__»¡riù
 
__’d±r
,

537 
loÿË_t
 
__loc
è
__THROW
;

540 #ià
__HAVE_FLOAT128X


541 
_Flßt128x
 
	$wc¡of128x_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

542 
wch¬_t
 **
__»¡riù
 
__’d±r
,

543 
loÿË_t
 
__loc
è
__THROW
;

548 #ifdeà
__USE_XOPEN2K8


551 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

552 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

556 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

557 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

558 
__THROW
;

564 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

567 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

570 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


573 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

580 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

581 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

587 
	`w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

590 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

591 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

592 
__THROW
 ;

598 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

599 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

600 
__gnuc_va_li¡
 
__¬g
)

606 
	`vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

607 
__gnuc_va_li¡
 
__¬g
)

611 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

612 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

613 
__gnuc_va_li¡
 
__¬g
)

614 
__THROW
 ;

621 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

622 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

628 
	`wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

631 
	$swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

632 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

633 
__THROW
 ;

635 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

636 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

637 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

638 #ifdeà
__REDIRECT


642 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

643 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

644 
__isoc99_fwsÿnf
)

646 
	`__REDIRECT
 (
wsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

647 
__isoc99_wsÿnf
)

649 
	`__REDIRECT_NTH
 (
swsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

650 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

651 ...), 
__isoc99_swsÿnf
)

654 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

655 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

656 
	`__isoc99_wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

657 
	$__isoc99_swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

658 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

659 
__THROW
;

660 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

661 
	#wsÿnf
 
__isoc99_wsÿnf


	)

662 
	#swsÿnf
 
__isoc99_swsÿnf


	)

668 #ifdeà
__USE_ISOC99


673 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

674 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

675 
__gnuc_va_li¡
 
__¬g
)

681 
	`vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

682 
__gnuc_va_li¡
 
__¬g
)

685 
	$vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

686 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

687 
__gnuc_va_li¡
 
__¬g
)

688 
__THROW
 ;

690 #ià!
defšed
 
__USE_GNU
 \

691 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

692 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

693 #ifdeà
__REDIRECT


694 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

695 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

696 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

698 
	`__REDIRECT
 (
vwsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

699 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

701 
	`__REDIRECT_NTH
 (
vswsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

702 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

703 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

706 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

707 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

708 
__gnuc_va_li¡
 
__¬g
);

709 
	`__isoc99_vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

710 
__gnuc_va_li¡
 
__¬g
);

711 
	$__isoc99_vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

712 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

713 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

714 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

715 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

716 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

727 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

728 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

734 
wšt_t
 
	`g‘wch¬
 ();

741 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

742 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

748 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

756 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

757 
__FILE
 *
__»¡riù
 
__¡»am
);

763 
	`åutws
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

764 
__FILE
 *
__»¡riù
 
__¡»am
);

771 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

774 #ifdeà
__USE_GNU


782 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

783 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

791 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

799 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

808 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

809 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

818 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

819 
__FILE
 *
__»¡riù
 
__¡»am
);

827 
	`åutws_uÆocked
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

828 
__FILE
 *
__»¡riù
 
__¡»am
);

835 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

836 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

837 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

839 #ifdeà
__USE_GNU


842 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

843 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

844 cÚ¡ 
tm
 *
__»¡riù
 
__
,

845 
loÿË_t
 
__loc
è
__THROW
;

849 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


850 
	~<b™s/wch¬2.h
>

853 #ifdeà
__LDBL_COMPAT


854 
	~<b™s/wch¬-ldbl.h
>

857 
__END_DECLS


	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_MISC


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_MISC
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

61 
	~<b™s/ušŠ-id’t™y.h
>

63 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


64 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

65 
	#htŞe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

66 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

67 
	#Ë16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

69 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

70 
	#htŞe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

71 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

72 
	#Ë32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

74 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

75 
	#htŞe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

76 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

77 
	#Ë64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

80 
	#htobe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

81 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

82 
	#be16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

83 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

85 
	#htobe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

86 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

87 
	#be32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

88 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

90 
	#htobe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

91 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

92 
	#be64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

93 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

119 #undeà
__USE_ISOC11


120 #undeà
__USE_ISOC99


121 #undeà
__USE_ISOC95


122 #undeà
__USE_ISOCXX11


123 #undeà
__USE_POSIX


124 #undeà
__USE_POSIX2


125 #undeà
__USE_POSIX199309


126 #undeà
__USE_POSIX199506


127 #undeà
__USE_XOPEN


128 #undeà
__USE_XOPEN_EXTENDED


129 #undeà
__USE_UNIX98


130 #undeà
__USE_XOPEN2K


131 #undeà
__USE_XOPEN2KXSI


132 #undeà
__USE_XOPEN2K8


133 #undeà
__USE_XOPEN2K8XSI


134 #undeà
__USE_LARGEFILE


135 #undeà
__USE_LARGEFILE64


136 #undeà
__USE_FILE_OFFSET64


137 #undeà
__USE_MISC


138 #undeà
__USE_ATFILE


139 #undeà
__USE_GNU


140 #undeà
__USE_FORTIFY_LEVEL


141 #undeà
__KERNEL_STRICT_NAMES


142 #undeà
__GLIBC_USE_DEPRECATED_GETS


146 #iâdeà
_LOOSE_KERNEL_NAMES


147 
	#__KERNEL_STRICT_NAMES


	)

157 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


158 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

159 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

161 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

168 #ià
defšed
 
__şªg_majÜ__
 && defšed 
__şªg_mšÜ__


169 
	#__glibc_şªg_´”eq
(
maj
, 
mš
) \

170 ((
__şªg_majÜ__
 << 16è+ 
__şªg_mšÜ__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

172 
	#__glibc_şªg_´”eq
(
maj
, 
mš
è0

	)

176 
	#__GLIBC_USE
(
F
è
__GLIBC_USE_
 ## 
	)
F

182 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

183 && !
defšed
 
	g_DEFAULT_SOURCE


185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

190 #ifdeà
_GNU_SOURCE


191 #undeà
_ISOC95_SOURCE


192 
	#_ISOC95_SOURCE
 1

	)

193 #undeà
_ISOC99_SOURCE


194 
	#_ISOC99_SOURCE
 1

	)

195 #undeà
_ISOC11_SOURCE


196 
	#_ISOC11_SOURCE
 1

	)

197 #undeà
_POSIX_SOURCE


198 
	#_POSIX_SOURCE
 1

	)

199 #undeà
_POSIX_C_SOURCE


200 
	#_POSIX_C_SOURCE
 200809L

	)

201 #undeà
_XOPEN_SOURCE


202 
	#_XOPEN_SOURCE
 700

	)

203 #undeà
_XOPEN_SOURCE_EXTENDED


204 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

205 #undeà
_LARGEFILE64_SOURCE


206 
	#_LARGEFILE64_SOURCE
 1

	)

207 #undeà
_DEFAULT_SOURCE


208 
	#_DEFAULT_SOURCE
 1

	)

209 #undeà
_ATFILE_SOURCE


210 
	#_ATFILE_SOURCE
 1

	)

215 #ià(
defšed
 
_DEFAULT_SOURCE
 \

216 || (!
defšed
 
	g__STRICT_ANSI__
 \

217 && !
defšed
 
	g_ISOC99_SOURCE
 \

218 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

219 && !
defšed
 
	g_XOPEN_SOURCE
))

220 #undeà
_DEFAULT_SOURCE


221 
	#_DEFAULT_SOURCE
 1

	)

225 #ià(
defšed
 
_ISOC11_SOURCE
 \

226 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

227 
	#__USE_ISOC11
 1

	)

231 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

232 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

233 
	#__USE_ISOC99
 1

	)

237 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

238 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

239 
	#__USE_ISOC95
 1

	)

242 #ifdeà
__ılu¥lus


244 #ià
__ılu¥lus
 >= 201703L

245 
	#__USE_ISOC11
 1

	)

249 #ià
__ılu¥lus
 >ğ201103L || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__


250 
	#__USE_ISOCXX11
 1

	)

251 
	#__USE_ISOC99
 1

	)

258 #ifdeà
_DEFAULT_SOURCE


259 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


260 
	#__USE_POSIX_IMPLICITLY
 1

	)

262 #undeà
_POSIX_SOURCE


263 
	#_POSIX_SOURCE
 1

	)

264 #undeà
_POSIX_C_SOURCE


265 
	#_POSIX_C_SOURCE
 200809L

	)

268 #ià((!
defšed
 
__STRICT_ANSI__
 \

269 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

270 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

271 
	#_POSIX_SOURCE
 1

	)

272 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

273 
	#_POSIX_C_SOURCE
 2

	)

274 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

275 
	#_POSIX_C_SOURCE
 199506L

	)

276 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

277 
	#_POSIX_C_SOURCE
 200112L

	)

279 
	#_POSIX_C_SOURCE
 200809L

	)

281 
	#__USE_POSIX_IMPLICITLY
 1

	)

290 #ià((!
defšed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

291 && (
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE
))

292 
	#_POSIX_SOURCE
 1

	)

293 #undeà
_POSIX_C_SOURCE


294 
	#_POSIX_C_SOURCE
 199506L

	)

297 #ià(
defšed
 
_POSIX_SOURCE
 \

298 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

299 || 
defšed
 
_XOPEN_SOURCE
)

300 
	#__USE_POSIX
 1

	)

303 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


304 
	#__USE_POSIX2
 1

	)

307 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

308 
	#__USE_POSIX199309
 1

	)

311 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

312 
	#__USE_POSIX199506
 1

	)

315 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

316 
	#__USE_XOPEN2K
 1

	)

317 #undeà
__USE_ISOC95


318 
	#__USE_ISOC95
 1

	)

319 #undeà
__USE_ISOC99


320 
	#__USE_ISOC99
 1

	)

323 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

324 
	#__USE_XOPEN2K8
 1

	)

325 #undeà
_ATFILE_SOURCE


326 
	#_ATFILE_SOURCE
 1

	)

329 #ifdef 
_XOPEN_SOURCE


330 
	#__USE_XOPEN
 1

	)

331 #ià(
_XOPEN_SOURCE
 - 0) >= 500

332 
	#__USE_XOPEN_EXTENDED
 1

	)

333 
	#__USE_UNIX98
 1

	)

334 #undeà
_LARGEFILE_SOURCE


335 
	#_LARGEFILE_SOURCE
 1

	)

336 #ià(
_XOPEN_SOURCE
 - 0) >= 600

337 #ià(
_XOPEN_SOURCE
 - 0) >= 700

338 
	#__USE_XOPEN2K8
 1

	)

339 
	#__USE_XOPEN2K8XSI
 1

	)

341 
	#__USE_XOPEN2K
 1

	)

342 
	#__USE_XOPEN2KXSI
 1

	)

343 #undeà
__USE_ISOC95


344 
	#__USE_ISOC95
 1

	)

345 #undeà
__USE_ISOC99


346 
	#__USE_ISOC99
 1

	)

349 #ifdeà
_XOPEN_SOURCE_EXTENDED


350 
	#__USE_XOPEN_EXTENDED
 1

	)

355 #ifdeà
_LARGEFILE_SOURCE


356 
	#__USE_LARGEFILE
 1

	)

359 #ifdeà
_LARGEFILE64_SOURCE


360 
	#__USE_LARGEFILE64
 1

	)

363 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

364 
	#__USE_FILE_OFFSET64
 1

	)

367 #ià
defšed
 
_DEFAULT_SOURCE


368 
	#__USE_MISC
 1

	)

371 #ifdef 
_ATFILE_SOURCE


372 
	#__USE_ATFILE
 1

	)

375 #ifdef 
_GNU_SOURCE


376 
	#__USE_GNU
 1

	)

379 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

380 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

381 #ià
_FORTIFY_SOURCE
 > 1

382 
	#__USE_FORTIFY_LEVEL
 2

	)

384 
	#__USE_FORTIFY_LEVEL
 1

	)

387 
	#__USE_FORTIFY_LEVEL
 0

	)

394 #ià
defšed
 
__ılu¥lus
 ? __ılu¥lu >ğ201402L : defšed 
__USE_ISOC11


395 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

397 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

402 
	~<¡dc-´edef.h
>

410 #undeà
__GNU_LIBRARY__


411 
	#__GNU_LIBRARY__
 6

	)

415 
	#__GLIBC__
 2

	)

416 
	#__GLIBC_MINOR__
 27

	)

418 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

419 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

422 #iâdeà
__ASSEMBLER__


423 #iâdeà
_SYS_CDEFS_H


424 
	~<sys/cdefs.h
>

429 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


430 
	#__USE_LARGEFILE
 1

	)

431 
	#__USE_LARGEFILE64
 1

	)

437 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

438 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

439 && 
defšed
 
	g__ex‹º_šlše


440 
	#__USE_EXTERN_INLINES
 1

	)

448 
	~<gnu/¡ubs.h
>

	@/usr/include/netinet/in.h

18 #iâdef 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<b™s/¡dšt-ušŠ.h
>

23 
	~<sys/sock‘.h
>

24 
	~<b™s/ty³s.h
>

27 
__BEGIN_DECLS


30 
ušt32_t
 
	tš_addr_t
;

31 
	sš_addr


33 
š_addr_t
 
	ms_addr
;

37 
	~<b™s/š.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_MPLS
 = 137,

89 
	#IPPROTO_MPLS
 
IPPROTO_MPLS


	)

90 
	mIPPROTO_RAW
 = 255,

91 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

92 
	mIPPROTO_MAX


98 #ià!
__USE_KERNEL_IPV6_DEFS


101 
	mIPPROTO_HOPOPTS
 = 0,

102 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

103 
	mIPPROTO_ROUTING
 = 43,

104 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

105 
	mIPPROTO_FRAGMENT
 = 44,

106 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

107 
	mIPPROTO_ICMPV6
 = 58,

108 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

109 
	mIPPROTO_NONE
 = 59,

110 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

111 
	mIPPROTO_DSTOPTS
 = 60,

112 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

113 
	mIPPROTO_MH
 = 135

114 
	#IPPROTO_MH
 
IPPROTO_MH


	)

119 
ušt16_t
 
	tš_pÜt_t
;

124 
	mIPPORT_ECHO
 = 7,

125 
	mIPPORT_DISCARD
 = 9,

126 
	mIPPORT_SYSTAT
 = 11,

127 
	mIPPORT_DAYTIME
 = 13,

128 
	mIPPORT_NETSTAT
 = 15,

129 
	mIPPORT_FTP
 = 21,

130 
	mIPPORT_TELNET
 = 23,

131 
	mIPPORT_SMTP
 = 25,

132 
	mIPPORT_TIMESERVER
 = 37,

133 
	mIPPORT_NAMESERVER
 = 42,

134 
	mIPPORT_WHOIS
 = 43,

135 
	mIPPORT_MTP
 = 57,

137 
	mIPPORT_TFTP
 = 69,

138 
	mIPPORT_RJE
 = 77,

139 
	mIPPORT_FINGER
 = 79,

140 
	mIPPORT_TTYLINK
 = 87,

141 
	mIPPORT_SUPDUP
 = 95,

144 
	mIPPORT_EXECSERVER
 = 512,

145 
	mIPPORT_LOGINSERVER
 = 513,

146 
	mIPPORT_CMDSERVER
 = 514,

147 
	mIPPORT_EFSSERVER
 = 520,

150 
	mIPPORT_BIFFUDP
 = 512,

151 
	mIPPORT_WHOSERVER
 = 513,

152 
	mIPPORT_ROUTESERVER
 = 520,

155 
	mIPPORT_RESERVED
 = 1024,

158 
	mIPPORT_USERRESERVED
 = 5000

166 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

167 
	#IN_CLASSA_NET
 0xff000000

	)

168 
	#IN_CLASSA_NSHIFT
 24

	)

169 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

170 
	#IN_CLASSA_MAX
 128

	)

172 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

173 
	#IN_CLASSB_NET
 0xffff0000

	)

174 
	#IN_CLASSB_NSHIFT
 16

	)

175 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

176 
	#IN_CLASSB_MAX
 65536

	)

178 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

179 
	#IN_CLASSC_NET
 0xffffff00

	)

180 
	#IN_CLASSC_NSHIFT
 8

	)

181 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

183 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

184 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

186 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

187 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

190 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

192 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

194 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

197 
	#IN_LOOPBACKNET
 127

	)

199 #iâdeà
INADDR_LOOPBACK


200 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

204 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

205 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

206 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

207 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

209 #ià!
__USE_KERNEL_IPV6_DEFS


211 
	sš6_addr


215 
ušt8_t
 
	m__u6_addr8
[16];

216 
ušt16_t
 
	m__u6_addr16
[8];

217 
ušt32_t
 
	m__u6_addr32
[4];

218 } 
	m__š6_u
;

219 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

220 #ifdeà
__USE_MISC


221 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

222 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

227 cÚ¡ 
š6_addr
 
š6addr_ªy
;

228 cÚ¡ 
š6_addr
 
š6addr_loİback
;

229 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

230 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

232 
	#INET_ADDRSTRLEN
 16

	)

233 
	#INET6_ADDRSTRLEN
 46

	)

237 
	ssockaddr_š


239 
__SOCKADDR_COMMON
 (
sš_
);

240 
š_pÜt_t
 
	msš_pÜt
;

241 
š_addr
 
	msš_addr
;

244 
	msš_z”o
[ (
sockaddr
) -

245 
__SOCKADDR_COMMON_SIZE
 -

246  (
š_pÜt_t
) -

247  (
š_addr
)];

250 #ià!
__USE_KERNEL_IPV6_DEFS


252 
	ssockaddr_š6


254 
__SOCKADDR_COMMON
 (
sš6_
);

255 
š_pÜt_t
 
	msš6_pÜt
;

256 
ušt32_t
 
	msš6_æowšfo
;

257 
š6_addr
 
	msš6_addr
;

258 
ušt32_t
 
	msš6_scİe_id
;

262 #ifdeà
__USE_MISC


264 
	s_m»q


267 
š_addr
 
	mimr_muÉŸddr
;

270 
š_addr
 
	mimr_š‹rçû
;

273 
	s_m»q_sourû


276 
š_addr
 
	mimr_muÉŸddr
;

279 
š_addr
 
	mimr_š‹rçû
;

282 
š_addr
 
	mimr_sourûaddr
;

286 #ià!
__USE_KERNEL_IPV6_DEFS


288 
	sv6_m»q


291 
š6_addr
 
	mv6mr_muÉŸddr
;

294 
	mv6mr_š‹rçû
;

298 #ifdeà
__USE_MISC


300 
	sgroup_»q


303 
ušt32_t
 
	mgr_š‹rçû
;

306 
sockaddr_¡Üage
 
	mgr_group
;

309 
	sgroup_sourû_»q


312 
ušt32_t
 
	mg¤_š‹rçû
;

315 
sockaddr_¡Üage
 
	mg¤_group
;

318 
sockaddr_¡Üage
 
	mg¤_sourû
;

323 
	s_msf‹r


326 
š_addr
 
	mimsf_muÉŸddr
;

329 
š_addr
 
	mimsf_š‹rçû
;

332 
ušt32_t
 
	mimsf_fmode
;

335 
ušt32_t
 
	mimsf_num¤c
;

337 
š_addr
 
	mimsf_¦i¡
[1];

340 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

341 -  (
š_addr
) \

342 + (
num¤c
è*  (
š_addr
))

	)

344 
	sgroup_f‹r


347 
ušt32_t
 
	mgf_š‹rçû
;

350 
sockaddr_¡Üage
 
	mgf_group
;

353 
ušt32_t
 
	mgf_fmode
;

356 
ušt32_t
 
	mgf_num¤c
;

358 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

361 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

362 -  (
sockaddr_¡Üage
) \

363 + ((
num¤c
) \

364 *  (
sockaddr_¡Üage
)))

	)

374 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

375 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

376 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

377 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

378 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

379 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

380 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

382 
	~<’dŸn.h
>

385 
	~<b™s/by‹sw­.h
>

386 
	~<b™s/ušŠ-id’t™y.h
>

388 #ifdeà
__OPTIMIZE__


392 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


395 
	#Áohl
(
x
è
	`__ušt32_id’t™y
 (x)

	)

396 
	#Áohs
(
x
è
	`__ušt16_id’t™y
 (x)

	)

397 
	#htÚl
(
x
è
	`__ušt32_id’t™y
 (x)

	)

398 
	#htÚs
(
x
è
	`__ušt16_id’t™y
 (x)

	)

400 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


401 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

402 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

403 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

404 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

409 #ifdeà
__GNUC__


410 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

411 (
__ex‹nsiÚ__
 \

412 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

413 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

414 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

415 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

416 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ0; 
	}
}))

	)

418 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

419 (
__ex‹nsiÚ__
 \

420 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

421 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

422 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

423 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

424 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ
	`htÚl
 (1); }))

	)

426 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

427 (
__ex‹nsiÚ__
 \

428 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

429 (
__a
->
__š6_u
.
__u6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xã800000); }))

	)

431 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

432 (
__ex‹nsiÚ__
 \

433 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

434 (
__a
->
__š6_u
.
__u6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xãc00000); }))

	)

436 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

437 (
__ex‹nsiÚ__
 \

438 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

439 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

440 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

441 && 
__a
->
__š6_u
.
__u6_addr32
[2] =ğ
	`htÚl
 (0xffff); }))

	)

443 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

444 (
__ex‹nsiÚ__
 \

445 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

446 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

447 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

448 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

449 && 
	`Áohl
 (
__a
->
__š6_u
.
__u6_addr32
[3]è> 1; }))

	)

451 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

452 (
__ex‹nsiÚ__
 \

453 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

454 cÚ¡ 
š6_addr
 *
__b
 = (cÚ¡ š6_add¸*è(
b
); \

455 
__a
->
__š6_u
.
__u6_addr32
[0] =ğ
__b
->__in6_u.__u6_addr32[0] \

456 && 
__a
->
__š6_u
.
__u6_addr32
[1] =ğ
__b
->__in6_u.__u6_addr32[1] \

457 && 
__a
->
__š6_u
.
__u6_addr32
[2] =ğ
__b
->__in6_u.__u6_addr32[2] \

458 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ
__b
->__š6_u.__u6_addr32[3]; }))

	)

460 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

461 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

462 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

463 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

464 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

466 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

467 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

468 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

469 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

470 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

472 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

473 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

474 =ğ
	`htÚl
 (0xã800000))

	)

476 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

477 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

478 =ğ
	`htÚl
 (0xãc00000))

	)

480 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

481 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

482 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

483 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

485 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

486 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

487 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

488 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0) \

489 && (
	`Áohl
 (((cÚ¡ 
ušt32_t
 *è(
a
))[3]è> 1))

	)

491 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

492 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[0]) \

493 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[1]) \

494 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[2]) \

495 && (((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

498 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((cÚ¡ 
ušt8_t
 *è×))[0] =ğ0xff)

	)

500 #ifdeà
__USE_MISC


502 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

505 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

506 
__THROW
;

510 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

511 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

512 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

514 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

515 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

516 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

518 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

519 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

520 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

522 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

523 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

524 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

526 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

527 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

528 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

531 #ifdeà
__USE_GNU


532 
cmsghdr
;

534 #ià!
__USE_KERNEL_IPV6_DEFS


536 
	sš6_pktšfo


538 
š6_addr
 
i6_addr
;

539 
i6_ifšdex
;

543 
	s6_mtušfo


545 
sockaddr_š6
 
6m_addr
;

546 
ušt32_t
 
6m_mtu
;

551 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

552 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

553 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

554 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

555 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

556 cÚ¡ 
ušt8_t
 *
__ty³p
, 
__muÉx
,

557 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

558 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

559 
__muÉx
, 
__¶usy
)

560 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

561 
	$š‘6_İtiÚ_Ãxt
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

562 
ušt8_t
 **
__Œp
)

563 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

564 
	$š‘6_İtiÚ_fšd
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

565 
ušt8_t
 **
__Œp
, 
__ty³
)

566 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

570 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

571 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

572 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

573 **
__d©abuå
è
__THROW
;

574 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

575 
__THROW
;

576 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

577 
sockËn_t
 
__v®Ën
è
__THROW
;

578 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

579 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

580 **
__d©abuå
è
__THROW
;

581 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

582 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

583 **
__d©abuå
è
__THROW
;

584 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

585 
sockËn_t
 
__v®Ën
è
__THROW
;

589 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

590 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

591 
__£gm’ts
è
__THROW
;

592 
	$š‘6_¹h_add
 (*
__bp
, cÚ¡ 
š6_addr
 *
__addr
è
__THROW
;

593 
	$š‘6_¹h_»v”£
 (cÚ¡ *
__š
, *
__out
è
__THROW
;

594 
	$š‘6_¹h_£gm’ts
 (cÚ¡ *
__bp
è
__THROW
;

595 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (cÚ¡ *
__bp
, 
__šdex
)

596 
__THROW
;

602 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

603 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

604 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

605 
__THROW
;

608 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

609 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

610 
ušt32_t
 
__num¤c
,

611 cÚ¡ 
š_addr
 *
__¦i¡
)

612 
__THROW
;

616 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

617 cÚ¡ 
sockaddr
 *
__group
,

618 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

619 
ušt32_t
 *
__num¤c
,

620 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

623 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

624 cÚ¡ 
sockaddr
 *
__group
,

625 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

626 
ušt32_t
 
__num¤c
,

627 cÚ¡ 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

630 
__END_DECLS


	@/usr/include/sched.h

19 #iâdef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

27 
	#__Ãed_size_t


	)

28 
	#__Ãed_NULL


	)

29 
	~<¡ddef.h
>

31 
	~<b™s/ty³s/time_t.h
>

32 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

33 #iâdeà
__USE_XOPEN2K


34 
	~<time.h
>

37 #iâdeà
__pid_t_defšed


38 
__pid_t
 
	tpid_t
;

39 
	#__pid_t_defšed


	)

43 
	~<b™s/sched.h
>

44 
	~<b™s/ıu-£t.h
>

47 
	#sched_´iÜ™y
 
sched_´iÜ™y


	)

48 
	#__sched_´iÜ™y
 
sched_´iÜ™y


	)

51 
__BEGIN_DECLS


54 
	$sched_£¬am
 (
__pid_t
 
__pid
, cÚ¡ 
sched_·¿m
 *
__·¿m
)

55 
__THROW
;

58 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

61 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

62 cÚ¡ 
sched_·¿m
 *
__·¿m
è
__THROW
;

65 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

68 
	$sched_y›ld
 (è
__THROW
;

71 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

74 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

77 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

80 #ifdeà
__USE_GNU


82 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

83 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

84 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

85 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

86 
ıu£
)

	)

87 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

88 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

90 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

91 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

92 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

93 
ıu£
)

	)

94 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

95 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

97 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

98 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

99 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

100 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

102 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

103 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

104 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

105 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

106 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

107 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

108 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

109 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

110 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

111 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

112 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

113 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

115 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

116 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

117 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

121 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

122 cÚ¡ 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

125 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

126 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

129 
__END_DECLS


	@/usr/include/strings.h

18 #iâdef 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	#__Ãed_size_t


	)

23 
	~<¡ddef.h
>

26 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

27 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

30 
	g__BEGIN_DECLS


32 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


34 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

35 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

38 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

39 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

42 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

45 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


48 *
	`šdex
 (*
__s
, 
__c
)

49 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

50 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

51 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

53 #ià
defšed
 
__OPTIMIZE__


54 
__ex‹º_®ways_šlše
 *

55 
	`šdex
 (*
__s
, 
__c
è
__THROW


57  
	`__butš_šdex
 (
__s
, 
__c
);

60 
__ex‹º_®ways_šlše
 const *

61 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


63  
	`__butš_šdex
 (
__s
, 
__c
);

66 
	}
}

68 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

69 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

73 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


76 *
	`ršdex
 (*
__s
, 
__c
)

77 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

78 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

79 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ià
defšed
 
__OPTIMIZE__


82 
__ex‹º_®ways_šlše
 *

83 
	`ršdex
 (*
__s
, 
__c
è
__THROW


85  
	`__butš_ršdex
 (
__s
, 
__c
);

88 
__ex‹º_®ways_šlše
 const *

89 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


91  
	`__butš_ršdex
 (
__s
, 
__c
);

94 
	}
}

96 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

97 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

101 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8
 || defšed 
__USE_XOPEN2K8XSI


104 
	$ffs
 (
__i
è
__THROW
 
__©Œibu‹_cÚ¡__
;

109 #ifdef 
__USE_MISC


110 
	$ff¦
 (
__l
è
__THROW
 
__©Œibu‹_cÚ¡__
;

111 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

112 
__THROW
 
__©Œibu‹_cÚ¡__
;

116 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

117 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

120 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

123 #ifdef 
__USE_XOPEN2K8


125 
	~<b™s/ty³s/loÿË_t.h
>

128 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
loÿË_t
 
__loc
)

129 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

133 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

134 
size_t
 
__n
, 
loÿË_t
 
__loc
)

135 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

138 
__END_DECLS


140 #ià
	`__GNUC_PREREQ
 (3,4è&& 
__USE_FORTIFY_LEVEL
 > 0 \

141 && 
defšed
 
__fÜtify_funùiÚ


143 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


144 
	~<b™s/¡ršgs_fÜtif›d.h
>

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

61 
	#__STDC_NO_THREADS__
 1

	)

	@
1
.
1
/usr/include
89
1685
App/App.cpp
App/App.h
App/Enclave_u.c
App/Enclave_u.h
App/activations.cpp
App/activations.h
App/avgpool_layer.h
App/blas.cpp
App/blas.h
App/connected_layer.h
App/convolutional_layer.h
App/cost_layer.h
App/darknet.h
App/data.cpp
App/data.h
App/dropout_layer.h
App/image.cpp
App/image.h
App/layer.h
App/list.cpp
App/list.h
App/matrix.cpp
App/matrix.h
App/maxpool_layer.h
App/network.cpp
App/network.h
App/option_list.cpp
App/option_list.h
App/parser.cpp
App/parser.h
App/socket_api.h
App/socket_client.cpp
App/socket_server.cpp
App/softmax_layer.h
App/stb_image.h
App/stb_image_write.h
App/tree.cpp
App/tree.h
App/utils.cpp
App/utils.h
Enclave/Enclave.cpp
Enclave/Enclave.h
Enclave/Enclave_t.c
Enclave/Enclave_t.h
Enclave/activations_TA.cpp
Enclave/activations_TA.h
Enclave/aes-common.h
Enclave/aes-gcm-entry.cpp
Enclave/aes-gcm.cpp
Enclave/aes-internal-enc.cpp
Enclave/aes-internal.cpp
Enclave/aes-internal.h
Enclave/aes.h
Enclave/aes_TA.cpp
Enclave/aes_TA.h
Enclave/blas_TA.cpp
Enclave/blas_TA.h
Enclave/darknet_TA.h
Enclave/darknetp_ta.h
Enclave/gemm_TA.cpp
Enclave/gemm_TA.h
Enclave/im2col_TA.cpp
Enclave/im2col_TA.h
Enclave/math_TA.cpp
Enclave/math_TA.h
Enclave/utils_TA.cpp
Enclave/utils_TA.h
/usr/include/arpa/inet.h
/usr/include/assert.h
/usr/include/ctype.h
/usr/include/err.h
/usr/include/errno.h
/usr/include/limits.h
/usr/include/math.h
/usr/include/pthread.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/wchar.h
/usr/include/alloca.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/netinet/in.h
/usr/include/sched.h
/usr/include/strings.h
/usr/include/stdc-predef.h
